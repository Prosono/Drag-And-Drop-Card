{
  "version": 3,
  "sources": ["../node_modules/@interactjs/utils/isWindow.ts", "../node_modules/@interactjs/utils/window.ts", "../node_modules/@interactjs/utils/is.ts", "../node_modules/@interactjs/actions/drag/plugin.ts", "../node_modules/@interactjs/utils/domObjects.ts", "../node_modules/@interactjs/utils/browser.ts", "../node_modules/@interactjs/utils/domUtils.ts", "../node_modules/@interactjs/utils/extend.ts", "../node_modules/@interactjs/utils/rect.ts", "../node_modules/@interactjs/utils/getOriginXY.ts", "../node_modules/@interactjs/utils/normalizeListeners.ts", "../node_modules/@interactjs/utils/hypot.ts", "../node_modules/@interactjs/utils/pointerExtend.ts", "../node_modules/@interactjs/utils/pointerUtils.ts", "../node_modules/@interactjs/core/BaseEvent.ts", "../node_modules/@interactjs/utils/arr.ts", "../node_modules/@interactjs/actions/drop/DropEvent.ts", "../node_modules/@interactjs/actions/drop/plugin.ts", "../node_modules/@interactjs/actions/gesture/plugin.ts", "../node_modules/@interactjs/actions/resize/plugin.ts", "../node_modules/@interactjs/utils/raf.ts", "../node_modules/@interactjs/actions/plugin.ts", "../node_modules/@interactjs/auto-scroll/plugin.ts", "../node_modules/@interactjs/utils/misc.ts", "../node_modules/@interactjs/auto-start/InteractableMethods.ts", "../node_modules/@interactjs/auto-start/base.ts", "../node_modules/@interactjs/auto-start/dragAxis.ts", "../node_modules/@interactjs/auto-start/hold.ts", "../node_modules/@interactjs/auto-start/plugin.ts", "../node_modules/@interactjs/core/interactablePreventDefault.ts", "../node_modules/@interactjs/utils/isNonNativeEvent.ts", "../node_modules/@interactjs/utils/clone.ts", "../node_modules/@interactjs/modifiers/Modification.ts", "../node_modules/@interactjs/modifiers/base.ts", "../node_modules/@interactjs/core/options.ts", "../node_modules/@interactjs/core/InteractEvent.ts", "../node_modules/@interactjs/core/PointerInfo.ts", "../node_modules/@interactjs/core/Interaction.ts", "../node_modules/@interactjs/offset/plugin.ts", "../node_modules/@interactjs/inertia/plugin.ts", "../node_modules/@interactjs/core/Eventable.ts", "../node_modules/@interactjs/core/events.ts", "../node_modules/@interactjs/core/interactionFinder.ts", "../node_modules/@interactjs/core/interactions.ts", "../node_modules/@interactjs/core/Interactable.ts", "../node_modules/@interactjs/core/InteractableSet.ts", "../node_modules/@interactjs/core/scope.ts", "../node_modules/@interactjs/core/InteractStatic.ts", "../node_modules/@interactjs/interact/index.ts", "../node_modules/@interactjs/snappers/edgeTarget.ts", "../node_modules/@interactjs/snappers/elements.ts", "../node_modules/@interactjs/snappers/grid.ts", "../node_modules/@interactjs/snappers/plugin.ts", "../node_modules/@interactjs/modifiers/aspectRatio.ts", "../node_modules/@interactjs/modifiers/noop.ts", "../node_modules/@interactjs/modifiers/restrict/pointer.ts", "../node_modules/@interactjs/modifiers/restrict/edges.ts", "../node_modules/@interactjs/modifiers/restrict/rect.ts", "../node_modules/@interactjs/modifiers/restrict/size.ts", "../node_modules/@interactjs/modifiers/snap/pointer.ts", "../node_modules/@interactjs/modifiers/snap/size.ts", "../node_modules/@interactjs/modifiers/snap/edges.ts", "../node_modules/@interactjs/modifiers/all.ts", "../node_modules/@interactjs/modifiers/plugin.ts", "../node_modules/@interactjs/pointer-events/PointerEvent.ts", "../node_modules/@interactjs/pointer-events/base.ts", "../node_modules/@interactjs/pointer-events/holdRepeat.ts", "../node_modules/@interactjs/pointer-events/interactableTargets.ts", "../node_modules/@interactjs/pointer-events/plugin.ts", "../node_modules/@interactjs/reflow/plugin.ts", "../node_modules/interactjs/index.ts", "../node_modules/@interactjs/interactjs/index.ts", "../src/drag-and-drop-card.js", "../node_modules/js-yaml/dist/js-yaml.mjs"],
  "sourcesContent": ["export default (thing: any) => !!(thing && thing.Window) && thing instanceof thing.Window\n", "import isWindow from './isWindow'\n\nexport let realWindow = undefined as Window\n\nlet win = undefined as Window\nexport { win as window }\n\nexport function init(window: Window & { wrap?: (...args: any[]) => any }) {\n  // get wrapped window if using Shadow DOM polyfill\n\n  realWindow = window\n\n  // create a TextNode\n  const el = window.document.createTextNode('')\n\n  // check if it's wrapped by a polyfill\n  if (el.ownerDocument !== window.document && typeof window.wrap === 'function' && window.wrap(el) === el) {\n    // use wrapped window\n    window = window.wrap(window)\n  }\n\n  win = window\n}\n\nif (typeof window !== 'undefined' && !!window) {\n  init(window)\n}\n\nexport function getWindow(node: any) {\n  if (isWindow(node)) {\n    return node\n  }\n\n  const rootNode = node.ownerDocument || node\n\n  return rootNode.defaultView || win.window\n}\n", "import isWindow from './isWindow'\nimport * as win from './window'\n\nconst window = (thing: any): thing is Window => thing === win.window || isWindow(thing)\n\nconst docFrag = (thing: any): thing is DocumentFragment => object(thing) && thing.nodeType === 11\n\nconst object = (thing: any): thing is { [index: string]: any } => !!thing && typeof thing === 'object'\n\nconst func = (thing: any): thing is (...args: any[]) => any => typeof thing === 'function'\n\nconst number = (thing: any): thing is number => typeof thing === 'number'\n\nconst bool = (thing: any): thing is boolean => typeof thing === 'boolean'\n\nconst string = (thing: any): thing is string => typeof thing === 'string'\n\nconst element = (thing: any): thing is HTMLElement | SVGElement => {\n  if (!thing || typeof thing !== 'object') {\n    return false\n  }\n\n  const _window = win.getWindow(thing) || win.window\n\n  return /object|function/.test(typeof Element)\n    ? thing instanceof Element || thing instanceof _window.Element\n    : thing.nodeType === 1 && typeof thing.nodeName === 'string'\n}\n\nconst plainObject: typeof object = (thing: any): thing is { [index: string]: any } =>\n  object(thing) && !!thing.constructor && /function Object\\b/.test(thing.constructor.toString())\n\nconst array = <T extends unknown>(thing: any): thing is T[] =>\n  object(thing) && typeof thing.length !== 'undefined' && func(thing.splice)\n\nexport default {\n  window,\n  docFrag,\n  object,\n  func,\n  number,\n  bool,\n  string,\n  element,\n  plainObject,\n  array,\n}\n", "import type { Interactable } from '@interactjs/core/Interactable'\nimport type { InteractEvent } from '@interactjs/core/InteractEvent'\nimport type { PerActionDefaults } from '@interactjs/core/options'\nimport type { Scope, Plugin } from '@interactjs/core/scope'\nimport type { ListenersArg, OrBoolean } from '@interactjs/core/types'\nimport is from '@interactjs/utils/is'\n\ndeclare module '@interactjs/core/Interactable' {\n  interface Interactable {\n    draggable(options: Partial<OrBoolean<DraggableOptions>> | boolean): this\n    draggable(): DraggableOptions\n    /**\n     * ```js\n     * interact(element).draggable({\n     *     onstart: function (event) {},\n     *     onmove : function (event) {},\n     *     onend  : function (event) {},\n     *\n     *     // the axis in which the first movement must be\n     *     // for the drag sequence to start\n     *     // 'xy' by default - any direction\n     *     startAxis: 'x' || 'y' || 'xy',\n     *\n     *     // 'xy' by default - don't restrict to one axis (move in any direction)\n     *     // 'x' or 'y' to restrict movement to either axis\n     *     // 'start' to restrict movement to the axis the drag started in\n     *     lockAxis: 'x' || 'y' || 'xy' || 'start',\n     *\n     *     // max number of drags that can happen concurrently\n     *     // with elements of this Interactable. Infinity by default\n     *     max: Infinity,\n     *\n     *     // max number of drags that can target the same element+Interactable\n     *     // 1 by default\n     *     maxPerElement: 2\n     * })\n     *\n     * var isDraggable = interact('element').draggable(); // true\n     * ```\n     *\n     * Get or set whether drag actions can be performed on the target\n     *\n     * @param options - true/false or An object with event\n     * listeners to be fired on drag events (object makes the Interactable\n     * draggable)\n     */\n    draggable(options?: Partial<OrBoolean<DraggableOptions>> | boolean): this | DraggableOptions\n  }\n}\n\ndeclare module '@interactjs/core/options' {\n  interface ActionDefaults {\n    drag: DraggableOptions\n  }\n}\n\ndeclare module '@interactjs/core/types' {\n  interface ActionMap {\n    drag?: typeof drag\n  }\n}\n\nexport type DragEvent = InteractEvent<'drag'>\n\nexport interface DraggableOptions extends PerActionDefaults {\n  startAxis?: 'x' | 'y' | 'xy'\n  lockAxis?: 'x' | 'y' | 'xy' | 'start'\n  oninertiastart?: ListenersArg\n  onstart?: ListenersArg\n  onmove?: ListenersArg\n  onend?: ListenersArg\n}\n\nfunction install(scope: Scope) {\n  const { actions, Interactable, defaults } = scope\n\n  Interactable.prototype.draggable = drag.draggable\n\n  actions.map.drag = drag\n  actions.methodDict.drag = 'draggable'\n\n  defaults.actions.drag = drag.defaults\n}\n\nfunction beforeMove({ interaction }) {\n  if (interaction.prepared.name !== 'drag') return\n\n  const axis = interaction.prepared.axis\n\n  if (axis === 'x') {\n    interaction.coords.cur.page.y = interaction.coords.start.page.y\n    interaction.coords.cur.client.y = interaction.coords.start.client.y\n\n    interaction.coords.velocity.client.y = 0\n    interaction.coords.velocity.page.y = 0\n  } else if (axis === 'y') {\n    interaction.coords.cur.page.x = interaction.coords.start.page.x\n    interaction.coords.cur.client.x = interaction.coords.start.client.x\n\n    interaction.coords.velocity.client.x = 0\n    interaction.coords.velocity.page.x = 0\n  }\n}\n\nfunction move({ iEvent, interaction }) {\n  if (interaction.prepared.name !== 'drag') return\n\n  const axis = interaction.prepared.axis\n\n  if (axis === 'x' || axis === 'y') {\n    const opposite = axis === 'x' ? 'y' : 'x'\n\n    iEvent.page[opposite] = interaction.coords.start.page[opposite]\n    iEvent.client[opposite] = interaction.coords.start.client[opposite]\n    iEvent.delta[opposite] = 0\n  }\n}\n\nconst draggable: Interactable['draggable'] = function draggable(\n  this: Interactable,\n  options?: DraggableOptions | boolean,\n): any {\n  if (is.object(options)) {\n    this.options.drag.enabled = options.enabled !== false\n    this.setPerAction('drag', options)\n    this.setOnEvents('drag', options)\n\n    if (/^(xy|x|y|start)$/.test(options.lockAxis)) {\n      this.options.drag.lockAxis = options.lockAxis\n    }\n    if (/^(xy|x|y)$/.test(options.startAxis)) {\n      this.options.drag.startAxis = options.startAxis\n    }\n\n    return this\n  }\n\n  if (is.bool(options)) {\n    this.options.drag.enabled = options\n\n    return this\n  }\n\n  return this.options.drag as DraggableOptions\n}\n\nconst drag: Plugin = {\n  id: 'actions/drag',\n  install,\n  listeners: {\n    'interactions:before-action-move': beforeMove,\n    'interactions:action-resume': beforeMove,\n\n    // dragmove\n    'interactions:action-move': move,\n    'auto-start:check': (arg) => {\n      const { interaction, interactable, buttons } = arg\n      const dragOptions = interactable.options.drag\n\n      if (\n        !(dragOptions && dragOptions.enabled) ||\n        // check mouseButton setting if the pointer is down\n        (interaction.pointerIsDown &&\n          /mouse|pointer/.test(interaction.pointerType) &&\n          (buttons & interactable.options.drag.mouseButtons) === 0)\n      ) {\n        return undefined\n      }\n\n      arg.action = {\n        name: 'drag',\n        axis: dragOptions.lockAxis === 'start' ? dragOptions.startAxis : dragOptions.lockAxis,\n      }\n\n      return false\n    },\n  },\n  draggable,\n  beforeMove,\n  move,\n  defaults: {\n    startAxis: 'xy',\n    lockAxis: 'xy',\n  } as DraggableOptions,\n\n  getCursor() {\n    return 'move'\n  },\n\n  filterEventType: (type: string) => type.search('drag') === 0,\n}\n\nexport default drag\n", "const domObjects: {\n  init: any\n  document: Document\n  DocumentFragment: typeof DocumentFragment\n  SVGElement: typeof SVGElement\n  SVGSVGElement: typeof SVGSVGElement\n  SVGElementInstance: any\n  Element: typeof Element\n  HTMLElement: typeof HTMLElement\n  Event: typeof Event\n  Touch: typeof Touch\n  PointerEvent: typeof PointerEvent\n} = {\n  init,\n  document: null,\n  DocumentFragment: null,\n  SVGElement: null,\n  SVGSVGElement: null,\n  SVGElementInstance: null,\n  Element: null,\n  HTMLElement: null,\n  Event: null,\n  Touch: null,\n  PointerEvent: null,\n}\n\nfunction blank() {}\n\nexport default domObjects\n\nfunction init(window: Window) {\n  const win = window as any\n\n  domObjects.document = win.document\n  domObjects.DocumentFragment = win.DocumentFragment || blank\n  domObjects.SVGElement = win.SVGElement || blank\n  domObjects.SVGSVGElement = win.SVGSVGElement || blank\n  domObjects.SVGElementInstance = win.SVGElementInstance || blank\n  domObjects.Element = win.Element || blank\n  domObjects.HTMLElement = win.HTMLElement || domObjects.Element\n\n  domObjects.Event = win.Event\n  domObjects.Touch = win.Touch || blank\n  domObjects.PointerEvent = win.PointerEvent || win.MSPointerEvent\n}\n", "import domObjects from './domObjects'\nimport is from './is'\n\nconst browser = {\n  init,\n  supportsTouch: null as boolean,\n  supportsPointerEvent: null as boolean,\n  isIOS7: null as boolean,\n  isIOS: null as boolean,\n  isIe9: null as boolean,\n  isOperaMobile: null as boolean,\n  prefixedMatchesSelector: null as 'matches',\n  pEventTypes: null as {\n    up: string\n    down: string\n    over: string\n    out: string\n    move: string\n    cancel: string\n  },\n  wheelEvent: null as string,\n}\n\nfunction init(window: any) {\n  const Element = domObjects.Element\n  const navigator: Partial<Navigator> = window.navigator || {}\n\n  // Does the browser support touch input?\n  browser.supportsTouch =\n    'ontouchstart' in window ||\n    (is.func(window.DocumentTouch) && domObjects.document instanceof window.DocumentTouch)\n\n  // Does the browser support PointerEvents\n  // https://github.com/taye/interact.js/issues/703#issuecomment-471570492\n  browser.supportsPointerEvent = (navigator as any).pointerEnabled !== false && !!domObjects.PointerEvent\n\n  browser.isIOS = /iP(hone|od|ad)/.test(navigator.platform)\n\n  // scrolling doesn't change the result of getClientRects on iOS 7\n  browser.isIOS7 = /iP(hone|od|ad)/.test(navigator.platform) && /OS 7[^\\d]/.test(navigator.appVersion)\n\n  browser.isIe9 = /MSIE 9/.test(navigator.userAgent)\n\n  // Opera Mobile must be handled differently\n  browser.isOperaMobile =\n    navigator.appName === 'Opera' && browser.supportsTouch && /Presto/.test(navigator.userAgent)\n\n  // prefix matchesSelector\n  browser.prefixedMatchesSelector = (\n    'matches' in Element.prototype\n      ? 'matches'\n      : 'webkitMatchesSelector' in Element.prototype\n        ? 'webkitMatchesSelector'\n        : 'mozMatchesSelector' in Element.prototype\n          ? 'mozMatchesSelector'\n          : 'oMatchesSelector' in Element.prototype\n            ? 'oMatchesSelector'\n            : 'msMatchesSelector'\n  ) as 'matches'\n\n  browser.pEventTypes = browser.supportsPointerEvent\n    ? domObjects.PointerEvent === window.MSPointerEvent\n      ? {\n          up: 'MSPointerUp',\n          down: 'MSPointerDown',\n          over: 'mouseover',\n          out: 'mouseout',\n          move: 'MSPointerMove',\n          cancel: 'MSPointerCancel',\n        }\n      : {\n          up: 'pointerup',\n          down: 'pointerdown',\n          over: 'pointerover',\n          out: 'pointerout',\n          move: 'pointermove',\n          cancel: 'pointercancel',\n        }\n    : null\n\n  // because Webkit and Opera still use 'mousewheel' event type\n  browser.wheelEvent = domObjects.document && 'onmousewheel' in domObjects.document ? 'mousewheel' : 'wheel'\n}\n\nexport default browser\n", "import type { Rect, Target, Element } from '@interactjs/core/types'\n\nimport browser from './browser'\nimport domObjects from './domObjects'\nimport is from './is'\nimport * as win from './window'\n\nexport function nodeContains(parent: Node, child: Node) {\n  if (parent.contains) {\n    return parent.contains(child as Node)\n  }\n\n  while (child) {\n    if (child === parent) {\n      return true\n    }\n\n    child = (child as Node).parentNode\n  }\n\n  return false\n}\n\nexport function closest(element: Node, selector: string) {\n  while (is.element(element)) {\n    if (matchesSelector(element, selector)) {\n      return element\n    }\n\n    element = parentNode(element)\n  }\n\n  return null\n}\n\nexport function parentNode(node: Node | Document) {\n  let parent = node.parentNode\n\n  if (is.docFrag(parent)) {\n    // skip past #shado-root fragments\n    // tslint:disable-next-line\n    while ((parent = (parent as any).host) && is.docFrag(parent)) {\n      continue\n    }\n\n    return parent\n  }\n\n  return parent\n}\n\nexport function matchesSelector(element: Element, selector: string) {\n  // remove /deep/ from selectors if shadowDOM polyfill is used\n  if (win.window !== win.realWindow) {\n    selector = selector.replace(/\\/deep\\//g, ' ')\n  }\n\n  return element[browser.prefixedMatchesSelector](selector)\n}\n\nconst getParent = (el: Node | Document | ShadowRoot) => el.parentNode || (el as ShadowRoot).host\n\n// Test for the element that's \"above\" all other qualifiers\nexport function indexOfDeepestElement(elements: Element[] | NodeListOf<globalThis.Element>) {\n  let deepestNodeParents: Node[] = []\n  let deepestNodeIndex: number\n\n  for (let i = 0; i < elements.length; i++) {\n    const currentNode = elements[i]\n    const deepestNode: Node = elements[deepestNodeIndex]\n\n    // node may appear in elements array multiple times\n    if (!currentNode || i === deepestNodeIndex) {\n      continue\n    }\n\n    if (!deepestNode) {\n      deepestNodeIndex = i\n      continue\n    }\n\n    const currentNodeParent = getParent(currentNode)\n    const deepestNodeParent = getParent(deepestNode)\n\n    // check if the deepest or current are document.documentElement/rootElement\n    // - if the current node is, do nothing and continue\n    if (currentNodeParent === currentNode.ownerDocument) {\n      continue\n    }\n    // - if deepest is, update with the current node and continue to next\n    else if (deepestNodeParent === currentNode.ownerDocument) {\n      deepestNodeIndex = i\n      continue\n    }\n\n    // compare zIndex of siblings\n    if (currentNodeParent === deepestNodeParent) {\n      if (zIndexIsHigherThan(currentNode, deepestNode)) {\n        deepestNodeIndex = i\n      }\n\n      continue\n    }\n\n    // populate the ancestry array for the latest deepest node\n    deepestNodeParents = deepestNodeParents.length ? deepestNodeParents : getNodeParents(deepestNode)\n\n    let ancestryStart: Node\n\n    // if the deepest node is an HTMLElement and the current node is a non root svg element\n    if (\n      deepestNode instanceof domObjects.HTMLElement &&\n      currentNode instanceof domObjects.SVGElement &&\n      !(currentNode instanceof domObjects.SVGSVGElement)\n    ) {\n      // TODO: is this check necessary? Was this for HTML elements embedded in SVG?\n      if (currentNode === deepestNodeParent) {\n        continue\n      }\n\n      ancestryStart = currentNode.ownerSVGElement\n    } else {\n      ancestryStart = currentNode\n    }\n\n    const currentNodeParents = getNodeParents(ancestryStart, deepestNode.ownerDocument)\n    let commonIndex = 0\n\n    // get (position of closest common ancestor) + 1\n    while (\n      currentNodeParents[commonIndex] &&\n      currentNodeParents[commonIndex] === deepestNodeParents[commonIndex]\n    ) {\n      commonIndex++\n    }\n\n    const parents = [\n      currentNodeParents[commonIndex - 1],\n      currentNodeParents[commonIndex],\n      deepestNodeParents[commonIndex],\n    ]\n\n    if (parents[0]) {\n      let child = parents[0].lastChild\n\n      while (child) {\n        if (child === parents[1]) {\n          deepestNodeIndex = i\n          deepestNodeParents = currentNodeParents\n\n          break\n        } else if (child === parents[2]) {\n          break\n        }\n\n        child = child.previousSibling\n      }\n    }\n  }\n\n  return deepestNodeIndex\n}\n\nfunction getNodeParents(node: Node, limit?: Node) {\n  const parents: Node[] = []\n  let parent: Node = node\n  let parentParent: Node\n\n  while ((parentParent = getParent(parent)) && parent !== limit && parentParent !== parent.ownerDocument) {\n    parents.unshift(parent)\n    parent = parentParent\n  }\n\n  return parents\n}\n\nfunction zIndexIsHigherThan(higherNode: Node, lowerNode: Node) {\n  const higherIndex = parseInt(win.getWindow(higherNode).getComputedStyle(higherNode).zIndex, 10) || 0\n  const lowerIndex = parseInt(win.getWindow(lowerNode).getComputedStyle(lowerNode).zIndex, 10) || 0\n\n  return higherIndex >= lowerIndex\n}\n\nexport function matchesUpTo(element: Element, selector: string, limit: Node) {\n  while (is.element(element)) {\n    if (matchesSelector(element, selector)) {\n      return true\n    }\n\n    element = parentNode(element) as Element\n\n    if (element === limit) {\n      return matchesSelector(element, selector)\n    }\n  }\n\n  return false\n}\n\nexport function getActualElement(element: Element) {\n  return (element as any).correspondingUseElement || element\n}\n\nexport function getScrollXY(relevantWindow?: Window) {\n  relevantWindow = relevantWindow || win.window\n  return {\n    x: relevantWindow.scrollX || relevantWindow.document.documentElement.scrollLeft,\n    y: relevantWindow.scrollY || relevantWindow.document.documentElement.scrollTop,\n  }\n}\n\nexport function getElementClientRect(element: Element): Required<Rect> {\n  const clientRect =\n    element instanceof domObjects.SVGElement ? element.getBoundingClientRect() : element.getClientRects()[0]\n\n  return (\n    clientRect && {\n      left: clientRect.left,\n      right: clientRect.right,\n      top: clientRect.top,\n      bottom: clientRect.bottom,\n      width: clientRect.width || clientRect.right - clientRect.left,\n      height: clientRect.height || clientRect.bottom - clientRect.top,\n    }\n  )\n}\n\nexport function getElementRect(element: Element) {\n  const clientRect = getElementClientRect(element)\n\n  if (!browser.isIOS7 && clientRect) {\n    const scroll = getScrollXY(win.getWindow(element))\n\n    clientRect.left += scroll.x\n    clientRect.right += scroll.x\n    clientRect.top += scroll.y\n    clientRect.bottom += scroll.y\n  }\n\n  return clientRect\n}\n\nexport function getPath(node: Node | Document) {\n  const path = []\n\n  while (node) {\n    path.push(node)\n    node = parentNode(node)\n  }\n\n  return path\n}\n\nexport function trySelector(value: Target) {\n  if (!is.string(value)) {\n    return false\n  }\n\n  // an exception will be raised if it is invalid\n  domObjects.document.querySelector(value)\n  return true\n}\n", "export default function extend<T, U extends object>(dest: U & Partial<T>, source: T): T & U {\n  for (const prop in source) {\n    ;(dest as unknown as T)[prop] = source[prop]\n  }\n\n  const ret = dest as T & U\n\n  return ret\n}\n", "import type {\n  HasGetRect,\n  RectResolvable,\n  Rect,\n  Element,\n  Point,\n  FullRect,\n  EdgeOptions,\n} from '@interactjs/core/types'\n\nimport { closest, getElementRect, parentNode } from './domUtils'\nimport extend from './extend'\nimport is from './is'\n\nexport function getStringOptionResult(value: any, target: HasGetRect, element: Node) {\n  if (value === 'parent') {\n    return parentNode(element)\n  }\n\n  if (value === 'self') {\n    return target.getRect(element as Element)\n  }\n\n  return closest(element, value)\n}\n\nexport function resolveRectLike<T extends any[]>(\n  value: RectResolvable<T>,\n  target?: HasGetRect,\n  element?: Node,\n  functionArgs?: T,\n) {\n  let returnValue: any = value\n  if (is.string(returnValue)) {\n    returnValue = getStringOptionResult(returnValue, target, element)\n  } else if (is.func(returnValue)) {\n    returnValue = returnValue(...functionArgs)\n  }\n\n  if (is.element(returnValue)) {\n    returnValue = getElementRect(returnValue)\n  }\n\n  return returnValue as Rect\n}\n\nexport function toFullRect(rect: Rect): FullRect {\n  const { top, left, bottom, right } = rect\n  const width = rect.width ?? rect.right - rect.left\n  const height = rect.height ?? rect.bottom - rect.top\n\n  return { top, left, bottom, right, width, height }\n}\n\nexport function rectToXY(rect: Rect | Point) {\n  return (\n    rect && {\n      x: 'x' in rect ? rect.x : rect.left,\n      y: 'y' in rect ? rect.y : rect.top,\n    }\n  )\n}\n\nexport function xywhToTlbr<T extends Partial<Rect & Point>>(rect: T) {\n  if (rect && !('left' in rect && 'top' in rect)) {\n    rect = extend({}, rect)\n\n    rect.left = rect.x || 0\n    rect.top = rect.y || 0\n    rect.right = rect.right || rect.left + rect.width\n    rect.bottom = rect.bottom || rect.top + rect.height\n  }\n\n  return rect as Rect & T\n}\n\nexport function tlbrToXywh(rect: Rect & Partial<Point>) {\n  if (rect && !('x' in rect && 'y' in rect)) {\n    rect = extend({}, rect)\n\n    rect.x = rect.left || 0\n    rect.y = rect.top || 0\n    rect.width = rect.width || (rect.right || 0) - rect.x\n    rect.height = rect.height || (rect.bottom || 0) - rect.y\n  }\n\n  return rect as FullRect & Point\n}\n\nexport function addEdges(edges: EdgeOptions, rect: Rect, delta: Point) {\n  if (edges.left) {\n    rect.left += delta.x\n  }\n  if (edges.right) {\n    rect.right += delta.x\n  }\n  if (edges.top) {\n    rect.top += delta.y\n  }\n  if (edges.bottom) {\n    rect.bottom += delta.y\n  }\n\n  rect.width = rect.right - rect.left\n  rect.height = rect.bottom - rect.top\n}\n", "import type { PerActionDefaults } from '@interactjs/core/options'\nimport type { ActionName, HasGetRect } from '@interactjs/core/types'\n\nimport { rectToXY, resolveRectLike } from './rect'\n\nexport default function getOriginXY(\n  target: HasGetRect & { options: PerActionDefaults },\n  element: Node,\n  actionName?: ActionName,\n) {\n  const actionOptions = actionName && (target.options as any)[actionName]\n  const actionOrigin = actionOptions && actionOptions.origin\n  const origin = actionOrigin || target.options.origin\n\n  const originRect = resolveRectLike(origin, target, element, [target && element])\n\n  return rectToXY(originRect) || { x: 0, y: 0 }\n}\n", "import type { EventTypes, Listener, ListenersArg } from '@interactjs/core/types'\n\nimport is from './is'\n\nexport interface NormalizedListeners {\n  [type: string]: Listener[]\n}\n\nexport default function normalize(\n  type: EventTypes,\n  listeners?: ListenersArg | ListenersArg[] | null,\n  filter = (_typeOrPrefix: string) => true,\n  result?: NormalizedListeners,\n): NormalizedListeners {\n  result = result || {}\n\n  if (is.string(type) && type.search(' ') !== -1) {\n    type = split(type)\n  }\n\n  if (is.array(type)) {\n    type.forEach((t) => normalize(t, listeners, filter, result))\n    return result\n  }\n\n  // before:  type = [{ drag: () => {} }], listeners = undefined\n  // after:   type = ''                  , listeners = [{ drag: () => {} }]\n  if (is.object(type)) {\n    listeners = type\n    type = ''\n  }\n\n  if (is.func(listeners) && filter(type)) {\n    result[type] = result[type] || []\n    result[type].push(listeners)\n  } else if (is.array(listeners)) {\n    for (const l of listeners) {\n      normalize(type, l, filter, result)\n    }\n  } else if (is.object(listeners)) {\n    for (const prefix in listeners) {\n      const combinedTypes = split(prefix).map((p) => `${type}${p}`)\n\n      normalize(combinedTypes, listeners[prefix], filter, result)\n    }\n  }\n\n  return result as NormalizedListeners\n}\n\nfunction split(type: string) {\n  return type.trim().split(/ +/)\n}\n", "export default (x: number, y: number) => Math.sqrt(x * x + y * y)\n", "const VENDOR_PREFIXES = ['webkit', 'moz']\n\nexport default function pointerExtend<T>(dest: Partial<T & { __set?: Partial<T> }>, source: T) {\n  dest.__set ||= {} as any\n\n  for (const prop in source) {\n    // skip deprecated prefixed properties\n    if (VENDOR_PREFIXES.some((prefix) => prop.indexOf(prefix) === 0)) continue\n\n    if (typeof dest[prop] !== 'function' && prop !== '__set') {\n      Object.defineProperty(dest, prop, {\n        get() {\n          if (prop in dest.__set) return dest.__set[prop]\n\n          return (dest.__set[prop] = source[prop] as any)\n        },\n        set(value: any) {\n          dest.__set[prop] = value\n        },\n        configurable: true,\n      })\n    }\n  }\n  return dest\n}\n", "import type { InteractEvent } from '@interactjs/core/InteractEvent'\nimport type { CoordsSetMember, PointerType, Point, PointerEventType, Element } from '@interactjs/core/types'\n\nimport browser from './browser'\nimport dom from './domObjects'\nimport * as domUtils from './domUtils'\nimport hypot from './hypot'\nimport is from './is'\nimport pointerExtend from './pointerExtend'\n\nexport function copyCoords(dest: CoordsSetMember, src: CoordsSetMember) {\n  dest.page = dest.page || ({} as any)\n  dest.page.x = src.page.x\n  dest.page.y = src.page.y\n\n  dest.client = dest.client || ({} as any)\n  dest.client.x = src.client.x\n  dest.client.y = src.client.y\n\n  dest.timeStamp = src.timeStamp\n}\n\nexport function setCoordDeltas(targetObj: CoordsSetMember, prev: CoordsSetMember, cur: CoordsSetMember) {\n  targetObj.page.x = cur.page.x - prev.page.x\n  targetObj.page.y = cur.page.y - prev.page.y\n  targetObj.client.x = cur.client.x - prev.client.x\n  targetObj.client.y = cur.client.y - prev.client.y\n  targetObj.timeStamp = cur.timeStamp - prev.timeStamp\n}\n\nexport function setCoordVelocity(targetObj: CoordsSetMember, delta: CoordsSetMember) {\n  const dt = Math.max(delta.timeStamp / 1000, 0.001)\n\n  targetObj.page.x = delta.page.x / dt\n  targetObj.page.y = delta.page.y / dt\n  targetObj.client.x = delta.client.x / dt\n  targetObj.client.y = delta.client.y / dt\n  targetObj.timeStamp = dt\n}\n\nexport function setZeroCoords(targetObj: CoordsSetMember) {\n  targetObj.page.x = 0\n  targetObj.page.y = 0\n  targetObj.client.x = 0\n  targetObj.client.y = 0\n}\n\nexport function isNativePointer(pointer: any) {\n  return pointer instanceof dom.Event || pointer instanceof dom.Touch\n}\n\n// Get specified X/Y coords for mouse or event.touches[0]\nexport function getXY(type: string, pointer: PointerType | InteractEvent, xy: Point) {\n  xy = xy || ({} as Point)\n  type = type || 'page'\n\n  xy.x = pointer[(type + 'X') as 'pageX']\n  xy.y = pointer[(type + 'Y') as 'pageY']\n\n  return xy\n}\n\nexport function getPageXY(pointer: PointerType | InteractEvent, page?: Point) {\n  page = page || { x: 0, y: 0 }\n\n  // Opera Mobile handles the viewport and scrolling oddly\n  if (browser.isOperaMobile && isNativePointer(pointer)) {\n    getXY('screen', pointer, page)\n\n    page.x += window.scrollX\n    page.y += window.scrollY\n  } else {\n    getXY('page', pointer, page)\n  }\n\n  return page\n}\n\nexport function getClientXY(pointer: PointerType, client: Point) {\n  client = client || ({} as any)\n\n  if (browser.isOperaMobile && isNativePointer(pointer)) {\n    // Opera Mobile handles the viewport and scrolling oddly\n    getXY('screen', pointer, client)\n  } else {\n    getXY('client', pointer, client)\n  }\n\n  return client\n}\n\nexport function getPointerId(pointer: { pointerId?: number; identifier?: number; type?: string }) {\n  return is.number(pointer.pointerId) ? pointer.pointerId! : pointer.identifier!\n}\n\nexport function setCoords(dest: CoordsSetMember, pointers: any[], timeStamp: number) {\n  const pointer = pointers.length > 1 ? pointerAverage(pointers) : pointers[0]\n\n  getPageXY(pointer, dest.page)\n  getClientXY(pointer, dest.client)\n\n  dest.timeStamp = timeStamp\n}\n\nexport function getTouchPair(event: TouchEvent | PointerType[]) {\n  const touches: PointerType[] = []\n\n  // array of touches is supplied\n  if (is.array(event)) {\n    touches[0] = event[0]\n    touches[1] = event[1]\n  }\n  // an event\n  else {\n    if (event.type === 'touchend') {\n      if (event.touches.length === 1) {\n        touches[0] = event.touches[0]\n        touches[1] = event.changedTouches[0]\n      } else if (event.touches.length === 0) {\n        touches[0] = event.changedTouches[0]\n        touches[1] = event.changedTouches[1]\n      }\n    } else {\n      touches[0] = event.touches[0]\n      touches[1] = event.touches[1]\n    }\n  }\n\n  return touches\n}\n\nexport function pointerAverage(pointers: PointerType[]) {\n  const average = {\n    pageX: 0,\n    pageY: 0,\n    clientX: 0,\n    clientY: 0,\n    screenX: 0,\n    screenY: 0,\n  }\n\n  type CoordKeys = keyof typeof average\n\n  for (const pointer of pointers) {\n    for (const prop in average) {\n      average[prop as CoordKeys] += pointer[prop as CoordKeys]\n    }\n  }\n  for (const prop in average) {\n    average[prop as CoordKeys] /= pointers.length\n  }\n\n  return average\n}\n\nexport function touchBBox(event: PointerType[]) {\n  if (!event.length) {\n    return null\n  }\n\n  const touches = getTouchPair(event)\n  const minX = Math.min(touches[0].pageX, touches[1].pageX)\n  const minY = Math.min(touches[0].pageY, touches[1].pageY)\n  const maxX = Math.max(touches[0].pageX, touches[1].pageX)\n  const maxY = Math.max(touches[0].pageY, touches[1].pageY)\n\n  return {\n    x: minX,\n    y: minY,\n    left: minX,\n    top: minY,\n    right: maxX,\n    bottom: maxY,\n    width: maxX - minX,\n    height: maxY - minY,\n  }\n}\n\nexport function touchDistance(event: PointerType[] | TouchEvent, deltaSource: string) {\n  const sourceX = (deltaSource + 'X') as 'pageX'\n  const sourceY = (deltaSource + 'Y') as 'pageY'\n  const touches = getTouchPair(event)\n\n  const dx = touches[0][sourceX] - touches[1][sourceX]\n  const dy = touches[0][sourceY] - touches[1][sourceY]\n\n  return hypot(dx, dy)\n}\n\nexport function touchAngle(event: PointerType[] | TouchEvent, deltaSource: string) {\n  const sourceX = (deltaSource + 'X') as 'pageX'\n  const sourceY = (deltaSource + 'Y') as 'pageY'\n  const touches = getTouchPair(event)\n  const dx = touches[1][sourceX] - touches[0][sourceX]\n  const dy = touches[1][sourceY] - touches[0][sourceY]\n  const angle = (180 * Math.atan2(dy, dx)) / Math.PI\n\n  return angle\n}\n\nexport function getPointerType(pointer: { pointerType?: string; identifier?: number; type?: string }) {\n  return is.string(pointer.pointerType)\n    ? pointer.pointerType\n    : is.number(pointer.pointerType)\n      ? [undefined, undefined, 'touch', 'pen', 'mouse'][pointer.pointerType]!\n      : // if the PointerEvent API isn't available, then the \"pointer\" must\n        // be either a MouseEvent, TouchEvent, or Touch object\n        /touch/.test(pointer.type || '') || pointer instanceof dom.Touch\n        ? 'touch'\n        : 'mouse'\n}\n\n// [ event.target, event.currentTarget ]\nexport function getEventTargets(event: Event) {\n  const path = is.func(event.composedPath)\n    ? (event.composedPath() as Element[])\n    : (event as unknown as { path: Element[] }).path\n\n  return [\n    domUtils.getActualElement(path ? path[0] : (event.target as Element)),\n    domUtils.getActualElement(event.currentTarget as Element),\n  ]\n}\n\nexport function newCoords(): CoordsSetMember {\n  return {\n    page: { x: 0, y: 0 },\n    client: { x: 0, y: 0 },\n    timeStamp: 0,\n  }\n}\n\nexport function coordsToEvent(coords: MockCoords) {\n  const event = {\n    coords,\n    get page() {\n      return this.coords.page\n    },\n    get client() {\n      return this.coords.client\n    },\n    get timeStamp() {\n      return this.coords.timeStamp\n    },\n    get pageX() {\n      return this.coords.page.x\n    },\n    get pageY() {\n      return this.coords.page.y\n    },\n    get clientX() {\n      return this.coords.client.x\n    },\n    get clientY() {\n      return this.coords.client.y\n    },\n    get pointerId() {\n      return this.coords.pointerId\n    },\n    get target() {\n      return this.coords.target\n    },\n    get type() {\n      return this.coords.type\n    },\n    get pointerType() {\n      return this.coords.pointerType\n    },\n    get buttons() {\n      return this.coords.buttons\n    },\n    preventDefault() {},\n  }\n\n  return event as typeof event & PointerType & PointerEventType\n}\n\nexport interface MockCoords {\n  page: Point\n  client: Point\n  timeStamp?: number\n  pointerId?: any\n  target?: any\n  type?: string\n  pointerType?: string\n  buttons?: number\n}\n\nexport { pointerExtend }\n", "import type { Interactable } from '@interactjs/core/Interactable'\nimport type { Interaction, InteractionProxy } from '@interactjs/core/Interaction'\nimport type { ActionName } from '@interactjs/core/types'\n\nexport class BaseEvent<T extends ActionName | null = never> {\n  declare type: string\n  declare target: EventTarget\n  declare currentTarget: Node\n  declare interactable: Interactable\n  /** @internal */\n  declare _interaction: Interaction<T>\n  declare timeStamp: number\n  immediatePropagationStopped = false\n  propagationStopped = false\n\n  constructor(interaction: Interaction<T>) {\n    this._interaction = interaction\n  }\n\n  preventDefault() {}\n\n  /**\n   * Don't call any other listeners (even on the current target)\n   */\n  stopPropagation() {\n    this.propagationStopped = true\n  }\n\n  /**\n   * Don't call listeners on the remaining targets\n   */\n  stopImmediatePropagation() {\n    this.immediatePropagationStopped = this.propagationStopped = true\n  }\n}\n\n// defined outside of class definition to avoid assignment of undefined during\n// construction\nexport interface BaseEvent<T extends ActionName | null = never> {\n  interaction: InteractionProxy<T>\n}\n\n// getters and setters defined here to support typescript 3.6 and below which\n// don't support getter and setters in .d.ts files\nObject.defineProperty(BaseEvent.prototype, 'interaction', {\n  get(this: BaseEvent) {\n    return this._interaction._proxy\n  },\n  set(this: BaseEvent) {},\n})\n", "type Filter<T> = (element: T, index: number, array: T[]) => boolean\n\nexport const contains = <T>(array: T[], target: T) => array.indexOf(target) !== -1\n\nexport const remove = <T>(array: T[], target: T) => array.splice(array.indexOf(target), 1)\n\nexport const merge = <T, U>(target: Array<T | U>, source: U[]) => {\n  for (const item of source) {\n    target.push(item)\n  }\n\n  return target\n}\n\nexport const from = <T = any>(source: ArrayLike<T>) => merge([] as T[], source as T[])\n\nexport const findIndex = <T>(array: T[], func: Filter<T>) => {\n  for (let i = 0; i < array.length; i++) {\n    if (func(array[i], i, array)) {\n      return i\n    }\n  }\n\n  return -1\n}\n\nexport const find = <T = any>(array: T[], func: Filter<T>): T | undefined => array[findIndex(array, func)]\n", "import { BaseEvent } from '@interactjs/core/BaseEvent'\nimport type { Interactable } from '@interactjs/core/Interactable'\nimport type { InteractEvent } from '@interactjs/core/InteractEvent'\nimport type { Element } from '@interactjs/core/types'\nimport * as arr from '@interactjs/utils/arr'\n\nimport type { DropState } from './plugin'\n\nexport class DropEvent extends BaseEvent<'drag'> {\n  declare target: Element\n  dropzone: Interactable\n  dragEvent: InteractEvent<'drag'>\n  relatedTarget: Element\n  draggable: Interactable\n  propagationStopped = false\n  immediatePropagationStopped = false\n\n  /**\n   * Class of events fired on dropzones during drags with acceptable targets.\n   */\n  constructor(dropState: DropState, dragEvent: InteractEvent<'drag'>, type: string) {\n    super(dragEvent._interaction)\n\n    const { element, dropzone } = type === 'dragleave' ? dropState.prev : dropState.cur\n\n    this.type = type\n    this.target = element\n    this.currentTarget = element\n    this.dropzone = dropzone\n    this.dragEvent = dragEvent\n    this.relatedTarget = dragEvent.target\n    this.draggable = dragEvent.interactable\n    this.timeStamp = dragEvent.timeStamp\n  }\n\n  /**\n   * If this is a `dropactivate` event, the dropzone element will be\n   * deactivated.\n   *\n   * If this is a `dragmove` or `dragenter`, a `dragleave` will be fired on the\n   * dropzone element and more.\n   */\n  reject() {\n    const { dropState } = this._interaction\n\n    if (\n      this.type !== 'dropactivate' &&\n      (!this.dropzone || dropState.cur.dropzone !== this.dropzone || dropState.cur.element !== this.target)\n    ) {\n      return\n    }\n\n    dropState.prev.dropzone = this.dropzone\n    dropState.prev.element = this.target\n\n    dropState.rejected = true\n    dropState.events.enter = null\n\n    this.stopImmediatePropagation()\n\n    if (this.type === 'dropactivate') {\n      const activeDrops = dropState.activeDrops\n      const index = arr.findIndex(\n        activeDrops,\n        ({ dropzone, element }) => dropzone === this.dropzone && element === this.target,\n      )\n\n      dropState.activeDrops.splice(index, 1)\n\n      const deactivateEvent = new DropEvent(dropState, this.dragEvent, 'dropdeactivate')\n\n      deactivateEvent.dropzone = this.dropzone\n      deactivateEvent.target = this.target\n\n      this.dropzone.fire(deactivateEvent)\n    } else {\n      this.dropzone.fire(new DropEvent(dropState, this.dragEvent, 'dragleave'))\n    }\n  }\n\n  preventDefault() {}\n\n  stopPropagation() {\n    this.propagationStopped = true\n  }\n\n  stopImmediatePropagation() {\n    this.immediatePropagationStopped = this.propagationStopped = true\n  }\n}\n", "import type { Interactable } from '@interactjs/core/Interactable'\nimport type { EventPhase, InteractEvent } from '@interactjs/core/InteractEvent'\nimport type { Interaction, DoPhaseArg } from '@interactjs/core/Interaction'\nimport type { PerActionDefaults } from '@interactjs/core/options'\nimport type { Scope, Plugin } from '@interactjs/core/scope'\nimport type { Element, PointerEventType, Rect, ListenersArg } from '@interactjs/core/types'\nimport * as domUtils from '@interactjs/utils/domUtils'\nimport extend from '@interactjs/utils/extend'\nimport getOriginXY from '@interactjs/utils/getOriginXY'\nimport is from '@interactjs/utils/is'\nimport normalizeListeners from '@interactjs/utils/normalizeListeners'\nimport * as pointerUtils from '@interactjs/utils/pointerUtils'\n\n/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport '../drag/plugin'\n\nimport type { DragEvent } from '../drag/plugin'\nimport drag from '../drag/plugin'\n/* eslint-enable import/no-duplicates */\n\nimport { DropEvent } from './DropEvent'\n\nexport type DropFunctionChecker = (\n  dragEvent: any, // related drag operation\n  event: any, // touch or mouse EventEmitter\n  dropped: boolean, // default checker result\n  dropzone: Interactable, // dropzone interactable\n  dropElement: Element, // drop zone element\n  draggable: Interactable, // draggable's Interactable\n  draggableElement: Element, // dragged element\n) => boolean\n\nexport interface DropzoneOptions extends PerActionDefaults {\n  accept?:\n    | string\n    | Element\n    | (({ dropzone, draggableElement }: { dropzone: Interactable; draggableElement: Element }) => boolean)\n  // How the overlap is checked on the drop zone\n  overlap?: 'pointer' | 'center' | number\n  checker?: DropFunctionChecker\n\n  ondropactivate?: ListenersArg\n  ondropdeactivate?: ListenersArg\n  ondragenter?: ListenersArg\n  ondragleave?: ListenersArg\n  ondropmove?: ListenersArg\n  ondrop?: ListenersArg\n}\n\nexport interface DropzoneMethod {\n  (this: Interactable, options: DropzoneOptions | boolean): Interactable\n  (): DropzoneOptions\n}\n\ndeclare module '@interactjs/core/Interactable' {\n  interface Interactable {\n    /**\n     *\n     * ```js\n     * interact('.drop').dropzone({\n     *   accept: '.can-drop' || document.getElementById('single-drop'),\n     *   overlap: 'pointer' || 'center' || zeroToOne\n     * }\n     * ```\n     *\n     * Returns or sets whether draggables can be dropped onto this target to\n     * trigger drop events\n     *\n     * Dropzones can receive the following events:\n     *  - `dropactivate` and `dropdeactivate` when an acceptable drag starts and ends\n     *  - `dragenter` and `dragleave` when a draggable enters and leaves the dropzone\n     *  - `dragmove` when a draggable that has entered the dropzone is moved\n     *  - `drop` when a draggable is dropped into this dropzone\n     *\n     * Use the `accept` option to allow only elements that match the given CSS\n     * selector or element. The value can be:\n     *\n     *  - **an Element** - only that element can be dropped into this dropzone.\n     *  - **a string**, - the element being dragged must match it as a CSS selector.\n     *  - **`null`** - accept options is cleared - it accepts any element.\n     *\n     * Use the `overlap` option to set how drops are checked for. The allowed\n     * values are:\n     *\n     *   - `'pointer'`, the pointer must be over the dropzone (default)\n     *   - `'center'`, the draggable element's center must be over the dropzone\n     *   - a number from 0-1 which is the `(intersection area) / (draggable area)`.\n     *   e.g. `0.5` for drop to happen when half of the area of the draggable is\n     *   over the dropzone\n     *\n     * Use the `checker` option to specify a function to check if a dragged element\n     * is over this Interactable.\n     *\n     * @param options - The new options to be set\n     */\n    dropzone(options: DropzoneOptions | boolean): Interactable\n    /** @returns The current setting */\n    dropzone(): DropzoneOptions\n\n    /**\n     * ```js\n     * interact(target)\n     * .dropChecker(function(dragEvent,         // related dragmove or dragend event\n     *                       event,             // TouchEvent/PointerEvent/MouseEvent\n     *                       dropped,           // bool result of the default checker\n     *                       dropzone,          // dropzone Interactable\n     *                       dropElement,       // dropzone elemnt\n     *                       draggable,         // draggable Interactable\n     *                       draggableElement) {// draggable element\n     *\n     *   return dropped && event.target.hasAttribute('allow-drop')\n     * }\n     * ```\n     */\n    dropCheck(\n      dragEvent: InteractEvent,\n      event: PointerEventType,\n      draggable: Interactable,\n      draggableElement: Element,\n      dropElemen: Element,\n      rect: any,\n    ): boolean\n  }\n}\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction {\n    dropState?: DropState\n  }\n}\n\ndeclare module '@interactjs/core/InteractEvent' {\n  interface InteractEvent {\n    /** @internal */\n    prevDropzone?: Interactable\n    dropzone?: Interactable\n    dragEnter?: Element\n    dragLeave?: Element\n  }\n}\n\ndeclare module '@interactjs/core/options' {\n  interface ActionDefaults {\n    drop: DropzoneOptions\n  }\n}\n\ndeclare module '@interactjs/core/scope' {\n  interface Scope {\n    dynamicDrop?: boolean\n  }\n\n  interface SignalArgs {\n    'actions/drop:start': DropSignalArg\n    'actions/drop:move': DropSignalArg\n    'actions/drop:end': DropSignalArg\n  }\n}\n\ndeclare module '@interactjs/core/types' {\n  interface ActionMap {\n    drop?: typeof drop\n  }\n}\n\ndeclare module '@interactjs/core/InteractStatic' {\n  interface InteractStatic {\n    /**\n     * Returns or sets whether the dimensions of dropzone elements are calculated\n     * on every dragmove or only on dragstart for the default dropChecker\n     *\n     * @param {boolean} [newValue] True to check on each move. False to check only\n     * before start\n     * @return {boolean | interact} The current setting or interact\n     */\n    dynamicDrop: (newValue?: boolean) => boolean | this\n  }\n}\n\ninterface DropSignalArg {\n  interaction: Interaction<'drag'>\n  dragEvent: DragEvent\n}\n\nexport interface ActiveDrop {\n  dropzone: Interactable\n  element: Element\n  rect: Rect\n}\n\nexport interface DropState {\n  cur: {\n    // the dropzone a drag target might be dropped into\n    dropzone: Interactable\n    // the element at the time of checking\n    element: Element\n  }\n  prev: {\n    // the dropzone that was recently dragged away from\n    dropzone: Interactable\n    // the element at the time of checking\n    element: Element\n  }\n  // wheather the potential drop was rejected from a listener\n  rejected: boolean\n  // the drop events related to the current drag event\n  events: FiredDropEvents\n  activeDrops: ActiveDrop[]\n}\n\nfunction install(scope: Scope) {\n  const { actions, interactStatic: interact, Interactable, defaults } = scope\n\n  scope.usePlugin(drag)\n\n  Interactable.prototype.dropzone = function (this: Interactable, options) {\n    return dropzoneMethod(this, options)\n  } as Interactable['dropzone']\n\n  Interactable.prototype.dropCheck = function (\n    this: Interactable,\n    dragEvent,\n    event,\n    draggable,\n    draggableElement,\n    dropElement,\n    rect,\n  ) {\n    return dropCheckMethod(this, dragEvent, event, draggable, draggableElement, dropElement, rect)\n  }\n\n  interact.dynamicDrop = function (newValue?: boolean) {\n    if (is.bool(newValue)) {\n      // if (dragging && scope.dynamicDrop !== newValue && !newValue) {\n      //  calcRects(dropzones)\n      // }\n\n      scope.dynamicDrop = newValue\n\n      return interact\n    }\n    return scope.dynamicDrop!\n  }\n\n  extend(actions.phaselessTypes, {\n    dragenter: true,\n    dragleave: true,\n    dropactivate: true,\n    dropdeactivate: true,\n    dropmove: true,\n    drop: true,\n  })\n  actions.methodDict.drop = 'dropzone'\n\n  scope.dynamicDrop = false\n\n  defaults.actions.drop = drop.defaults\n}\n\nfunction collectDropzones({ interactables }: Scope, draggableElement: Element) {\n  const drops: ActiveDrop[] = []\n\n  // collect all dropzones and their elements which qualify for a drop\n  for (const dropzone of interactables.list) {\n    if (!dropzone.options.drop.enabled) {\n      continue\n    }\n\n    const accept = dropzone.options.drop.accept\n\n    // test the draggable draggableElement against the dropzone's accept setting\n    if (\n      (is.element(accept) && accept !== draggableElement) ||\n      (is.string(accept) && !domUtils.matchesSelector(draggableElement, accept)) ||\n      (is.func(accept) && !accept({ dropzone, draggableElement }))\n    ) {\n      continue\n    }\n\n    for (const dropzoneElement of dropzone.getAllElements()) {\n      if (dropzoneElement !== draggableElement) {\n        drops.push({\n          dropzone,\n          element: dropzoneElement,\n          rect: dropzone.getRect(dropzoneElement),\n        })\n      }\n    }\n  }\n\n  return drops\n}\n\nfunction fireActivationEvents(activeDrops: ActiveDrop[], event: DropEvent) {\n  // loop through all active dropzones and trigger event\n  for (const { dropzone, element } of activeDrops.slice()) {\n    event.dropzone = dropzone\n\n    // set current element as event target\n    event.target = element\n    dropzone.fire(event)\n    event.propagationStopped = event.immediatePropagationStopped = false\n  }\n}\n\n// return a new array of possible drops. getActiveDrops should always be\n// called when a drag has just started or a drag event happens while\n// dynamicDrop is true\nfunction getActiveDrops(scope: Scope, dragElement: Element) {\n  // get dropzones and their elements that could receive the draggable\n  const activeDrops = collectDropzones(scope, dragElement)\n\n  for (const activeDrop of activeDrops) {\n    activeDrop.rect = activeDrop.dropzone.getRect(activeDrop.element)\n  }\n\n  return activeDrops\n}\n\nfunction getDrop(\n  { dropState, interactable: draggable, element: dragElement }: Interaction,\n  dragEvent,\n  pointerEvent,\n) {\n  const validDrops: Element[] = []\n\n  // collect all dropzones and their elements which qualify for a drop\n  for (const { dropzone, element: dropzoneElement, rect } of dropState.activeDrops) {\n    const isValid = dropzone.dropCheck(\n      dragEvent,\n      pointerEvent,\n      draggable!,\n      dragElement!,\n      dropzoneElement,\n      rect,\n    )\n    validDrops.push(isValid ? dropzoneElement : null)\n  }\n\n  // get the most appropriate dropzone based on DOM depth and order\n  const dropIndex = domUtils.indexOfDeepestElement(validDrops)\n\n  return dropState!.activeDrops[dropIndex] || null\n}\n\nfunction getDropEvents(interaction: Interaction, _pointerEvent, dragEvent: DragEvent) {\n  const dropState = interaction.dropState!\n  const dropEvents: Record<string, DropEvent | null> = {\n    enter: null,\n    leave: null,\n    activate: null,\n    deactivate: null,\n    move: null,\n    drop: null,\n  }\n\n  if (dragEvent.type === 'dragstart') {\n    dropEvents.activate = new DropEvent(dropState, dragEvent, 'dropactivate')\n\n    dropEvents.activate.target = null as never\n    dropEvents.activate.dropzone = null as never\n  }\n  if (dragEvent.type === 'dragend') {\n    dropEvents.deactivate = new DropEvent(dropState, dragEvent, 'dropdeactivate')\n\n    dropEvents.deactivate.target = null as never\n    dropEvents.deactivate.dropzone = null as never\n  }\n\n  if (dropState.rejected) {\n    return dropEvents\n  }\n\n  if (dropState.cur.element !== dropState.prev.element) {\n    // if there was a previous dropzone, create a dragleave event\n    if (dropState.prev.dropzone) {\n      dropEvents.leave = new DropEvent(dropState, dragEvent, 'dragleave')\n\n      dragEvent.dragLeave = dropEvents.leave.target = dropState.prev.element\n      dragEvent.prevDropzone = dropEvents.leave.dropzone = dropState.prev.dropzone\n    }\n    // if dropzone is not null, create a dragenter event\n    if (dropState.cur.dropzone) {\n      dropEvents.enter = new DropEvent(dropState, dragEvent, 'dragenter')\n\n      dragEvent.dragEnter = dropState.cur.element\n      dragEvent.dropzone = dropState.cur.dropzone\n    }\n  }\n\n  if (dragEvent.type === 'dragend' && dropState.cur.dropzone) {\n    dropEvents.drop = new DropEvent(dropState, dragEvent, 'drop')\n\n    dragEvent.dropzone = dropState.cur.dropzone\n    dragEvent.relatedTarget = dropState.cur.element\n  }\n  if (dragEvent.type === 'dragmove' && dropState.cur.dropzone) {\n    dropEvents.move = new DropEvent(dropState, dragEvent, 'dropmove')\n\n    dragEvent.dropzone = dropState.cur.dropzone\n  }\n\n  return dropEvents\n}\n\ntype FiredDropEvents = Partial<\n  Record<'leave' | 'enter' | 'move' | 'drop' | 'activate' | 'deactivate', DropEvent>\n>\n\nfunction fireDropEvents(interaction: Interaction, events: FiredDropEvents) {\n  const dropState = interaction.dropState!\n  const { activeDrops, cur, prev } = dropState\n\n  if (events.leave) {\n    prev.dropzone.fire(events.leave)\n  }\n  if (events.enter) {\n    cur.dropzone.fire(events.enter)\n  }\n  if (events.move) {\n    cur.dropzone.fire(events.move)\n  }\n  if (events.drop) {\n    cur.dropzone.fire(events.drop)\n  }\n\n  if (events.deactivate) {\n    fireActivationEvents(activeDrops, events.deactivate)\n  }\n\n  dropState.prev.dropzone = cur.dropzone\n  dropState.prev.element = cur.element\n}\n\nfunction onEventCreated({ interaction, iEvent, event }: DoPhaseArg<'drag', EventPhase>, scope: Scope) {\n  if (iEvent.type !== 'dragmove' && iEvent.type !== 'dragend') {\n    return\n  }\n\n  const dropState = interaction.dropState!\n\n  if (scope.dynamicDrop) {\n    dropState.activeDrops = getActiveDrops(scope, interaction.element!)\n  }\n\n  const dragEvent = iEvent\n  const dropResult = getDrop(interaction, dragEvent, event)\n\n  // update rejected status\n  dropState.rejected =\n    dropState.rejected &&\n    !!dropResult &&\n    dropResult.dropzone === dropState.cur.dropzone &&\n    dropResult.element === dropState.cur.element\n\n  dropState.cur.dropzone = dropResult && dropResult.dropzone\n  dropState.cur.element = dropResult && dropResult.element\n\n  dropState.events = getDropEvents(interaction, event, dragEvent)\n}\n\nfunction dropzoneMethod(interactable: Interactable): DropzoneOptions\nfunction dropzoneMethod(interactable: Interactable, options: DropzoneOptions | boolean): Interactable\nfunction dropzoneMethod(interactable: Interactable, options?: DropzoneOptions | boolean) {\n  if (is.object(options)) {\n    interactable.options.drop.enabled = options.enabled !== false\n\n    if (options.listeners) {\n      const normalized = normalizeListeners(options.listeners)\n      // rename 'drop' to '' as it will be prefixed with 'drop'\n      const corrected = Object.keys(normalized).reduce((acc, type) => {\n        const correctedType = /^(enter|leave)/.test(type)\n          ? `drag${type}`\n          : /^(activate|deactivate|move)/.test(type)\n            ? `drop${type}`\n            : type\n\n        acc[correctedType] = normalized[type]\n\n        return acc\n      }, {})\n\n      const prevListeners = interactable.options.drop.listeners\n      prevListeners && interactable.off(prevListeners)\n\n      interactable.on(corrected)\n      interactable.options.drop.listeners = corrected\n    }\n\n    if (is.func(options.ondrop)) {\n      interactable.on('drop', options.ondrop)\n    }\n    if (is.func(options.ondropactivate)) {\n      interactable.on('dropactivate', options.ondropactivate)\n    }\n    if (is.func(options.ondropdeactivate)) {\n      interactable.on('dropdeactivate', options.ondropdeactivate)\n    }\n    if (is.func(options.ondragenter)) {\n      interactable.on('dragenter', options.ondragenter)\n    }\n    if (is.func(options.ondragleave)) {\n      interactable.on('dragleave', options.ondragleave)\n    }\n    if (is.func(options.ondropmove)) {\n      interactable.on('dropmove', options.ondropmove)\n    }\n\n    if (/^(pointer|center)$/.test(options.overlap as string)) {\n      interactable.options.drop.overlap = options.overlap\n    } else if (is.number(options.overlap)) {\n      interactable.options.drop.overlap = Math.max(Math.min(1, options.overlap), 0)\n    }\n    if ('accept' in options) {\n      interactable.options.drop.accept = options.accept\n    }\n    if ('checker' in options) {\n      interactable.options.drop.checker = options.checker\n    }\n\n    return interactable\n  }\n\n  if (is.bool(options)) {\n    interactable.options.drop.enabled = options\n\n    return interactable\n  }\n\n  return interactable.options.drop\n}\n\nfunction dropCheckMethod(\n  interactable: Interactable,\n  dragEvent: InteractEvent,\n  event: PointerEventType,\n  draggable: Interactable,\n  draggableElement: Element,\n  dropElement: Element,\n  rect: any,\n) {\n  let dropped = false\n\n  // if the dropzone has no rect (eg. display: none)\n  // call the custom dropChecker or just return false\n  if (!(rect = rect || interactable.getRect(dropElement))) {\n    return interactable.options.drop.checker\n      ? interactable.options.drop.checker(\n          dragEvent,\n          event,\n          dropped,\n          interactable,\n          dropElement,\n          draggable,\n          draggableElement,\n        )\n      : false\n  }\n\n  const dropOverlap = interactable.options.drop.overlap\n\n  if (dropOverlap === 'pointer') {\n    const origin = getOriginXY(draggable, draggableElement, 'drag')\n    const page = pointerUtils.getPageXY(dragEvent)\n\n    page.x += origin.x\n    page.y += origin.y\n\n    const horizontal = page.x > rect.left && page.x < rect.right\n    const vertical = page.y > rect.top && page.y < rect.bottom\n\n    dropped = horizontal && vertical\n  }\n\n  const dragRect = draggable.getRect(draggableElement)\n\n  if (dragRect && dropOverlap === 'center') {\n    const cx = dragRect.left + dragRect.width / 2\n    const cy = dragRect.top + dragRect.height / 2\n\n    dropped = cx >= rect.left && cx <= rect.right && cy >= rect.top && cy <= rect.bottom\n  }\n\n  if (dragRect && is.number(dropOverlap)) {\n    const overlapArea =\n      Math.max(0, Math.min(rect.right, dragRect.right) - Math.max(rect.left, dragRect.left)) *\n      Math.max(0, Math.min(rect.bottom, dragRect.bottom) - Math.max(rect.top, dragRect.top))\n\n    const overlapRatio = overlapArea / (dragRect.width * dragRect.height)\n\n    dropped = overlapRatio >= dropOverlap\n  }\n\n  if (interactable.options.drop.checker) {\n    dropped = interactable.options.drop.checker(\n      dragEvent,\n      event,\n      dropped,\n      interactable,\n      dropElement,\n      draggable,\n      draggableElement,\n    )\n  }\n\n  return dropped\n}\n\nconst drop: Plugin = {\n  id: 'actions/drop',\n  install,\n  listeners: {\n    'interactions:before-action-start': ({ interaction }) => {\n      if (interaction.prepared.name !== 'drag') {\n        return\n      }\n\n      interaction.dropState = {\n        cur: {\n          dropzone: null,\n          element: null,\n        },\n        prev: {\n          dropzone: null,\n          element: null,\n        },\n        rejected: null,\n        events: null,\n        activeDrops: [],\n      }\n    },\n\n    'interactions:after-action-start': (\n      { interaction, event, iEvent: dragEvent }: DoPhaseArg<'drag', EventPhase>,\n      scope,\n    ) => {\n      if (interaction.prepared.name !== 'drag') {\n        return\n      }\n\n      const dropState = interaction.dropState!\n\n      // reset active dropzones\n      dropState.activeDrops = []\n      dropState.events = {}\n      dropState.activeDrops = getActiveDrops(scope, interaction.element!)\n      dropState.events = getDropEvents(interaction, event, dragEvent)\n\n      if (dropState.events.activate) {\n        fireActivationEvents(dropState.activeDrops, dropState.events.activate)\n        scope.fire('actions/drop:start', { interaction, dragEvent })\n      }\n    },\n\n    'interactions:action-move': onEventCreated,\n\n    'interactions:after-action-move': (\n      { interaction, iEvent: dragEvent }: DoPhaseArg<'drag', EventPhase>,\n      scope,\n    ) => {\n      if (interaction.prepared.name !== 'drag') {\n        return\n      }\n\n      const dropState = interaction.dropState!\n      fireDropEvents(interaction, dropState.events)\n\n      scope.fire('actions/drop:move', { interaction, dragEvent })\n      dropState.events = {}\n    },\n\n    'interactions:action-end': (arg: DoPhaseArg<'drag', EventPhase>, scope) => {\n      if (arg.interaction.prepared.name !== 'drag') {\n        return\n      }\n\n      const { interaction, iEvent: dragEvent } = arg\n\n      onEventCreated(arg, scope)\n      fireDropEvents(interaction, interaction.dropState!.events)\n      scope.fire('actions/drop:end', { interaction, dragEvent })\n    },\n\n    'interactions:stop': ({ interaction }) => {\n      if (interaction.prepared.name !== 'drag') {\n        return\n      }\n\n      const { dropState } = interaction\n\n      if (dropState) {\n        dropState.activeDrops = null as never\n        dropState.events = null as never\n        dropState.cur.dropzone = null as never\n        dropState.cur.element = null as never\n        dropState.prev.dropzone = null as never\n        dropState.prev.element = null as never\n        dropState.rejected = false\n      }\n    },\n  },\n  getActiveDrops,\n  getDrop,\n  getDropEvents,\n  fireDropEvents,\n\n  filterEventType: (type: string) => type.search('drag') === 0 || type.search('drop') === 0,\n\n  defaults: {\n    enabled: false,\n    accept: null as never,\n    overlap: 'pointer',\n  } as DropzoneOptions,\n}\n\nexport default drop\n", "import type { Interactable } from '@interactjs/core/Interactable'\nimport type { InteractEvent, EventPhase } from '@interactjs/core/InteractEvent'\nimport type { Interaction, DoPhaseArg } from '@interactjs/core/Interaction'\nimport type { PerActionDefaults } from '@interactjs/core/options'\nimport type { Scope, Plugin } from '@interactjs/core/scope'\nimport type { Rect, PointerType, ListenersArg, OrBoolean } from '@interactjs/core/types'\nimport is from '@interactjs/utils/is'\nimport * as pointerUtils from '@interactjs/utils/pointerUtils'\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction {\n    gesture?: {\n      angle: number // angle from first to second touch\n      distance: number\n      scale: number // gesture.distance / gesture.startDistance\n      startAngle: number // angle of line joining two touches\n      startDistance: number // distance between two touches of touchStart\n    }\n  }\n}\n\ndeclare module '@interactjs/core/Interactable' {\n  interface Interactable {\n    gesturable(options: Partial<OrBoolean<GesturableOptions>> | boolean): this\n    gesturable(): GesturableOptions\n    /**\n     * ```js\n     * interact(element).gesturable({\n     *     onstart: function (event) {},\n     *     onmove : function (event) {},\n     *     onend  : function (event) {},\n     *\n     *     // limit multiple gestures.\n     *     // See the explanation in {@link Interactable.draggable} example\n     *     max: Infinity,\n     *     maxPerElement: 1,\n     * })\n     *\n     * var isGestureable = interact(element).gesturable()\n     * ```\n     *\n     * Gets or sets whether multitouch gestures can be performed on the target\n     *\n     * @param options - true/false or An object with event listeners to be fired on gesture events (makes the Interactable gesturable)\n     * @returns A boolean indicating if this can be the target of gesture events, or this Interactable\n     */\n    gesturable(options?: Partial<OrBoolean<GesturableOptions>> | boolean): this | GesturableOptions\n  }\n}\n\ndeclare module '@interactjs/core/options' {\n  interface ActionDefaults {\n    gesture: GesturableOptions\n  }\n}\n\ndeclare module '@interactjs/core/types' {\n  interface ActionMap {\n    gesture?: typeof gesture\n  }\n}\n\nexport interface GesturableOptions extends PerActionDefaults {\n  onstart?: ListenersArg\n  onmove?: ListenersArg\n  onend?: ListenersArg\n}\n\nexport interface GestureEvent extends InteractEvent<'gesture'> {\n  distance: number\n  angle: number\n  da: number // angle change\n  scale: number // ratio of distance start to current event\n  ds: number // scale change\n  box: Rect // enclosing box of all points\n  touches: PointerType[]\n}\n\nexport interface GestureSignalArg extends DoPhaseArg<'gesture', EventPhase> {\n  iEvent: GestureEvent\n  interaction: Interaction<'gesture'>\n}\n\nfunction install(scope: Scope) {\n  const { actions, Interactable, defaults } = scope\n\n  Interactable.prototype.gesturable = function (\n    this: InstanceType<typeof Interactable>,\n    options: GesturableOptions | boolean,\n  ) {\n    if (is.object(options)) {\n      this.options.gesture.enabled = options.enabled !== false\n      this.setPerAction('gesture', options)\n      this.setOnEvents('gesture', options)\n\n      return this\n    }\n\n    if (is.bool(options)) {\n      this.options.gesture.enabled = options\n\n      return this\n    }\n\n    return this.options.gesture as GesturableOptions\n  } as Interactable['gesturable']\n\n  actions.map.gesture = gesture\n  actions.methodDict.gesture = 'gesturable'\n\n  defaults.actions.gesture = gesture.defaults\n}\n\nfunction updateGestureProps({ interaction, iEvent, phase }: GestureSignalArg) {\n  if (interaction.prepared.name !== 'gesture') return\n\n  const pointers = interaction.pointers.map((p) => p.pointer)\n  const starting = phase === 'start'\n  const ending = phase === 'end'\n  const deltaSource = interaction.interactable.options.deltaSource\n\n  iEvent.touches = [pointers[0], pointers[1]]\n\n  if (starting) {\n    iEvent.distance = pointerUtils.touchDistance(pointers, deltaSource)\n    iEvent.box = pointerUtils.touchBBox(pointers)\n    iEvent.scale = 1\n    iEvent.ds = 0\n    iEvent.angle = pointerUtils.touchAngle(pointers, deltaSource)\n    iEvent.da = 0\n\n    interaction.gesture.startDistance = iEvent.distance\n    interaction.gesture.startAngle = iEvent.angle\n  } else if (ending || interaction.pointers.length < 2) {\n    const prevEvent = interaction.prevEvent as GestureEvent\n\n    iEvent.distance = prevEvent.distance\n    iEvent.box = prevEvent.box\n    iEvent.scale = prevEvent.scale\n    iEvent.ds = 0\n    iEvent.angle = prevEvent.angle\n    iEvent.da = 0\n  } else {\n    iEvent.distance = pointerUtils.touchDistance(pointers, deltaSource)\n    iEvent.box = pointerUtils.touchBBox(pointers)\n    iEvent.scale = iEvent.distance / interaction.gesture.startDistance\n    iEvent.angle = pointerUtils.touchAngle(pointers, deltaSource)\n\n    iEvent.ds = iEvent.scale - interaction.gesture.scale\n    iEvent.da = iEvent.angle - interaction.gesture.angle\n  }\n\n  interaction.gesture.distance = iEvent.distance\n  interaction.gesture.angle = iEvent.angle\n\n  if (is.number(iEvent.scale) && iEvent.scale !== Infinity && !isNaN(iEvent.scale)) {\n    interaction.gesture.scale = iEvent.scale\n  }\n}\n\nconst gesture: Plugin = {\n  id: 'actions/gesture',\n  before: ['actions/drag', 'actions/resize'],\n  install,\n  listeners: {\n    'interactions:action-start': updateGestureProps,\n    'interactions:action-move': updateGestureProps,\n    'interactions:action-end': updateGestureProps,\n\n    'interactions:new': ({ interaction }) => {\n      interaction.gesture = {\n        angle: 0,\n        distance: 0,\n        scale: 1,\n        startAngle: 0,\n        startDistance: 0,\n      }\n    },\n\n    'auto-start:check': (arg) => {\n      if (arg.interaction.pointers.length < 2) {\n        return undefined\n      }\n\n      const gestureOptions = arg.interactable.options.gesture\n\n      if (!(gestureOptions && gestureOptions.enabled)) {\n        return undefined\n      }\n\n      arg.action = { name: 'gesture' }\n\n      return false\n    },\n  },\n\n  defaults: {},\n\n  getCursor() {\n    return ''\n  },\n\n  filterEventType: (type: string) => type.search('gesture') === 0,\n}\n\nexport default gesture\n", "import type { Interactable } from '@interactjs/core/Interactable'\nimport type { EventPhase, InteractEvent } from '@interactjs/core/InteractEvent'\nimport type { Interaction } from '@interactjs/core/Interaction'\nimport type { PerActionDefaults } from '@interactjs/core/options'\nimport type { Scope, Plugin } from '@interactjs/core/scope'\nimport type {\n  ActionName,\n  ActionProps,\n  EdgeOptions,\n  FullRect,\n  ListenersArg,\n  OrBoolean,\n  Point,\n  Rect,\n} from '@interactjs/core/types'\nimport * as dom from '@interactjs/utils/domUtils'\nimport extend from '@interactjs/utils/extend'\nimport is from '@interactjs/utils/is'\n\nexport type EdgeName = 'top' | 'left' | 'bottom' | 'right'\n\ndeclare module '@interactjs/core/Interactable' {\n  interface Interactable {\n    resizable(): ResizableOptions\n    resizable(options: Partial<OrBoolean<ResizableOptions>> | boolean): this\n    /**\n     * ```js\n     * interact(element).resizable({\n     *   onstart: function (event) {},\n     *   onmove : function (event) {},\n     *   onend  : function (event) {},\n     *\n     *   edges: {\n     *     top   : true,       // Use pointer coords to check for resize.\n     *     left  : false,      // Disable resizing from left edge.\n     *     bottom: '.resize-s',// Resize if pointer target matches selector\n     *     right : handleEl    // Resize if pointer target is the given Element\n     *   },\n     *\n     *   // Width and height can be adjusted independently. When `true`, width and\n     *   // height are adjusted at a 1:1 ratio.\n     *   square: false,\n     *\n     *   // Width and height can be adjusted independently. When `true`, width and\n     *   // height maintain the aspect ratio they had when resizing started.\n     *   preserveAspectRatio: false,\n     *\n     *   // a value of 'none' will limit the resize rect to a minimum of 0x0\n     *   // 'negate' will allow the rect to have negative width/height\n     *   // 'reposition' will keep the width/height positive by swapping\n     *   // the top and bottom edges and/or swapping the left and right edges\n     *   invert: 'none' || 'negate' || 'reposition'\n     *\n     *   // limit multiple resizes.\n     *   // See the explanation in the {@link Interactable.draggable} example\n     *   max: Infinity,\n     *   maxPerElement: 1,\n     * })\n     *\n     * var isResizeable = interact(element).resizable()\n     * ```\n     *\n     * Gets or sets whether resize actions can be performed on the target\n     *\n     * @param options - true/false or An object with event\n     * listeners to be fired on resize events (object makes the Interactable\n     * resizable)\n     * @returns A boolean indicating if this can be the\n     * target of resize elements, or this Interactable\n     */\n    resizable(options?: Partial<OrBoolean<ResizableOptions>> | boolean): this | ResizableOptions\n  }\n}\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction<T extends ActionName | null = ActionName> {\n    resizeAxes: 'x' | 'y' | 'xy'\n    styleCursor(newValue: boolean): this\n    styleCursor(): boolean\n    resizeStartAspectRatio: number\n  }\n}\n\ndeclare module '@interactjs/core/options' {\n  interface ActionDefaults {\n    resize: ResizableOptions\n  }\n}\n\ndeclare module '@interactjs/core/types' {\n  interface ActionMap {\n    resize?: typeof resize\n  }\n}\n\nexport interface ResizableOptions extends PerActionDefaults {\n  square?: boolean\n  preserveAspectRatio?: boolean\n  edges?: EdgeOptions | null\n  axis?: 'x' | 'y' | 'xy' // deprecated\n  invert?: 'none' | 'negate' | 'reposition'\n  margin?: number\n  squareResize?: boolean\n  oninertiastart?: ListenersArg\n  onstart?: ListenersArg\n  onmove?: ListenersArg\n  onend?: ListenersArg\n}\n\nexport interface ResizeEvent<P extends EventPhase = EventPhase> extends InteractEvent<'resize', P> {\n  deltaRect?: FullRect\n  edges?: ActionProps['edges']\n}\n\nfunction install(scope: Scope) {\n  const {\n    actions,\n    browser,\n    Interactable, // tslint:disable-line no-shadowed-variable\n    defaults,\n  } = scope\n\n  // Less Precision with touch input\n\n  resize.cursors = initCursors(browser)\n  resize.defaultMargin = browser.supportsTouch || browser.supportsPointerEvent ? 20 : 10\n\n  Interactable.prototype.resizable = function (this: Interactable, options: ResizableOptions | boolean) {\n    return resizable(this, options, scope)\n  } as Interactable['resizable']\n\n  actions.map.resize = resize\n  actions.methodDict.resize = 'resizable'\n\n  defaults.actions.resize = resize.defaults\n}\n\nfunction resizeChecker(arg) {\n  const { interaction, interactable, element, rect, buttons } = arg\n\n  if (!rect) {\n    return undefined\n  }\n\n  const page = extend({}, interaction.coords.cur.page)\n  const resizeOptions = interactable.options.resize\n\n  if (\n    !(resizeOptions && resizeOptions.enabled) ||\n    // check mouseButton setting if the pointer is down\n    (interaction.pointerIsDown &&\n      /mouse|pointer/.test(interaction.pointerType) &&\n      (buttons & resizeOptions.mouseButtons) === 0)\n  ) {\n    return undefined\n  }\n\n  // if using resize.edges\n  if (is.object(resizeOptions.edges)) {\n    const resizeEdges = {\n      left: false,\n      right: false,\n      top: false,\n      bottom: false,\n    }\n\n    for (const edge in resizeEdges) {\n      resizeEdges[edge] = checkResizeEdge(\n        edge,\n        resizeOptions.edges[edge],\n        page,\n        interaction._latestPointer.eventTarget,\n        element,\n        rect,\n        resizeOptions.margin || resize.defaultMargin,\n      )\n    }\n\n    resizeEdges.left = resizeEdges.left && !resizeEdges.right\n    resizeEdges.top = resizeEdges.top && !resizeEdges.bottom\n\n    if (resizeEdges.left || resizeEdges.right || resizeEdges.top || resizeEdges.bottom) {\n      arg.action = {\n        name: 'resize',\n        edges: resizeEdges,\n      }\n    }\n  } else {\n    const right = resizeOptions.axis !== 'y' && page.x > rect.right - resize.defaultMargin\n    const bottom = resizeOptions.axis !== 'x' && page.y > rect.bottom - resize.defaultMargin\n\n    if (right || bottom) {\n      arg.action = {\n        name: 'resize',\n        axes: (right ? 'x' : '') + (bottom ? 'y' : ''),\n      }\n    }\n  }\n\n  return arg.action ? false : undefined\n}\n\nfunction resizable(interactable: Interactable, options: OrBoolean<ResizableOptions> | boolean, scope: Scope) {\n  if (is.object(options)) {\n    interactable.options.resize.enabled = options.enabled !== false\n    interactable.setPerAction('resize', options)\n    interactable.setOnEvents('resize', options)\n\n    if (is.string(options.axis) && /^x$|^y$|^xy$/.test(options.axis)) {\n      interactable.options.resize.axis = options.axis\n    } else if (options.axis === null) {\n      interactable.options.resize.axis = scope.defaults.actions.resize.axis\n    }\n\n    if (is.bool(options.preserveAspectRatio)) {\n      interactable.options.resize.preserveAspectRatio = options.preserveAspectRatio\n    } else if (is.bool(options.square)) {\n      interactable.options.resize.square = options.square\n    }\n\n    return interactable\n  }\n  if (is.bool(options)) {\n    interactable.options.resize.enabled = options\n\n    return interactable\n  }\n  return interactable.options.resize\n}\n\nfunction checkResizeEdge(\n  name: string,\n  value: any,\n  page: Point,\n  element: Node,\n  interactableElement: Element,\n  rect: Rect,\n  margin: number,\n) {\n  // false, '', undefined, null\n  if (!value) {\n    return false\n  }\n\n  // true value, use pointer coords and element rect\n  if (value === true) {\n    // if dimensions are negative, \"switch\" edges\n    const width = is.number(rect.width) ? rect.width : rect.right - rect.left\n    const height = is.number(rect.height) ? rect.height : rect.bottom - rect.top\n\n    // don't use margin greater than half the relevent dimension\n    margin = Math.min(margin, Math.abs((name === 'left' || name === 'right' ? width : height) / 2))\n\n    if (width < 0) {\n      if (name === 'left') {\n        name = 'right'\n      } else if (name === 'right') {\n        name = 'left'\n      }\n    }\n    if (height < 0) {\n      if (name === 'top') {\n        name = 'bottom'\n      } else if (name === 'bottom') {\n        name = 'top'\n      }\n    }\n\n    if (name === 'left') {\n      const edge = width >= 0 ? rect.left : rect.right\n      return page.x < edge + margin\n    }\n    if (name === 'top') {\n      const edge = height >= 0 ? rect.top : rect.bottom\n      return page.y < edge + margin\n    }\n\n    if (name === 'right') {\n      return page.x > (width >= 0 ? rect.right : rect.left) - margin\n    }\n    if (name === 'bottom') {\n      return page.y > (height >= 0 ? rect.bottom : rect.top) - margin\n    }\n  }\n\n  // the remaining checks require an element\n  if (!is.element(element)) {\n    return false\n  }\n\n  return is.element(value)\n    ? // the value is an element to use as a resize handle\n      value === element\n    : // otherwise check if element matches value as selector\n      dom.matchesUpTo(element, value, interactableElement)\n}\n\n/* eslint-disable multiline-ternary */\n// eslint-disable-next-line @typescript-eslint/consistent-type-imports\nfunction initCursors(browser: typeof import('@interactjs/utils/browser').default) {\n  return browser.isIe9\n    ? {\n        x: 'e-resize',\n        y: 's-resize',\n        xy: 'se-resize',\n\n        top: 'n-resize',\n        left: 'w-resize',\n        bottom: 's-resize',\n        right: 'e-resize',\n        topleft: 'se-resize',\n        bottomright: 'se-resize',\n        topright: 'ne-resize',\n        bottomleft: 'ne-resize',\n      }\n    : {\n        x: 'ew-resize',\n        y: 'ns-resize',\n        xy: 'nwse-resize',\n\n        top: 'ns-resize',\n        left: 'ew-resize',\n        bottom: 'ns-resize',\n        right: 'ew-resize',\n        topleft: 'nwse-resize',\n        bottomright: 'nwse-resize',\n        topright: 'nesw-resize',\n        bottomleft: 'nesw-resize',\n      }\n}\n/* eslint-enable multiline-ternary */\n\nfunction start({ iEvent, interaction }: { iEvent: InteractEvent<any, any>; interaction: Interaction }) {\n  if (interaction.prepared.name !== 'resize' || !interaction.prepared.edges) {\n    return\n  }\n\n  const resizeEvent = iEvent as ResizeEvent\n  const rect = interaction.rect\n\n  interaction._rects = {\n    start: extend({}, rect),\n    corrected: extend({}, rect),\n    previous: extend({}, rect),\n    delta: {\n      left: 0,\n      right: 0,\n      width: 0,\n      top: 0,\n      bottom: 0,\n      height: 0,\n    },\n  }\n\n  resizeEvent.edges = interaction.prepared.edges\n  resizeEvent.rect = interaction._rects.corrected\n  resizeEvent.deltaRect = interaction._rects.delta\n}\n\nfunction move({ iEvent, interaction }: { iEvent: InteractEvent<any, any>; interaction: Interaction }) {\n  if (interaction.prepared.name !== 'resize' || !interaction.prepared.edges) return\n\n  const resizeEvent = iEvent as ResizeEvent\n  const resizeOptions = interaction.interactable.options.resize\n  const invert = resizeOptions.invert\n  const invertible = invert === 'reposition' || invert === 'negate'\n\n  const current = interaction.rect\n  const { start: startRect, corrected, delta: deltaRect, previous } = interaction._rects\n\n  extend(previous, corrected)\n\n  if (invertible) {\n    // if invertible, copy the current rect\n    extend(corrected, current)\n\n    if (invert === 'reposition') {\n      // swap edge values if necessary to keep width/height positive\n      if (corrected.top > corrected.bottom) {\n        const swap = corrected.top\n\n        corrected.top = corrected.bottom\n        corrected.bottom = swap\n      }\n      if (corrected.left > corrected.right) {\n        const swap = corrected.left\n\n        corrected.left = corrected.right\n        corrected.right = swap\n      }\n    }\n  } else {\n    // if not invertible, restrict to minimum of 0x0 rect\n    corrected.top = Math.min(current.top, startRect.bottom)\n    corrected.bottom = Math.max(current.bottom, startRect.top)\n    corrected.left = Math.min(current.left, startRect.right)\n    corrected.right = Math.max(current.right, startRect.left)\n  }\n\n  corrected.width = corrected.right - corrected.left\n  corrected.height = corrected.bottom - corrected.top\n\n  for (const edge in corrected) {\n    deltaRect[edge] = corrected[edge] - previous[edge]\n  }\n\n  resizeEvent.edges = interaction.prepared.edges\n  resizeEvent.rect = corrected\n  resizeEvent.deltaRect = deltaRect\n}\n\nfunction end({ iEvent, interaction }: { iEvent: InteractEvent<any, any>; interaction: Interaction }) {\n  if (interaction.prepared.name !== 'resize' || !interaction.prepared.edges) return\n\n  const resizeEvent = iEvent as ResizeEvent\n\n  resizeEvent.edges = interaction.prepared.edges\n  resizeEvent.rect = interaction._rects.corrected\n  resizeEvent.deltaRect = interaction._rects.delta\n}\n\nfunction updateEventAxes({\n  iEvent,\n  interaction,\n}: {\n  iEvent: InteractEvent<any, any>\n  interaction: Interaction\n}) {\n  if (interaction.prepared.name !== 'resize' || !interaction.resizeAxes) return\n\n  const options = interaction.interactable.options\n  const resizeEvent = iEvent as ResizeEvent\n\n  if (options.resize.square) {\n    if (interaction.resizeAxes === 'y') {\n      resizeEvent.delta.x = resizeEvent.delta.y\n    } else {\n      resizeEvent.delta.y = resizeEvent.delta.x\n    }\n    resizeEvent.axes = 'xy'\n  } else {\n    resizeEvent.axes = interaction.resizeAxes\n\n    if (interaction.resizeAxes === 'x') {\n      resizeEvent.delta.y = 0\n    } else if (interaction.resizeAxes === 'y') {\n      resizeEvent.delta.x = 0\n    }\n  }\n}\n\nconst resize: Plugin = {\n  id: 'actions/resize',\n  before: ['actions/drag'],\n  install,\n  listeners: {\n    'interactions:new': ({ interaction }) => {\n      interaction.resizeAxes = 'xy'\n    },\n\n    'interactions:action-start': (arg) => {\n      start(arg)\n      updateEventAxes(arg)\n    },\n    'interactions:action-move': (arg) => {\n      move(arg)\n      updateEventAxes(arg)\n    },\n    'interactions:action-end': end,\n    'auto-start:check': resizeChecker,\n  },\n\n  defaults: {\n    square: false,\n    preserveAspectRatio: false,\n    axis: 'xy',\n\n    // use default margin\n    margin: NaN,\n\n    // object with props left, right, top, bottom which are\n    // true/false values to resize when the pointer is over that edge,\n    // CSS selectors to match the handles for each direction\n    // or the Elements for each handle\n    edges: null,\n\n    // a value of 'none' will limit the resize rect to a minimum of 0x0\n    // 'negate' will alow the rect to have negative width/height\n    // 'reposition' will keep the width/height positive by swapping\n    // the top and bottom edges and/or swapping the left and right edges\n    invert: 'none',\n  } as ResizableOptions,\n\n  cursors: null as ReturnType<typeof initCursors>,\n\n  getCursor({ edges, axis, name }: ActionProps) {\n    const cursors = resize.cursors\n    let result: string = null\n\n    if (axis) {\n      result = cursors[name + axis]\n    } else if (edges) {\n      let cursorKey = ''\n\n      for (const edge of ['top', 'bottom', 'left', 'right']) {\n        if (edges[edge]) {\n          cursorKey += edge\n        }\n      }\n\n      result = cursors[cursorKey]\n    }\n\n    return result\n  },\n\n  filterEventType: (type: string) => type.search('resize') === 0,\n\n  defaultMargin: null as number,\n}\n\nexport default resize\n", "let lastTime = 0\nlet request: typeof requestAnimationFrame\nlet cancel: typeof cancelAnimationFrame\n\nfunction init(global: Window | typeof globalThis) {\n  request = global.requestAnimationFrame\n  cancel = global.cancelAnimationFrame\n\n  if (!request) {\n    const vendors = ['ms', 'moz', 'webkit', 'o']\n\n    for (const vendor of vendors) {\n      request = global[`${vendor}RequestAnimationFrame` as 'requestAnimationFrame']\n      cancel =\n        global[`${vendor}CancelAnimationFrame` as 'cancelAnimationFrame'] ||\n        global[`${vendor}CancelRequestAnimationFrame` as 'cancelAnimationFrame']\n    }\n  }\n\n  request = request && request.bind(global)\n  cancel = cancel && cancel.bind(global)\n\n  if (!request) {\n    request = (callback) => {\n      const currTime = Date.now()\n      const timeToCall = Math.max(0, 16 - (currTime - lastTime))\n      const token = global.setTimeout(() => {\n        // eslint-disable-next-line n/no-callback-literal\n        callback(currTime + timeToCall)\n      }, timeToCall)\n\n      lastTime = currTime + timeToCall\n      return token as any\n    }\n\n    cancel = (token) => clearTimeout(token)\n  }\n}\n\nexport default {\n  request: (callback: FrameRequestCallback) => request(callback),\n  cancel: (token: number) => cancel(token),\n  init,\n}\n", "import type { Scope } from '@interactjs/core/scope'\n\n/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport './drag/plugin'\nimport './drop/plugin'\nimport './gesture/plugin'\nimport './resize/plugin'\n\nimport drag from './drag/plugin'\nimport drop from './drop/plugin'\nimport gesture from './gesture/plugin'\nimport resize from './resize/plugin'\n/* eslint-enable import/no-duplicates */\n\nexport default {\n  id: 'actions',\n  install(scope: Scope) {\n    scope.usePlugin(gesture)\n    scope.usePlugin(resize)\n    scope.usePlugin(drag)\n    scope.usePlugin(drop)\n  },\n}\n", "import type { Interactable } from '@interactjs/core/Interactable'\nimport type Interaction from '@interactjs/core/Interaction'\nimport type { Scope, Plugin } from '@interactjs/core/scope'\nimport type { ActionName, PointerType } from '@interactjs/core/types'\nimport * as domUtils from '@interactjs/utils/domUtils'\nimport is from '@interactjs/utils/is'\nimport raf from '@interactjs/utils/raf'\nimport { getStringOptionResult } from '@interactjs/utils/rect'\nimport { getWindow } from '@interactjs/utils/window'\n\ndeclare module '@interactjs/core/scope' {\n  interface Scope {\n    autoScroll: typeof autoScroll\n  }\n}\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction {\n    autoScroll?: typeof autoScroll\n  }\n}\n\ndeclare module '@interactjs/core/options' {\n  interface PerActionDefaults {\n    autoScroll?: AutoScrollOptions\n  }\n}\n\nexport interface AutoScrollOptions {\n  container?: Window | HTMLElement | string\n  margin?: number\n  distance?: number\n  interval?: number\n  speed?: number\n  enabled?: boolean\n}\n\nfunction install(scope: Scope) {\n  const { defaults, actions } = scope\n\n  scope.autoScroll = autoScroll\n  autoScroll.now = () => scope.now()\n\n  actions.phaselessTypes.autoscroll = true\n  defaults.perAction.autoScroll = autoScroll.defaults\n}\n\nconst autoScroll = {\n  defaults: {\n    enabled: false,\n    margin: 60,\n\n    // the item that is scrolled (Window or HTMLElement)\n    container: null as AutoScrollOptions['container'],\n\n    // the scroll speed in pixels per second\n    speed: 300,\n  } as AutoScrollOptions,\n\n  now: Date.now,\n\n  interaction: null as Interaction<ActionName> | null,\n  i: 0, // the handle returned by window.setInterval\n\n  // Direction each pulse is to scroll in\n  x: 0,\n  y: 0,\n\n  isScrolling: false,\n  prevTime: 0,\n  margin: 0,\n  speed: 0,\n\n  start(interaction: Interaction) {\n    autoScroll.isScrolling = true\n    raf.cancel(autoScroll.i)\n\n    interaction.autoScroll = autoScroll\n    autoScroll.interaction = interaction\n    autoScroll.prevTime = autoScroll.now()\n    autoScroll.i = raf.request(autoScroll.scroll)\n  },\n\n  stop() {\n    autoScroll.isScrolling = false\n    if (autoScroll.interaction) {\n      autoScroll.interaction.autoScroll = null\n    }\n    raf.cancel(autoScroll.i)\n  },\n\n  // scroll the window by the values in scroll.x/y\n  scroll() {\n    const { interaction } = autoScroll\n    const { interactable, element } = interaction\n    const actionName = interaction.prepared.name\n    const options = interactable.options[actionName].autoScroll\n    const container = getContainer(options.container, interactable, element)\n    const now = autoScroll.now()\n    // change in time in seconds\n    const dt = (now - autoScroll.prevTime) / 1000\n    // displacement\n    const s = options.speed * dt\n\n    if (s >= 1) {\n      const scrollBy = {\n        x: autoScroll.x * s,\n        y: autoScroll.y * s,\n      }\n\n      if (scrollBy.x || scrollBy.y) {\n        const prevScroll = getScroll(container)\n\n        if (is.window(container)) {\n          container.scrollBy(scrollBy.x, scrollBy.y)\n        } else if (container) {\n          container.scrollLeft += scrollBy.x\n          container.scrollTop += scrollBy.y\n        }\n\n        const curScroll = getScroll(container)\n        const delta = {\n          x: curScroll.x - prevScroll.x,\n          y: curScroll.y - prevScroll.y,\n        }\n\n        if (delta.x || delta.y) {\n          interactable.fire({\n            type: 'autoscroll',\n            target: element,\n            interactable,\n            delta,\n            interaction,\n            container,\n          })\n        }\n      }\n\n      autoScroll.prevTime = now\n    }\n\n    if (autoScroll.isScrolling) {\n      raf.cancel(autoScroll.i)\n      autoScroll.i = raf.request(autoScroll.scroll)\n    }\n  },\n  check(interactable: Interactable, actionName: ActionName) {\n    const options = interactable.options\n\n    return options[actionName].autoScroll?.enabled\n  },\n  onInteractionMove<T extends ActionName>({\n    interaction,\n    pointer,\n  }: {\n    interaction: Interaction<T>\n    pointer: PointerType\n  }) {\n    if (\n      !(interaction.interacting() && autoScroll.check(interaction.interactable, interaction.prepared.name))\n    ) {\n      return\n    }\n\n    if (interaction.simulation) {\n      autoScroll.x = autoScroll.y = 0\n      return\n    }\n\n    let top: boolean\n    let right: boolean\n    let bottom: boolean\n    let left: boolean\n\n    const { interactable, element } = interaction\n    const actionName = interaction.prepared.name\n    const options = interactable.options[actionName].autoScroll\n    const container = getContainer(options.container, interactable, element)\n\n    if (is.window(container)) {\n      left = pointer.clientX < autoScroll.margin\n      top = pointer.clientY < autoScroll.margin\n      right = pointer.clientX > container.innerWidth - autoScroll.margin\n      bottom = pointer.clientY > container.innerHeight - autoScroll.margin\n    } else {\n      const rect = domUtils.getElementClientRect(container)\n\n      left = pointer.clientX < rect.left + autoScroll.margin\n      top = pointer.clientY < rect.top + autoScroll.margin\n      right = pointer.clientX > rect.right - autoScroll.margin\n      bottom = pointer.clientY > rect.bottom - autoScroll.margin\n    }\n\n    autoScroll.x = right ? 1 : left ? -1 : 0\n    autoScroll.y = bottom ? 1 : top ? -1 : 0\n\n    if (!autoScroll.isScrolling) {\n      // set the autoScroll properties to those of the target\n      autoScroll.margin = options.margin\n      autoScroll.speed = options.speed\n\n      autoScroll.start(interaction)\n    }\n  },\n}\n\nexport function getContainer(value: any, interactable: Interactable, element: Element) {\n  return (\n    (is.string(value) ? getStringOptionResult(value, interactable, element) : value) || getWindow(element)\n  )\n}\n\nexport function getScroll(container: any) {\n  if (is.window(container)) {\n    container = window.document.body\n  }\n\n  return { x: container.scrollLeft, y: container.scrollTop }\n}\n\nexport function getScrollSize(container: any) {\n  if (is.window(container)) {\n    container = window.document.body\n  }\n\n  return { x: container.scrollWidth, y: container.scrollHeight }\n}\n\nexport function getScrollSizeDelta<T extends ActionName>(\n  {\n    interaction,\n    element,\n  }: {\n    interaction: Partial<Interaction<T>>\n    element: Element\n  },\n  func: any,\n) {\n  const scrollOptions = interaction && interaction.interactable.options[interaction.prepared.name].autoScroll\n\n  if (!scrollOptions || !scrollOptions.enabled) {\n    func()\n    return { x: 0, y: 0 }\n  }\n\n  const scrollContainer = getContainer(scrollOptions.container, interaction.interactable, element)\n\n  const prevSize = getScroll(scrollContainer)\n  func()\n  const curSize = getScroll(scrollContainer)\n\n  return {\n    x: curSize.x - prevSize.x,\n    y: curSize.y - prevSize.y,\n  }\n}\n\nconst autoScrollPlugin: Plugin = {\n  id: 'auto-scroll',\n  install,\n  listeners: {\n    'interactions:new': ({ interaction }) => {\n      interaction.autoScroll = null\n    },\n\n    'interactions:destroy': ({ interaction }) => {\n      interaction.autoScroll = null\n      autoScroll.stop()\n      if (autoScroll.interaction) {\n        autoScroll.interaction = null\n      }\n    },\n\n    'interactions:stop': autoScroll.stop,\n\n    'interactions:action-move': (arg: any) => autoScroll.onInteractionMove(arg),\n  },\n}\n\nexport default autoScrollPlugin\n", "import type { ActionName, ActionProps } from '@interactjs/core/types'\n\nimport { window } from './window'\n\nexport function warnOnce<T>(this: T, method: (...args: any[]) => any, message: string) {\n  let warned = false\n\n  return function (this: T) {\n    if (!warned) {\n      ;(window as any).console.warn(message)\n      warned = true\n    }\n\n    return method.apply(this, arguments)\n  }\n}\n\nexport function copyAction<T extends ActionName>(dest: ActionProps<any>, src: ActionProps<T>) {\n  dest.name = src.name\n  dest.axis = src.axis\n  dest.edges = src.edges\n\n  return dest\n}\n\nexport const sign = (n: number) => (n >= 0 ? 1 : -1)\n", "import type { Interactable } from '@interactjs/core/Interactable'\nimport type { Interaction } from '@interactjs/core/Interaction'\nimport type { Scope } from '@interactjs/core/scope'\nimport type { ActionProps, PointerType, PointerEventType, Element } from '@interactjs/core/types'\nimport is from '@interactjs/utils/is'\nimport { warnOnce } from '@interactjs/utils/misc'\n\ndeclare module '@interactjs/core/Interactable' {\n  interface Interactable {\n    getAction: (\n      this: Interactable,\n      pointer: PointerType,\n      event: PointerEventType,\n      interaction: Interaction,\n      element: Element,\n    ) => ActionProps | null\n    styleCursor(newValue: boolean): this\n    styleCursor(): boolean\n    /**\n     * Returns or sets whether the the cursor should be changed depending on the\n     * action that would be performed if the mouse were pressed and dragged.\n     *\n     * @param {boolean} [newValue]\n     * @return {boolean | Interactable} The current setting or this Interactable\n     */\n    styleCursor(newValue?: boolean): boolean | this\n    actionChecker(checker: Function): Interactable\n    actionChecker(): Function\n    /**\n     * ```js\n     * interact('.resize-drag')\n     *   .resizable(true)\n     *   .draggable(true)\n     *   .actionChecker(function (pointer, event, action, interactable, element, interaction) {\n     *\n     *     if (interact.matchesSelector(event.target, '.drag-handle')) {\n     *       // force drag with handle target\n     *       action.name = drag\n     *     }\n     *     else {\n     *       // resize from the top and right edges\n     *       action.name  = 'resize'\n     *       action.edges = { top: true, right: true }\n     *     }\n     *\n     *     return action\n     * })\n     * ```\n     *\n     * Returns or sets the function used to check action to be performed on\n     * pointerDown\n     *\n     * @param checker - A function which takes a pointer event,\n     * defaultAction string, interactable, element and interaction as parameters\n     * and returns an object with name property 'drag' 'resize' or 'gesture' and\n     * optionally an `edges` object with boolean 'top', 'left', 'bottom' and right\n     * props.\n     * @returns The checker function or this Interactable\n     */\n    actionChecker(checker?: Function): Interactable | Function\n    /** @returns This interactable */\n    ignoreFrom(newValue: string | Element | null): Interactable\n    /** @returns The current ignoreFrom value */\n    ignoreFrom(): string | Element | null\n    /**\n     * If the target of the `mousedown`, `pointerdown` or `touchstart` event or any\n     * of it's parents match the given CSS selector or Element, no\n     * drag/resize/gesture is started.\n     *\n     * @deprecated\n     * Don't use this method. Instead set the `ignoreFrom` option for each action\n     * or for `pointerEvents`\n     *\n     * ```js\n     * interact(targett)\n     *   .draggable({\n     *     ignoreFrom: 'input, textarea, a[href]'',\n     *   })\n     *   .pointerEvents({\n     *     ignoreFrom: '[no-pointer]',\n     *   })\n     * ```\n     * Interactable\n     */\n    ignoreFrom(\n      /** a CSS selector string, an Element or `null` to not ignore any elements */\n      newValue?: string | Element | null,\n    ): Interactable | string | Element | null\n    allowFrom(): boolean\n    /**\n     *\n     * A drag/resize/gesture is started only If the target of the `mousedown`,\n     * `pointerdown` or `touchstart` event or any of it's parents match the given\n     * CSS selector or Element.\n     *\n     * @deprecated\n     * Don't use this method. Instead set the `allowFrom` option for each action\n     * or for `pointerEvents`\n     *\n     * ```js\n     * interact(targett)\n     *   .resizable({\n     *     allowFrom: '.resize-handle',\n     *   .pointerEvents({\n     *     allowFrom: '.handle',,\n     *   })\n     * ```\n     *\n     * @param {string | Element | null} [newValue]\n     * @return {string | Element | object} The current allowFrom value or this\n     * Interactable\n     */\n    allowFrom(\n      /** A CSS selector string, an Element or `null` to allow from any element */\n      newValue: string | Element | null,\n    ): Interactable\n  }\n}\n\nfunction install(scope: Scope) {\n  const {\n    Interactable, // tslint:disable-line no-shadowed-variable\n  } = scope\n\n  Interactable.prototype.getAction = function getAction(\n    this: Interactable,\n    pointer: PointerType,\n    event: PointerEventType,\n    interaction: Interaction,\n    element: Element,\n  ): ActionProps {\n    const action = defaultActionChecker(this, event, interaction, element, scope)\n\n    if (this.options.actionChecker) {\n      return this.options.actionChecker(pointer, event, action, this, element, interaction)\n    }\n\n    return action\n  }\n\n  Interactable.prototype.ignoreFrom = warnOnce(function (this: Interactable, newValue) {\n    return this._backCompatOption('ignoreFrom', newValue)\n  }, 'Interactable.ignoreFrom() has been deprecated. Use Interactble.draggable({ignoreFrom: newValue}).')\n\n  Interactable.prototype.allowFrom = warnOnce(function (this: Interactable, newValue) {\n    return this._backCompatOption('allowFrom', newValue)\n  }, 'Interactable.allowFrom() has been deprecated. Use Interactble.draggable({allowFrom: newValue}).')\n\n  Interactable.prototype.actionChecker = actionChecker\n\n  Interactable.prototype.styleCursor = styleCursor\n}\n\nfunction defaultActionChecker(\n  interactable: Interactable,\n  event: PointerEventType,\n  interaction: Interaction,\n  element: Element,\n  scope: Scope,\n) {\n  const rect = interactable.getRect(element)\n  const buttons =\n    (event as MouseEvent).buttons ||\n    {\n      0: 1,\n      1: 4,\n      3: 8,\n      4: 16,\n    }[(event as MouseEvent).button as 0 | 1 | 3 | 4]\n  const arg = {\n    action: null,\n    interactable,\n    interaction,\n    element,\n    rect,\n    buttons,\n  }\n\n  scope.fire('auto-start:check', arg)\n\n  return arg.action\n}\n\nfunction styleCursor(this: Interactable, newValue?: boolean) {\n  if (is.bool(newValue)) {\n    this.options.styleCursor = newValue\n\n    return this\n  }\n\n  if (newValue === null) {\n    delete this.options.styleCursor\n\n    return this\n  }\n\n  return this.options.styleCursor\n}\n\nfunction actionChecker(this: Interactable, checker?: any) {\n  if (is.func(checker)) {\n    this.options.actionChecker = checker\n\n    return this\n  }\n\n  if (checker === null) {\n    delete this.options.actionChecker\n\n    return this\n  }\n\n  return this.options.actionChecker\n}\n\nexport default {\n  id: 'auto-start/interactableMethods',\n  install,\n}\n", "import type { Interactable } from '@interactjs/core/Interactable'\nimport type { Interaction } from '@interactjs/core/Interaction'\nimport type { Scope, SignalArgs, Plugin } from '@interactjs/core/scope'\nimport type {\n  CursorChecker,\n  PointerType,\n  PointerEventType,\n  Element,\n  ActionName,\n  ActionProps,\n} from '@interactjs/core/types'\nimport * as domUtils from '@interactjs/utils/domUtils'\nimport extend from '@interactjs/utils/extend'\nimport is from '@interactjs/utils/is'\nimport { copyAction } from '@interactjs/utils/misc'\n\n/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport './InteractableMethods'\nimport InteractableMethods from './InteractableMethods'\n/* eslint-enable import/no-duplicates */\n\ndeclare module '@interactjs/core/InteractStatic' {\n  export interface InteractStatic {\n    /**\n     * Returns or sets the maximum number of concurrent interactions allowed.  By\n     * default only 1 interaction is allowed at a time (for backwards\n     * compatibility). To allow multiple interactions on the same Interactables and\n     * elements, you need to enable it in the draggable, resizable and gesturable\n     * `'max'` and `'maxPerElement'` options.\n     *\n     * @param {number} [newValue] Any number. newValue <= 0 means no interactions.\n     */\n    maxInteractions: (newValue: any) => any\n  }\n}\n\ndeclare module '@interactjs/core/scope' {\n  interface Scope {\n    autoStart: AutoStart\n  }\n\n  interface SignalArgs {\n    'autoStart:before-start': Omit<SignalArgs['interactions:move'], 'interaction'> & {\n      interaction: Interaction<ActionName>\n    }\n    'autoStart:prepared': { interaction: Interaction }\n    'auto-start:check': CheckSignalArg\n  }\n}\n\ndeclare module '@interactjs/core/options' {\n  interface BaseDefaults {\n    actionChecker?: any\n    cursorChecker?: any\n    styleCursor?: any\n  }\n\n  interface PerActionDefaults {\n    manualStart?: boolean\n    max?: number\n    maxPerElement?: number\n    allowFrom?: string | Element\n    ignoreFrom?: string | Element\n    cursorChecker?: CursorChecker\n\n    // only allow left button by default\n    // see https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/buttons#Return_value\n    // TODO: docst\n    mouseButtons?: 0 | 1 | 2 | 4 | 8 | 16\n  }\n}\n\ninterface CheckSignalArg {\n  interactable: Interactable\n  interaction: Interaction\n  element: Element\n  action: ActionProps<ActionName>\n  buttons: number\n}\n\nexport interface AutoStart {\n  // Allow this many interactions to happen simultaneously\n  maxInteractions: number\n  withinInteractionLimit: typeof withinInteractionLimit\n  cursorElement: Element\n}\n\nfunction install(scope: Scope) {\n  const { interactStatic: interact, defaults } = scope\n\n  scope.usePlugin(InteractableMethods)\n\n  defaults.base.actionChecker = null\n  defaults.base.styleCursor = true\n\n  extend(defaults.perAction, {\n    manualStart: false,\n    max: Infinity,\n    maxPerElement: 1,\n    allowFrom: null,\n    ignoreFrom: null,\n\n    // only allow left button by default\n    // see https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/buttons#Return_value\n    mouseButtons: 1,\n  })\n\n  interact.maxInteractions = (newValue: number) => maxInteractions(newValue, scope)\n\n  scope.autoStart = {\n    // Allow this many interactions to happen simultaneously\n    maxInteractions: Infinity,\n    withinInteractionLimit,\n    cursorElement: null,\n  }\n}\n\nfunction prepareOnDown(\n  { interaction, pointer, event, eventTarget }: SignalArgs['interactions:down'],\n  scope: Scope,\n) {\n  if (interaction.interacting()) return\n\n  const actionInfo = getActionInfo(interaction, pointer, event, eventTarget, scope)\n  prepare(interaction, actionInfo, scope)\n}\n\nfunction prepareOnMove(\n  { interaction, pointer, event, eventTarget }: SignalArgs['interactions:move'],\n  scope: Scope,\n) {\n  if (interaction.pointerType !== 'mouse' || interaction.pointerIsDown || interaction.interacting()) return\n\n  const actionInfo = getActionInfo(interaction, pointer, event, eventTarget as Element, scope)\n  prepare(interaction, actionInfo, scope)\n}\n\nfunction startOnMove(arg: SignalArgs['interactions:move'], scope: Scope) {\n  const { interaction } = arg\n\n  if (\n    !interaction.pointerIsDown ||\n    interaction.interacting() ||\n    !interaction.pointerWasMoved ||\n    !interaction.prepared.name\n  ) {\n    return\n  }\n\n  scope.fire('autoStart:before-start', arg)\n\n  const { interactable } = interaction\n  const actionName = (interaction as Interaction<ActionName>).prepared.name\n\n  if (actionName && interactable) {\n    // check manualStart and interaction limit\n    if (\n      interactable.options[actionName].manualStart ||\n      !withinInteractionLimit(interactable, interaction.element, interaction.prepared, scope)\n    ) {\n      interaction.stop()\n    } else {\n      interaction.start(interaction.prepared, interactable, interaction.element)\n      setInteractionCursor(interaction, scope)\n    }\n  }\n}\n\nfunction clearCursorOnStop({ interaction }: { interaction: Interaction }, scope: Scope) {\n  const { interactable } = interaction\n\n  if (interactable && interactable.options.styleCursor) {\n    setCursor(interaction.element, '', scope)\n  }\n}\n\n// Check if the current interactable supports the action.\n// If so, return the validated action. Otherwise, return null\nfunction validateAction<T extends ActionName>(\n  action: ActionProps<T>,\n  interactable: Interactable,\n  element: Element,\n  eventTarget: Node,\n  scope: Scope,\n) {\n  if (\n    interactable.testIgnoreAllow(interactable.options[action.name], element, eventTarget) &&\n    interactable.options[action.name].enabled &&\n    withinInteractionLimit(interactable, element, action, scope)\n  ) {\n    return action\n  }\n\n  return null\n}\n\nfunction validateMatches(\n  interaction: Interaction,\n  pointer: PointerType,\n  event: PointerEventType,\n  matches: Interactable[],\n  matchElements: Element[],\n  eventTarget: Node,\n  scope: Scope,\n) {\n  for (let i = 0, len = matches.length; i < len; i++) {\n    const match = matches[i]\n    const matchElement = matchElements[i]\n    const matchAction = match.getAction(pointer, event, interaction, matchElement)\n\n    if (!matchAction) {\n      continue\n    }\n\n    const action = validateAction<ActionName>(matchAction, match, matchElement, eventTarget, scope)\n\n    if (action) {\n      return {\n        action,\n        interactable: match,\n        element: matchElement,\n      }\n    }\n  }\n\n  return { action: null, interactable: null, element: null }\n}\n\nfunction getActionInfo(\n  interaction: Interaction,\n  pointer: PointerType,\n  event: PointerEventType,\n  eventTarget: Node,\n  scope: Scope,\n) {\n  let matches: Interactable[] = []\n  let matchElements: Element[] = []\n\n  let element = eventTarget as Element\n\n  function pushMatches(interactable: Interactable) {\n    matches.push(interactable)\n    matchElements.push(element)\n  }\n\n  while (is.element(element)) {\n    matches = []\n    matchElements = []\n\n    scope.interactables.forEachMatch(element, pushMatches)\n\n    const actionInfo = validateMatches(\n      interaction,\n      pointer,\n      event,\n      matches,\n      matchElements,\n      eventTarget,\n      scope,\n    )\n\n    if (actionInfo.action && !actionInfo.interactable.options[actionInfo.action.name].manualStart) {\n      return actionInfo\n    }\n\n    element = domUtils.parentNode(element) as Element\n  }\n\n  return { action: null, interactable: null, element: null }\n}\n\nfunction prepare(\n  interaction: Interaction,\n  {\n    action,\n    interactable,\n    element,\n  }: {\n    action: ActionProps<any>\n    interactable: Interactable\n    element: Element\n  },\n  scope: Scope,\n) {\n  action = action || { name: null }\n\n  interaction.interactable = interactable\n  interaction.element = element\n  copyAction(interaction.prepared, action)\n\n  interaction.rect = interactable && action.name ? interactable.getRect(element) : null\n\n  setInteractionCursor(interaction, scope)\n\n  scope.fire('autoStart:prepared', { interaction })\n}\n\nfunction withinInteractionLimit<T extends ActionName>(\n  interactable: Interactable,\n  element: Element,\n  action: ActionProps<T>,\n  scope: Scope,\n) {\n  const options = interactable.options\n  const maxActions = options[action.name].max\n  const maxPerElement = options[action.name].maxPerElement\n  const autoStartMax = scope.autoStart.maxInteractions\n  let activeInteractions = 0\n  let interactableCount = 0\n  let elementCount = 0\n\n  // no actions if any of these values == 0\n  if (!(maxActions && maxPerElement && autoStartMax)) {\n    return false\n  }\n\n  for (const interaction of scope.interactions.list) {\n    const otherAction = interaction.prepared.name\n\n    if (!interaction.interacting()) {\n      continue\n    }\n\n    activeInteractions++\n\n    if (activeInteractions >= autoStartMax) {\n      return false\n    }\n\n    if (interaction.interactable !== interactable) {\n      continue\n    }\n\n    interactableCount += otherAction === action.name ? 1 : 0\n\n    if (interactableCount >= maxActions) {\n      return false\n    }\n\n    if (interaction.element === element) {\n      elementCount++\n\n      if (otherAction === action.name && elementCount >= maxPerElement) {\n        return false\n      }\n    }\n  }\n\n  return autoStartMax > 0\n}\n\nfunction maxInteractions(newValue: any, scope: Scope) {\n  if (is.number(newValue)) {\n    scope.autoStart.maxInteractions = newValue\n\n    return this\n  }\n\n  return scope.autoStart.maxInteractions\n}\n\nfunction setCursor(element: Element, cursor: string, scope: Scope) {\n  const { cursorElement: prevCursorElement } = scope.autoStart\n\n  if (prevCursorElement && prevCursorElement !== element) {\n    prevCursorElement.style.cursor = ''\n  }\n\n  element.ownerDocument.documentElement.style.cursor = cursor\n  element.style.cursor = cursor\n  scope.autoStart.cursorElement = cursor ? element : null\n}\n\nfunction setInteractionCursor<T extends ActionName>(interaction: Interaction<T>, scope: Scope) {\n  const { interactable, element, prepared } = interaction\n\n  if (!(interaction.pointerType === 'mouse' && interactable && interactable.options.styleCursor)) {\n    // clear previous target element cursor\n    if (scope.autoStart.cursorElement) {\n      setCursor(scope.autoStart.cursorElement, '', scope)\n    }\n\n    return\n  }\n\n  let cursor = ''\n\n  if (prepared.name) {\n    const cursorChecker = interactable.options[prepared.name].cursorChecker\n\n    if (is.func(cursorChecker)) {\n      cursor = cursorChecker(prepared, interactable, element, interaction._interacting)\n    } else {\n      cursor = scope.actions.map[prepared.name].getCursor(prepared)\n    }\n  }\n\n  setCursor(interaction.element, cursor || '', scope)\n}\n\nconst autoStart: Plugin = {\n  id: 'auto-start/base',\n  before: ['actions'],\n  install,\n  listeners: {\n    'interactions:down': prepareOnDown,\n    'interactions:move': (arg, scope) => {\n      prepareOnMove(arg, scope)\n      startOnMove(arg, scope)\n    },\n    'interactions:stop': clearCursorOnStop,\n  },\n  maxInteractions,\n  withinInteractionLimit,\n  validateAction,\n}\n\nexport default autoStart\n", "import type { Interactable } from '@interactjs/core/Interactable'\nimport type Interaction from '@interactjs/core/Interaction'\nimport type { SignalArgs, Scope } from '@interactjs/core/scope'\nimport type { ActionName, Element } from '@interactjs/core/types'\nimport { parentNode } from '@interactjs/utils/domUtils'\nimport is from '@interactjs/utils/is'\n\nimport autoStart from './base'\n\nfunction beforeStart({ interaction, eventTarget, dx, dy }: SignalArgs['interactions:move'], scope: Scope) {\n  if (interaction.prepared.name !== 'drag') return\n\n  // check if a drag is in the correct axis\n  const absX = Math.abs(dx)\n  const absY = Math.abs(dy)\n  const targetOptions = interaction.interactable.options.drag\n  const startAxis = targetOptions.startAxis\n  const currentAxis = absX > absY ? 'x' : absX < absY ? 'y' : 'xy'\n\n  interaction.prepared.axis =\n    targetOptions.lockAxis === 'start'\n      ? (currentAxis[0] as 'x' | 'y') // always lock to one axis even if currentAxis === 'xy'\n      : targetOptions.lockAxis\n\n  // if the movement isn't in the startAxis of the interactable\n  if (currentAxis !== 'xy' && startAxis !== 'xy' && startAxis !== currentAxis) {\n    // cancel the prepared action\n    ;(interaction as Interaction<ActionName>).prepared.name = null\n\n    // then try to get a drag from another ineractable\n    let element = eventTarget as Element\n\n    const getDraggable = function (interactable: Interactable): Interactable | void {\n      if (interactable === interaction.interactable) return\n\n      const options = interaction.interactable.options.drag\n\n      if (!options.manualStart && interactable.testIgnoreAllow(options, element, eventTarget)) {\n        const action = interactable.getAction(\n          interaction.downPointer,\n          interaction.downEvent,\n          interaction,\n          element,\n        )\n\n        if (\n          action &&\n          action.name === 'drag' &&\n          checkStartAxis(currentAxis, interactable) &&\n          autoStart.validateAction(action, interactable, element, eventTarget, scope)\n        ) {\n          return interactable\n        }\n      }\n    }\n\n    // check all interactables\n    while (is.element(element)) {\n      const interactable = scope.interactables.forEachMatch(element, getDraggable)\n\n      if (interactable) {\n        ;(interaction as Interaction<ActionName>).prepared.name = 'drag'\n        interaction.interactable = interactable\n        interaction.element = element\n        break\n      }\n\n      element = parentNode(element) as Element\n    }\n  }\n}\n\nfunction checkStartAxis(startAxis: string, interactable: Interactable) {\n  if (!interactable) {\n    return false\n  }\n\n  const thisAxis = interactable.options.drag.startAxis\n\n  return startAxis === 'xy' || thisAxis === 'xy' || thisAxis === startAxis\n}\n\nexport default {\n  id: 'auto-start/dragAxis',\n  listeners: { 'autoStart:before-start': beforeStart },\n}\n", "import type Interaction from '@interactjs/core/Interaction'\nimport type { Scope, Plugin } from '@interactjs/core/scope'\n\n/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport './base'\nimport basePlugin from './base'\n/* eslint-enable */\n\ndeclare module '@interactjs/core/options' {\n  interface PerActionDefaults {\n    hold?: number\n    delay?: number\n  }\n}\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction {\n    autoStartHoldTimer?: any\n  }\n}\n\nfunction install(scope: Scope) {\n  const { defaults } = scope\n\n  scope.usePlugin(basePlugin)\n\n  defaults.perAction.hold = 0\n  defaults.perAction.delay = 0\n}\n\nfunction getHoldDuration(interaction: Interaction) {\n  const actionName = interaction.prepared && interaction.prepared.name\n\n  if (!actionName) {\n    return null\n  }\n\n  const options = interaction.interactable.options\n\n  return options[actionName].hold || options[actionName].delay\n}\n\nconst hold: Plugin = {\n  id: 'auto-start/hold',\n  install,\n  listeners: {\n    'interactions:new': ({ interaction }) => {\n      interaction.autoStartHoldTimer = null\n    },\n\n    'autoStart:prepared': ({ interaction }) => {\n      const hold = getHoldDuration(interaction)\n\n      if (hold > 0) {\n        interaction.autoStartHoldTimer = setTimeout(() => {\n          interaction.start(interaction.prepared, interaction.interactable, interaction.element)\n        }, hold)\n      }\n    },\n\n    'interactions:move': ({ interaction, duplicate }) => {\n      if (interaction.autoStartHoldTimer && interaction.pointerWasMoved && !duplicate) {\n        clearTimeout(interaction.autoStartHoldTimer)\n        interaction.autoStartHoldTimer = null\n      }\n    },\n\n    // prevent regular down->move autoStart\n    'autoStart:before-start': ({ interaction }) => {\n      const holdDuration = getHoldDuration(interaction)\n\n      if (holdDuration > 0) {\n        interaction.prepared.name = null\n      }\n    },\n  },\n  getHoldDuration,\n}\nexport default hold\n", "import type { Scope } from '@interactjs/core/scope'\n\n/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport './base'\nimport './dragAxis'\nimport './hold'\n\nimport autoStart from './base'\nimport dragAxis from './dragAxis'\nimport hold from './hold'\n/* eslint-enable import/no-duplicates */\n\nexport default {\n  id: 'auto-start',\n  install(scope: Scope) {\n    scope.usePlugin(autoStart)\n    scope.usePlugin(hold)\n    scope.usePlugin(dragAxis)\n  },\n}\n", "import { matchesSelector, nodeContains } from '@interactjs/utils/domUtils'\nimport is from '@interactjs/utils/is'\nimport { getWindow } from '@interactjs/utils/window'\n\nimport type { Interactable } from '@interactjs/core/Interactable'\nimport type Interaction from '@interactjs/core/Interaction'\nimport type { Scope } from '@interactjs/core/scope'\nimport type { PointerEventType } from '@interactjs/core/types'\n\ntype PreventDefaultValue = 'always' | 'never' | 'auto'\n\ndeclare module '@interactjs/core/Interactable' {\n  interface Interactable {\n    preventDefault(newValue: PreventDefaultValue): this\n    preventDefault(): PreventDefaultValue\n    /**\n     * Returns or sets whether to prevent the browser's default behaviour in\n     * response to pointer events. Can be set to:\n     *  - `'always'` to always prevent\n     *  - `'never'` to never prevent\n     *  - `'auto'` to let interact.js try to determine what would be best\n     *\n     * @param newValue - `'always'`, `'never'` or `'auto'`\n     * @returns The current setting or this Interactable\n     */\n    preventDefault(newValue?: PreventDefaultValue): PreventDefaultValue | this\n    checkAndPreventDefault(event: Event): void\n  }\n}\n\nconst preventDefault = function preventDefault(this: Interactable, newValue?: PreventDefaultValue) {\n  if (/^(always|never|auto)$/.test(newValue)) {\n    this.options.preventDefault = newValue\n    return this\n  }\n\n  if (is.bool(newValue)) {\n    this.options.preventDefault = newValue ? 'always' : 'never'\n    return this\n  }\n\n  return this.options.preventDefault\n} as Interactable['preventDefault']\n\nfunction checkAndPreventDefault(interactable: Interactable, scope: Scope, event: Event) {\n  const setting = interactable.options.preventDefault\n\n  if (setting === 'never') return\n\n  if (setting === 'always') {\n    event.preventDefault()\n    return\n  }\n\n  // setting === 'auto'\n\n  // if the browser supports passive event listeners and isn't running on iOS,\n  // don't preventDefault of touch{start,move} events. CSS touch-action and\n  // user-select should be used instead of calling event.preventDefault().\n  if (scope.events.supportsPassive && /^touch(start|move)$/.test(event.type)) {\n    const doc = getWindow(event.target).document\n    const docOptions = scope.getDocOptions(doc)\n\n    if (!(docOptions && docOptions.events) || docOptions.events.passive !== false) {\n      return\n    }\n  }\n\n  // don't preventDefault of pointerdown events\n  if (/^(mouse|pointer|touch)*(down|start)/i.test(event.type)) {\n    return\n  }\n\n  // don't preventDefault on editable elements\n  if (\n    is.element(event.target) &&\n    matchesSelector(event.target, 'input,select,textarea,[contenteditable=true],[contenteditable=true] *')\n  ) {\n    return\n  }\n\n  event.preventDefault()\n}\n\nfunction onInteractionEvent({ interaction, event }: { interaction: Interaction; event: PointerEventType }) {\n  if (interaction.interactable) {\n    interaction.interactable.checkAndPreventDefault(event as Event)\n  }\n}\n\nexport function install(scope: Scope) {\n  const { Interactable } = scope\n\n  Interactable.prototype.preventDefault = preventDefault\n\n  Interactable.prototype.checkAndPreventDefault = function (event) {\n    return checkAndPreventDefault(this, scope, event)\n  }\n\n  // prevent native HTML5 drag on interact.js target elements\n  scope.interactions.docEvents.push({\n    type: 'dragstart',\n    listener(event) {\n      for (const interaction of scope.interactions.list) {\n        if (\n          interaction.element &&\n          (interaction.element === event.target || nodeContains(interaction.element, event.target))\n        ) {\n          interaction.interactable.checkAndPreventDefault(event)\n          return\n        }\n      }\n    },\n  })\n}\n\nexport default {\n  id: 'core/interactablePreventDefault',\n  install,\n  listeners: ['down', 'move', 'up', 'cancel'].reduce((acc, eventType) => {\n    acc[`interactions:${eventType}`] = onInteractionEvent\n    return acc\n  }, {} as any),\n}\n", "import type { Actions } from '@interactjs/core/types'\n\nexport default function isNonNativeEvent(type: string, actions: Actions) {\n  if (actions.phaselessTypes[type]) {\n    return true\n  }\n\n  for (const name in actions.map) {\n    if (type.indexOf(name) === 0 && type.substr(name.length) in actions.phases) {\n      return true\n    }\n  }\n\n  return false\n}\n", "import * as arr from './arr'\nimport is from './is'\n\n// tslint:disable-next-line ban-types\nexport default function clone<T extends Object>(source: T): Partial<T> {\n  const dest = {} as Partial<T>\n\n  for (const prop in source) {\n    const value = source[prop]\n\n    if (is.plainObject(value)) {\n      dest[prop] = clone(value) as any\n    } else if (is.array(value)) {\n      dest[prop] = arr.from(value) as typeof value\n    } else {\n      dest[prop] = value\n    }\n  }\n\n  return dest\n}\n", "import type { EventPhase } from '@interactjs/core/InteractEvent'\nimport type { Interaction, DoAnyPhaseArg } from '@interactjs/core/Interaction'\nimport type { EdgeOptions, FullRect, Point, Rect } from '@interactjs/core/types'\nimport clone from '@interactjs/utils/clone'\nimport extend from '@interactjs/utils/extend'\nimport * as rectUtils from '@interactjs/utils/rect'\n\nimport type { Modifier, ModifierArg, ModifierState } from './types'\n\nexport interface ModificationResult {\n  delta: Point\n  rectDelta: Rect\n  coords: Point\n  rect: FullRect\n  eventProps: any[]\n  changed: boolean\n}\n\ninterface MethodArg {\n  phase: EventPhase\n  pageCoords: Point\n  rect: FullRect\n  coords: Point\n  preEnd?: boolean\n  skipModifiers?: number\n}\n\nexport class Modification {\n  states: ModifierState[] = []\n  startOffset: Rect = { left: 0, right: 0, top: 0, bottom: 0 }\n  startDelta!: Point\n  result!: ModificationResult\n  endResult!: Point\n  startEdges!: EdgeOptions\n  edges: EdgeOptions\n  readonly interaction: Readonly<Interaction>\n\n  constructor(interaction: Interaction) {\n    this.interaction = interaction\n    this.result = createResult()\n    this.edges = {\n      left: false,\n      right: false,\n      top: false,\n      bottom: false,\n    }\n  }\n\n  start({ phase }: { phase: EventPhase }, pageCoords: Point) {\n    const { interaction } = this\n    const modifierList = getModifierList(interaction)\n    this.prepareStates(modifierList)\n\n    this.startEdges = extend({}, interaction.edges)\n    this.edges = extend({}, this.startEdges)\n    this.startOffset = getRectOffset(interaction.rect, pageCoords)\n    this.startDelta = { x: 0, y: 0 }\n\n    const arg = this.fillArg({\n      phase,\n      pageCoords,\n      preEnd: false,\n    })\n\n    this.result = createResult()\n    this.startAll(arg)\n\n    const result = (this.result = this.setAll(arg))\n\n    return result\n  }\n\n  fillArg(arg: Partial<ModifierArg>) {\n    const { interaction } = this\n\n    arg.interaction = interaction\n    arg.interactable = interaction.interactable\n    arg.element = interaction.element\n    arg.rect ||= interaction.rect\n    arg.edges ||= this.startEdges\n    arg.startOffset = this.startOffset\n\n    return arg as ModifierArg\n  }\n\n  startAll(arg: MethodArg & Partial<ModifierArg>) {\n    for (const state of this.states) {\n      if (state.methods.start) {\n        arg.state = state\n        state.methods.start(arg as ModifierArg)\n      }\n    }\n  }\n\n  setAll(arg: MethodArg & Partial<ModifierArg>): ModificationResult {\n    const { phase, preEnd, skipModifiers, rect: unmodifiedRect, edges: unmodifiedEdges } = arg\n\n    arg.coords = extend({}, arg.pageCoords)\n    arg.rect = extend({}, unmodifiedRect)\n    arg.edges = extend({}, unmodifiedEdges)\n\n    const states = skipModifiers ? this.states.slice(skipModifiers) : this.states\n\n    const newResult = createResult(arg.coords, arg.rect)\n\n    for (const state of states) {\n      const { options } = state\n      const lastModifierCoords = extend({}, arg.coords)\n      let returnValue = null\n\n      if (state.methods?.set && this.shouldDo(options, preEnd, phase)) {\n        arg.state = state\n        returnValue = state.methods.set(arg as ModifierArg<never>)\n\n        rectUtils.addEdges(arg.edges, arg.rect, {\n          x: arg.coords.x - lastModifierCoords.x,\n          y: arg.coords.y - lastModifierCoords.y,\n        })\n      }\n\n      newResult.eventProps.push(returnValue)\n    }\n\n    extend(this.edges, arg.edges)\n\n    newResult.delta.x = arg.coords.x - arg.pageCoords.x\n    newResult.delta.y = arg.coords.y - arg.pageCoords.y\n\n    newResult.rectDelta.left = arg.rect.left - unmodifiedRect.left\n    newResult.rectDelta.right = arg.rect.right - unmodifiedRect.right\n    newResult.rectDelta.top = arg.rect.top - unmodifiedRect.top\n    newResult.rectDelta.bottom = arg.rect.bottom - unmodifiedRect.bottom\n\n    const prevCoords = this.result.coords\n    const prevRect = this.result.rect\n\n    if (prevCoords && prevRect) {\n      const rectChanged =\n        newResult.rect.left !== prevRect.left ||\n        newResult.rect.right !== prevRect.right ||\n        newResult.rect.top !== prevRect.top ||\n        newResult.rect.bottom !== prevRect.bottom\n\n      newResult.changed =\n        rectChanged || prevCoords.x !== newResult.coords.x || prevCoords.y !== newResult.coords.y\n    }\n\n    return newResult\n  }\n\n  applyToInteraction(arg: { phase: EventPhase; rect?: Rect }) {\n    const { interaction } = this\n    const { phase } = arg\n    const curCoords = interaction.coords.cur\n    const startCoords = interaction.coords.start\n    const { result, startDelta } = this\n    const curDelta = result.delta\n\n    if (phase === 'start') {\n      extend(this.startDelta, result.delta)\n    }\n\n    for (const [coordsSet, delta] of [\n      [startCoords, startDelta],\n      [curCoords, curDelta],\n    ] as const) {\n      coordsSet.page.x += delta.x\n      coordsSet.page.y += delta.y\n      coordsSet.client.x += delta.x\n      coordsSet.client.y += delta.y\n    }\n\n    const { rectDelta } = this.result\n    const rect = arg.rect || interaction.rect\n\n    rect.left += rectDelta.left\n    rect.right += rectDelta.right\n    rect.top += rectDelta.top\n    rect.bottom += rectDelta.bottom\n\n    rect.width = rect.right - rect.left\n    rect.height = rect.bottom - rect.top\n  }\n\n  setAndApply(\n    arg: Partial<DoAnyPhaseArg> & {\n      phase: EventPhase\n      preEnd?: boolean\n      skipModifiers?: number\n      modifiedCoords?: Point\n    },\n  ): void | false {\n    const { interaction } = this\n    const { phase, preEnd, skipModifiers } = arg\n\n    const result = this.setAll(\n      this.fillArg({\n        preEnd,\n        phase,\n        pageCoords: arg.modifiedCoords || interaction.coords.cur.page,\n      }),\n    )\n\n    this.result = result\n\n    // don't fire an action move if a modifier would keep the event in the same\n    // cordinates as before\n    if (\n      !result.changed &&\n      (!skipModifiers || skipModifiers < this.states.length) &&\n      interaction.interacting()\n    ) {\n      return false\n    }\n\n    if (arg.modifiedCoords) {\n      const { page } = interaction.coords.cur\n      const adjustment = {\n        x: arg.modifiedCoords.x - page.x,\n        y: arg.modifiedCoords.y - page.y,\n      }\n\n      result.coords.x += adjustment.x\n      result.coords.y += adjustment.y\n      result.delta.x += adjustment.x\n      result.delta.y += adjustment.y\n    }\n\n    this.applyToInteraction(arg)\n  }\n\n  beforeEnd(arg: Omit<DoAnyPhaseArg, 'iEvent'> & { state?: ModifierState }): void | false {\n    const { interaction, event } = arg\n    const states = this.states\n\n    if (!states || !states.length) {\n      return\n    }\n\n    let doPreend = false\n\n    for (const state of states) {\n      arg.state = state\n      const { options, methods } = state\n\n      const endPosition = methods.beforeEnd && methods.beforeEnd(arg as unknown as ModifierArg)\n\n      if (endPosition) {\n        this.endResult = endPosition\n        return false\n      }\n\n      doPreend = doPreend || (!doPreend && this.shouldDo(options, true, arg.phase, true))\n    }\n\n    if (doPreend) {\n      // trigger a final modified move before ending\n      interaction.move({ event, preEnd: true })\n    }\n  }\n\n  stop(arg: { interaction: Interaction }) {\n    const { interaction } = arg\n\n    if (!this.states || !this.states.length) {\n      return\n    }\n\n    const modifierArg: Partial<ModifierArg> = extend(\n      {\n        states: this.states,\n        interactable: interaction.interactable,\n        element: interaction.element,\n        rect: null,\n      },\n      arg,\n    )\n\n    this.fillArg(modifierArg)\n\n    for (const state of this.states) {\n      modifierArg.state = state\n\n      if (state.methods.stop) {\n        state.methods.stop(modifierArg as ModifierArg)\n      }\n    }\n\n    this.states = null\n    this.endResult = null\n  }\n\n  prepareStates(modifierList: Modifier[]) {\n    this.states = []\n\n    for (let index = 0; index < modifierList.length; index++) {\n      const { options, methods, name } = modifierList[index]\n\n      this.states.push({\n        options,\n        methods,\n        index,\n        name,\n      })\n    }\n\n    return this.states\n  }\n\n  restoreInteractionCoords({ interaction: { coords, rect, modification } }: { interaction: Interaction }) {\n    if (!modification.result) return\n\n    const { startDelta } = modification\n    const { delta: curDelta, rectDelta } = modification.result\n\n    const coordsAndDeltas = [\n      [coords.start, startDelta],\n      [coords.cur, curDelta],\n    ]\n\n    for (const [coordsSet, delta] of coordsAndDeltas as any) {\n      coordsSet.page.x -= delta.x\n      coordsSet.page.y -= delta.y\n      coordsSet.client.x -= delta.x\n      coordsSet.client.y -= delta.y\n    }\n\n    rect.left -= rectDelta.left\n    rect.right -= rectDelta.right\n    rect.top -= rectDelta.top\n    rect.bottom -= rectDelta.bottom\n  }\n\n  shouldDo(options, preEnd?: boolean, phase?: string, requireEndOnly?: boolean) {\n    if (\n      // ignore disabled modifiers\n      !options ||\n      options.enabled === false ||\n      // check if we require endOnly option to fire move before end\n      (requireEndOnly && !options.endOnly) ||\n      // don't apply endOnly modifiers when not ending\n      (options.endOnly && !preEnd) ||\n      // check if modifier should run be applied on start\n      (phase === 'start' && !options.setStart)\n    ) {\n      return false\n    }\n\n    return true\n  }\n\n  copyFrom(other: Modification) {\n    this.startOffset = other.startOffset\n    this.startDelta = other.startDelta\n    this.startEdges = other.startEdges\n    this.edges = other.edges\n    this.states = other.states.map((s) => clone(s) as ModifierState)\n    this.result = createResult(extend({}, other.result.coords), extend({}, other.result.rect))\n  }\n\n  destroy() {\n    for (const prop in this) {\n      this[prop] = null\n    }\n  }\n}\n\nfunction createResult(coords?: Point, rect?: FullRect): ModificationResult {\n  return {\n    rect,\n    coords,\n    delta: { x: 0, y: 0 },\n    rectDelta: {\n      left: 0,\n      right: 0,\n      top: 0,\n      bottom: 0,\n    },\n    eventProps: [],\n    changed: true,\n  }\n}\n\nfunction getModifierList(interaction) {\n  const actionOptions = interaction.interactable.options[interaction.prepared.name]\n  const actionModifiers = actionOptions.modifiers\n\n  if (actionModifiers && actionModifiers.length) {\n    return actionModifiers\n  }\n\n  return ['snap', 'snapSize', 'snapEdges', 'restrict', 'restrictEdges', 'restrictSize']\n    .map((type) => {\n      const options = actionOptions[type]\n\n      return (\n        options &&\n        options.enabled && {\n          options,\n          methods: options._methods,\n        }\n      )\n    })\n    .filter((m) => !!m)\n}\n\nexport function getRectOffset(rect, coords) {\n  return rect\n    ? {\n        left: coords.x - rect.left,\n        top: coords.y - rect.top,\n        right: rect.right - coords.x,\n        bottom: rect.bottom - coords.y,\n      }\n    : {\n        left: 0,\n        top: 0,\n        right: 0,\n        bottom: 0,\n      }\n}\n", "import type { InteractEvent } from '@interactjs/core/InteractEvent'\nimport type Interaction from '@interactjs/core/Interaction'\nimport type { Plugin } from '@interactjs/core/scope'\n\nimport { Modification } from './Modification'\nimport type { Modifier, ModifierModule, ModifierState } from './types'\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction {\n    modification?: Modification\n  }\n}\n\ndeclare module '@interactjs/core/InteractEvent' {\n  interface InteractEvent {\n    modifiers?: Array<{\n      name: string\n      [key: string]: any\n    }>\n  }\n}\n\ndeclare module '@interactjs/core/options' {\n  interface PerActionDefaults {\n    modifiers?: Modifier[]\n  }\n}\n\nexport function makeModifier<\n  Defaults extends { enabled?: boolean },\n  State extends ModifierState,\n  Name extends string,\n  Result,\n>(module: ModifierModule<Defaults, State, Result>, name?: Name) {\n  const { defaults } = module\n  const methods = {\n    start: module.start,\n    set: module.set,\n    beforeEnd: module.beforeEnd,\n    stop: module.stop,\n  }\n\n  const modifier = (_options?: Partial<Defaults>) => {\n    const options = (_options || {}) as Defaults\n\n    options.enabled = options.enabled !== false\n\n    // add missing defaults to options\n    for (const prop in defaults) {\n      if (!(prop in options)) {\n        ;(options as any)[prop] = defaults[prop]\n      }\n    }\n\n    const m: Modifier<Defaults, State, Name, Result> = {\n      options,\n      methods,\n      name,\n      enable: () => {\n        options.enabled = true\n        return m\n      },\n      disable: () => {\n        options.enabled = false\n        return m\n      },\n    }\n\n    return m\n  }\n\n  if (name && typeof name === 'string') {\n    // for backwrads compatibility\n    modifier._defaults = defaults\n    modifier._methods = methods\n  }\n\n  return modifier\n}\n\nexport function addEventModifiers({\n  iEvent,\n  interaction,\n}: {\n  iEvent: InteractEvent<any>\n  interaction: Interaction<any>\n}) {\n  const result = interaction.modification!.result\n\n  if (result) {\n    iEvent.modifiers = result.eventProps\n  }\n}\n\nconst modifiersBase: Plugin = {\n  id: 'modifiers/base',\n  before: ['actions'],\n  install: (scope) => {\n    scope.defaults.perAction.modifiers = []\n  },\n  listeners: {\n    'interactions:new': ({ interaction }) => {\n      interaction.modification = new Modification(interaction)\n    },\n\n    'interactions:before-action-start': (arg) => {\n      const { interaction } = arg\n      const modification = arg.interaction.modification!\n\n      modification.start(arg, interaction.coords.start.page)\n      interaction.edges = modification.edges\n      modification.applyToInteraction(arg)\n    },\n\n    'interactions:before-action-move': (arg) => {\n      const { interaction } = arg\n      const { modification } = interaction\n      const ret = modification.setAndApply(arg)\n      interaction.edges = modification.edges\n\n      return ret\n    },\n\n    'interactions:before-action-end': (arg) => {\n      const { interaction } = arg\n      const { modification } = interaction\n      const ret = modification.beforeEnd(arg)\n      interaction.edges = modification.startEdges\n\n      return ret\n    },\n\n    'interactions:action-start': addEventModifiers,\n    'interactions:action-move': addEventModifiers,\n    'interactions:action-end': addEventModifiers,\n\n    'interactions:after-action-start': (arg) => arg.interaction.modification.restoreInteractionCoords(arg),\n    'interactions:after-action-move': (arg) => arg.interaction.modification.restoreInteractionCoords(arg),\n\n    'interactions:stop': (arg) => arg.interaction.modification.stop(arg),\n  },\n}\n\nexport default modifiersBase\n", "import type { Point, Listeners, OrBoolean, Element, Rect } from '@interactjs/core/types'\n\nexport interface Defaults {\n  base: BaseDefaults\n  perAction: PerActionDefaults\n  actions: ActionDefaults\n}\n\n// eslint-disable-next-line @typescript-eslint/no-empty-interface\nexport interface ActionDefaults {}\n\nexport interface BaseDefaults {\n  preventDefault?: 'always' | 'never' | 'auto'\n  deltaSource?: 'page' | 'client'\n  context?: Node\n  getRect?: (element: Element) => Rect\n}\n\nexport interface PerActionDefaults {\n  enabled?: boolean\n  origin?: Point | string | Element\n  listeners?: Listeners\n  allowFrom?: string | Element\n  ignoreFrom?: string | Element\n}\n\nexport type Options = Partial<BaseDefaults> &\n  Partial<PerActionDefaults> & {\n    [P in keyof ActionDefaults]?: Partial<ActionDefaults[P]>\n  }\n\nexport interface OptionsArg extends BaseDefaults, OrBoolean<Partial<ActionDefaults>> {}\n\nexport const defaults: Defaults = {\n  base: {\n    preventDefault: 'auto',\n    deltaSource: 'page',\n  },\n\n  perAction: {\n    enabled: false,\n    origin: { x: 0, y: 0 },\n  },\n\n  actions: {} as ActionDefaults,\n}\n", "import extend from '@interactjs/utils/extend'\nimport getOriginXY from '@interactjs/utils/getOriginXY'\nimport hypot from '@interactjs/utils/hypot'\n\nimport type { Point, FullRect, PointerEventType, Element, ActionName } from '@interactjs/core/types'\n\nimport { BaseEvent } from './BaseEvent'\nimport type { Interaction } from './Interaction'\nimport { defaults } from './options'\n\nexport type EventPhase = keyof PhaseMap\n\nexport interface PhaseMap {\n  start: true\n  move: true\n  end: true\n}\n\n// defined outside of class definition to avoid assignment of undefined during\n// construction\nexport interface InteractEvent {\n  pageX: number\n  pageY: number\n\n  clientX: number\n  clientY: number\n\n  dx: number\n  dy: number\n\n  velocityX: number\n  velocityY: number\n}\n\nexport class InteractEvent<\n  T extends ActionName = never,\n  P extends EventPhase = EventPhase,\n> extends BaseEvent<T> {\n  declare target: Element\n  declare currentTarget: Element\n  relatedTarget: Element | null = null\n  screenX?: number\n  screenY?: number\n  button: number\n  buttons: number\n  ctrlKey: boolean\n  shiftKey: boolean\n  altKey: boolean\n  metaKey: boolean\n  page: Point\n  client: Point\n  delta: Point\n  rect: FullRect\n  x0: number\n  y0: number\n  t0: number\n  dt: number\n  duration: number\n  clientX0: number\n  clientY0: number\n  velocity: Point\n  speed: number\n  swipe: ReturnType<InteractEvent<T>['getSwipe']>\n  // resize\n  axes?: 'x' | 'y' | 'xy'\n  /** @internal */\n  preEnd?: boolean\n\n  constructor(\n    interaction: Interaction<T>,\n    event: PointerEventType,\n    actionName: T,\n    phase: P,\n    element: Element,\n    preEnd?: boolean,\n    type?: string,\n  ) {\n    super(interaction)\n\n    element = element || interaction.element\n\n    const target = interaction.interactable\n    const deltaSource = (((target && target.options) || defaults) as any).deltaSource as 'page' | 'client'\n    const origin = getOriginXY(target, element, actionName)\n    const starting = phase === 'start'\n    const ending = phase === 'end'\n    const prevEvent = starting ? this : interaction.prevEvent\n    const coords = starting\n      ? interaction.coords.start\n      : ending\n        ? { page: prevEvent.page, client: prevEvent.client, timeStamp: interaction.coords.cur.timeStamp }\n        : interaction.coords.cur\n\n    this.page = extend({}, coords.page)\n    this.client = extend({}, coords.client)\n    this.rect = extend({}, interaction.rect)\n    this.timeStamp = coords.timeStamp\n\n    if (!ending) {\n      this.page.x -= origin.x\n      this.page.y -= origin.y\n\n      this.client.x -= origin.x\n      this.client.y -= origin.y\n    }\n\n    this.ctrlKey = event.ctrlKey\n    this.altKey = event.altKey\n    this.shiftKey = event.shiftKey\n    this.metaKey = event.metaKey\n    this.button = (event as MouseEvent).button\n    this.buttons = (event as MouseEvent).buttons\n    this.target = element\n    this.currentTarget = element\n    this.preEnd = preEnd\n    this.type = type || actionName + (phase || '')\n    this.interactable = target\n\n    this.t0 = starting ? interaction.pointers[interaction.pointers.length - 1].downTime : prevEvent.t0\n\n    this.x0 = interaction.coords.start.page.x - origin.x\n    this.y0 = interaction.coords.start.page.y - origin.y\n    this.clientX0 = interaction.coords.start.client.x - origin.x\n    this.clientY0 = interaction.coords.start.client.y - origin.y\n\n    if (starting || ending) {\n      this.delta = { x: 0, y: 0 }\n    } else {\n      this.delta = {\n        x: this[deltaSource].x - prevEvent[deltaSource].x,\n        y: this[deltaSource].y - prevEvent[deltaSource].y,\n      }\n    }\n\n    this.dt = interaction.coords.delta.timeStamp\n    this.duration = this.timeStamp - this.t0\n\n    // velocity and speed in pixels per second\n    this.velocity = extend({}, interaction.coords.velocity[deltaSource])\n    this.speed = hypot(this.velocity.x, this.velocity.y)\n\n    this.swipe = ending || phase === 'inertiastart' ? this.getSwipe() : null\n  }\n\n  getSwipe() {\n    const interaction = this._interaction\n\n    if (interaction.prevEvent.speed < 600 || this.timeStamp - interaction.prevEvent.timeStamp > 150) {\n      return null\n    }\n\n    let angle = (180 * Math.atan2(interaction.prevEvent.velocityY, interaction.prevEvent.velocityX)) / Math.PI\n    const overlap = 22.5\n\n    if (angle < 0) {\n      angle += 360\n    }\n\n    const left = 135 - overlap <= angle && angle < 225 + overlap\n    const up = 225 - overlap <= angle && angle < 315 + overlap\n\n    const right = !left && (315 - overlap <= angle || angle < 45 + overlap)\n    const down = !up && 45 - overlap <= angle && angle < 135 + overlap\n\n    return {\n      up,\n      down,\n      left,\n      right,\n      angle,\n      speed: interaction.prevEvent.speed,\n      velocity: {\n        x: interaction.prevEvent.velocityX,\n        y: interaction.prevEvent.velocityY,\n      },\n    }\n  }\n\n  preventDefault() {}\n\n  /**\n   * Don't call listeners on the remaining targets\n   */\n  stopImmediatePropagation() {\n    this.immediatePropagationStopped = this.propagationStopped = true\n  }\n\n  /**\n   * Don't call any other listeners (even on the current target)\n   */\n  stopPropagation() {\n    this.propagationStopped = true\n  }\n}\n\n// getters and setters defined here to support typescript 3.6 and below which\n// don't support getter and setters in .d.ts files\nObject.defineProperties(InteractEvent.prototype, {\n  pageX: {\n    get() {\n      return this.page.x\n    },\n    set(value) {\n      this.page.x = value\n    },\n  },\n  pageY: {\n    get() {\n      return this.page.y\n    },\n    set(value) {\n      this.page.y = value\n    },\n  },\n\n  clientX: {\n    get() {\n      return this.client.x\n    },\n    set(value) {\n      this.client.x = value\n    },\n  },\n  clientY: {\n    get() {\n      return this.client.y\n    },\n    set(value) {\n      this.client.y = value\n    },\n  },\n\n  dx: {\n    get() {\n      return this.delta.x\n    },\n    set(value) {\n      this.delta.x = value\n    },\n  },\n  dy: {\n    get() {\n      return this.delta.y\n    },\n    set(value) {\n      this.delta.y = value\n    },\n  },\n\n  velocityX: {\n    get() {\n      return this.velocity.x\n    },\n    set(value) {\n      this.velocity.x = value\n    },\n  },\n  velocityY: {\n    get() {\n      return this.velocity.y\n    },\n    set(value) {\n      this.velocity.y = value\n    },\n  },\n})\n", "import type { PointerEventType, PointerType } from '@interactjs/core/types'\n\nexport class PointerInfo {\n  id: number\n  pointer: PointerType\n  event: PointerEventType\n  downTime: number\n  downTarget: Node\n\n  constructor(id: number, pointer: PointerType, event: PointerEventType, downTime: number, downTarget: Node) {\n    this.id = id\n    this.pointer = pointer\n    this.event = event\n    this.downTime = downTime\n    this.downTarget = downTarget\n  }\n}\n", "import * as arr from '@interactjs/utils/arr'\nimport extend from '@interactjs/utils/extend'\nimport hypot from '@interactjs/utils/hypot'\nimport { warnOnce, copyAction } from '@interactjs/utils/misc'\nimport * as pointerUtils from '@interactjs/utils/pointerUtils'\nimport * as rectUtils from '@interactjs/utils/rect'\n\nimport type {\n  Element,\n  EdgeOptions,\n  PointerEventType,\n  PointerType,\n  FullRect,\n  CoordsSet,\n  ActionName,\n  ActionProps,\n} from '@interactjs/core/types'\n\nimport type { Interactable } from './Interactable'\nimport type { EventPhase } from './InteractEvent'\nimport { InteractEvent } from './InteractEvent'\nimport type { ActionDefaults } from './options'\nimport { PointerInfo } from './PointerInfo'\nimport type { Scope } from './scope'\n\nexport enum _ProxyValues {\n  interactable = '',\n  element = '',\n  prepared = '',\n  pointerIsDown = '',\n  pointerWasMoved = '',\n  _proxy = '',\n}\n\nexport enum _ProxyMethods {\n  start = '',\n  move = '',\n  end = '',\n  stop = '',\n  interacting = '',\n}\n\nexport type PointerArgProps<T extends {} = {}> = {\n  pointer: PointerType\n  event: PointerEventType\n  eventTarget: Node\n  pointerIndex: number\n  pointerInfo: PointerInfo\n  interaction: Interaction<never>\n} & T\n\nexport interface DoPhaseArg<T extends ActionName, P extends EventPhase> {\n  event: PointerEventType\n  phase: EventPhase\n  interaction: Interaction<T>\n  iEvent: InteractEvent<T, P>\n  preEnd?: boolean\n  type?: string\n}\n\nexport type DoAnyPhaseArg = DoPhaseArg<ActionName, EventPhase>\n\ndeclare module '@interactjs/core/scope' {\n  interface SignalArgs {\n    'interactions:new': { interaction: Interaction<ActionName> }\n    'interactions:down': PointerArgProps<{\n      type: 'down'\n    }>\n    'interactions:move': PointerArgProps<{\n      type: 'move'\n      dx: number\n      dy: number\n      duplicate: boolean\n    }>\n    'interactions:up': PointerArgProps<{\n      type: 'up'\n      curEventTarget: EventTarget\n    }>\n    'interactions:cancel': SignalArgs['interactions:up'] & {\n      type: 'cancel'\n      curEventTarget: EventTarget\n    }\n    'interactions:update-pointer': PointerArgProps<{\n      down: boolean\n    }>\n    'interactions:remove-pointer': PointerArgProps\n    'interactions:blur': { interaction: Interaction<never>; event: Event; type: 'blur' }\n    'interactions:before-action-start': Omit<DoAnyPhaseArg, 'iEvent'>\n    'interactions:action-start': DoAnyPhaseArg\n    'interactions:after-action-start': DoAnyPhaseArg\n    'interactions:before-action-move': Omit<DoAnyPhaseArg, 'iEvent'>\n    'interactions:action-move': DoAnyPhaseArg\n    'interactions:after-action-move': DoAnyPhaseArg\n    'interactions:before-action-end': Omit<DoAnyPhaseArg, 'iEvent'>\n    'interactions:action-end': DoAnyPhaseArg\n    'interactions:after-action-end': DoAnyPhaseArg\n    'interactions:stop': { interaction: Interaction }\n  }\n}\n\nexport type InteractionProxy<T extends ActionName | null = never> = Pick<\n  Interaction<T>,\n  Exclude<keyof typeof _ProxyValues | keyof typeof _ProxyMethods, '_proxy'>\n>\n\nlet idCounter = 0\n\nexport class Interaction<T extends ActionName | null = ActionName> {\n  /** current interactable being interacted with */\n  interactable: Interactable | null = null\n\n  /** the target element of the interactable */\n  element: Element | null = null\n  rect: FullRect | null = null\n  /** @internal */\n  _rects?: {\n    start: FullRect\n    corrected: FullRect\n    previous: FullRect\n    delta: FullRect\n  }\n  /** @internal */\n  edges: EdgeOptions | null = null\n\n  /** @internal */\n  _scopeFire: Scope['fire']\n\n  // action that's ready to be fired on next move event\n  prepared: ActionProps<T> = {\n    name: null,\n    axis: null,\n    edges: null,\n  }\n\n  pointerType: string\n\n  /** @internal keep track of added pointers */\n  pointers: PointerInfo[] = []\n\n  /** @internal pointerdown/mousedown/touchstart event */\n  downEvent: PointerEventType | null = null\n\n  /** @internal */ downPointer: PointerType = {} as PointerType\n\n  /** @internal */\n  _latestPointer: {\n    pointer: PointerType\n    event: PointerEventType\n    eventTarget: Node\n  } = {\n    pointer: null,\n    event: null,\n    eventTarget: null,\n  }\n\n  /** @internal */ prevEvent: InteractEvent<T, EventPhase> = null\n\n  pointerIsDown = false\n  pointerWasMoved = false\n  /** @internal */ _interacting = false\n  /** @internal */ _ending = false\n  /** @internal */ _stopped = true\n  /** @internal */ _proxy: InteractionProxy<T>\n\n  /** @internal */ simulation = null\n\n  /** @internal */ get pointerMoveTolerance() {\n    return 1\n  }\n\n  doMove = warnOnce(function (this: Interaction, signalArg: any) {\n    this.move(signalArg)\n  }, 'The interaction.doMove() method has been renamed to interaction.move()')\n\n  coords: CoordsSet = {\n    // Starting InteractEvent pointer coordinates\n    start: pointerUtils.newCoords(),\n    // Previous native pointer move event coordinates\n    prev: pointerUtils.newCoords(),\n    // current native pointer move event coordinates\n    cur: pointerUtils.newCoords(),\n    // Change in coordinates and time of the pointer\n    delta: pointerUtils.newCoords(),\n    // pointer velocity\n    velocity: pointerUtils.newCoords(),\n  }\n\n  /** @internal */ readonly _id: number = idCounter++\n\n  constructor({ pointerType, scopeFire }: { pointerType?: string; scopeFire: Scope['fire'] }) {\n    this._scopeFire = scopeFire\n    this.pointerType = pointerType\n\n    const that = this\n\n    this._proxy = {} as InteractionProxy<T>\n\n    for (const key in _ProxyValues) {\n      Object.defineProperty(this._proxy, key, {\n        get() {\n          return that[key]\n        },\n      })\n    }\n\n    for (const key in _ProxyMethods) {\n      Object.defineProperty(this._proxy, key, {\n        value: (...args: any[]) => that[key](...args),\n      })\n    }\n\n    this._scopeFire('interactions:new', { interaction: this })\n  }\n\n  pointerDown(pointer: PointerType, event: PointerEventType, eventTarget: Node) {\n    const pointerIndex = this.updatePointer(pointer, event, eventTarget, true)\n    const pointerInfo = this.pointers[pointerIndex]\n\n    this._scopeFire('interactions:down', {\n      pointer,\n      event,\n      eventTarget,\n      pointerIndex,\n      pointerInfo,\n      type: 'down',\n      interaction: this as unknown as Interaction<never>,\n    })\n  }\n\n  /**\n   * ```js\n   * interact(target)\n   *   .draggable({\n   *     // disable the default drag start by down->move\n   *     manualStart: true\n   *   })\n   *   // start dragging after the user holds the pointer down\n   *   .on('hold', function (event) {\n   *     var interaction = event.interaction\n   *\n   *     if (!interaction.interacting()) {\n   *       interaction.start({ name: 'drag' },\n   *                         event.interactable,\n   *                         event.currentTarget)\n   *     }\n   * })\n   * ```\n   *\n   * Start an action with the given Interactable and Element as tartgets. The\n   * action must be enabled for the target Interactable and an appropriate\n   * number of pointers must be held down - 1 for drag/resize, 2 for gesture.\n   *\n   * Use it with `interactable.<action>able({ manualStart: false })` to always\n   * [start actions manually](https://github.com/taye/interact.js/issues/114)\n   *\n   * @param action - The action to be performed - drag, resize, etc.\n   * @param target - The Interactable to target\n   * @param element - The DOM Element to target\n   * @returns Whether the interaction was successfully started\n   */\n  start<A extends ActionName>(action: ActionProps<A>, interactable: Interactable, element: Element): boolean {\n    if (\n      this.interacting() ||\n      !this.pointerIsDown ||\n      this.pointers.length < (action.name === 'gesture' ? 2 : 1) ||\n      !interactable.options[action.name as keyof ActionDefaults].enabled\n    ) {\n      return false\n    }\n\n    copyAction(this.prepared, action)\n\n    this.interactable = interactable\n    this.element = element\n    this.rect = interactable.getRect(element)\n    this.edges = this.prepared.edges\n      ? extend({}, this.prepared.edges)\n      : { left: true, right: true, top: true, bottom: true }\n    this._stopped = false\n    this._interacting =\n      this._doPhase({\n        interaction: this,\n        event: this.downEvent,\n        phase: 'start',\n      }) && !this._stopped\n\n    return this._interacting\n  }\n\n  pointerMove(pointer: PointerType, event: PointerEventType, eventTarget: Node) {\n    if (!this.simulation && !(this.modification && this.modification.endResult)) {\n      this.updatePointer(pointer, event, eventTarget, false)\n    }\n\n    const duplicateMove =\n      this.coords.cur.page.x === this.coords.prev.page.x &&\n      this.coords.cur.page.y === this.coords.prev.page.y &&\n      this.coords.cur.client.x === this.coords.prev.client.x &&\n      this.coords.cur.client.y === this.coords.prev.client.y\n\n    let dx: number\n    let dy: number\n\n    // register movement greater than pointerMoveTolerance\n    if (this.pointerIsDown && !this.pointerWasMoved) {\n      dx = this.coords.cur.client.x - this.coords.start.client.x\n      dy = this.coords.cur.client.y - this.coords.start.client.y\n\n      this.pointerWasMoved = hypot(dx, dy) > this.pointerMoveTolerance\n    }\n\n    const pointerIndex = this.getPointerIndex(pointer)\n    const signalArg = {\n      pointer,\n      pointerIndex,\n      pointerInfo: this.pointers[pointerIndex],\n      event,\n      type: 'move' as const,\n      eventTarget,\n      dx,\n      dy,\n      duplicate: duplicateMove,\n      interaction: this as unknown as Interaction<never>,\n    }\n\n    if (!duplicateMove) {\n      // set pointer coordinate, time changes and velocity\n      pointerUtils.setCoordVelocity(this.coords.velocity, this.coords.delta)\n    }\n\n    this._scopeFire('interactions:move', signalArg)\n\n    if (!duplicateMove && !this.simulation) {\n      // if interacting, fire an 'action-move' signal etc\n      if (this.interacting()) {\n        signalArg.type = null\n        this.move(signalArg)\n      }\n\n      if (this.pointerWasMoved) {\n        pointerUtils.copyCoords(this.coords.prev, this.coords.cur)\n      }\n    }\n  }\n\n  /**\n   * ```js\n   * interact(target)\n   *   .draggable(true)\n   *   .on('dragmove', function (event) {\n   *     if (someCondition) {\n   *       // change the snap settings\n   *       event.interactable.draggable({ snap: { targets: [] }})\n   *       // fire another move event with re-calculated snap\n   *       event.interaction.move()\n   *     }\n   *   })\n   * ```\n   *\n   * Force a move of the current action at the same coordinates. Useful if\n   * snap/restrict has been changed and you want a movement with the new\n   * settings.\n   */\n  move(signalArg?: any) {\n    if (!signalArg || !signalArg.event) {\n      pointerUtils.setZeroCoords(this.coords.delta)\n    }\n\n    signalArg = extend(\n      {\n        pointer: this._latestPointer.pointer,\n        event: this._latestPointer.event,\n        eventTarget: this._latestPointer.eventTarget,\n        interaction: this,\n      },\n      signalArg || {},\n    )\n\n    signalArg.phase = 'move'\n\n    this._doPhase(signalArg)\n  }\n\n  /**\n   * @internal\n   * End interact move events and stop auto-scroll unless simulation is running\n   */\n  pointerUp(pointer: PointerType, event: PointerEventType, eventTarget: Node, curEventTarget: EventTarget) {\n    let pointerIndex = this.getPointerIndex(pointer)\n\n    if (pointerIndex === -1) {\n      pointerIndex = this.updatePointer(pointer, event, eventTarget, false)\n    }\n\n    const type = /cancel$/i.test(event.type) ? 'cancel' : 'up'\n\n    this._scopeFire(`interactions:${type}` as 'interactions:up' | 'interactions:cancel', {\n      pointer,\n      pointerIndex,\n      pointerInfo: this.pointers[pointerIndex],\n      event,\n      eventTarget,\n      type: type as any,\n      curEventTarget,\n      interaction: this as unknown as Interaction<never>,\n    })\n\n    if (!this.simulation) {\n      this.end(event)\n    }\n\n    this.removePointer(pointer, event)\n  }\n\n  /** @internal */\n  documentBlur(event: Event) {\n    this.end(event as any)\n    this._scopeFire('interactions:blur', {\n      event,\n      type: 'blur',\n      interaction: this as unknown as Interaction<never>,\n    })\n  }\n\n  /**\n   * ```js\n   * interact(target)\n   *   .draggable(true)\n   *   .on('move', function (event) {\n   *     if (event.pageX > 1000) {\n   *       // end the current action\n   *       event.interaction.end()\n   *       // stop all further listeners from being called\n   *       event.stopImmediatePropagation()\n   *     }\n   *   })\n   * ```\n   */\n  end(event?: PointerEventType) {\n    this._ending = true\n    event = event || this._latestPointer.event\n    let endPhaseResult: boolean\n\n    if (this.interacting()) {\n      endPhaseResult = this._doPhase({\n        event,\n        interaction: this,\n        phase: 'end',\n      })\n    }\n\n    this._ending = false\n\n    if (endPhaseResult === true) {\n      this.stop()\n    }\n  }\n\n  currentAction() {\n    return this._interacting ? this.prepared.name : null\n  }\n\n  interacting() {\n    return this._interacting\n  }\n\n  stop() {\n    this._scopeFire('interactions:stop', { interaction: this })\n\n    this.interactable = this.element = null\n\n    this._interacting = false\n    this._stopped = true\n    this.prepared.name = this.prevEvent = null\n  }\n\n  /** @internal */\n  getPointerIndex(pointer: any) {\n    const pointerId = pointerUtils.getPointerId(pointer)\n\n    // mouse and pen interactions may have only one pointer\n    return this.pointerType === 'mouse' || this.pointerType === 'pen'\n      ? this.pointers.length - 1\n      : arr.findIndex(this.pointers, (curPointer) => curPointer.id === pointerId)\n  }\n\n  /** @internal */\n  getPointerInfo(pointer: any) {\n    return this.pointers[this.getPointerIndex(pointer)]\n  }\n\n  /** @internal */\n  updatePointer(pointer: PointerType, event: PointerEventType, eventTarget: Node, down?: boolean) {\n    const id = pointerUtils.getPointerId(pointer)\n    let pointerIndex = this.getPointerIndex(pointer)\n    let pointerInfo = this.pointers[pointerIndex]\n\n    down = down === false ? false : down || /(down|start)$/i.test(event.type)\n\n    if (!pointerInfo) {\n      pointerInfo = new PointerInfo(id, pointer, event, null, null)\n\n      pointerIndex = this.pointers.length\n      this.pointers.push(pointerInfo)\n    } else {\n      pointerInfo.pointer = pointer\n    }\n\n    pointerUtils.setCoords(\n      this.coords.cur,\n      this.pointers.map((p) => p.pointer),\n      this._now(),\n    )\n    pointerUtils.setCoordDeltas(this.coords.delta, this.coords.prev, this.coords.cur)\n\n    if (down) {\n      this.pointerIsDown = true\n\n      pointerInfo.downTime = this.coords.cur.timeStamp\n      pointerInfo.downTarget = eventTarget\n      pointerUtils.pointerExtend(this.downPointer, pointer)\n\n      if (!this.interacting()) {\n        pointerUtils.copyCoords(this.coords.start, this.coords.cur)\n        pointerUtils.copyCoords(this.coords.prev, this.coords.cur)\n\n        this.downEvent = event\n        this.pointerWasMoved = false\n      }\n    }\n\n    this._updateLatestPointer(pointer, event, eventTarget)\n\n    this._scopeFire('interactions:update-pointer', {\n      pointer,\n      event,\n      eventTarget,\n      down,\n      pointerInfo,\n      pointerIndex,\n      interaction: this as unknown as Interaction<never>,\n    })\n\n    return pointerIndex\n  }\n\n  /** @internal */\n  removePointer(pointer: PointerType, event: PointerEventType) {\n    const pointerIndex = this.getPointerIndex(pointer)\n\n    if (pointerIndex === -1) return\n\n    const pointerInfo = this.pointers[pointerIndex]\n\n    this._scopeFire('interactions:remove-pointer', {\n      pointer,\n      event,\n      eventTarget: null,\n      pointerIndex,\n      pointerInfo,\n      interaction: this as unknown as Interaction<never>,\n    })\n\n    this.pointers.splice(pointerIndex, 1)\n    this.pointerIsDown = false\n  }\n\n  /** @internal */\n  _updateLatestPointer(pointer: PointerType, event: PointerEventType, eventTarget: Node) {\n    this._latestPointer.pointer = pointer\n    this._latestPointer.event = event\n    this._latestPointer.eventTarget = eventTarget\n  }\n\n  destroy() {\n    this._latestPointer.pointer = null\n    this._latestPointer.event = null\n    this._latestPointer.eventTarget = null\n  }\n\n  /** @internal */\n  _createPreparedEvent<P extends EventPhase>(\n    event: PointerEventType,\n    phase: P,\n    preEnd?: boolean,\n    type?: string,\n  ) {\n    return new InteractEvent<T, P>(this, event, this.prepared.name, phase, this.element, preEnd, type)\n  }\n\n  /** @internal */\n  _fireEvent<P extends EventPhase>(iEvent: InteractEvent<T, P>) {\n    this.interactable?.fire(iEvent)\n\n    if (!this.prevEvent || iEvent.timeStamp >= this.prevEvent.timeStamp) {\n      this.prevEvent = iEvent\n    }\n  }\n\n  /** @internal */\n  _doPhase<P extends EventPhase>(\n    signalArg: Omit<DoPhaseArg<T, P>, 'iEvent'> & { iEvent?: InteractEvent<T, P> },\n  ) {\n    const { event, phase, preEnd, type } = signalArg\n    const { rect } = this\n\n    if (rect && phase === 'move') {\n      // update the rect changes due to pointer move\n      rectUtils.addEdges(this.edges, rect, this.coords.delta[this.interactable.options.deltaSource])\n\n      rect.width = rect.right - rect.left\n      rect.height = rect.bottom - rect.top\n    }\n\n    const beforeResult = this._scopeFire(`interactions:before-action-${phase}` as any, signalArg)\n\n    if (beforeResult === false) {\n      return false\n    }\n\n    const iEvent = (signalArg.iEvent = this._createPreparedEvent(event, phase, preEnd, type))\n\n    this._scopeFire(`interactions:action-${phase}` as any, signalArg)\n\n    if (phase === 'start') {\n      this.prevEvent = iEvent\n    }\n\n    this._fireEvent(iEvent)\n\n    this._scopeFire(`interactions:after-action-${phase}` as any, signalArg)\n\n    return true\n  }\n\n  /** @internal */\n  _now() {\n    return Date.now()\n  }\n}\n\nexport default Interaction\nexport { PointerInfo }\n", "import type Interaction from '@interactjs/core/Interaction'\nimport { _ProxyMethods } from '@interactjs/core/Interaction'\nimport type { Plugin } from '@interactjs/core/scope'\nimport type { Point } from '@interactjs/core/types'\nimport * as rectUtils from '@interactjs/utils/rect'\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction {\n    offsetBy?: typeof offsetBy\n    offset: {\n      total: Point\n      pending: Point\n    }\n  }\n\n  enum _ProxyMethods {\n    offsetBy = '',\n  }\n}\n\n;(_ProxyMethods as any).offsetBy = ''\n\nexport function addTotal(interaction: Interaction) {\n  if (!interaction.pointerIsDown) {\n    return\n  }\n\n  addToCoords(interaction.coords.cur, interaction.offset.total)\n\n  interaction.offset.pending.x = 0\n  interaction.offset.pending.y = 0\n}\n\nfunction beforeAction({ interaction }: { interaction: Interaction }) {\n  applyPending(interaction)\n}\n\nfunction beforeEnd({ interaction }: { interaction: Interaction }): boolean | void {\n  const hadPending = applyPending(interaction)\n\n  if (!hadPending) return\n\n  interaction.move({ offset: true })\n  interaction.end()\n\n  return false\n}\n\nfunction end({ interaction }: { interaction: Interaction }) {\n  interaction.offset.total.x = 0\n  interaction.offset.total.y = 0\n  interaction.offset.pending.x = 0\n  interaction.offset.pending.y = 0\n}\n\nexport function applyPending(interaction: Interaction) {\n  if (!hasPending(interaction)) {\n    return false\n  }\n\n  const { pending } = interaction.offset\n\n  addToCoords(interaction.coords.cur, pending)\n  addToCoords(interaction.coords.delta, pending)\n  rectUtils.addEdges(interaction.edges, interaction.rect, pending)\n\n  pending.x = 0\n  pending.y = 0\n\n  return true\n}\n\nfunction offsetBy(this: Interaction, { x, y }: Point) {\n  this.offset.pending.x += x\n  this.offset.pending.y += y\n\n  this.offset.total.x += x\n  this.offset.total.y += y\n}\n\nfunction addToCoords({ page, client }, { x, y }: Point) {\n  page.x += x\n  page.y += y\n  client.x += x\n  client.y += y\n}\n\nfunction hasPending(interaction: Interaction) {\n  return !!(interaction.offset.pending.x || interaction.offset.pending.y)\n}\n\nconst offset: Plugin = {\n  id: 'offset',\n  before: ['modifiers', 'pointer-events', 'actions', 'inertia'],\n  install(scope) {\n    scope.Interaction.prototype.offsetBy = offsetBy\n  },\n  listeners: {\n    'interactions:new': ({ interaction }) => {\n      interaction.offset = {\n        total: { x: 0, y: 0 },\n        pending: { x: 0, y: 0 },\n      }\n    },\n    'interactions:update-pointer': ({ interaction }) => addTotal(interaction),\n    'interactions:before-action-start': beforeAction,\n    'interactions:before-action-move': beforeAction,\n    'interactions:before-action-end': beforeEnd,\n    'interactions:stop': end,\n  },\n}\n\nexport default offset\n", "import type { Interaction, DoPhaseArg } from '@interactjs/core/Interaction'\nimport type { Scope, SignalArgs, Plugin } from '@interactjs/core/scope'\nimport type { ActionName, Point, PointerEventType } from '@interactjs/core/types'\n/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport '@interactjs/modifiers/base'\nimport '@interactjs/offset/plugin'\nimport * as modifiers from '@interactjs/modifiers/base'\nimport { Modification } from '@interactjs/modifiers/Modification'\nimport type { ModifierArg } from '@interactjs/modifiers/types'\nimport offset from '@interactjs/offset/plugin'\n/* eslint-enable import/no-duplicates */\nimport * as dom from '@interactjs/utils/domUtils'\nimport hypot from '@interactjs/utils/hypot'\nimport is from '@interactjs/utils/is'\nimport { copyCoords } from '@interactjs/utils/pointerUtils'\nimport raf from '@interactjs/utils/raf'\n\ndeclare module '@interactjs/core/InteractEvent' {\n  interface PhaseMap {\n    resume?: true\n    inertiastart?: true\n  }\n}\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction {\n    inertia?: InertiaState\n  }\n}\n\ndeclare module '@interactjs/core/options' {\n  interface PerActionDefaults {\n    inertia?: {\n      enabled?: boolean\n      resistance?: number // the lambda in exponential decay\n      minSpeed?: number // target speed must be above this for inertia to start\n      endSpeed?: number // the speed at which inertia is slow enough to stop\n      allowResume?: true // allow resuming an action in inertia phase\n      smoothEndDuration?: number // animate to snap/restrict endOnly if there's no inertia\n    }\n  }\n}\n\ndeclare module '@interactjs/core/scope' {\n  interface SignalArgs {\n    'interactions:before-action-inertiastart': Omit<DoPhaseArg<ActionName, 'inertiastart'>, 'iEvent'>\n    'interactions:action-inertiastart': DoPhaseArg<ActionName, 'inertiastart'>\n    'interactions:after-action-inertiastart': DoPhaseArg<ActionName, 'inertiastart'>\n    'interactions:before-action-resume': Omit<DoPhaseArg<ActionName, 'resume'>, 'iEvent'>\n    'interactions:action-resume': DoPhaseArg<ActionName, 'resume'>\n    'interactions:after-action-resume': DoPhaseArg<ActionName, 'resume'>\n  }\n}\n\nfunction install(scope: Scope) {\n  const { defaults } = scope\n\n  scope.usePlugin(offset)\n  scope.usePlugin(modifiers.default)\n  scope.actions.phases.inertiastart = true\n  scope.actions.phases.resume = true\n\n  defaults.perAction.inertia = {\n    enabled: false,\n    resistance: 10, // the lambda in exponential decay\n    minSpeed: 100, // target speed must be above this for inertia to start\n    endSpeed: 10, // the speed at which inertia is slow enough to stop\n    allowResume: true, // allow resuming an action in inertia phase\n    smoothEndDuration: 300, // animate to snap/restrict endOnly if there's no inertia\n  }\n}\n\nexport class InertiaState {\n  active = false\n  isModified = false\n  smoothEnd = false\n  allowResume = false\n\n  modification!: Modification\n  modifierCount = 0\n  modifierArg!: ModifierArg\n\n  startCoords!: Point\n  t0 = 0\n  v0 = 0\n\n  te = 0\n  targetOffset!: Point\n  modifiedOffset!: Point\n  currentOffset!: Point\n\n  lambda_v0? = 0 // eslint-disable-line camelcase\n  one_ve_v0? = 0 // eslint-disable-line camelcase\n  timeout!: number\n  readonly interaction: Interaction\n\n  constructor(interaction: Interaction) {\n    this.interaction = interaction\n  }\n\n  start(event: PointerEventType) {\n    const { interaction } = this\n    const options = getOptions(interaction)\n\n    if (!options || !options.enabled) {\n      return false\n    }\n\n    const { client: velocityClient } = interaction.coords.velocity\n    const pointerSpeed = hypot(velocityClient.x, velocityClient.y)\n    const modification = this.modification || (this.modification = new Modification(interaction))\n\n    modification.copyFrom(interaction.modification)\n\n    this.t0 = interaction._now()\n    this.allowResume = options.allowResume\n    this.v0 = pointerSpeed\n    this.currentOffset = { x: 0, y: 0 }\n    this.startCoords = interaction.coords.cur.page\n\n    this.modifierArg = modification.fillArg({\n      pageCoords: this.startCoords,\n      preEnd: true,\n      phase: 'inertiastart',\n    })\n\n    const thrown =\n      this.t0 - interaction.coords.cur.timeStamp < 50 &&\n      pointerSpeed > options.minSpeed &&\n      pointerSpeed > options.endSpeed\n\n    if (thrown) {\n      this.startInertia()\n    } else {\n      modification.result = modification.setAll(this.modifierArg)\n\n      if (!modification.result.changed) {\n        return false\n      }\n\n      this.startSmoothEnd()\n    }\n\n    // force modification change\n    interaction.modification.result.rect = null\n\n    // bring inertiastart event to the target coords\n    interaction.offsetBy(this.targetOffset)\n    interaction._doPhase({\n      interaction,\n      event,\n      phase: 'inertiastart',\n    })\n    interaction.offsetBy({ x: -this.targetOffset.x, y: -this.targetOffset.y })\n    // force modification change\n    interaction.modification.result.rect = null\n\n    this.active = true\n    interaction.simulation = this\n\n    return true\n  }\n\n  startInertia() {\n    const startVelocity = this.interaction.coords.velocity.client\n    const options = getOptions(this.interaction)\n    const lambda = options.resistance\n    const inertiaDur = -Math.log(options.endSpeed / this.v0) / lambda\n\n    this.targetOffset = {\n      x: (startVelocity.x - inertiaDur) / lambda,\n      y: (startVelocity.y - inertiaDur) / lambda,\n    }\n\n    this.te = inertiaDur\n    this.lambda_v0 = lambda / this.v0\n    this.one_ve_v0 = 1 - options.endSpeed / this.v0\n\n    const { modification, modifierArg } = this\n\n    modifierArg.pageCoords = {\n      x: this.startCoords.x + this.targetOffset.x,\n      y: this.startCoords.y + this.targetOffset.y,\n    }\n\n    modification.result = modification.setAll(modifierArg)\n\n    if (modification.result.changed) {\n      this.isModified = true\n      this.modifiedOffset = {\n        x: this.targetOffset.x + modification.result.delta.x,\n        y: this.targetOffset.y + modification.result.delta.y,\n      }\n    }\n\n    this.onNextFrame(() => this.inertiaTick())\n  }\n\n  startSmoothEnd() {\n    this.smoothEnd = true\n    this.isModified = true\n    this.targetOffset = {\n      x: this.modification.result.delta.x,\n      y: this.modification.result.delta.y,\n    }\n\n    this.onNextFrame(() => this.smoothEndTick())\n  }\n\n  onNextFrame(tickFn: () => void) {\n    this.timeout = raf.request(() => {\n      if (this.active) {\n        tickFn()\n      }\n    })\n  }\n\n  inertiaTick() {\n    const { interaction } = this\n    const options = getOptions(interaction)\n    const lambda = options.resistance\n    const t = (interaction._now() - this.t0) / 1000\n\n    if (t < this.te) {\n      const progress = 1 - (Math.exp(-lambda * t) - this.lambda_v0) / this.one_ve_v0\n      let newOffset: Point\n\n      if (this.isModified) {\n        newOffset = getQuadraticCurvePoint(\n          0,\n          0,\n          this.targetOffset.x,\n          this.targetOffset.y,\n          this.modifiedOffset.x,\n          this.modifiedOffset.y,\n          progress,\n        )\n      } else {\n        newOffset = {\n          x: this.targetOffset.x * progress,\n          y: this.targetOffset.y * progress,\n        }\n      }\n\n      const delta = { x: newOffset.x - this.currentOffset.x, y: newOffset.y - this.currentOffset.y }\n\n      this.currentOffset.x += delta.x\n      this.currentOffset.y += delta.y\n\n      interaction.offsetBy(delta)\n      interaction.move()\n\n      this.onNextFrame(() => this.inertiaTick())\n    } else {\n      interaction.offsetBy({\n        x: this.modifiedOffset.x - this.currentOffset.x,\n        y: this.modifiedOffset.y - this.currentOffset.y,\n      })\n\n      this.end()\n    }\n  }\n\n  smoothEndTick() {\n    const { interaction } = this\n    const t = interaction._now() - this.t0\n    const { smoothEndDuration: duration } = getOptions(interaction)\n\n    if (t < duration) {\n      const newOffset = {\n        x: easeOutQuad(t, 0, this.targetOffset.x, duration),\n        y: easeOutQuad(t, 0, this.targetOffset.y, duration),\n      }\n      const delta = {\n        x: newOffset.x - this.currentOffset.x,\n        y: newOffset.y - this.currentOffset.y,\n      }\n\n      this.currentOffset.x += delta.x\n      this.currentOffset.y += delta.y\n\n      interaction.offsetBy(delta)\n      interaction.move({ skipModifiers: this.modifierCount })\n\n      this.onNextFrame(() => this.smoothEndTick())\n    } else {\n      interaction.offsetBy({\n        x: this.targetOffset.x - this.currentOffset.x,\n        y: this.targetOffset.y - this.currentOffset.y,\n      })\n\n      this.end()\n    }\n  }\n\n  resume({ pointer, event, eventTarget }: SignalArgs['interactions:down']) {\n    const { interaction } = this\n\n    // undo inertia changes to interaction coords\n    interaction.offsetBy({\n      x: -this.currentOffset.x,\n      y: -this.currentOffset.y,\n    })\n\n    // update pointer at pointer down position\n    interaction.updatePointer(pointer, event, eventTarget, true)\n\n    // fire resume signals and event\n    interaction._doPhase({\n      interaction,\n      event,\n      phase: 'resume',\n    })\n    copyCoords(interaction.coords.prev, interaction.coords.cur)\n\n    this.stop()\n  }\n\n  end() {\n    this.interaction.move()\n    this.interaction.end()\n    this.stop()\n  }\n\n  stop() {\n    this.active = this.smoothEnd = false\n    this.interaction.simulation = null\n    raf.cancel(this.timeout)\n  }\n}\n\nfunction start({ interaction, event }: DoPhaseArg<ActionName, 'end'>) {\n  if (!interaction._interacting || interaction.simulation) {\n    return null\n  }\n\n  const started = interaction.inertia.start(event)\n\n  // prevent action end if inertia or smoothEnd\n  return started ? false : null\n}\n\n// Check if the down event hits the current inertia target\n// control should be return to the user\nfunction resume(arg: SignalArgs['interactions:down']) {\n  const { interaction, eventTarget } = arg\n  const state = interaction.inertia\n\n  if (!state.active) return\n\n  let element = eventTarget as Node\n\n  // climb up the DOM tree from the event target\n  while (is.element(element)) {\n    // if interaction element is the current inertia target element\n    if (element === interaction.element) {\n      state.resume(arg)\n      break\n    }\n\n    element = dom.parentNode(element)\n  }\n}\n\nfunction stop({ interaction }: { interaction: Interaction }) {\n  const state = interaction.inertia\n\n  if (state.active) {\n    state.stop()\n  }\n}\n\nfunction getOptions({ interactable, prepared }: Interaction) {\n  return interactable && interactable.options && prepared.name && interactable.options[prepared.name].inertia\n}\n\nconst inertia: Plugin = {\n  id: 'inertia',\n  before: ['modifiers', 'actions'],\n  install,\n  listeners: {\n    'interactions:new': ({ interaction }) => {\n      interaction.inertia = new InertiaState(interaction)\n    },\n\n    'interactions:before-action-end': start,\n    'interactions:down': resume,\n    'interactions:stop': stop,\n\n    'interactions:before-action-resume': (arg) => {\n      const { modification } = arg.interaction\n\n      modification.stop(arg)\n      modification.start(arg, arg.interaction.coords.cur.page)\n      modification.applyToInteraction(arg)\n    },\n\n    'interactions:before-action-inertiastart': (arg) => arg.interaction.modification.setAndApply(arg),\n    'interactions:action-resume': modifiers.addEventModifiers,\n    'interactions:action-inertiastart': modifiers.addEventModifiers,\n    'interactions:after-action-inertiastart': (arg) =>\n      arg.interaction.modification.restoreInteractionCoords(arg),\n    'interactions:after-action-resume': (arg) => arg.interaction.modification.restoreInteractionCoords(arg),\n  },\n}\n\n// http://stackoverflow.com/a/5634528/2280888\nfunction _getQBezierValue(t: number, p1: number, p2: number, p3: number) {\n  const iT = 1 - t\n  return iT * iT * p1 + 2 * iT * t * p2 + t * t * p3\n}\n\nfunction getQuadraticCurvePoint(\n  startX: number,\n  startY: number,\n  cpX: number,\n  cpY: number,\n  endX: number,\n  endY: number,\n  position: number,\n) {\n  return {\n    x: _getQBezierValue(position, startX, cpX, endX),\n    y: _getQBezierValue(position, startY, cpY, endY),\n  }\n}\n\n// http://gizma.com/easing/\nfunction easeOutQuad(t: number, b: number, c: number, d: number) {\n  t /= d\n  return -c * t * (t - 2) + b\n}\n\nexport default inertia\n", "import * as arr from '@interactjs/utils/arr'\nimport extend from '@interactjs/utils/extend'\nimport type { NormalizedListeners } from '@interactjs/utils/normalizeListeners'\nimport normalize from '@interactjs/utils/normalizeListeners'\n\nimport type { Listener, ListenersArg, Rect } from '@interactjs/core/types'\n\nfunction fireUntilImmediateStopped(event: any, listeners: Listener[]) {\n  for (const listener of listeners) {\n    if (event.immediatePropagationStopped) {\n      break\n    }\n\n    listener(event)\n  }\n}\n\nexport class Eventable {\n  options: any\n  types: NormalizedListeners = {}\n  propagationStopped = false\n  immediatePropagationStopped = false\n  global: any\n\n  constructor(options?: { [index: string]: any }) {\n    this.options = extend({}, options || {})\n  }\n\n  fire<T extends { type: string; propagationStopped?: boolean }>(event: T) {\n    let listeners: Listener[]\n    const global = this.global\n\n    // Interactable#on() listeners\n    // tslint:disable no-conditional-assignment\n    if ((listeners = this.types[event.type])) {\n      fireUntilImmediateStopped(event, listeners)\n    }\n\n    // interact.on() listeners\n    if (!event.propagationStopped && global && (listeners = global[event.type])) {\n      fireUntilImmediateStopped(event, listeners)\n    }\n  }\n\n  on(type: string, listener: ListenersArg) {\n    const listeners = normalize(type, listener)\n\n    for (type in listeners) {\n      this.types[type] = arr.merge(this.types[type] || [], listeners[type])\n    }\n  }\n\n  off(type: string, listener: ListenersArg) {\n    const listeners = normalize(type, listener)\n\n    for (type in listeners) {\n      const eventList = this.types[type]\n\n      if (!eventList || !eventList.length) {\n        continue\n      }\n\n      for (const subListener of listeners[type]) {\n        const index = eventList.indexOf(subListener)\n\n        if (index !== -1) {\n          eventList.splice(index, 1)\n        }\n      }\n    }\n  }\n\n  getRect(_element: Element): Rect {\n    return null\n  }\n}\n", "import * as arr from '@interactjs/utils/arr'\nimport * as domUtils from '@interactjs/utils/domUtils'\nimport is from '@interactjs/utils/is'\nimport pExtend from '@interactjs/utils/pointerExtend'\nimport * as pointerUtils from '@interactjs/utils/pointerUtils'\n\nimport type { Scope } from '@interactjs/core/scope'\nimport type { Element } from '@interactjs/core/types'\n\nimport type { NativeEventTarget } from './NativeTypes'\n\ndeclare module '@interactjs/core/scope' {\n  interface Scope {\n    events: ReturnType<typeof install>\n  }\n}\n\ninterface EventOptions {\n  capture: boolean\n  passive: boolean\n}\n\ntype PartialEventTarget = Partial<NativeEventTarget>\n\ntype ListenerEntry = { func: (event: Event | FakeEvent) => any; options: EventOptions }\n\nfunction install(scope: Scope) {\n  const targets: Array<{\n    eventTarget: PartialEventTarget\n    events: { [type: string]: ListenerEntry[] }\n  }> = []\n\n  const delegatedEvents: {\n    [type: string]: Array<{\n      selector: string\n      context: Node\n      listeners: ListenerEntry[]\n    }>\n  } = {}\n  const documents: Document[] = []\n\n  const eventsMethods = {\n    add,\n    remove,\n\n    addDelegate,\n    removeDelegate,\n\n    delegateListener,\n    delegateUseCapture,\n    delegatedEvents,\n    documents,\n\n    targets,\n\n    supportsOptions: false,\n    supportsPassive: false,\n  }\n\n  // check if browser supports passive events and options arg\n  scope.document?.createElement('div').addEventListener('test', null, {\n    get capture() {\n      return (eventsMethods.supportsOptions = true)\n    },\n    get passive() {\n      return (eventsMethods.supportsPassive = true)\n    },\n  })\n\n  scope.events = eventsMethods\n\n  function add(\n    eventTarget: PartialEventTarget,\n    type: string,\n    listener: ListenerEntry['func'],\n    optionalArg?: boolean | EventOptions,\n  ) {\n    if (!eventTarget.addEventListener) return\n\n    const options = getOptions(optionalArg)\n    let target = arr.find(targets, (t) => t.eventTarget === eventTarget)\n\n    if (!target) {\n      target = {\n        eventTarget,\n        events: {},\n      }\n\n      targets.push(target)\n    }\n\n    if (!target.events[type]) {\n      target.events[type] = []\n    }\n\n    if (!arr.find(target.events[type], (l) => l.func === listener && optionsMatch(l.options, options))) {\n      eventTarget.addEventListener(\n        type,\n        listener as any,\n        eventsMethods.supportsOptions ? options : options.capture,\n      )\n      target.events[type].push({ func: listener, options })\n    }\n  }\n\n  function remove(\n    eventTarget: PartialEventTarget,\n    type: string,\n    listener?: 'all' | ListenerEntry['func'],\n    optionalArg?: boolean | EventOptions,\n  ) {\n    if (!eventTarget.addEventListener || !eventTarget.removeEventListener) return\n\n    const targetIndex = arr.findIndex(targets, (t) => t.eventTarget === eventTarget)\n    const target = targets[targetIndex]\n\n    if (!target || !target.events) {\n      return\n    }\n\n    if (type === 'all') {\n      for (type in target.events) {\n        if (target.events.hasOwnProperty(type)) {\n          remove(eventTarget, type, 'all')\n        }\n      }\n      return\n    }\n\n    let typeIsEmpty = false\n    const typeListeners = target.events[type]\n\n    if (typeListeners) {\n      if (listener === 'all') {\n        for (let i = typeListeners.length - 1; i >= 0; i--) {\n          const entry = typeListeners[i]\n          remove(eventTarget, type, entry.func, entry.options)\n        }\n        return\n      } else {\n        const options = getOptions(optionalArg)\n\n        for (let i = 0; i < typeListeners.length; i++) {\n          const entry = typeListeners[i]\n          if (entry.func === listener && optionsMatch(entry.options, options)) {\n            eventTarget.removeEventListener(\n              type,\n              listener as any,\n              eventsMethods.supportsOptions ? options : options.capture,\n            )\n            typeListeners.splice(i, 1)\n\n            if (typeListeners.length === 0) {\n              delete target.events[type]\n              typeIsEmpty = true\n            }\n\n            break\n          }\n        }\n      }\n    }\n\n    if (typeIsEmpty && !Object.keys(target.events).length) {\n      targets.splice(targetIndex, 1)\n    }\n  }\n\n  function addDelegate(\n    selector: string,\n    context: Node,\n    type: string,\n    listener: ListenerEntry['func'],\n    optionalArg?: any,\n  ) {\n    const options = getOptions(optionalArg)\n    if (!delegatedEvents[type]) {\n      delegatedEvents[type] = []\n\n      // add delegate listener functions\n      for (const doc of documents) {\n        add(doc, type, delegateListener)\n        add(doc, type, delegateUseCapture, true)\n      }\n    }\n\n    const delegates = delegatedEvents[type]\n    let delegate = arr.find(delegates, (d) => d.selector === selector && d.context === context)\n\n    if (!delegate) {\n      delegate = { selector, context, listeners: [] }\n      delegates.push(delegate)\n    }\n\n    delegate.listeners.push({ func: listener, options })\n  }\n\n  function removeDelegate(\n    selector: string,\n    context: Document | Element,\n    type: string,\n    listener?: ListenerEntry['func'],\n    optionalArg?: any,\n  ) {\n    const options = getOptions(optionalArg)\n    const delegates = delegatedEvents[type]\n    let matchFound = false\n    let index: number\n\n    if (!delegates) return\n\n    // count from last index of delegated to 0\n    for (index = delegates.length - 1; index >= 0; index--) {\n      const cur = delegates[index]\n      // look for matching selector and context Node\n      if (cur.selector === selector && cur.context === context) {\n        const { listeners } = cur\n\n        // each item of the listeners array is an array: [function, capture, passive]\n        for (let i = listeners.length - 1; i >= 0; i--) {\n          const entry = listeners[i]\n\n          // check if the listener functions and capture and passive flags match\n          if (entry.func === listener && optionsMatch(entry.options, options)) {\n            // remove the listener from the array of listeners\n            listeners.splice(i, 1)\n\n            // if all listeners for this target have been removed\n            // remove the target from the delegates array\n            if (!listeners.length) {\n              delegates.splice(index, 1)\n\n              // remove delegate function from context\n              remove(context, type, delegateListener)\n              remove(context, type, delegateUseCapture, true)\n            }\n\n            // only remove one listener\n            matchFound = true\n            break\n          }\n        }\n\n        if (matchFound) {\n          break\n        }\n      }\n    }\n  }\n\n  // bound to the interactable context when a DOM event\n  // listener is added to a selector interactable\n  function delegateListener(event: Event | FakeEvent, optionalArg?: any) {\n    const options = getOptions(optionalArg)\n    const fakeEvent = new FakeEvent(event as Event)\n    const delegates = delegatedEvents[event.type]\n    const [eventTarget] = pointerUtils.getEventTargets(event as Event)\n    let element: Node = eventTarget\n\n    // climb up document tree looking for selector matches\n    while (is.element(element)) {\n      for (let i = 0; i < delegates.length; i++) {\n        const cur = delegates[i]\n        const { selector, context } = cur\n\n        if (\n          domUtils.matchesSelector(element, selector) &&\n          domUtils.nodeContains(context, eventTarget) &&\n          domUtils.nodeContains(context, element)\n        ) {\n          const { listeners } = cur\n\n          fakeEvent.currentTarget = element\n\n          for (const entry of listeners) {\n            if (optionsMatch(entry.options, options)) {\n              entry.func(fakeEvent)\n            }\n          }\n        }\n      }\n\n      element = domUtils.parentNode(element)\n    }\n  }\n\n  function delegateUseCapture(this: Element, event: Event | FakeEvent) {\n    return delegateListener.call(this, event, true)\n  }\n\n  // for type inferrence\n  return eventsMethods\n}\n\nclass FakeEvent implements Partial<Event> {\n  currentTarget: Node\n  originalEvent: Event\n  type: string\n\n  constructor(originalEvent: Event) {\n    this.originalEvent = originalEvent\n    // duplicate the event so that currentTarget can be changed\n    pExtend(this, originalEvent)\n  }\n\n  preventOriginalDefault() {\n    this.originalEvent.preventDefault()\n  }\n\n  stopPropagation() {\n    this.originalEvent.stopPropagation()\n  }\n\n  stopImmediatePropagation() {\n    this.originalEvent.stopImmediatePropagation()\n  }\n}\n\nfunction getOptions(param: { [index: string]: any } | boolean): { capture: boolean; passive: boolean } {\n  if (!is.object(param)) {\n    return { capture: !!param, passive: false }\n  }\n\n  return {\n    capture: !!param.capture,\n    passive: !!param.passive,\n  }\n}\n\nfunction optionsMatch(a: Partial<EventOptions> | boolean, b: Partial<EventOptions>) {\n  if (a === b) return true\n\n  if (typeof a === 'boolean') return !!b.capture === a && !!b.passive === false\n\n  return !!a.capture === !!b.capture && !!a.passive === !!b.passive\n}\n\nexport default {\n  id: 'events',\n  install,\n}\n", "import * as dom from '@interactjs/utils/domUtils'\n\nimport type Interaction from '@interactjs/core/Interaction'\nimport type { Scope } from '@interactjs/core/scope'\nimport type { PointerType } from '@interactjs/core/types'\n\nexport interface SearchDetails {\n  pointer: PointerType\n  pointerId: number\n  pointerType: string\n  eventType: string\n  eventTarget: EventTarget\n  curEventTarget: EventTarget\n  scope: Scope\n}\n\nconst finder = {\n  methodOrder: ['simulationResume', 'mouseOrPen', 'hasPointer', 'idle'] as const,\n\n  search(details: SearchDetails) {\n    for (const method of finder.methodOrder) {\n      const interaction = finder[method](details)\n\n      if (interaction) {\n        return interaction\n      }\n    }\n\n    return null\n  },\n\n  // try to resume simulation with a new pointer\n  simulationResume({ pointerType, eventType, eventTarget, scope }: SearchDetails) {\n    if (!/down|start/i.test(eventType)) {\n      return null\n    }\n\n    for (const interaction of scope.interactions.list) {\n      let element = eventTarget as Node\n\n      if (\n        interaction.simulation &&\n        interaction.simulation.allowResume &&\n        interaction.pointerType === pointerType\n      ) {\n        while (element) {\n          // if the element is the interaction element\n          if (element === interaction.element) {\n            return interaction\n          }\n          element = dom.parentNode(element)\n        }\n      }\n    }\n\n    return null\n  },\n\n  // if it's a mouse or pen interaction\n  mouseOrPen({ pointerId, pointerType, eventType, scope }: SearchDetails) {\n    if (pointerType !== 'mouse' && pointerType !== 'pen') {\n      return null\n    }\n\n    let firstNonActive\n\n    for (const interaction of scope.interactions.list) {\n      if (interaction.pointerType === pointerType) {\n        // if it's a down event, skip interactions with running simulations\n        if (interaction.simulation && !hasPointerId(interaction, pointerId)) {\n          continue\n        }\n\n        // if the interaction is active, return it immediately\n        if (interaction.interacting()) {\n          return interaction\n        }\n        // otherwise save it and look for another active interaction\n        else if (!firstNonActive) {\n          firstNonActive = interaction\n        }\n      }\n    }\n\n    // if no active mouse interaction was found use the first inactive mouse\n    // interaction\n    if (firstNonActive) {\n      return firstNonActive\n    }\n\n    // find any mouse or pen interaction.\n    // ignore the interaction if the eventType is a *down, and a simulation\n    // is active\n    for (const interaction of scope.interactions.list) {\n      if (interaction.pointerType === pointerType && !(/down/i.test(eventType) && interaction.simulation)) {\n        return interaction\n      }\n    }\n\n    return null\n  },\n\n  // get interaction that has this pointer\n  hasPointer({ pointerId, scope }: SearchDetails) {\n    for (const interaction of scope.interactions.list) {\n      if (hasPointerId(interaction, pointerId)) {\n        return interaction\n      }\n    }\n\n    return null\n  },\n\n  // get first idle interaction with a matching pointerType\n  idle({ pointerType, scope }: SearchDetails) {\n    for (const interaction of scope.interactions.list) {\n      // if there's already a pointer held down\n      if (interaction.pointers.length === 1) {\n        const target = interaction.interactable\n        // don't add this pointer if there is a target interactable and it\n        // isn't gesturable\n        if (target && !(target.options.gesture && target.options.gesture.enabled)) {\n          continue\n        }\n      }\n      // maximum of 2 pointers per interaction\n      else if (interaction.pointers.length >= 2) {\n        continue\n      }\n\n      if (!interaction.interacting() && pointerType === interaction.pointerType) {\n        return interaction\n      }\n    }\n\n    return null\n  },\n}\n\nfunction hasPointerId(interaction: Interaction, pointerId: number) {\n  return interaction.pointers.some(({ id }) => id === pointerId)\n}\n\nexport default finder\n", "import browser from '@interactjs/utils/browser'\nimport domObjects from '@interactjs/utils/domObjects'\nimport { nodeContains } from '@interactjs/utils/domUtils'\nimport * as pointerUtils from '@interactjs/utils/pointerUtils'\n\nimport type { Scope, SignalArgs, Plugin } from '@interactjs/core/scope'\nimport type { ActionName, Listener } from '@interactjs/core/types'\n\n/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport './interactablePreventDefault'\nimport interactablePreventDefault from './interactablePreventDefault'\nimport InteractionBase from './Interaction'\n/* eslint-enable import/no-duplicates */\nimport type { SearchDetails } from './interactionFinder'\nimport finder from './interactionFinder'\n\ndeclare module '@interactjs/core/scope' {\n  interface Scope {\n    Interaction: typeof InteractionBase\n    interactions: {\n      new: <T extends ActionName>(options: any) => InteractionBase<T>\n      list: Array<InteractionBase<ActionName>>\n      listeners: { [type: string]: Listener }\n      docEvents: Array<{ type: string; listener: Listener }>\n      pointerMoveTolerance: number\n    }\n    prevTouchTime: number\n  }\n\n  interface SignalArgs {\n    'interactions:find': {\n      interaction: InteractionBase\n      searchDetails: SearchDetails\n    }\n  }\n}\n\nconst methodNames = [\n  'pointerDown',\n  'pointerMove',\n  'pointerUp',\n  'updatePointer',\n  'removePointer',\n  'windowBlur',\n]\n\nfunction install(scope: Scope) {\n  const listeners = {} as any\n\n  for (const method of methodNames) {\n    listeners[method] = doOnInteractions(method, scope)\n  }\n\n  const pEventTypes = browser.pEventTypes\n  let docEvents: typeof scope.interactions.docEvents\n\n  if (domObjects.PointerEvent) {\n    docEvents = [\n      { type: pEventTypes.down, listener: releasePointersOnRemovedEls },\n      { type: pEventTypes.down, listener: listeners.pointerDown },\n      { type: pEventTypes.move, listener: listeners.pointerMove },\n      { type: pEventTypes.up, listener: listeners.pointerUp },\n      { type: pEventTypes.cancel, listener: listeners.pointerUp },\n    ]\n  } else {\n    docEvents = [\n      { type: 'mousedown', listener: listeners.pointerDown },\n      { type: 'mousemove', listener: listeners.pointerMove },\n      { type: 'mouseup', listener: listeners.pointerUp },\n\n      { type: 'touchstart', listener: releasePointersOnRemovedEls },\n      { type: 'touchstart', listener: listeners.pointerDown },\n      { type: 'touchmove', listener: listeners.pointerMove },\n      { type: 'touchend', listener: listeners.pointerUp },\n      { type: 'touchcancel', listener: listeners.pointerUp },\n    ]\n  }\n\n  docEvents.push({\n    type: 'blur',\n    listener(event) {\n      for (const interaction of scope.interactions.list) {\n        interaction.documentBlur(event)\n      }\n    },\n  })\n\n  // for ignoring browser's simulated mouse events\n  scope.prevTouchTime = 0\n\n  scope.Interaction = class<T extends ActionName> extends InteractionBase<T> {\n    get pointerMoveTolerance() {\n      return scope.interactions.pointerMoveTolerance\n    }\n\n    set pointerMoveTolerance(value) {\n      scope.interactions.pointerMoveTolerance = value\n    }\n\n    _now() {\n      return scope.now()\n    }\n  }\n\n  scope.interactions = {\n    // all active and idle interactions\n    list: [],\n    new<T extends ActionName>(options: { pointerType?: string; scopeFire?: Scope['fire'] }) {\n      options.scopeFire = (name, arg) => scope.fire(name, arg)\n\n      const interaction = new scope.Interaction<T>(options as Required<typeof options>)\n\n      scope.interactions.list.push(interaction)\n      return interaction\n    },\n    listeners,\n    docEvents,\n    pointerMoveTolerance: 1,\n  }\n\n  function releasePointersOnRemovedEls() {\n    // for all inactive touch interactions with pointers down\n    for (const interaction of scope.interactions.list) {\n      if (!interaction.pointerIsDown || interaction.pointerType !== 'touch' || interaction._interacting) {\n        continue\n      }\n\n      // if a pointer is down on an element that is no longer in the DOM tree\n      for (const pointer of interaction.pointers) {\n        if (!scope.documents.some(({ doc }) => nodeContains(doc, pointer.downTarget))) {\n          // remove the pointer from the interaction\n          interaction.removePointer(pointer.pointer, pointer.event)\n        }\n      }\n    }\n  }\n\n  scope.usePlugin(interactablePreventDefault)\n}\n\nfunction doOnInteractions(method: string, scope: Scope) {\n  return function (event: Event) {\n    const interactions = scope.interactions.list\n\n    const pointerType = pointerUtils.getPointerType(event)\n    const [eventTarget, curEventTarget] = pointerUtils.getEventTargets(event)\n    const matches: any[] = [] // [ [pointer, interaction], ...]\n\n    if (/^touch/.test(event.type)) {\n      scope.prevTouchTime = scope.now()\n\n      // @ts-expect-error\n      for (const changedTouch of event.changedTouches) {\n        const pointer = changedTouch\n        const pointerId = pointerUtils.getPointerId(pointer)\n        const searchDetails: SearchDetails = {\n          pointer,\n          pointerId,\n          pointerType,\n          eventType: event.type,\n          eventTarget,\n          curEventTarget,\n          scope,\n        }\n        const interaction = getInteraction(searchDetails)\n\n        matches.push([\n          searchDetails.pointer,\n          searchDetails.eventTarget,\n          searchDetails.curEventTarget,\n          interaction,\n        ])\n      }\n    } else {\n      let invalidPointer = false\n\n      if (!browser.supportsPointerEvent && /mouse/.test(event.type)) {\n        // ignore mouse events while touch interactions are active\n        for (let i = 0; i < interactions.length && !invalidPointer; i++) {\n          invalidPointer = interactions[i].pointerType !== 'mouse' && interactions[i].pointerIsDown\n        }\n\n        // try to ignore mouse events that are simulated by the browser\n        // after a touch event\n        invalidPointer =\n          invalidPointer ||\n          scope.now() - scope.prevTouchTime < 500 ||\n          // on iOS and Firefox Mobile, MouseEvent.timeStamp is zero if simulated\n          event.timeStamp === 0\n      }\n\n      if (!invalidPointer) {\n        const searchDetails = {\n          pointer: event as PointerEvent,\n          pointerId: pointerUtils.getPointerId(event as PointerEvent),\n          pointerType,\n          eventType: event.type,\n          curEventTarget,\n          eventTarget,\n          scope,\n        }\n\n        const interaction = getInteraction(searchDetails)\n\n        matches.push([\n          searchDetails.pointer,\n          searchDetails.eventTarget,\n          searchDetails.curEventTarget,\n          interaction,\n        ])\n      }\n    }\n\n    // eslint-disable-next-line no-shadow\n    for (const [pointer, eventTarget, curEventTarget, interaction] of matches) {\n      interaction[method](pointer, event, eventTarget, curEventTarget)\n    }\n  }\n}\n\nfunction getInteraction(searchDetails: SearchDetails) {\n  const { pointerType, scope } = searchDetails\n\n  const foundInteraction = finder.search(searchDetails)\n  const signalArg = { interaction: foundInteraction, searchDetails }\n\n  scope.fire('interactions:find', signalArg)\n\n  return signalArg.interaction || scope.interactions.new({ pointerType })\n}\n\nfunction onDocSignal<T extends 'scope:add-document' | 'scope:remove-document'>(\n  { doc, scope, options }: SignalArgs[T],\n  eventMethodName: 'add' | 'remove',\n) {\n  const {\n    interactions: { docEvents },\n    events,\n  } = scope\n  const eventMethod = events[eventMethodName]\n\n  if (scope.browser.isIOS && !options.events) {\n    options.events = { passive: false }\n  }\n\n  // delegate event listener\n  for (const eventType in events.delegatedEvents) {\n    eventMethod(doc, eventType, events.delegateListener)\n    eventMethod(doc, eventType, events.delegateUseCapture, true)\n  }\n\n  const eventOptions = options && options.events\n\n  for (const { type, listener } of docEvents) {\n    eventMethod(doc, type, listener, eventOptions)\n  }\n}\n\nconst interactions: Plugin = {\n  id: 'core/interactions',\n  install,\n  listeners: {\n    'scope:add-document': (arg) => onDocSignal(arg, 'add'),\n    'scope:remove-document': (arg) => onDocSignal(arg, 'remove'),\n    'interactable:unset': ({ interactable }, scope) => {\n      // Stop and destroy related interactions when an Interactable is unset\n      for (let i = scope.interactions.list.length - 1; i >= 0; i--) {\n        const interaction = scope.interactions.list[i]\n\n        if (interaction.interactable !== interactable) {\n          continue\n        }\n\n        interaction.stop()\n        scope.fire('interactions:destroy', { interaction })\n        interaction.destroy()\n\n        if (scope.interactions.list.length > 2) {\n          scope.interactions.list.splice(i, 1)\n        }\n      }\n    },\n  },\n  onDocSignal,\n  doOnInteractions,\n  methodNames,\n}\n\nexport default interactions\n", "/* eslint-disable no-dupe-class-members */\nimport * as arr from '@interactjs/utils/arr'\nimport browser from '@interactjs/utils/browser'\nimport clone from '@interactjs/utils/clone'\nimport { getElementRect, matchesUpTo, nodeContains, trySelector } from '@interactjs/utils/domUtils'\nimport extend from '@interactjs/utils/extend'\nimport is from '@interactjs/utils/is'\nimport isNonNativeEvent from '@interactjs/utils/isNonNativeEvent'\nimport normalizeListeners from '@interactjs/utils/normalizeListeners'\nimport { getWindow } from '@interactjs/utils/window'\n\nimport type { Scope } from '@interactjs/core/scope'\nimport type {\n  ActionMap,\n  ActionMethod,\n  ActionName,\n  Actions,\n  Context,\n  Element,\n  EventTypes,\n  Listeners,\n  ListenersArg,\n  OrBoolean,\n  Target,\n} from '@interactjs/core/types'\n\nimport { Eventable } from './Eventable'\nimport type { ActionDefaults, Defaults, OptionsArg, PerActionDefaults, Options } from './options'\n\ntype IgnoreValue = string | Element | boolean\ntype DeltaSource = 'page' | 'client'\n\nconst enum OnOffMethod {\n  On,\n  Off,\n}\n\n/**\n * ```ts\n * const interactable = interact('.cards')\n *   .draggable({\n *     listeners: { move: event => console.log(event.type, event.pageX, event.pageY) }\n *   })\n *   .resizable({\n *     listeners: { move: event => console.log(event.rect) },\n *     modifiers: [interact.modifiers.restrictEdges({ outer: 'parent' })]\n *   })\n * ```\n */\nexport class Interactable implements Partial<Eventable> {\n  /** @internal */ get _defaults(): Defaults {\n    return {\n      base: {},\n      perAction: {},\n      actions: {} as ActionDefaults,\n    }\n  }\n\n  readonly target: Target\n  /** @internal */ readonly options!: Required<Options>\n  /** @internal */ readonly _actions: Actions\n  /** @internal */ readonly events = new Eventable()\n  /** @internal */ readonly _context: Context\n  /** @internal */ readonly _win: Window\n  /** @internal */ readonly _doc: Document\n  /** @internal */ readonly _scopeEvents: Scope['events']\n\n  constructor(\n    target: Target,\n    options: any,\n    defaultContext: Document | Element,\n    scopeEvents: Scope['events'],\n  ) {\n    this._actions = options.actions\n    this.target = target\n    this._context = options.context || defaultContext\n    this._win = getWindow(trySelector(target) ? this._context : target)\n    this._doc = this._win.document\n    this._scopeEvents = scopeEvents\n\n    this.set(options)\n  }\n\n  setOnEvents(actionName: ActionName, phases: NonNullable<any>) {\n    if (is.func(phases.onstart)) {\n      this.on(`${actionName}start`, phases.onstart)\n    }\n    if (is.func(phases.onmove)) {\n      this.on(`${actionName}move`, phases.onmove)\n    }\n    if (is.func(phases.onend)) {\n      this.on(`${actionName}end`, phases.onend)\n    }\n    if (is.func(phases.oninertiastart)) {\n      this.on(`${actionName}inertiastart`, phases.oninertiastart)\n    }\n\n    return this\n  }\n\n  updatePerActionListeners(actionName: ActionName, prev: Listeners | undefined, cur: Listeners | undefined) {\n    const actionFilter = (this._actions.map[actionName] as { filterEventType?: (type: string) => boolean })\n      ?.filterEventType\n    const filter = (type: string) =>\n      (actionFilter == null || actionFilter(type)) && isNonNativeEvent(type, this._actions)\n\n    if (is.array(prev) || is.object(prev)) {\n      this._onOff(OnOffMethod.Off, actionName, prev, undefined, filter)\n    }\n\n    if (is.array(cur) || is.object(cur)) {\n      this._onOff(OnOffMethod.On, actionName, cur, undefined, filter)\n    }\n  }\n\n  setPerAction(actionName: ActionName, options: OrBoolean<Options>) {\n    const defaults = this._defaults\n\n    // for all the default per-action options\n    for (const optionName_ in options) {\n      const optionName = optionName_ as keyof PerActionDefaults\n      const actionOptions = this.options[actionName]\n      const optionValue: any = options[optionName]\n\n      // remove old event listeners and add new ones\n      if (optionName === 'listeners') {\n        this.updatePerActionListeners(actionName, actionOptions.listeners, optionValue as Listeners)\n      }\n\n      // if the option value is an array\n      if (is.array(optionValue)) {\n        ;(actionOptions[optionName] as any) = arr.from(optionValue)\n      }\n      // if the option value is an object\n      else if (is.plainObject(optionValue)) {\n        // copy the object\n        ;(actionOptions[optionName] as any) = extend(\n          actionOptions[optionName] || ({} as any),\n          clone(optionValue),\n        )\n\n        // set anabled field to true if it exists in the defaults\n        if (\n          is.object(defaults.perAction[optionName]) &&\n          'enabled' in (defaults.perAction[optionName] as any)\n        ) {\n          ;(actionOptions[optionName] as any).enabled = optionValue.enabled !== false\n        }\n      }\n      // if the option value is a boolean and the default is an object\n      else if (is.bool(optionValue) && is.object(defaults.perAction[optionName])) {\n        ;(actionOptions[optionName] as any).enabled = optionValue\n      }\n      // if it's anything else, do a plain assignment\n      else {\n        ;(actionOptions[optionName] as any) = optionValue\n      }\n    }\n  }\n\n  /**\n   * The default function to get an Interactables bounding rect. Can be\n   * overridden using {@link Interactable.rectChecker}.\n   *\n   * @param {Element} [element] The element to measure.\n   * @return {Rect} The object's bounding rectangle.\n   */\n  getRect(element: Element) {\n    element = element || (is.element(this.target) ? this.target : null)\n\n    if (is.string(this.target)) {\n      element = element || this._context.querySelector(this.target)\n    }\n\n    return getElementRect(element)\n  }\n\n  /**\n   * Returns or sets the function used to calculate the interactable's\n   * element's rectangle\n   *\n   * @param {function} [checker] A function which returns this Interactable's\n   * bounding rectangle. See {@link Interactable.getRect}\n   * @return {function | object} The checker function or this Interactable\n   */\n  rectChecker(): (element: Element) => any | null\n  rectChecker(checker: (element: Element) => any): this\n  rectChecker(checker?: (element: Element) => any) {\n    if (is.func(checker)) {\n      this.getRect = (element) => {\n        const rect = extend({}, checker.apply(this, element))\n\n        if (!(('width' in rect) as unknown)) {\n          rect.width = rect.right - rect.left\n          rect.height = rect.bottom - rect.top\n        }\n\n        return rect\n      }\n\n      return this\n    }\n\n    if (checker === null) {\n      delete (this as Partial<typeof this>).getRect\n\n      return this\n    }\n\n    return this.getRect\n  }\n\n  /** @internal */\n  _backCompatOption(optionName: keyof Options, newValue: any) {\n    if (trySelector(newValue) || is.object(newValue)) {\n      ;(this.options[optionName] as any) = newValue\n\n      for (const action in this._actions.map) {\n        ;(this.options[action as keyof ActionMap] as any)[optionName] = newValue\n      }\n\n      return this\n    }\n\n    return this.options[optionName]\n  }\n\n  /**\n   * Gets or sets the origin of the Interactable's element.  The x and y\n   * of the origin will be subtracted from action event coordinates.\n   *\n   * @param {Element | object | string} [origin] An HTML or SVG Element whose\n   * rect will be used, an object eg. { x: 0, y: 0 } or string 'parent', 'self'\n   * or any CSS selector\n   *\n   * @return {object} The current origin or this Interactable\n   */\n  origin(newValue: any) {\n    return this._backCompatOption('origin', newValue)\n  }\n\n  /**\n   * Returns or sets the mouse coordinate types used to calculate the\n   * movement of the pointer.\n   *\n   * @param {string} [newValue] Use 'client' if you will be scrolling while\n   * interacting; Use 'page' if you want autoScroll to work\n   * @return {string | object} The current deltaSource or this Interactable\n   */\n  deltaSource(): DeltaSource\n  deltaSource(newValue: DeltaSource): this\n  deltaSource(newValue?: DeltaSource) {\n    if (newValue === 'page' || newValue === 'client') {\n      this.options.deltaSource = newValue\n\n      return this\n    }\n\n    return this.options.deltaSource\n  }\n\n  /** @internal */\n  getAllElements(): Element[] {\n    const { target } = this\n\n    if (is.string(target)) {\n      return Array.from(this._context.querySelectorAll(target))\n    }\n\n    if (is.func(target) && (target as any).getAllElements) {\n      return (target as any).getAllElements()\n    }\n\n    return is.element(target) ? [target] : []\n  }\n\n  /**\n   * Gets the selector context Node of the Interactable. The default is\n   * `window.document`.\n   *\n   * @return {Node} The context Node of this Interactable\n   */\n  context() {\n    return this._context\n  }\n\n  inContext(element: Document | Node) {\n    return this._context === element.ownerDocument || nodeContains(this._context, element)\n  }\n\n  /** @internal */\n  testIgnoreAllow(\n    this: Interactable,\n    options: { ignoreFrom?: IgnoreValue; allowFrom?: IgnoreValue },\n    targetNode: Node,\n    eventTarget: Node,\n  ) {\n    return (\n      !this.testIgnore(options.ignoreFrom, targetNode, eventTarget) &&\n      this.testAllow(options.allowFrom, targetNode, eventTarget)\n    )\n  }\n\n  /** @internal */\n  testAllow(this: Interactable, allowFrom: IgnoreValue | undefined, targetNode: Node, element: Node) {\n    if (!allowFrom) {\n      return true\n    }\n\n    if (!is.element(element)) {\n      return false\n    }\n\n    if (is.string(allowFrom)) {\n      return matchesUpTo(element, allowFrom, targetNode)\n    } else if (is.element(allowFrom)) {\n      return nodeContains(allowFrom, element)\n    }\n\n    return false\n  }\n\n  /** @internal */\n  testIgnore(this: Interactable, ignoreFrom: IgnoreValue | undefined, targetNode: Node, element: Node) {\n    if (!ignoreFrom || !is.element(element)) {\n      return false\n    }\n\n    if (is.string(ignoreFrom)) {\n      return matchesUpTo(element, ignoreFrom, targetNode)\n    } else if (is.element(ignoreFrom)) {\n      return nodeContains(ignoreFrom, element)\n    }\n\n    return false\n  }\n\n  /**\n   * Calls listeners for the given InteractEvent type bound globally\n   * and directly to this Interactable\n   *\n   * @param {InteractEvent} iEvent The InteractEvent object to be fired on this\n   * Interactable\n   * @return {Interactable} this Interactable\n   */\n  fire<E extends { type: string }>(iEvent: E) {\n    this.events.fire(iEvent)\n\n    return this\n  }\n\n  /** @internal */\n  _onOff(\n    method: OnOffMethod,\n    typeArg: EventTypes,\n    listenerArg?: ListenersArg | null,\n    options?: any,\n    filter?: (type: string) => boolean,\n  ) {\n    if (is.object(typeArg) && !is.array(typeArg)) {\n      options = listenerArg\n      listenerArg = null\n    }\n\n    const listeners = normalizeListeners(typeArg, listenerArg, filter)\n\n    for (let type in listeners) {\n      if (type === 'wheel') {\n        type = browser.wheelEvent\n      }\n\n      for (const listener of listeners[type]) {\n        // if it is an action event type\n        if (isNonNativeEvent(type, this._actions)) {\n          this.events[method === OnOffMethod.On ? 'on' : 'off'](type, listener)\n        }\n        // delegated event\n        else if (is.string(this.target)) {\n          this._scopeEvents[method === OnOffMethod.On ? 'addDelegate' : 'removeDelegate'](\n            this.target,\n            this._context,\n            type,\n            listener,\n            options,\n          )\n        }\n        // remove listener from this Interactable's element\n        else {\n          this._scopeEvents[method === OnOffMethod.On ? 'add' : 'remove'](\n            this.target,\n            type,\n            listener,\n            options,\n          )\n        }\n      }\n    }\n\n    return this\n  }\n\n  /**\n   * Binds a listener for an InteractEvent, pointerEvent or DOM event.\n   *\n   * @param {string | array | object} types The types of events to listen\n   * for\n   * @param {function | array | object} [listener] The event listener function(s)\n   * @param {object | boolean} [options] options object or useCapture flag for\n   * addEventListener\n   * @return {Interactable} This Interactable\n   */\n  on(types: EventTypes, listener?: ListenersArg, options?: any) {\n    return this._onOff(OnOffMethod.On, types, listener, options)\n  }\n\n  /**\n   * Removes an InteractEvent, pointerEvent or DOM event listener.\n   *\n   * @param {string | array | object} types The types of events that were\n   * listened for\n   * @param {function | array | object} [listener] The event listener function(s)\n   * @param {object | boolean} [options] options object or useCapture flag for\n   * removeEventListener\n   * @return {Interactable} This Interactable\n   */\n  off(types: string | string[] | EventTypes, listener?: ListenersArg, options?: any) {\n    return this._onOff(OnOffMethod.Off, types, listener, options)\n  }\n\n  /**\n   * Reset the options of this Interactable\n   *\n   * @param {object} options The new settings to apply\n   * @return {object} This Interactable\n   */\n  set(options: OptionsArg) {\n    const defaults = this._defaults\n\n    if (!is.object(options)) {\n      options = {}\n    }\n\n    ;(this.options as Required<Options>) = clone(defaults.base) as Required<Options>\n\n    for (const actionName_ in this._actions.methodDict) {\n      const actionName = actionName_ as ActionName\n      const methodName = this._actions.methodDict[actionName]\n\n      this.options[actionName] = {}\n      this.setPerAction(actionName, extend(extend({}, defaults.perAction), defaults.actions[actionName]))\n      ;(this[methodName] as ActionMethod<unknown>)(options[actionName])\n    }\n\n    for (const setting in options) {\n      if (setting === 'getRect') {\n        this.rectChecker(options.getRect)\n        continue\n      }\n\n      if (is.func((this as any)[setting])) {\n        ;(this as any)[setting](options[setting as keyof typeof options])\n      }\n    }\n\n    return this\n  }\n\n  /**\n   * Remove this interactable from the list of interactables and remove it's\n   * action capabilities and event listeners\n   */\n  unset() {\n    if (is.string(this.target)) {\n      // remove delegated events\n      for (const type in this._scopeEvents.delegatedEvents) {\n        const delegated = this._scopeEvents.delegatedEvents[type]\n\n        for (let i = delegated.length - 1; i >= 0; i--) {\n          const { selector, context, listeners } = delegated[i]\n\n          if (selector === this.target && context === this._context) {\n            delegated.splice(i, 1)\n          }\n\n          for (let l = listeners.length - 1; l >= 0; l--) {\n            this._scopeEvents.removeDelegate(\n              this.target,\n              this._context,\n              type,\n              listeners[l][0],\n              listeners[l][1],\n            )\n          }\n        }\n      }\n    } else {\n      this._scopeEvents.remove(this.target, 'all')\n    }\n  }\n}\n", "import * as arr from '@interactjs/utils/arr'\nimport * as domUtils from '@interactjs/utils/domUtils'\nimport extend from '@interactjs/utils/extend'\nimport is from '@interactjs/utils/is'\n\nimport type { Interactable } from '@interactjs/core/Interactable'\nimport type { OptionsArg, Options } from '@interactjs/core/options'\nimport type { Scope } from '@interactjs/core/scope'\nimport type { Target } from '@interactjs/core/types'\n\ndeclare module '@interactjs/core/scope' {\n  interface SignalArgs {\n    'interactable:new': {\n      interactable: Interactable\n      target: Target\n      options: OptionsArg\n      win: Window\n    }\n  }\n}\n\nexport class InteractableSet {\n  // all set interactables\n  list: Interactable[] = []\n\n  selectorMap: {\n    [selector: string]: Interactable[]\n  } = {}\n\n  scope: Scope\n\n  constructor(scope: Scope) {\n    this.scope = scope\n    scope.addListeners({\n      'interactable:unset': ({ interactable }) => {\n        const { target } = interactable\n        const interactablesOnTarget: Interactable[] = is.string(target)\n          ? this.selectorMap[target]\n          : (target as any)[this.scope.id]\n\n        const targetIndex = arr.findIndex(interactablesOnTarget, (i) => i === interactable)\n        interactablesOnTarget.splice(targetIndex, 1)\n      },\n    })\n  }\n\n  new(target: Target, options?: any): Interactable {\n    options = extend(options || {}, {\n      actions: this.scope.actions,\n    })\n    const interactable = new this.scope.Interactable(target, options, this.scope.document, this.scope.events)\n\n    this.scope.addDocument(interactable._doc)\n    this.list.push(interactable)\n\n    if (is.string(target)) {\n      if (!this.selectorMap[target]) {\n        this.selectorMap[target] = []\n      }\n      this.selectorMap[target].push(interactable)\n    } else {\n      if (!(interactable.target as any)[this.scope.id]) {\n        Object.defineProperty(target, this.scope.id, {\n          value: [],\n          configurable: true,\n        })\n      }\n\n      ;(target as any)[this.scope.id].push(interactable)\n    }\n\n    this.scope.fire('interactable:new', {\n      target,\n      options,\n      interactable,\n      win: this.scope._win,\n    })\n\n    return interactable\n  }\n\n  getExisting(target: Target, options?: Options) {\n    const context = (options && options.context) || this.scope.document\n    const isSelector = is.string(target)\n    const interactablesOnTarget: Interactable[] = isSelector\n      ? this.selectorMap[target as string]\n      : (target as any)[this.scope.id]\n\n    if (!interactablesOnTarget) return undefined\n\n    return arr.find(\n      interactablesOnTarget,\n      (interactable) =>\n        interactable._context === context && (isSelector || interactable.inContext(target as any)),\n    )\n  }\n\n  forEachMatch<T>(node: Node, callback: (interactable: Interactable) => T): T | void {\n    for (const interactable of this.list) {\n      let ret: T\n\n      if (\n        (is.string(interactable.target)\n          ? // target is a selector and the element matches\n            is.element(node) && domUtils.matchesSelector(node, interactable.target)\n          : // target is the element\n            node === interactable.target) &&\n        // the element is in context\n        interactable.inContext(node)\n      ) {\n        ret = callback(interactable)\n      }\n\n      if (ret !== undefined) {\n        return ret\n      }\n    }\n  }\n}\n", "import browser from '@interactjs/utils/browser'\nimport clone from '@interactjs/utils/clone'\nimport domObjects from '@interactjs/utils/domObjects'\nimport extend from '@interactjs/utils/extend'\nimport is from '@interactjs/utils/is'\nimport raf from '@interactjs/utils/raf'\nimport * as win from '@interactjs/utils/window'\n\nimport type Interaction from '@interactjs/core/Interaction'\n\nimport { Eventable } from './Eventable'\n/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport './events'\nimport './interactions'\nimport events from './events'\nimport { Interactable as InteractableBase } from './Interactable'\nimport { InteractableSet } from './InteractableSet'\nimport { InteractEvent } from './InteractEvent'\nimport interactions from './interactions'\n/* eslint-enable import/no-duplicates */\nimport { createInteractStatic } from './InteractStatic'\nimport type { OptionsArg } from './options'\nimport { defaults } from './options'\nimport type { Actions } from './types'\n\nexport interface SignalArgs {\n  'scope:add-document': DocSignalArg\n  'scope:remove-document': DocSignalArg\n  'interactable:unset': { interactable: InteractableBase }\n  'interactable:set': { interactable: InteractableBase; options: OptionsArg }\n  'interactions:destroy': { interaction: Interaction }\n}\n\nexport type ListenerName = keyof SignalArgs\n\nexport type ListenerMap = {\n  [P in ListenerName]?: (arg: SignalArgs[P], scope: Scope, signalName: P) => void | boolean\n}\n\ninterface DocSignalArg {\n  doc: Document\n  window: Window\n  scope: Scope\n  options: Record<string, any>\n}\n\nexport interface Plugin {\n  [key: string]: any\n  id?: string\n  listeners?: ListenerMap\n  before?: string[]\n  install?(scope: Scope, options?: any): void\n}\n\n/** @internal */\nexport class Scope {\n  id = `__interact_scope_${Math.floor(Math.random() * 100)}`\n  isInitialized = false\n  listenerMaps: Array<{\n    map: ListenerMap\n    id?: string\n  }> = []\n\n  browser = browser\n  defaults = clone(defaults) as typeof defaults\n  Eventable = Eventable\n  actions: Actions = {\n    map: {},\n    phases: {\n      start: true,\n      move: true,\n      end: true,\n    },\n    methodDict: {} as any,\n    phaselessTypes: {},\n  }\n\n  interactStatic = createInteractStatic(this)\n  InteractEvent = InteractEvent\n  Interactable: typeof InteractableBase\n  interactables = new InteractableSet(this)\n\n  // main window\n  _win!: Window\n\n  // main document\n  document!: Document\n\n  // main window\n  window!: Window\n\n  // all documents being listened to\n  documents: Array<{ doc: Document; options: any }> = []\n\n  _plugins: {\n    list: Plugin[]\n    map: { [id: string]: Plugin }\n  } = {\n    list: [],\n    map: {},\n  }\n\n  constructor() {\n    const scope = this\n\n    this.Interactable = class extends InteractableBase {\n      get _defaults() {\n        return scope.defaults\n      }\n\n      set<T extends InteractableBase>(this: T, options: OptionsArg) {\n        super.set(options)\n\n        scope.fire('interactable:set', {\n          options,\n          interactable: this,\n        })\n\n        return this\n      }\n\n      unset(this: InteractableBase) {\n        super.unset()\n\n        const index = scope.interactables.list.indexOf(this)\n        if (index < 0) return\n\n        scope.interactables.list.splice(index, 1)\n        scope.fire('interactable:unset', { interactable: this })\n      }\n    }\n  }\n\n  addListeners(map: ListenerMap, id?: string) {\n    this.listenerMaps.push({ id, map })\n  }\n\n  fire<T extends ListenerName>(name: T, arg: SignalArgs[T]): void | false {\n    for (const {\n      map: { [name]: listener },\n    } of this.listenerMaps) {\n      if (!!listener && listener(arg as any, this, name as never) === false) {\n        return false\n      }\n    }\n  }\n\n  onWindowUnload = (event: BeforeUnloadEvent) => this.removeDocument(event.target as Document)\n\n  init(window: Window | typeof globalThis) {\n    return this.isInitialized ? this : initScope(this, window)\n  }\n\n  pluginIsInstalled(plugin: Plugin) {\n    const { id } = plugin\n    return id ? !!this._plugins.map[id] : this._plugins.list.indexOf(plugin) !== -1\n  }\n\n  usePlugin(plugin: Plugin, options?: { [key: string]: any }) {\n    if (!this.isInitialized) {\n      return this\n    }\n\n    if (this.pluginIsInstalled(plugin)) {\n      return this\n    }\n\n    if (plugin.id) {\n      this._plugins.map[plugin.id] = plugin\n    }\n    this._plugins.list.push(plugin)\n\n    if (plugin.install) {\n      plugin.install(this, options)\n    }\n\n    if (plugin.listeners && plugin.before) {\n      let index = 0\n      const len = this.listenerMaps.length\n      const before = plugin.before.reduce((acc, id) => {\n        acc[id] = true\n        acc[pluginIdRoot(id)] = true\n        return acc\n      }, {})\n\n      for (; index < len; index++) {\n        const otherId = this.listenerMaps[index].id\n\n        if (otherId && (before[otherId] || before[pluginIdRoot(otherId)])) {\n          break\n        }\n      }\n\n      this.listenerMaps.splice(index, 0, { id: plugin.id, map: plugin.listeners })\n    } else if (plugin.listeners) {\n      this.listenerMaps.push({ id: plugin.id, map: plugin.listeners })\n    }\n\n    return this\n  }\n\n  addDocument(doc: Document, options?: any): void | false {\n    // do nothing if document is already known\n    if (this.getDocIndex(doc) !== -1) {\n      return false\n    }\n\n    const window = win.getWindow(doc)\n\n    options = options ? extend({}, options) : {}\n\n    this.documents.push({ doc, options })\n    this.events.documents.push(doc)\n\n    // don't add an unload event for the main document\n    // so that the page may be cached in browser history\n    if (doc !== this.document) {\n      this.events.add(window, 'unload', this.onWindowUnload)\n    }\n\n    this.fire('scope:add-document', { doc, window, scope: this, options })\n  }\n\n  removeDocument(doc: Document) {\n    const index = this.getDocIndex(doc)\n\n    const window = win.getWindow(doc)\n    const options = this.documents[index].options\n\n    this.events.remove(window, 'unload', this.onWindowUnload)\n\n    this.documents.splice(index, 1)\n    this.events.documents.splice(index, 1)\n\n    this.fire('scope:remove-document', { doc, window, scope: this, options })\n  }\n\n  getDocIndex(doc: Document) {\n    for (let i = 0; i < this.documents.length; i++) {\n      if (this.documents[i].doc === doc) {\n        return i\n      }\n    }\n\n    return -1\n  }\n\n  getDocOptions(doc: Document) {\n    const docIndex = this.getDocIndex(doc)\n\n    return docIndex === -1 ? null : this.documents[docIndex].options\n  }\n\n  now() {\n    return (((this.window as any).Date as typeof Date) || Date).now()\n  }\n}\n\n// Keep Scope class internal, but expose minimal interface to avoid broken types when Scope is stripped out\nexport interface Scope {\n  fire<T extends ListenerName>(name: T, arg: SignalArgs[T]): void | false\n}\n\n/** @internal */\nexport function initScope(scope: Scope, window: Window | typeof globalThis) {\n  scope.isInitialized = true\n\n  if (is.window(window)) {\n    win.init(window)\n  }\n\n  domObjects.init(window)\n  browser.init(window)\n  raf.init(window)\n\n  // @ts-expect-error\n  scope.window = window\n  scope.document = window.document\n\n  scope.usePlugin(interactions)\n  scope.usePlugin(events)\n\n  return scope\n}\n\nfunction pluginIdRoot(id: string) {\n  return id && id.replace(/\\/.*$/, '')\n}\n", "import browser from '@interactjs/utils/browser'\nimport * as domUtils from '@interactjs/utils/domUtils'\nimport is from '@interactjs/utils/is'\nimport isNonNativeEvent from '@interactjs/utils/isNonNativeEvent'\nimport { warnOnce } from '@interactjs/utils/misc'\nimport * as pointerUtils from '@interactjs/utils/pointerUtils'\n\nimport type { Scope, Plugin } from '@interactjs/core/scope'\nimport type { Context, EventTypes, Listener, ListenersArg, Target } from '@interactjs/core/types'\n\nimport type { Interactable } from './Interactable'\nimport type { Options } from './options'\n\n/**\n * ```js\n * interact('#draggable').draggable(true)\n *\n * var rectables = interact('rect')\n * rectables\n *   .gesturable(true)\n *   .on('gesturemove', function (event) {\n *       // ...\n *   })\n * ```\n *\n * The methods of this variable can be used to set elements as interactables\n * and also to change various default settings.\n *\n * Calling it as a function and passing an element or a valid CSS selector\n * string returns an Interactable object which has various methods to configure\n * it.\n *\n * @param {Element | string} target The HTML or SVG Element to interact with\n * or CSS selector\n * @return {Interactable}\n */\nexport interface InteractStatic {\n  (target: Target, options?: Options): Interactable\n  getPointerAverage: typeof pointerUtils.pointerAverage\n  getTouchBBox: typeof pointerUtils.touchBBox\n  getTouchDistance: typeof pointerUtils.touchDistance\n  getTouchAngle: typeof pointerUtils.touchAngle\n  getElementRect: typeof domUtils.getElementRect\n  getElementClientRect: typeof domUtils.getElementClientRect\n  matchesSelector: typeof domUtils.matchesSelector\n  closest: typeof domUtils.closest\n  /** @internal */ globalEvents: any\n  version: string\n  /** @internal */ scope: Scope\n  /**\n   * Use a plugin\n   */\n  use(\n    plugin: Plugin,\n    options?: {\n      [key: string]: any\n    },\n  ): any\n  /**\n   * Check if an element or selector has been set with the `interact(target)`\n   * function\n   *\n   * @return {boolean} Indicates if the element or CSS selector was previously\n   * passed to interact\n   */\n  isSet(\n    /* The Element or string being searched for */\n    target: Target,\n    options?: any,\n  ): boolean\n  on(type: string | EventTypes, listener: ListenersArg, options?: object): any\n  off(type: EventTypes, listener: any, options?: object): any\n  debug(): any\n  /**\n   * Whether or not the browser supports touch input\n   */\n  supportsTouch(): boolean\n  /**\n   * Whether or not the browser supports PointerEvents\n   */\n  supportsPointerEvent(): boolean\n  /**\n   * Cancels all interactions (end events are not fired)\n   */\n  stop(): InteractStatic\n  /**\n   * Returns or sets the distance the pointer must be moved before an action\n   * sequence occurs. This also affects tolerance for tap events.\n   */\n  pointerMoveTolerance(\n    /** The movement from the start position must be greater than this value */\n    newValue?: number,\n  ): InteractStatic | number\n  addDocument(doc: Document, options?: object): void\n  removeDocument(doc: Document): void\n}\n\nexport function createInteractStatic(scope: Scope): InteractStatic {\n  const interact = ((target: Target, options: Options) => {\n    let interactable = scope.interactables.getExisting(target, options)\n\n    if (!interactable) {\n      interactable = scope.interactables.new(target, options)\n      interactable.events.global = interact.globalEvents\n    }\n\n    return interactable\n  }) as InteractStatic\n\n  // expose the functions used to calculate multi-touch properties\n  interact.getPointerAverage = pointerUtils.pointerAverage\n  interact.getTouchBBox = pointerUtils.touchBBox\n  interact.getTouchDistance = pointerUtils.touchDistance\n  interact.getTouchAngle = pointerUtils.touchAngle\n\n  interact.getElementRect = domUtils.getElementRect\n  interact.getElementClientRect = domUtils.getElementClientRect\n  interact.matchesSelector = domUtils.matchesSelector\n  interact.closest = domUtils.closest\n\n  interact.globalEvents = {} as any\n\n  // eslint-disable-next-line no-undef\n  interact.version = process.env.npm_package_version\n  interact.scope = scope\n  interact.use = function (plugin, options) {\n    this.scope.usePlugin(plugin, options)\n\n    return this\n  }\n\n  interact.isSet = function (target: Target, options?: { context?: Context }): boolean {\n    return !!this.scope.interactables.get(target, options && options.context)\n  }\n\n  interact.on = warnOnce(function on(type: string | EventTypes, listener: ListenersArg, options?: object) {\n    if (is.string(type) && type.search(' ') !== -1) {\n      type = type.trim().split(/ +/)\n    }\n\n    if (is.array(type)) {\n      for (const eventType of type as any[]) {\n        this.on(eventType, listener, options)\n      }\n\n      return this\n    }\n\n    if (is.object(type)) {\n      for (const prop in type) {\n        this.on(prop, (type as any)[prop], listener)\n      }\n\n      return this\n    }\n\n    // if it is an InteractEvent type, add listener to globalEvents\n    if (isNonNativeEvent(type, this.scope.actions)) {\n      // if this type of event was never bound\n      if (!this.globalEvents[type]) {\n        this.globalEvents[type] = [listener]\n      } else {\n        this.globalEvents[type].push(listener)\n      }\n    }\n    // If non InteractEvent type, addEventListener to document\n    else {\n      this.scope.events.add(this.scope.document, type, listener as Listener, { options })\n    }\n\n    return this\n  }, 'The interact.on() method is being deprecated')\n\n  interact.off = warnOnce(function off(type: EventTypes, listener: any, options?: object) {\n    if (is.string(type) && type.search(' ') !== -1) {\n      type = type.trim().split(/ +/)\n    }\n\n    if (is.array(type)) {\n      for (const eventType of type) {\n        this.off(eventType, listener, options)\n      }\n\n      return this\n    }\n\n    if (is.object(type)) {\n      for (const prop in type) {\n        this.off(prop, type[prop], listener)\n      }\n\n      return this\n    }\n\n    if (isNonNativeEvent(type, this.scope.actions)) {\n      let index: number\n\n      if (type in this.globalEvents && (index = this.globalEvents[type].indexOf(listener)) !== -1) {\n        this.globalEvents[type].splice(index, 1)\n      }\n    } else {\n      this.scope.events.remove(this.scope.document, type, listener, options)\n    }\n\n    return this\n  }, 'The interact.off() method is being deprecated')\n\n  interact.debug = function () {\n    return this.scope\n  }\n\n  interact.supportsTouch = function () {\n    return browser.supportsTouch\n  }\n\n  interact.supportsPointerEvent = function () {\n    return browser.supportsPointerEvent\n  }\n\n  interact.stop = function () {\n    for (const interaction of this.scope.interactions.list) {\n      interaction.stop()\n    }\n\n    return this\n  }\n\n  interact.pointerMoveTolerance = function (newValue?: number) {\n    if (is.number(newValue)) {\n      this.scope.interactions.pointerMoveTolerance = newValue\n\n      return this\n    }\n\n    return this.scope.interactions.pointerMoveTolerance\n  }\n\n  interact.addDocument = function (doc: Document, options?: object) {\n    this.scope.addDocument(doc, options)\n  }\n\n  interact.removeDocument = function (doc: Document) {\n    this.scope.removeDocument(doc)\n  }\n\n  return interact\n}\n", "import { Scope } from '@interactjs/core/scope'\n\nconst scope = new Scope()\n\nconst interact = scope.interactStatic\n\nexport default interact\n\nconst _global = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : this\nscope.init(_global)\n", "export default () => {}\n", "export default () => {}\n", "import type { Rect, Point } from '@interactjs/core/types'\nimport type { SnapFunction, SnapTarget } from '@interactjs/modifiers/snap/pointer'\n\nexport interface GridOptionsBase {\n  range?: number\n  limits?: Rect\n  offset?: Point\n}\nexport interface GridOptionsXY extends GridOptionsBase {\n  x: number\n  y: number\n}\nexport interface GridOptionsTopLeft extends GridOptionsBase {\n  top?: number\n  left?: number\n}\nexport interface GridOptionsBottomRight extends GridOptionsBase {\n  bottom?: number\n  right?: number\n}\nexport interface GridOptionsWidthHeight extends GridOptionsBase {\n  width?: number\n  height?: number\n}\n\nexport type GridOptions = GridOptionsXY | GridOptionsTopLeft | GridOptionsBottomRight | GridOptionsWidthHeight\n\nexport default (grid: GridOptions) => {\n  const coordFields = (\n    [\n      ['x', 'y'],\n      ['left', 'top'],\n      ['right', 'bottom'],\n      ['width', 'height'],\n    ] as const\n  ).filter(([xField, yField]) => xField in grid || yField in grid)\n\n  const gridFunc: SnapFunction & {\n    grid: typeof grid\n    coordFields: typeof coordFields\n  } = (x, y) => {\n    const {\n      range,\n      limits = {\n        left: -Infinity,\n        right: Infinity,\n        top: -Infinity,\n        bottom: Infinity,\n      },\n      offset = { x: 0, y: 0 },\n    } = grid\n\n    const result: SnapTarget & {\n      grid: typeof grid\n    } = { range, grid, x: null as number, y: null as number }\n\n    for (const [xField, yField] of coordFields) {\n      const gridx = Math.round((x - offset.x) / (grid as any)[xField])\n      const gridy = Math.round((y - offset.y) / (grid as any)[yField])\n\n      result[xField] = Math.max(limits.left, Math.min(limits.right, gridx * (grid as any)[xField] + offset.x))\n      result[yField] = Math.max(limits.top, Math.min(limits.bottom, gridy * (grid as any)[yField] + offset.y))\n    }\n\n    return result\n  }\n\n  gridFunc.grid = grid\n  gridFunc.coordFields = coordFields\n\n  return gridFunc\n}\n", "import type { Plugin } from '@interactjs/core/scope'\nimport extend from '@interactjs/utils/extend'\n\nimport * as allSnappers from './all'\n\ndeclare module '@interactjs/core/InteractStatic' {\n  export interface InteractStatic {\n    snappers: typeof allSnappers\n    createSnapGrid: typeof allSnappers.grid\n  }\n}\n\nconst snappersPlugin: Plugin = {\n  id: 'snappers',\n  install(scope) {\n    const { interactStatic: interact } = scope\n\n    interact.snappers = extend(interact.snappers || {}, allSnappers)\n    interact.createSnapGrid = interact.snappers.grid\n  },\n}\n\nexport default snappersPlugin\n", "/**\n * @module modifiers/aspectRatio\n *\n * @description\n * This modifier forces elements to be resized with a specified dx/dy ratio.\n *\n * ```js\n * interact(target).resizable({\n *   modifiers: [\n *     interact.modifiers.snapSize({\n *       targets: [ interact.snappers.grid({ x: 20, y: 20 }) ],\n *     }),\n *     interact.aspectRatio({ ratio: 'preserve' }),\n *   ],\n * });\n * ```\n */\n\nimport type { Point, Rect, EdgeOptions } from '@interactjs/core/types'\nimport extend from '@interactjs/utils/extend'\nimport { addEdges } from '@interactjs/utils/rect'\n\nimport { makeModifier } from './base'\nimport { Modification } from './Modification'\nimport type { Modifier, ModifierModule, ModifierState } from './types'\n\nexport interface AspectRatioOptions {\n  ratio?: number | 'preserve'\n  equalDelta?: boolean\n  modifiers?: Modifier[]\n  enabled?: boolean\n}\n\nexport type AspectRatioState = ModifierState<\n  AspectRatioOptions,\n  {\n    startCoords: Point\n    startRect: Rect\n    linkedEdges: EdgeOptions\n    ratio: number\n    equalDelta: boolean\n    xIsPrimaryAxis: boolean\n    edgeSign: {\n      x: number\n      y: number\n    }\n    subModification: Modification\n  }\n>\n\nconst aspectRatio: ModifierModule<AspectRatioOptions, AspectRatioState> = {\n  start(arg) {\n    const { state, rect, edges, pageCoords: coords } = arg\n    let { ratio, enabled } = state.options\n    const { equalDelta, modifiers } = state.options\n\n    if (ratio === 'preserve') {\n      ratio = rect.width / rect.height\n    }\n\n    state.startCoords = extend({}, coords)\n    state.startRect = extend({}, rect)\n    state.ratio = ratio\n    state.equalDelta = equalDelta\n\n    const linkedEdges = (state.linkedEdges = {\n      top: edges.top || (edges.left && !edges.bottom),\n      left: edges.left || (edges.top && !edges.right),\n      bottom: edges.bottom || (edges.right && !edges.top),\n      right: edges.right || (edges.bottom && !edges.left),\n    })\n\n    state.xIsPrimaryAxis = !!(edges.left || edges.right)\n\n    if (state.equalDelta) {\n      const sign = (linkedEdges.left ? 1 : -1) * (linkedEdges.top ? 1 : -1)\n      state.edgeSign = {\n        x: sign,\n        y: sign,\n      }\n    } else {\n      state.edgeSign = {\n        x: linkedEdges.left ? -1 : 1,\n        y: linkedEdges.top ? -1 : 1,\n      }\n    }\n\n    if (enabled !== false) {\n      extend(edges, linkedEdges)\n    }\n\n    if (!modifiers?.length) return\n\n    const subModification = new Modification(arg.interaction)\n\n    subModification.copyFrom(arg.interaction.modification)\n    subModification.prepareStates(modifiers)\n\n    state.subModification = subModification\n    subModification.startAll({ ...arg })\n  },\n\n  set(arg) {\n    const { state, rect, coords } = arg\n    const { linkedEdges } = state\n    const initialCoords = extend({}, coords)\n    const aspectMethod = state.equalDelta ? setEqualDelta : setRatio\n\n    extend(arg.edges, linkedEdges)\n    aspectMethod(state, state.xIsPrimaryAxis, coords, rect)\n\n    if (!state.subModification) {\n      return null\n    }\n\n    const correctedRect = extend({}, rect)\n\n    addEdges(linkedEdges, correctedRect, {\n      x: coords.x - initialCoords.x,\n      y: coords.y - initialCoords.y,\n    })\n\n    const result = state.subModification.setAll({\n      ...arg,\n      rect: correctedRect,\n      edges: linkedEdges,\n      pageCoords: coords,\n      prevCoords: coords,\n      prevRect: correctedRect,\n    })\n\n    const { delta } = result\n\n    if (result.changed) {\n      const xIsCriticalAxis = Math.abs(delta.x) > Math.abs(delta.y)\n\n      // do aspect modification again with critical edge axis as primary\n      aspectMethod(state, xIsCriticalAxis, result.coords, result.rect)\n      extend(coords, result.coords)\n    }\n\n    return result.eventProps\n  },\n\n  defaults: {\n    ratio: 'preserve',\n    equalDelta: false,\n    modifiers: [],\n    enabled: false,\n  },\n}\n\nfunction setEqualDelta({ startCoords, edgeSign }: AspectRatioState, xIsPrimaryAxis: boolean, coords: Point) {\n  if (xIsPrimaryAxis) {\n    coords.y = startCoords.y + (coords.x - startCoords.x) * edgeSign.y\n  } else {\n    coords.x = startCoords.x + (coords.y - startCoords.y) * edgeSign.x\n  }\n}\n\nfunction setRatio(\n  { startRect, startCoords, ratio, edgeSign }: AspectRatioState,\n  xIsPrimaryAxis: boolean,\n  coords: Point,\n  rect: Rect,\n) {\n  if (xIsPrimaryAxis) {\n    const newHeight = rect.width / ratio\n\n    coords.y = startCoords.y + (newHeight - startRect.height) * edgeSign.y\n  } else {\n    const newWidth = rect.height * ratio\n\n    coords.x = startCoords.x + (newWidth - startRect.width) * edgeSign.x\n  }\n}\n\nexport default makeModifier(aspectRatio, 'aspectRatio')\nexport { aspectRatio }\n", "import type { ModifierFunction } from './types'\n\nconst noop = (() => {}) as unknown as ModifierFunction<any, any, 'noop'>\n\nnoop._defaults = {}\n\nexport default noop\n", "import type Interaction from '@interactjs/core/Interaction'\nimport type { RectResolvable, Rect, Point } from '@interactjs/core/types'\nimport extend from '@interactjs/utils/extend'\nimport is from '@interactjs/utils/is'\nimport * as rectUtils from '@interactjs/utils/rect'\n\nimport { makeModifier } from '../base'\nimport type { ModifierArg, ModifierModule, ModifierState } from '../types'\n\nexport interface RestrictOptions {\n  // where to drag over\n  restriction: RectResolvable<[number, number, Interaction]>\n  // what part of self is allowed to drag over\n  elementRect: Rect\n  offset: Rect\n  // restrict just before the end drag\n  endOnly: boolean\n  enabled?: boolean\n}\n\nexport type RestrictState = ModifierState<\n  RestrictOptions,\n  {\n    offset: Rect\n  }\n>\n\nfunction start({ rect, startOffset, state, interaction, pageCoords }: ModifierArg<RestrictState>) {\n  const { options } = state\n  const { elementRect } = options\n  const offset: Rect = extend(\n    {\n      left: 0,\n      top: 0,\n      right: 0,\n      bottom: 0,\n    },\n    options.offset || {},\n  )\n\n  if (rect && elementRect) {\n    const restriction = getRestrictionRect(options.restriction, interaction, pageCoords)\n\n    if (restriction) {\n      const widthDiff = restriction.right - restriction.left - rect.width\n      const heightDiff = restriction.bottom - restriction.top - rect.height\n\n      if (widthDiff < 0) {\n        offset.left += widthDiff\n        offset.right += widthDiff\n      }\n      if (heightDiff < 0) {\n        offset.top += heightDiff\n        offset.bottom += heightDiff\n      }\n    }\n\n    offset.left += startOffset.left - rect.width * elementRect.left\n    offset.top += startOffset.top - rect.height * elementRect.top\n\n    offset.right += startOffset.right - rect.width * (1 - elementRect.right)\n    offset.bottom += startOffset.bottom - rect.height * (1 - elementRect.bottom)\n  }\n\n  state.offset = offset\n}\n\nfunction set({ coords, interaction, state }: ModifierArg<RestrictState>) {\n  const { options, offset } = state\n\n  const restriction = getRestrictionRect(options.restriction, interaction, coords)\n\n  if (!restriction) return\n\n  const rect = rectUtils.xywhToTlbr(restriction)\n\n  coords.x = Math.max(Math.min(rect.right - offset.right, coords.x), rect.left + offset.left)\n  coords.y = Math.max(Math.min(rect.bottom - offset.bottom, coords.y), rect.top + offset.top)\n}\n\nexport function getRestrictionRect(\n  value: RectResolvable<[number, number, Interaction]>,\n  interaction: Interaction,\n  coords?: Point,\n) {\n  if (is.func(value)) {\n    return rectUtils.resolveRectLike(value, interaction.interactable, interaction.element, [\n      coords.x,\n      coords.y,\n      interaction,\n    ])\n  } else {\n    return rectUtils.resolveRectLike(value, interaction.interactable, interaction.element)\n  }\n}\n\nconst defaults: RestrictOptions = {\n  restriction: null,\n  elementRect: null,\n  offset: null,\n  endOnly: false,\n  enabled: false,\n}\n\nconst restrict: ModifierModule<RestrictOptions, RestrictState> = {\n  start,\n  set,\n  defaults,\n}\n\nexport default makeModifier(restrict, 'restrict')\nexport { restrict }\n", "// This modifier adds the options.resize.restrictEdges setting which sets min and\n// max for the top, left, bottom and right edges of the target being resized.\n//\n// interact(target).resize({\n//   edges: { top: true, left: true },\n//   restrictEdges: {\n//     inner: { top: 200, left: 200, right: 400, bottom: 400 },\n//     outer: { top:   0, left:   0, right: 600, bottom: 600 },\n//   },\n// })\n\nimport type { Point, Rect } from '@interactjs/core/types'\nimport extend from '@interactjs/utils/extend'\nimport * as rectUtils from '@interactjs/utils/rect'\n\nimport { makeModifier } from '../base'\nimport type { ModifierArg, ModifierState } from '../types'\n\nimport type { RestrictOptions } from './pointer'\nimport { getRestrictionRect } from './pointer'\n\nexport interface RestrictEdgesOptions {\n  inner: RestrictOptions['restriction']\n  outer: RestrictOptions['restriction']\n  offset?: RestrictOptions['offset']\n  endOnly: boolean\n  enabled?: boolean\n}\n\nexport type RestrictEdgesState = ModifierState<\n  RestrictEdgesOptions,\n  {\n    inner: Rect\n    outer: Rect\n    offset: RestrictEdgesOptions['offset']\n  }\n>\n\nconst noInner = { top: +Infinity, left: +Infinity, bottom: -Infinity, right: -Infinity }\nconst noOuter = { top: -Infinity, left: -Infinity, bottom: +Infinity, right: +Infinity }\n\nfunction start({ interaction, startOffset, state }: ModifierArg<RestrictEdgesState>) {\n  const { options } = state\n  let offset: Point\n\n  if (options) {\n    const offsetRect = getRestrictionRect(options.offset, interaction, interaction.coords.start.page)\n\n    offset = rectUtils.rectToXY(offsetRect)\n  }\n\n  offset = offset || { x: 0, y: 0 }\n\n  state.offset = {\n    top: offset.y + startOffset.top,\n    left: offset.x + startOffset.left,\n    bottom: offset.y - startOffset.bottom,\n    right: offset.x - startOffset.right,\n  }\n}\n\nfunction set({ coords, edges, interaction, state }: ModifierArg<RestrictEdgesState>) {\n  const { offset, options } = state\n\n  if (!edges) {\n    return\n  }\n\n  const page = extend({}, coords)\n  const inner = getRestrictionRect(options.inner, interaction, page) || ({} as Rect)\n  const outer = getRestrictionRect(options.outer, interaction, page) || ({} as Rect)\n\n  fixRect(inner, noInner)\n  fixRect(outer, noOuter)\n\n  if (edges.top) {\n    coords.y = Math.min(Math.max(outer.top + offset.top, page.y), inner.top + offset.top)\n  } else if (edges.bottom) {\n    coords.y = Math.max(Math.min(outer.bottom + offset.bottom, page.y), inner.bottom + offset.bottom)\n  }\n  if (edges.left) {\n    coords.x = Math.min(Math.max(outer.left + offset.left, page.x), inner.left + offset.left)\n  } else if (edges.right) {\n    coords.x = Math.max(Math.min(outer.right + offset.right, page.x), inner.right + offset.right)\n  }\n}\n\nfunction fixRect(rect: Rect, defaults: Rect) {\n  for (const edge of ['top', 'left', 'bottom', 'right']) {\n    if (!(edge in rect)) {\n      rect[edge] = defaults[edge]\n    }\n  }\n\n  return rect\n}\n\nconst defaults: RestrictEdgesOptions = {\n  inner: null,\n  outer: null,\n  offset: null,\n  endOnly: false,\n  enabled: false,\n}\n\nconst restrictEdges = {\n  noInner,\n  noOuter,\n  start,\n  set,\n  defaults,\n}\n\nexport default makeModifier(restrictEdges, 'restrictEdges')\nexport { restrictEdges }\n", "import extend from '@interactjs/utils/extend'\n\nimport { makeModifier } from '../base'\n\nimport { restrict } from './pointer'\n\nconst defaults = extend(\n  {\n    get elementRect() {\n      return { top: 0, left: 0, bottom: 1, right: 1 }\n    },\n    set elementRect(_) {},\n  },\n  restrict.defaults,\n)\n\nconst restrictRect = {\n  start: restrict.start,\n  set: restrict.set,\n  defaults,\n}\n\nexport default makeModifier(restrictRect, 'restrictRect')\nexport { restrictRect }\n", "import type { Point, Rect, Size } from '@interactjs/core/types'\nimport extend from '@interactjs/utils/extend'\nimport * as rectUtils from '@interactjs/utils/rect'\n\nimport { makeModifier } from '../base'\nimport type { ModifierArg, ModifierState } from '../types'\n\nimport type { RestrictEdgesState } from './edges'\nimport { restrictEdges } from './edges'\nimport type { RestrictOptions } from './pointer'\nimport { getRestrictionRect } from './pointer'\n\nconst noMin = { width: -Infinity, height: -Infinity }\nconst noMax = { width: +Infinity, height: +Infinity }\n\nexport interface RestrictSizeOptions {\n  min?: Size | Point | RestrictOptions['restriction']\n  max?: Size | Point | RestrictOptions['restriction']\n  endOnly: boolean\n  enabled?: boolean\n}\n\nfunction start(arg: ModifierArg<RestrictEdgesState>) {\n  return restrictEdges.start(arg)\n}\n\nexport type RestrictSizeState = RestrictEdgesState &\n  ModifierState<\n    RestrictSizeOptions & { inner: Rect; outer: Rect },\n    {\n      min: Rect\n      max: Rect\n    }\n  >\n\nfunction set(arg: ModifierArg<RestrictSizeState>) {\n  const { interaction, state, rect, edges } = arg\n  const { options } = state\n\n  if (!edges) {\n    return\n  }\n\n  const minSize =\n    rectUtils.tlbrToXywh(getRestrictionRect(options.min as any, interaction, arg.coords)) || noMin\n  const maxSize =\n    rectUtils.tlbrToXywh(getRestrictionRect(options.max as any, interaction, arg.coords)) || noMax\n\n  state.options = {\n    endOnly: options.endOnly,\n    inner: extend({}, restrictEdges.noInner),\n    outer: extend({}, restrictEdges.noOuter),\n  }\n\n  if (edges.top) {\n    state.options.inner.top = rect.bottom - minSize.height\n    state.options.outer.top = rect.bottom - maxSize.height\n  } else if (edges.bottom) {\n    state.options.inner.bottom = rect.top + minSize.height\n    state.options.outer.bottom = rect.top + maxSize.height\n  }\n  if (edges.left) {\n    state.options.inner.left = rect.right - minSize.width\n    state.options.outer.left = rect.right - maxSize.width\n  } else if (edges.right) {\n    state.options.inner.right = rect.left + minSize.width\n    state.options.outer.right = rect.left + maxSize.width\n  }\n\n  restrictEdges.set(arg)\n\n  state.options = options\n}\n\nconst defaults: RestrictSizeOptions = {\n  min: null,\n  max: null,\n  endOnly: false,\n  enabled: false,\n}\n\nconst restrictSize = {\n  start,\n  set,\n  defaults,\n}\n\nexport default makeModifier(restrictSize, 'restrictSize')\nexport { restrictSize }\n", "import type { Interaction, InteractionProxy } from '@interactjs/core/Interaction'\nimport type { ActionName, Point, RectResolvable, Element } from '@interactjs/core/types'\nimport extend from '@interactjs/utils/extend'\nimport getOriginXY from '@interactjs/utils/getOriginXY'\nimport hypot from '@interactjs/utils/hypot'\nimport is from '@interactjs/utils/is'\nimport { resolveRectLike, rectToXY } from '@interactjs/utils/rect'\n\nimport { makeModifier } from '../base'\nimport type { ModifierArg, ModifierState } from '../types'\n\nexport interface Offset {\n  x: number\n  y: number\n  index: number\n  relativePoint?: Point | null\n}\n\nexport interface SnapPosition {\n  x?: number\n  y?: number\n  range?: number\n  offset?: Offset\n  [index: string]: any\n}\n\nexport type SnapFunction = (\n  x: number,\n  y: number,\n  interaction: InteractionProxy<ActionName>,\n  offset: Offset,\n  index: number,\n) => SnapPosition\nexport type SnapTarget = SnapPosition | SnapFunction\nexport interface SnapOptions {\n  targets?: SnapTarget[]\n  // target range\n  range?: number\n  // self points for snapping. [0,0] = top left, [1,1] = bottom right\n  relativePoints?: Point[]\n  // startCoords = offset snapping from drag start page position\n  offset?: Point | RectResolvable<[Interaction]> | 'startCoords'\n  offsetWithOrigin?: boolean\n  origin?: RectResolvable<[Element]> | Point\n  endOnly?: boolean\n  enabled?: boolean\n}\n\nexport type SnapState = ModifierState<\n  SnapOptions,\n  {\n    offsets?: Offset[]\n    closest?: any\n    targetFields?: string[][]\n  }\n>\n\nfunction start(arg: ModifierArg<SnapState>) {\n  const { interaction, interactable, element, rect, state, startOffset } = arg\n  const { options } = state\n  const origin = options.offsetWithOrigin ? getOrigin(arg) : { x: 0, y: 0 }\n\n  let snapOffset: Point\n\n  if (options.offset === 'startCoords') {\n    snapOffset = {\n      x: interaction.coords.start.page.x,\n      y: interaction.coords.start.page.y,\n    }\n  } else {\n    const offsetRect = resolveRectLike(options.offset as any, interactable, element, [interaction])\n\n    snapOffset = rectToXY(offsetRect) || { x: 0, y: 0 }\n    snapOffset.x += origin.x\n    snapOffset.y += origin.y\n  }\n\n  const { relativePoints } = options\n\n  state.offsets =\n    rect && relativePoints && relativePoints.length\n      ? relativePoints.map((relativePoint, index) => ({\n          index,\n          relativePoint,\n          x: startOffset.left - rect.width * relativePoint.x + snapOffset.x,\n          y: startOffset.top - rect.height * relativePoint.y + snapOffset.y,\n        }))\n      : [\n          {\n            index: 0,\n            relativePoint: null,\n            x: snapOffset.x,\n            y: snapOffset.y,\n          },\n        ]\n}\n\nfunction set(arg: ModifierArg<SnapState>) {\n  const { interaction, coords, state } = arg\n  const { options, offsets } = state\n\n  const origin = getOriginXY(interaction.interactable!, interaction.element!, interaction.prepared.name)\n  const page = extend({}, coords)\n  const targets: SnapPosition[] = []\n\n  if (!options.offsetWithOrigin) {\n    page.x -= origin.x\n    page.y -= origin.y\n  }\n\n  for (const offset of offsets!) {\n    const relativeX = page.x - offset.x\n    const relativeY = page.y - offset.y\n\n    for (let index = 0, len = options.targets!.length; index < len; index++) {\n      const snapTarget = options.targets![index]\n      let target: SnapPosition\n\n      if (is.func(snapTarget)) {\n        target = snapTarget(relativeX, relativeY, interaction._proxy, offset, index)\n      } else {\n        target = snapTarget\n      }\n\n      if (!target) {\n        continue\n      }\n\n      targets.push({\n        x: (is.number(target.x) ? target.x : relativeX) + offset.x,\n        y: (is.number(target.y) ? target.y : relativeY) + offset.y,\n\n        range: is.number(target.range) ? target.range : options.range,\n        source: snapTarget,\n        index,\n        offset,\n      })\n    }\n  }\n\n  const closest = {\n    target: null,\n    inRange: false,\n    distance: 0,\n    range: 0,\n    delta: { x: 0, y: 0 },\n  }\n\n  for (const target of targets) {\n    const range = target.range\n    const dx = target.x - page.x\n    const dy = target.y - page.y\n    const distance = hypot(dx, dy)\n    let inRange = distance <= range\n\n    // Infinite targets count as being out of range\n    // compared to non infinite ones that are in range\n    if (range === Infinity && closest.inRange && closest.range !== Infinity) {\n      inRange = false\n    }\n\n    if (\n      !closest.target ||\n      (inRange\n        ? // is the closest target in range?\n          closest.inRange && range !== Infinity\n          ? // the pointer is relatively deeper in this target\n            distance / range < closest.distance / closest.range\n          : // this target has Infinite range and the closest doesn't\n            (range === Infinity && closest.range !== Infinity) ||\n            // OR this target is closer that the previous closest\n            distance < closest.distance\n        : // The other is not in range and the pointer is closer to this target\n          !closest.inRange && distance < closest.distance)\n    ) {\n      closest.target = target\n      closest.distance = distance\n      closest.range = range\n      closest.inRange = inRange\n      closest.delta.x = dx\n      closest.delta.y = dy\n    }\n  }\n\n  if (closest.inRange) {\n    coords.x = closest.target.x\n    coords.y = closest.target.y\n  }\n\n  state.closest = closest\n  return closest\n}\n\nfunction getOrigin(arg: Partial<ModifierArg<SnapState>>) {\n  const { element } = arg.interaction\n  const optionsOrigin = rectToXY(resolveRectLike(arg.state.options.origin as any, null, null, [element]))\n  const origin = optionsOrigin || getOriginXY(arg.interactable, element, arg.interaction.prepared.name)\n\n  return origin\n}\n\nconst defaults: SnapOptions = {\n  range: Infinity,\n  targets: null,\n  offset: null,\n  offsetWithOrigin: true,\n  origin: null,\n  relativePoints: null,\n  endOnly: false,\n  enabled: false,\n}\nconst snap = {\n  start,\n  set,\n  defaults,\n}\n\nexport default makeModifier(snap, 'snap')\nexport { snap }\n", "// This modifier allows snapping of the size of targets during resize\n// interactions.\n\nimport extend from '@interactjs/utils/extend'\nimport is from '@interactjs/utils/is'\n\nimport { makeModifier } from '../base'\nimport type { ModifierArg } from '../types'\n\nimport type { SnapOptions, SnapState } from './pointer'\nimport { snap } from './pointer'\n\nexport type SnapSizeOptions = Pick<SnapOptions, 'targets' | 'offset' | 'endOnly' | 'range' | 'enabled'>\n\nfunction start(arg: ModifierArg<SnapState>) {\n  const { state, edges } = arg\n  const { options } = state\n\n  if (!edges) {\n    return null\n  }\n\n  arg.state = {\n    options: {\n      targets: null,\n      relativePoints: [\n        {\n          x: edges.left ? 0 : 1,\n          y: edges.top ? 0 : 1,\n        },\n      ],\n      offset: options.offset || 'self',\n      origin: { x: 0, y: 0 },\n      range: options.range,\n    },\n  }\n\n  state.targetFields = state.targetFields || [\n    ['width', 'height'],\n    ['x', 'y'],\n  ]\n\n  snap.start(arg)\n  state.offsets = arg.state.offsets\n\n  arg.state = state\n}\n\nfunction set(arg) {\n  const { interaction, state, coords } = arg\n  const { options, offsets } = state\n  const relative = {\n    x: coords.x - offsets[0].x,\n    y: coords.y - offsets[0].y,\n  }\n\n  state.options = extend({}, options)\n  state.options.targets = []\n\n  for (const snapTarget of options.targets || []) {\n    let target\n\n    if (is.func(snapTarget)) {\n      target = snapTarget(relative.x, relative.y, interaction)\n    } else {\n      target = snapTarget\n    }\n\n    if (!target) {\n      continue\n    }\n\n    for (const [xField, yField] of state.targetFields) {\n      if (xField in target || yField in target) {\n        target.x = target[xField]\n        target.y = target[yField]\n\n        break\n      }\n    }\n\n    state.options.targets.push(target)\n  }\n\n  const returnValue = snap.set(arg)\n\n  state.options = options\n\n  return returnValue\n}\n\nconst defaults: SnapSizeOptions = {\n  range: Infinity,\n  targets: null,\n  offset: null,\n  endOnly: false,\n  enabled: false,\n}\n\nconst snapSize = {\n  start,\n  set,\n  defaults,\n}\n\nexport default makeModifier(snapSize, 'snapSize')\nexport { snapSize }\n", "/**\n * @module modifiers/snapEdges\n *\n * @description\n * This modifier allows snapping of the edges of targets during resize\n * interactions.\n *\n * ```js\n * interact(target).resizable({\n *   snapEdges: {\n *     targets: [interact.snappers.grid({ x: 100, y: 50 })],\n *   },\n * })\n *\n * interact(target).resizable({\n *   snapEdges: {\n *     targets: [\n *       interact.snappers.grid({\n *        top: 50,\n *        left: 50,\n *        bottom: 100,\n *        right: 100,\n *       }),\n *     ],\n *   },\n * })\n * ```\n */\n\nimport clone from '@interactjs/utils/clone'\nimport extend from '@interactjs/utils/extend'\n\nimport { makeModifier } from '../base'\nimport type { ModifierArg, ModifierModule } from '../types'\n\nimport type { SnapOptions, SnapState } from './pointer'\nimport { snapSize } from './size'\n\nexport type SnapEdgesOptions = Pick<SnapOptions, 'targets' | 'range' | 'offset' | 'endOnly' | 'enabled'>\n\nfunction start(arg: ModifierArg<SnapState>) {\n  const { edges } = arg\n\n  if (!edges) {\n    return null\n  }\n\n  arg.state.targetFields = arg.state.targetFields || [\n    [edges.left ? 'left' : 'right', edges.top ? 'top' : 'bottom'],\n  ]\n\n  return snapSize.start(arg)\n}\n\nconst snapEdges: ModifierModule<SnapEdgesOptions, SnapState, ReturnType<typeof snapSize.set>> = {\n  start,\n  set: snapSize.set,\n  defaults: extend(clone(snapSize.defaults), {\n    targets: undefined,\n    range: undefined,\n    offset: { x: 0, y: 0 },\n  } as const),\n}\n\nexport default makeModifier(snapEdges, 'snapEdges')\nexport { snapEdges }\n", "/* eslint-disable n/no-extraneous-import, import/no-unresolved */\nimport aspectRatio from './aspectRatio'\nimport avoid from './avoid/avoid'\nimport restrictEdges from './restrict/edges'\nimport restrict from './restrict/pointer'\nimport restrictRect from './restrict/rect'\nimport restrictSize from './restrict/size'\nimport rubberband from './rubberband/rubberband'\nimport snapEdges from './snap/edges'\nimport snap from './snap/pointer'\nimport snapSize from './snap/size'\nimport spring from './spring/spring'\nimport transform from './transform/transform'\n\nexport default {\n  aspectRatio,\n  restrictEdges,\n  restrict,\n  restrictRect,\n  restrictSize,\n  snapEdges,\n  snap,\n  snapSize,\n\n  spring,\n  avoid,\n  transform,\n  rubberband,\n}\n", "import type { Plugin } from '@interactjs/core/scope'\nimport snappers from '@interactjs/snappers/plugin'\n\n/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport './all'\nimport './base'\n\nimport all from './all'\nimport base from './base'\n/* eslint-enable import/no-duplicates */\n\ndeclare module '@interactjs/core/InteractStatic' {\n  export interface InteractStatic {\n    modifiers: typeof all\n  }\n}\n\nconst modifiers: Plugin = {\n  id: 'modifiers',\n  install(scope) {\n    const { interactStatic: interact } = scope\n\n    scope.usePlugin(base)\n    scope.usePlugin(snappers)\n\n    interact.modifiers = all\n\n    // for backwrads compatibility\n    for (const type in all) {\n      const { _defaults, _methods } = all[type as keyof typeof all]\n\n      ;(_defaults as any)._methods = _methods\n      ;(scope.defaults.perAction as any)[type] = _defaults\n    }\n  },\n}\n\nexport default modifiers\n", "import { BaseEvent } from '@interactjs/core/BaseEvent'\nimport type Interaction from '@interactjs/core/Interaction'\nimport type { PointerEventType, PointerType, Point } from '@interactjs/core/types'\nimport * as pointerUtils from '@interactjs/utils/pointerUtils'\n\nexport class PointerEvent<T extends string = any> extends BaseEvent<never> {\n  declare type: T\n  declare originalEvent: PointerEventType\n  declare pointerId: number\n  declare pointerType: string\n  declare double: boolean\n  declare pageX: number\n  declare pageY: number\n  declare clientX: number\n  declare clientY: number\n  declare dt: number\n  declare eventable: any;\n  [key: string]: any\n\n  constructor(\n    type: T,\n    pointer: PointerType | PointerEvent<any>,\n    event: PointerEventType,\n    eventTarget: Node,\n    interaction: Interaction<never>,\n    timeStamp: number,\n  ) {\n    super(interaction)\n    pointerUtils.pointerExtend(this, event)\n\n    if (event !== pointer) {\n      pointerUtils.pointerExtend(this, pointer)\n    }\n\n    this.timeStamp = timeStamp\n    this.originalEvent = event\n    this.type = type\n    this.pointerId = pointerUtils.getPointerId(pointer)\n    this.pointerType = pointerUtils.getPointerType(pointer)\n    this.target = eventTarget\n    this.currentTarget = null\n\n    if (type === 'tap') {\n      const pointerIndex = interaction.getPointerIndex(pointer)\n      this.dt = this.timeStamp - interaction.pointers[pointerIndex].downTime\n\n      const interval = this.timeStamp - interaction.tapTime\n\n      this.double =\n        !!interaction.prevTap &&\n        interaction.prevTap.type !== 'doubletap' &&\n        interaction.prevTap.target === this.target &&\n        interval < 500\n    } else if (type === 'doubletap') {\n      this.dt = (pointer as PointerEvent<'tap'>).timeStamp - interaction.tapTime\n      this.double = true\n    }\n  }\n\n  _subtractOrigin({ x: originX, y: originY }: Point) {\n    this.pageX -= originX\n    this.pageY -= originY\n    this.clientX -= originX\n    this.clientY -= originY\n\n    return this\n  }\n\n  _addOrigin({ x: originX, y: originY }: Point) {\n    this.pageX += originX\n    this.pageY += originY\n    this.clientX += originX\n    this.clientY += originY\n\n    return this\n  }\n\n  /**\n   * Prevent the default behaviour of the original Event\n   */\n  preventDefault() {\n    this.originalEvent.preventDefault()\n  }\n}\n", "import type { Eventable } from '@interactjs/core/Eventable'\nimport type { Interaction } from '@interactjs/core/Interaction'\nimport type { PerActionDefaults } from '@interactjs/core/options'\nimport type { Scope, SignalArgs, Plugin } from '@interactjs/core/scope'\nimport type { Point, PointerType, PointerEventType, Element } from '@interactjs/core/types'\nimport * as domUtils from '@interactjs/utils/domUtils'\nimport extend from '@interactjs/utils/extend'\nimport getOriginXY from '@interactjs/utils/getOriginXY'\n\nimport { PointerEvent } from './PointerEvent'\n\nexport type EventTargetList = Array<{\n  node: Node\n  eventable: Eventable\n  props: { [key: string]: any }\n}>\n\nexport interface PointerEventOptions extends PerActionDefaults {\n  enabled?: undefined // not used\n  holdDuration?: number\n  ignoreFrom?: any\n  allowFrom?: any\n  origin?: Point | string | Element\n}\n\ndeclare module '@interactjs/core/scope' {\n  interface Scope {\n    pointerEvents: typeof pointerEvents\n  }\n}\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction {\n    prevTap?: PointerEvent<string>\n    tapTime?: number\n  }\n}\n\ndeclare module '@interactjs/core/PointerInfo' {\n  interface PointerInfo {\n    hold?: {\n      duration: number\n      timeout: any\n    }\n  }\n}\n\ndeclare module '@interactjs/core/options' {\n  interface ActionDefaults {\n    pointerEvents: Options\n  }\n}\n\ndeclare module '@interactjs/core/scope' {\n  interface SignalArgs {\n    'pointerEvents:new': { pointerEvent: PointerEvent<any> }\n    'pointerEvents:fired': {\n      interaction: Interaction<null>\n      pointer: PointerType | PointerEvent<any>\n      event: PointerEventType | PointerEvent<any>\n      eventTarget: Node\n      pointerEvent: PointerEvent<any>\n      targets?: EventTargetList\n      type: string\n    }\n    'pointerEvents:collect-targets': {\n      interaction: Interaction<any>\n      pointer: PointerType | PointerEvent<any>\n      event: PointerEventType | PointerEvent<any>\n      eventTarget: Node\n      targets?: EventTargetList\n      type: string\n      path: Node[]\n      node: null\n    }\n  }\n}\n\nconst defaults: PointerEventOptions = {\n  holdDuration: 600,\n  ignoreFrom: null,\n  allowFrom: null,\n  origin: { x: 0, y: 0 },\n}\n\nconst pointerEvents: Plugin = {\n  id: 'pointer-events/base',\n  before: ['inertia', 'modifiers', 'auto-start', 'actions'],\n  install,\n  listeners: {\n    'interactions:new': addInteractionProps,\n    'interactions:update-pointer': addHoldInfo,\n    'interactions:move': moveAndClearHold,\n    'interactions:down': (arg, scope) => {\n      downAndStartHold(arg, scope)\n      fire(arg, scope)\n    },\n    'interactions:up': (arg, scope) => {\n      clearHold(arg)\n      fire(arg, scope)\n      tapAfterUp(arg, scope)\n    },\n    'interactions:cancel': (arg, scope) => {\n      clearHold(arg)\n      fire(arg, scope)\n    },\n  },\n  PointerEvent,\n  fire,\n  collectEventTargets,\n  defaults,\n  types: {\n    down: true,\n    move: true,\n    up: true,\n    cancel: true,\n    tap: true,\n    doubletap: true,\n    hold: true,\n  } as { [type: string]: true },\n}\n\nfunction fire<T extends string>(\n  arg: {\n    pointer: PointerType | PointerEvent<any>\n    event: PointerEventType | PointerEvent<any>\n    eventTarget: Node\n    interaction: Interaction<never>\n    type: T\n    targets?: EventTargetList\n  },\n  scope: Scope,\n) {\n  const { interaction, pointer, event, eventTarget, type, targets = collectEventTargets(arg, scope) } = arg\n\n  const pointerEvent = new PointerEvent(type, pointer, event, eventTarget, interaction, scope.now())\n\n  scope.fire('pointerEvents:new', { pointerEvent })\n\n  const signalArg = {\n    interaction,\n    pointer,\n    event,\n    eventTarget,\n    targets,\n    type,\n    pointerEvent,\n  }\n\n  for (let i = 0; i < targets.length; i++) {\n    const target = targets[i]\n\n    for (const prop in target.props || {}) {\n      ;(pointerEvent as any)[prop] = target.props[prop]\n    }\n\n    const origin = getOriginXY(target.eventable, target.node)\n\n    pointerEvent._subtractOrigin(origin)\n    pointerEvent.eventable = target.eventable\n    pointerEvent.currentTarget = target.node\n\n    target.eventable.fire(pointerEvent)\n\n    pointerEvent._addOrigin(origin)\n\n    if (\n      pointerEvent.immediatePropagationStopped ||\n      (pointerEvent.propagationStopped &&\n        i + 1 < targets.length &&\n        targets[i + 1].node !== pointerEvent.currentTarget)\n    ) {\n      break\n    }\n  }\n\n  scope.fire('pointerEvents:fired', signalArg)\n\n  if (type === 'tap') {\n    // if pointerEvent should make a double tap, create and fire a doubletap\n    // PointerEvent and use that as the prevTap\n    const prevTap = pointerEvent.double\n      ? fire(\n          {\n            interaction,\n            pointer,\n            event,\n            eventTarget,\n            type: 'doubletap',\n          },\n          scope,\n        )\n      : pointerEvent\n\n    interaction.prevTap = prevTap\n    interaction.tapTime = prevTap.timeStamp\n  }\n\n  return pointerEvent\n}\n\nfunction collectEventTargets<T extends string>(\n  {\n    interaction,\n    pointer,\n    event,\n    eventTarget,\n    type,\n  }: {\n    interaction: Interaction<any>\n    pointer: PointerType | PointerEvent<any>\n    event: PointerEventType | PointerEvent<any>\n    eventTarget: Node\n    type: T\n  },\n  scope: Scope,\n) {\n  const pointerIndex = interaction.getPointerIndex(pointer)\n  const pointerInfo = interaction.pointers[pointerIndex]\n\n  // do not fire a tap event if the pointer was moved before being lifted\n  if (\n    type === 'tap' &&\n    (interaction.pointerWasMoved ||\n      // or if the pointerup target is different to the pointerdown target\n      !(pointerInfo && pointerInfo.downTarget === eventTarget))\n  ) {\n    return []\n  }\n\n  const path = domUtils.getPath(eventTarget as Element | Document)\n  const signalArg = {\n    interaction,\n    pointer,\n    event,\n    eventTarget,\n    type,\n    path,\n    targets: [] as EventTargetList,\n    node: null,\n  }\n\n  for (const node of path) {\n    signalArg.node = node\n\n    scope.fire('pointerEvents:collect-targets', signalArg)\n  }\n\n  if (type === 'hold') {\n    signalArg.targets = signalArg.targets.filter(\n      (target) =>\n        target.eventable.options.holdDuration === interaction.pointers[pointerIndex]?.hold?.duration,\n    )\n  }\n\n  return signalArg.targets\n}\n\nfunction addInteractionProps({ interaction }) {\n  interaction.prevTap = null // the most recent tap event on this interaction\n  interaction.tapTime = 0 // time of the most recent tap event\n}\n\nfunction addHoldInfo({ down, pointerInfo }: SignalArgs['interactions:update-pointer']) {\n  if (!down && pointerInfo.hold) {\n    return\n  }\n\n  pointerInfo.hold = { duration: Infinity, timeout: null }\n}\n\nfunction clearHold({ interaction, pointerIndex }) {\n  const hold = interaction.pointers[pointerIndex].hold\n\n  if (hold && hold.timeout) {\n    clearTimeout(hold.timeout)\n    hold.timeout = null\n  }\n}\n\nfunction moveAndClearHold(arg: SignalArgs['interactions:move'], scope: Scope) {\n  const { interaction, pointer, event, eventTarget, duplicate } = arg\n\n  if (!duplicate && (!interaction.pointerIsDown || interaction.pointerWasMoved)) {\n    if (interaction.pointerIsDown) {\n      clearHold(arg)\n    }\n\n    fire(\n      {\n        interaction,\n        pointer,\n        event,\n        eventTarget: eventTarget as Element,\n        type: 'move',\n      },\n      scope,\n    )\n  }\n}\n\nfunction downAndStartHold(\n  { interaction, pointer, event, eventTarget, pointerIndex }: SignalArgs['interactions:down'],\n  scope: Scope,\n) {\n  const timer = interaction.pointers[pointerIndex].hold!\n  const path = domUtils.getPath(eventTarget as Element | Document)\n  const signalArg = {\n    interaction,\n    pointer,\n    event,\n    eventTarget,\n    type: 'hold',\n    targets: [] as EventTargetList,\n    path,\n    node: null,\n  }\n\n  for (const node of path) {\n    signalArg.node = node\n\n    scope.fire('pointerEvents:collect-targets', signalArg)\n  }\n\n  if (!signalArg.targets.length) return\n\n  let minDuration = Infinity\n\n  for (const target of signalArg.targets) {\n    const holdDuration = target.eventable.options.holdDuration\n\n    if (holdDuration < minDuration) {\n      minDuration = holdDuration\n    }\n  }\n\n  timer.duration = minDuration\n  timer.timeout = setTimeout(() => {\n    fire(\n      {\n        interaction,\n        eventTarget,\n        pointer,\n        event,\n        type: 'hold',\n      },\n      scope,\n    )\n  }, minDuration)\n}\n\nfunction tapAfterUp(\n  { interaction, pointer, event, eventTarget }: SignalArgs['interactions:up'],\n  scope: Scope,\n) {\n  if (!interaction.pointerWasMoved) {\n    fire({ interaction, eventTarget, pointer, event, type: 'tap' }, scope)\n  }\n}\n\nfunction install(scope: Scope) {\n  scope.pointerEvents = pointerEvents\n  scope.defaults.actions.pointerEvents = pointerEvents.defaults\n  extend(scope.actions.phaselessTypes, pointerEvents.types)\n}\n\nexport default pointerEvents\n", "import type Interaction from '@interactjs/core/Interaction'\nimport type { ListenerMap, Scope, SignalArgs, Plugin } from '@interactjs/core/scope'\n\n/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport './base'\nimport basePlugin from './base'\n/* eslint-enable import/no-duplicates */\nimport { type PointerEvent } from './PointerEvent'\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction {\n    holdIntervalHandle?: any\n  }\n}\n\ndeclare module '@interactjs/pointer-events/PointerEvent' {\n  interface PointerEvent<T extends string = any> {\n    count?: number\n  }\n}\n\ndeclare module '@interactjs/pointer-events/base' {\n  interface PointerEventOptions {\n    holdRepeatInterval?: number\n  }\n}\n\nfunction install(scope: Scope) {\n  scope.usePlugin(basePlugin)\n\n  const { pointerEvents } = scope\n\n  // don't repeat by default\n  pointerEvents.defaults.holdRepeatInterval = 0\n  pointerEvents.types.holdrepeat = scope.actions.phaselessTypes.holdrepeat = true\n}\n\nfunction onNew({ pointerEvent }: { pointerEvent: PointerEvent<any> }) {\n  if (pointerEvent.type !== 'hold') return\n\n  pointerEvent.count = (pointerEvent.count || 0) + 1\n}\n\nfunction onFired(\n  { interaction, pointerEvent, eventTarget, targets }: SignalArgs['pointerEvents:fired'],\n  scope: Scope,\n) {\n  if (pointerEvent.type !== 'hold' || !targets.length) return\n\n  // get the repeat interval from the first eventable\n  const interval = targets[0].eventable.options.holdRepeatInterval\n\n  // don't repeat if the interval is 0 or less\n  if (interval <= 0) return\n\n  // set a timeout to fire the holdrepeat event\n  interaction.holdIntervalHandle = setTimeout(() => {\n    scope.pointerEvents.fire(\n      {\n        interaction,\n        eventTarget,\n        type: 'hold',\n        pointer: pointerEvent,\n        event: pointerEvent,\n      },\n      scope,\n    )\n  }, interval)\n}\n\nfunction endHoldRepeat({ interaction }: { interaction: Interaction }) {\n  // set the interaction's holdStopTime property\n  // to stop further holdRepeat events\n  if (interaction.holdIntervalHandle) {\n    clearInterval(interaction.holdIntervalHandle)\n    interaction.holdIntervalHandle = null\n  }\n}\n\nconst holdRepeat: Plugin = {\n  id: 'pointer-events/holdRepeat',\n  install,\n  listeners: ['move', 'up', 'cancel', 'endall'].reduce(\n    (acc, enderTypes) => {\n      ;(acc as any)[`pointerEvents:${enderTypes}`] = endHoldRepeat\n      return acc\n    },\n    {\n      'pointerEvents:new': onNew,\n      'pointerEvents:fired': onFired,\n    } as ListenerMap,\n  ),\n}\n\nexport default holdRepeat\n", "import type { Interactable } from '@interactjs/core/Interactable'\nimport type { Scope, Plugin } from '@interactjs/core/scope'\nimport type { Element } from '@interactjs/core/types'\nimport extend from '@interactjs/utils/extend'\n\nimport type { PointerEventOptions } from '@interactjs/pointer-events/base'\n\ndeclare module '@interactjs/core/Interactable' {\n  interface Interactable {\n    pointerEvents(options: Partial<PointerEventOptions>): this\n    /** @internal */\n    __backCompatOption: (optionName: string, newValue: any) => any\n  }\n}\n\nfunction install(scope: Scope) {\n  const { Interactable } = scope\n\n  Interactable.prototype.pointerEvents = function (\n    this: Interactable,\n    options: Partial<PointerEventOptions>,\n  ) {\n    extend(this.events.options, options)\n\n    return this\n  }\n\n  const __backCompatOption = Interactable.prototype._backCompatOption\n\n  Interactable.prototype._backCompatOption = function (optionName, newValue) {\n    const ret = __backCompatOption.call(this, optionName, newValue)\n\n    if (ret === this) {\n      this.events.options[optionName] = newValue\n    }\n\n    return ret\n  }\n}\n\nconst plugin: Plugin = {\n  id: 'pointer-events/interactableTargets',\n  install,\n  listeners: {\n    'pointerEvents:collect-targets': ({ targets, node, type, eventTarget }, scope) => {\n      scope.interactables.forEachMatch(node, (interactable: Interactable) => {\n        const eventable = interactable.events\n        const options = eventable.options\n\n        if (\n          eventable.types[type] &&\n          eventable.types[type].length &&\n          interactable.testIgnoreAllow(options, node, eventTarget)\n        ) {\n          targets.push({\n            node,\n            eventable,\n            props: { interactable },\n          })\n        }\n      })\n    },\n\n    'interactable:new': ({ interactable }) => {\n      interactable.events.getRect = function (element: Element) {\n        return interactable.getRect(element)\n      }\n    },\n\n    'interactable:set': ({ interactable, options }, scope) => {\n      extend(interactable.events.options, scope.pointerEvents.defaults)\n      extend(interactable.events.options, options.pointerEvents || {})\n    },\n  },\n}\n\nexport default plugin\n", "import type { Plugin } from '@interactjs/core/scope'\n\n/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport './base'\nimport './holdRepeat'\nimport './interactableTargets'\n\nimport * as pointerEvents from './base'\nimport holdRepeat from './holdRepeat'\nimport interactableTargets from './interactableTargets'\n/* eslint-enable import/no-duplicates */\n\nconst plugin: Plugin = {\n  id: 'pointer-events',\n  install(scope) {\n    scope.usePlugin(pointerEvents)\n    scope.usePlugin(holdRepeat)\n    scope.usePlugin(interactableTargets)\n  },\n}\n\nexport default plugin\n", "import type { Interactable } from '@interactjs/core/Interactable'\nimport type { DoAnyPhaseArg, Interaction } from '@interactjs/core/Interaction'\nimport type { Scope, Plugin } from '@interactjs/core/scope'\nimport type { ActionName, ActionProps, Element } from '@interactjs/core/types'\nimport * as arr from '@interactjs/utils/arr'\nimport { copyAction } from '@interactjs/utils/misc'\nimport * as pointerUtils from '@interactjs/utils/pointerUtils'\nimport { tlbrToXywh } from '@interactjs/utils/rect'\n\ndeclare module '@interactjs/core/scope' {\n  interface SignalArgs {\n    'interactions:before-action-reflow': Omit<DoAnyPhaseArg, 'iEvent'>\n    'interactions:action-reflow': DoAnyPhaseArg\n    'interactions:after-action-reflow': DoAnyPhaseArg\n  }\n}\n\ndeclare module '@interactjs/core/Interactable' {\n  interface Interactable {\n    /**\n     * ```js\n     * const interactable = interact(target)\n     * const drag = { name: drag, axis: 'x' }\n     * const resize = { name: resize, edges: { left: true, bottom: true }\n     *\n     * interactable.reflow(drag)\n     * interactable.reflow(resize)\n     * ```\n     *\n     * Start an action sequence to re-apply modifiers, check drops, etc.\n     *\n     * @param { Object } action The action to begin\n     * @param { string } action.name The name of the action\n     * @returns { Promise } A promise that resolves to the `Interactable` when actions on all targets have ended\n     */\n    reflow<T extends ActionName>(action: ActionProps<T>): ReturnType<typeof doReflow>\n  }\n}\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction {\n    _reflowPromise: Promise<void>\n    _reflowResolve: (...args: unknown[]) => void\n  }\n}\n\ndeclare module '@interactjs/core/InteractEvent' {\n  interface PhaseMap {\n    reflow?: true\n  }\n}\n\nfunction install(scope: Scope) {\n  const { Interactable } = scope\n\n  scope.actions.phases.reflow = true\n\n  Interactable.prototype.reflow = function (action: ActionProps) {\n    return doReflow(this, action, scope)\n  }\n}\n\nfunction doReflow<T extends ActionName>(\n  interactable: Interactable,\n  action: ActionProps<T>,\n  scope: Scope,\n): Promise<Interactable> {\n  const elements = interactable.getAllElements()\n\n  // tslint:disable-next-line variable-name\n  const Promise = (scope.window as any).Promise\n  const promises: Array<Promise<null>> | null = Promise ? [] : null\n\n  for (const element of elements) {\n    const rect = interactable.getRect(element as HTMLElement | SVGElement)\n\n    if (!rect) {\n      break\n    }\n\n    const runningInteraction = arr.find(scope.interactions.list, (interaction: Interaction) => {\n      return (\n        interaction.interacting() &&\n        interaction.interactable === interactable &&\n        interaction.element === element &&\n        interaction.prepared.name === action.name\n      )\n    })\n    let reflowPromise: Promise<null>\n\n    if (runningInteraction) {\n      runningInteraction.move()\n\n      if (promises) {\n        reflowPromise =\n          runningInteraction._reflowPromise ||\n          new Promise((resolve: any) => {\n            runningInteraction._reflowResolve = resolve\n          })\n      }\n    } else {\n      const xywh = tlbrToXywh(rect)\n      const coords = {\n        page: { x: xywh.x, y: xywh.y },\n        client: { x: xywh.x, y: xywh.y },\n        timeStamp: scope.now(),\n      }\n\n      const event = pointerUtils.coordsToEvent(coords)\n      reflowPromise = startReflow<T>(scope, interactable, element, action, event)\n    }\n\n    if (promises) {\n      promises.push(reflowPromise)\n    }\n  }\n\n  return promises && Promise.all(promises).then(() => interactable)\n}\n\nfunction startReflow<T extends ActionName>(\n  scope: Scope,\n  interactable: Interactable,\n  element: Element,\n  action: ActionProps<T>,\n  event: any,\n) {\n  const interaction = scope.interactions.new({ pointerType: 'reflow' })\n  const signalArg = {\n    interaction,\n    event,\n    pointer: event,\n    eventTarget: element,\n    phase: 'reflow',\n  } as const\n\n  interaction.interactable = interactable\n  interaction.element = element\n  interaction.prevEvent = event\n  interaction.updatePointer(event, event, element, true)\n  pointerUtils.setZeroCoords(interaction.coords.delta)\n\n  copyAction(interaction.prepared, action)\n  interaction._doPhase(signalArg)\n\n  const { Promise } = scope.window as unknown as { Promise: PromiseConstructor }\n  const reflowPromise = Promise\n    ? new Promise<undefined>((resolve) => {\n        interaction._reflowResolve = resolve\n      })\n    : undefined\n\n  interaction._reflowPromise = reflowPromise\n  interaction.start(action, interactable, element)\n\n  if (interaction._interacting) {\n    interaction.move(signalArg)\n    interaction.end(event)\n  } else {\n    interaction.stop()\n    interaction._reflowResolve()\n  }\n\n  interaction.removePointer(event, event)\n\n  return reflowPromise\n}\n\nconst reflow: Plugin = {\n  id: 'reflow',\n  install,\n  listeners: {\n    // remove completed reflow interactions\n    'interactions:stop': ({ interaction }, scope) => {\n      if (interaction.pointerType === 'reflow') {\n        if (interaction._reflowResolve) {\n          interaction._reflowResolve()\n        }\n\n        arr.remove(scope.interactions.list, interaction)\n      }\n    },\n  },\n}\n\nexport default reflow\n", "// eslint-disable-next-line import/no-extraneous-dependencies\nimport interact from '@interactjs/interactjs'\n\nexport default interact\n\nif (typeof module === 'object' && !!module) {\n  try {\n    module.exports = interact\n  } catch {}\n}\n\n;(interact as any).default = interact\n", "/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport '@interactjs/actions/plugin'\nimport '@interactjs/auto-scroll/plugin'\nimport '@interactjs/auto-start/plugin'\nimport '@interactjs/core/interactablePreventDefault'\nimport '@interactjs/dev-tools/plugin'\nimport '@interactjs/inertia/plugin'\nimport '@interactjs/interact'\nimport '@interactjs/modifiers/plugin'\nimport '@interactjs/offset/plugin'\nimport '@interactjs/pointer-events/plugin'\nimport '@interactjs/reflow/plugin'\n\nimport actions from '@interactjs/actions/plugin'\nimport autoScroll from '@interactjs/auto-scroll/plugin'\nimport autoStart from '@interactjs/auto-start/plugin'\nimport interactablePreventDefault from '@interactjs/core/interactablePreventDefault'\nimport devTools from '@interactjs/dev-tools/plugin'\nimport inertia from '@interactjs/inertia/plugin'\nimport interact from '@interactjs/interact'\nimport modifiers from '@interactjs/modifiers/plugin'\nimport offset from '@interactjs/offset/plugin'\nimport pointerEvents from '@interactjs/pointer-events/plugin'\nimport reflow from '@interactjs/reflow/plugin'\n/* eslint-enable import/no-duplicates */\n\ninteract.use(interactablePreventDefault)\n\ninteract.use(offset)\n\n// pointerEvents\ninteract.use(pointerEvents)\n\n// inertia\ninteract.use(inertia)\n\n// snap, resize, etc.\ninteract.use(modifiers)\n\n// autoStart, hold\ninteract.use(autoStart)\n\n// drag and drop, resize, gesture\ninteract.use(actions)\n\n// autoScroll\ninteract.use(autoScroll)\n\n// reflow\ninteract.use(reflow)\n\n// eslint-disable-next-line no-undef\nif (process.env.NODE_ENV !== 'production') {\n  interact.use(devTools)\n}\n\nexport default interact\n;(interact as any).default = interact\n", "/*!\n * Drag & Drop Card (Proprietary)\n * Copyright (c) 2025 <SMARTI AS>\n * Use is governed by EULA.md. Third-party notices: THIRD_PARTY_NOTICES.md\n */\n\n\n// \u2014 bundle-time imports so we don't rely on CDNs in HACS installs \u2014\nimport interact from 'interactjs';\nimport jsyaml from 'js-yaml';\n\n// expose for your existing code that checks window.interact/jsyaml\nif (!window.interact) window.interact = interact;\nif (!window.jsyaml) window.jsyaml = jsyaml;\n\n// pretty console banner + version\nconst VERSION = __VERSION__;\nconsole.info(\n  `%c drag-and-drop-card %c v${VERSION} `,\n  'color:#fff;background:#03a9f4;font-weight:700;padding:2px 6px;border-radius:3px 0 0 3px',\n  'color:#03303a;background:#bdeaff;padding:2px 6px;border-radius:0 3px 3px 0'\n);\n\n// drag-and-drop-card.js\n/* eslint-disable no-console */\nconst LOG = (m, ...a) => console.debug(`[drag-and-drop-card] ${m}`, ...a);\nconsole.info('%c drag-and-drop-card loaded', 'color:#03a9f4;font-weight:700;');\n\nconst raf = () => new Promise((r) => requestAnimationFrame(() => r()));\nconst idle = () => new Promise((r) => (window.requestIdleCallback ? requestIdleCallback(() => r()) : setTimeout(r, 0)));\n\nclass DragAndDropCard extends HTMLElement {\n\n  __booting = false;  \n\n  constructor() {\n    super();\n    if (!this.shadowRoot) this.attachShadow({ mode: 'open' });\n    this.__rebuiltCards = new WeakSet();\n  }\n\n  \n  // --- DDC patch: deep card_mod detection + one-time rebuild helper ---\n  _hasCardModDeep(cfg) {\n    try {\n      if (!cfg || typeof cfg !== 'object') return false;\n      if (cfg.card_mod || cfg.type === 'custom:mod-card') return true;\n      if (cfg.card) return this._hasCardModDeep(cfg.card);\n      if (Array.isArray(cfg.cards)) {\n        for (const c of cfg.cards) { if (this._hasCardModDeep(c)) return true; }\n      }\n      return false;\n    } catch { return false; }\n  }\n  _rebuildOnce(el) {\n    try {\n      if (!el) return;\n      if (!this.__rebuiltCards) this.__rebuiltCards = new WeakSet();\n      if (this.__rebuiltCards.has(el)) return;\n      this.__rebuiltCards.add(el);\n      // Fire rebuild from the child card so Lovelace/card-mod re-attaches without recreating DDC itself\n      el.dispatchEvent(new Event('ll-rebuild', { bubbles: true, composed: true }));\n    } catch {}\n  }\n\n\n  // Deep query across shadow roots\n  _deepQueryAll(selector, root = document) {\n    const results = [];\n    const visit = (node) => {\n      if (!node) return;\n      if (node.querySelectorAll) {\n        try {\n          node.querySelectorAll(selector).forEach(el => results.push(el));\n        } catch {}\n      }\n      // Recurse into shadow roots\n      const treeWalker = document.createTreeWalker(node, NodeFilter.SHOW_ELEMENT, null);\n      let el = node;\n      while (el) {\n        const sr = el.shadowRoot;\n        if (sr) visit(sr);\n        el = treeWalker.nextNode();\n      }\n    };\n    visit(root);\n    return results;\n  }\n\n\n  // Keep visible editors (HA sidebar or in-card modal) in sync with current storage_key\n  _syncEditorsStorageKey() {\n    try {\n      const val = this.storageKey || '';\n      // Update any open editor input fields for this card\n      // We look for our known editor markup within the DOM and set the storage key input.\n      const nodes = this._deepQueryAll('#storage_key');\n      nodes.forEach((inp) => {\n        try {\n          if (inp && inp.tagName === 'INPUT') {\n            if (inp.value !== val) {\n              inp.value = val;\n              // Fire input event so editor UIs update their internal state\n              inp.dispatchEvent(new Event('input', { bubbles: true }));\n              inp.dispatchEvent(new Event('change', { bubbles: true }));\n            }\n          }\n        } catch {}\n      });\n    } catch {}\n  }\n\n  // Inside class DragAndDropCard extends ...\n  static _genKey() {\n    const id =\n      globalThis.crypto?.randomUUID?.() ||\n      `${Date.now().toString(36)}_${Math.random().toString(36).slice(2, 8)}`;\n    return `layout_${id}`;\n  }\n\n  static getStubConfig(/* hass, entities, entitiesFallback */) {\n    return {\n      type: 'custom:drag-and-drop-card',\n      // \u2190 generated immediately when the card is added\n      storage_key: this._genKey(),\n\n      // (optional) sensible defaults you already use:\n      grid: 10,\n      drag_live_snap: false,\n      auto_save: true,\n      auto_save_debounce: 800,\n      container_size_mode: 'dynamic',\n\n\n      // your baked-in hero image, if you want it visible by default\n      hero_image:\n        \"https://i.postimg.cc/CxsWQgwp/Chat-GPT-Image-Sep-5-2025-09-26-16-AM.png\",\n    };\n  }\n\n  /* ------------------------- Mini config editor (HA) ------------------------- */\n  /* ------------------------- Mini config editor (HA) ------------------------- */\n  static getConfigElement() {\n    const el = document.createElement('div');\n    el.innerHTML = `\n      <style>\n        .cfg-row{display:flex;gap:12px;align-items:center;margin:8px 0;flex-wrap:wrap}\n        input[type=\"text\"],input[type=\"number\"],select{\n          padding:6px;border-radius:8px;border:1px solid var(--divider-color);\n          background:var(--primary-background-color);color:var(--primary-text-color)\n        }\n        label{font-weight:600;min-width:130px}\n        .inline{display:inline-flex;gap:8px;align-items:center}\n        .hint{opacity:.65;font-size:.85rem}\n      </style>\n\n      <div class=\"cfg-row\">\n        <label>Storage key</label>\n        <input id=\"storage_key\" type=\"text\" placeholder=\"my_unique_layout_key\" />\n      </div>\n\n      <div class=\"cfg-row\">\n        <label>Grid size</label>\n        <input id=\"grid\" type=\"number\" min=\"4\" max=\"32\" step=\"1\" value=\"10\" style=\"width:90px\" />\n        <span class=\"hint\">Grid cell in px; affects snap & default card size</span>\n      </div>\n\n      <div class=\"cfg-row\">\n        <label><input type=\"checkbox\" id=\"liveSnap\"> Snap while dragging (live)</label>\n      </div>\n\n      <div class=\"cfg-row\">\n        <label>Auto-save</label>\n        <input type=\"checkbox\" id=\"autoSave\" checked>\n        <span style=\"margin-left:auto\">Debounce (ms)</span>\n        <input type=\"number\" id=\"autoSaveDebounce\" min=\"0\" step=\"50\" value=\"800\" style=\"width:90px\">\n      </div>\n\n      <div class=\"cfg-row\">\n        <label>Container Background</label>\n        <input type=\"text\" id=\"containerBg\"\n          placeholder=\"transparent or css e.g. linear-gradient(...)\"\n          title=\"Try: transparent, #232f3e, linear-gradient(...), radial-gradient(...)\" />\n      </div>\n\n      <div class=\"cfg-row\">\n        <label>Card Background</label>\n        <input type=\"text\" id=\"cardBg\"\n          placeholder=\"var(--ha-card-background) or css e.g. #ffffffcc\"\n          title=\"Try: transparent, #151515aa, linear-gradient(...)\" />\n      </div>\n\n      <div class=\"cfg-row\">\n        <label><input type=\"checkbox\" id=\"debug\"> Debug logs</label>\n      </div>\n\n      <div class=\"cfg-row\">\n        <label><input type=\"checkbox\" id=\"noOverlap\"> Disable overlap</label>\n      </div>\n\n      <!-- Size controls -->\n      <div class=\"cfg-row\">\n        <label>Container size</label>\n        <select id=\"sizeMode\">\n          <option value=\"dynamic\">Dynamic (auto)</option>\n          <option value=\"fixed_custom\">Fixed (custom)</option>\n          <option value=\"preset\">Preset</option>\n        </select>\n\n        <span id=\"sizeCustom\" class=\"inline\" style=\"display:none\">\n          <span>W</span><input id=\"sizeW\" type=\"number\" min=\"100\" step=\"10\" style=\"width:90px\">\n          <span>H</span><input id=\"sizeH\" type=\"number\" min=\"100\" step=\"10\" style=\"width:90px\">\n        </span>\n\n        <span id=\"sizePresetWrap\" class=\"inline\" style=\"display:none\">\n          <select id=\"sizePreset\"></select>\n          <select id=\"sizeOrientation\">\n            <option value=\"auto\">Auto</option>\n            <option value=\"landscape\">Landscape</option>\n            <option value=\"portrait\">Portrait</option>\n          </select>\n        </span>\n      </div>\n\n      <!-- Actions -->\n      <div class=\"cfg-row\" style=\"justify-content:flex-end\">\n        <mwc-button id=\"revertBtn\" outlined>Revert</mwc-button>\n        <mwc-button id=\"applyBtn\" raised disabled>Apply</mwc-button>\n      </div>\n    `;\n\n    // Presets into #sizePreset\n    const og = document.createElement('optgroup');\n    og.label = 'Presets';\n    (DragAndDropCard._sizePresets?.() || []).forEach((p) => {\n      const o = document.createElement('option');\n      o.value = p.key; o.textContent = `${p.label} (${p.w}\u00D7${p.h})`;\n      og.appendChild(o);\n    });\n    el.querySelector('#sizePreset')?.appendChild(og);\n\n    const toggleSizeControls = () => {\n      const mode = el.querySelector('#sizeMode').value;\n      el.querySelector('#sizeCustom').style.display = mode==='fixed_custom' ? 'inline-flex' : 'none';\n      el.querySelector('#sizePresetWrap').style.display = mode==='preset' ? 'inline-flex' : 'none';\n    };\n\n    // Set incoming values (keep type + unknown keys)\n    el.setConfig = (config = {}) => {\n      el._config = { type: config.type || 'custom:drag-and-drop-card', ...config };\n\n\n      // If no storage_key yet, create one and plan to persist automatically\n      if (!el._config.storage_key) {\n        el._config.storage_key = `layout_${(crypto?.randomUUID?.() || Date.now().toString(36))}`;\n        el.__autokeyPending = true;  // <- remember to fire once after UI binds\n      }\n      // populate fields from el._config (not raw config)\n      el.querySelector('#storage_key').value = config.storage_key || '';\n      el.querySelector('#grid').value = config.grid ?? 10;\n      el.querySelector('#liveSnap').checked = !!config.drag_live_snap;\n      el.querySelector('#autoSave').checked = config.auto_save !== false;\n      el.querySelector('#autoSaveDebounce').value = config.auto_save_debounce ?? 800;\n      el.querySelector('#containerBg').value = config.container_background ?? 'transparent';\n      el.querySelector('#cardBg').value = config.card_background ?? 'var(--ha-card-background, var(--card-background-color))';\n      el.querySelector('#debug').checked = !!config.debug;\n      el.querySelector('#noOverlap').checked = !!config.disable_overlap;\n\n      // NEW sizing fields\n      el.querySelector('#sizeMode').value = config.container_size_mode || 'dynamic';\n      el.querySelector('#sizeW').value = config.container_fixed_width ?? '';\n      el.querySelector('#sizeH').value = config.container_fixed_height ?? '';\n      const presetSel = el.querySelector('#sizePreset');\n      const presets = DragAndDropCard._sizePresets?.() || [];\n      if (presetSel && ![...presetSel.options].some(o => o.value === (config.container_preset || ''))) {\n        // already appended above; nothing else needed\n      }\n      presetSel.value = config.container_preset || (presets[0]?.key || 'fhd');\n      el.querySelector('#sizeOrientation').value = config.container_preset_orientation || 'auto';\n\n      toggleSizeControls();\n      updateButtons();\n\n      // If we just generated a key, immediately persist it so the dashboard saves it\n      if (el.__autokeyPending) {\n        el.__autokeyPending = false;\n        fire(); // uses your existing fire() below to dispatch 'config-changed'\n      }\n    };\n\n    // Collect current values\n    el.getConfig = () => {\n      const base = { ...(el._config || {}) };\n      base.storage_key = el.querySelector('#storage_key').value || '';\n      base.grid = Number(el.querySelector('#grid').value || 10);\n      base.drag_live_snap = !!el.querySelector('#liveSnap').checked;\n      base.auto_save = !!el.querySelector('#autoSave').checked;\n      base.auto_save_debounce = Number(el.querySelector('#autoSaveDebounce').value || 800);\n      base.container_background = el.querySelector('#containerBg').value || 'transparent';\n      base.card_background = el.querySelector('#cardBg').value || 'var(--ha-card-background, var(--card-background-color))';\n      base.debug = !!el.querySelector('#debug').checked;\n      base.disable_overlap = !!el.querySelector('#noOverlap').checked;\n\n      // NEW\n      base.container_size_mode = el.querySelector('#sizeMode').value;\n      base.container_fixed_width  = Number(el.querySelector('#sizeW').value || 0) || undefined;\n      base.container_fixed_height = Number(el.querySelector('#sizeH').value || 0) || undefined;\n      base.container_preset = el.querySelector('#sizePreset').value || undefined;\n      base.container_preset_orientation = el.querySelector('#sizeOrientation').value || 'auto';\n      return base;\n    };\n\n    // Dirty / Apply handling\n    const applyBtn = el.querySelector('#applyBtn');\n    const revertBtn = el.querySelector('#revertBtn');\n\n    const isDirty = () => {\n      try { return JSON.stringify(el.getConfig()) !== JSON.stringify(el._config); }\n      catch { return true; }\n    };\n    const updateButtons = () => {\n      if (applyBtn) applyBtn.disabled = !isDirty();\n    };\n\n    const fire = () => {\n      el.dispatchEvent(new CustomEvent('config-changed', { detail: { config: el.getConfig() } }));\n      // Baseline becomes the new config after Apply\n      el._config = el.getConfig();\n      updateButtons();\n    };\n\n    const on = (sel, ev = 'input') =>\n      el.querySelector(sel)?.addEventListener(ev, () => {\n        if (sel === '#sizeMode') toggleSizeControls();\n        updateButtons(); // <- no immediate fire while typing\n      });\n\n    // Listeners (no per-keystroke fire)\n    on('#storage_key'); on('#grid');\n    on('#liveSnap','change'); on('#autoSave','change'); on('#autoSaveDebounce');\n    on('#containerBg'); on('#cardBg');\n    on('#debug','change'); on('#noOverlap','change');\n    on('#sizeMode','change'); on('#sizeW'); on('#sizeH');\n    on('#sizePreset','change'); on('#sizeOrientation','change');\n\n    applyBtn?.addEventListener('click', fire);\n    revertBtn?.addEventListener('click', () => el.setConfig(el._config));\n\n    return el;\n  }\n\n  \n    /* ---------------------------- Size helpers ---------------------------- */\n  // ---- size presets (CSS pixels) ----\nstatic _sizePresets() {\n  return [\n    // Phones\n    { key:'iphone-14-pro',      label:'iPhone 14 Pro',        w:393,  h:852,  group:'phone' },\n    { key:'iphone-14-pro-max',  label:'iPhone 14 Pro Max',    w:430,  h:932,  group:'phone' },\n    { key:'iphone-se-2',        label:'iPhone SE (2/3rd gen)',w:375,  h:667,  group:'phone' },\n    { key:'pixel-7',            label:'Pixel 7',              w:412,  h:915,  group:'phone' },\n    { key:'galaxy-s8',          label:'Galaxy S8',            w:360,  h:740,  group:'phone' },\n    { key:'galaxy-s20-ultra',   label:'Galaxy S20 Ultra',     w:412,  h:915,  group:'phone' },\n\n    // Tablets\n    { key:'ipad-9-7',           label:'iPad 9.7\"',            w:768,  h:1024, group:'tablet' },\n    { key:'ipad-11-pro',        label:'iPad Pro 11\"',         w:834,  h:1194, group:'tablet' },\n    { key:'ipad-12-9-pro',      label:'iPad Pro 12.9\"',       w:1024, h:1366, group:'tablet' },\n    { key:'surface-go-3',       label:'Surface Go 3',         w:800,  h:1280, group:'tablet' },\n\n    // Desktop / Displays\n    { key:'hd',                 label:'HD',                   w:1366, h:768,  group:'desktop' },\n    { key:'wxga-plus',          label:'WXGA+',                w:1440, h:900,  group:'desktop' },\n    { key:'fhd',                label:'Full HD',              w:1920, h:1080, group:'desktop' },\n    { key:'qhd',                label:'2K / QHD',             w:2560, h:1440, group:'desktop' },\n    { key:'uhd-4k',             label:'4K UHD',               w:3840, h:2160, group:'desktop' },\n  ];\n}\n\n_isContainerFixed() { return this.containerSizeMode !== 'dynamic'; }\n\n_resolveFixedSize() {\n  if (this.containerSizeMode === 'fixed_custom') {\n    const w = Math.max(100, Number(this.containerFixedWidth || 0));\n    const h = Math.max(100, Number(this.containerFixedHeight || 0));\n    return { w, h };\n  }\n  if (this.containerSizeMode === 'preset') {\n    const p = DragAndDropCard._sizePresets().find(x => x.key === this.containerPreset) ||\n              DragAndDropCard._sizePresets().find(x => x.key === 'fhd');\n    if (!p) return { w: 1920, h: 1080 };\n    let w = p.w, h = p.h;\n    if (this.containerPresetOrient === 'portrait' && w > h) [w,h] = [h,w];\n    if (this.containerPresetOrient === 'landscape' && h > w) [w,h] = [h,w];\n    return { w, h };\n  }\n  return null;\n}\n\n_applyContainerSizingFromConfig(initial=false) {\n  // set container size according to mode\n  const c = this.cardContainer; if (!c) return;\n\n  if (this._isContainerFixed()) {\n    const { w, h } = this._resolveFixedSize();\n    c.style.width  = `${w}px`;\n    c.style.height = `${h}px`;\n    // ensure overflow hidden (hard lock)\n    c.style.overflow = 'hidden';\n    if (!initial) this._dbgPush?.('size', 'Applied fixed size', { w, h, mode: this.containerSizeMode, preset:this.containerPreset, orient:this.containerPresetOrient });\n    // pull any existing cards back inside\n    this._clampAllCardsInside();\n  } else {\n    // dynamic \u2014 let _resizeContainer compute; clear inline to allow growth/shrink\n    c.style.overflow = 'hidden';\n    // keep width/height managed by _resizeContainer\n    if (!initial) this._dbgPush?.('size', 'Applied dynamic size');\n    this._resizeContainer();\n  }\n}\n\n_getContainerSize() {\n  const c = this.cardContainer; if (!c) return { w:0, h:0 };\n  const w = parseFloat(getComputedStyle(c).width) || c.getBoundingClientRect().width;\n  const h = parseFloat(getComputedStyle(c).height) || c.getBoundingClientRect().height;\n  return { w, h };\n}\n\n_clampAllCardsInside() {\n  if (!this._isContainerFixed()) return;\n  const { w: cw, h: ch } = this._getContainerSize();\n  const wraps = this.cardContainer.querySelectorAll('.card-wrapper');\n  wraps.forEach(w => {\n    const x = parseFloat(w.getAttribute('data-x')) || 0;\n    const y = parseFloat(w.getAttribute('data-y')) || 0;\n    const ww = parseFloat(w.style.width)  || w.getBoundingClientRect().width;\n    const hh = parseFloat(w.style.height) || w.getBoundingClientRect().height;\n\n    const nx = Math.max(0, Math.min(x, Math.max(0, cw - ww)));\n    const ny = Math.max(0, Math.min(y, Math.max(0, ch - hh)));\n    let nw = Math.min(ww, cw);\n    let nh = Math.min(hh, ch);\n\n    // if width/height exceed box, shrink then re-clamp pos\n    if (nw !== ww || nh !== hh) {\n      w.style.width  = `${nw}px`;\n      w.style.height = `${nh}px`;\n    }\n    const nx2 = Math.max(0, Math.min(nx, Math.max(0, cw - nw)));\n    const ny2 = Math.max(0, Math.min(ny, Math.max(0, ch - nh)));\n    this._setCardPosition(w, nx2, ny2);\n  });\n}\n\n_applyGridVars() {\n  const sz = `${this.gridSize || 10}px`;\n  // host (inherits down)\n  this.style.setProperty('--ddc-grid-size', sz);\n  // container (extra robust)\n  this.cardContainer?.style.setProperty('--ddc-grid-size', sz);\n}\n\n  /* ---------------------------- debug helpers ---------------------------- */\n  _dbgInit() {\n    if (this.__dbgReady) return;\n    this.__dbgReady = true;\n    this._dbgBuffer = [];\n    this._dbgMax = 400;\n    try { window.DDC = this; } catch {}\n  }\n  _dbgPush(kind, msg, extra = null) {\n    const line = { t: new Date().toISOString(), kind, msg, extra };\n    this._dbgBuffer.push(line);\n    if (this._dbgBuffer.length > this._dbgMax) this._dbgBuffer.shift();\n    if (this.debug) console.debug(`%c[ddc:${kind}]%c ${msg}`, 'color:#03a9f4', 'color:unset', extra ?? '');\n  }\n  _dbgDump() { return [...this._dbgBuffer]; }\n  _safe(s) { return String(s).replace(/[&<>\"']/g, (c)=>({'&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;',\"'\":'&#39;'}[c])); }\n\n  /* --------------------------- Card lifecycle --------------------------- */\n  setConfig(config = {}) {\n    // Track old key so we only rebuild when storage_key actually changes\n    // Auto\u2011assign a storage key if none provided\n    // Keep previous to detect real key changes\n    const prevKey = this.storageKey;\n    // Use existing instance key if present\n\n    this.config = { ...config };\n    if (!this.config.storage_key || this.config.storage_key === \"\") {\n      this.config.storage_key = this.constructor._genKey();\n    }\n    this.storageKey = this.config.storage_key;\n\n    // STABLE storage_key: reuse instance key if none provided\n    if (!config.storage_key) {\n      if (this.storageKey) {\n        config = { ...config, storage_key: this.storageKey };\n      } else {\n        this.storageKey = `layout_${(crypto?.randomUUID?.() || Date.now().toString(36))}`;\n        config = { ...config, storage_key: this.storageKey };\n      }\n    }\n\n    // Store & reflect\n    this._config = config;\n    this.storageKey = config.storage_key;\n    this._syncEditorsStorageKey();\n\n\n    // Store incoming config and update properties\n    this.storageKey = config.storage_key || undefined;\n    this._syncEditorsStorageKey();\n    this.gridSize                 = Number(config.grid ?? 10);\n    this.dragLiveSnap             = !!config.drag_live_snap;\n    this.autoSave                 = config.auto_save !== false;\n    this.autoSaveDebounce         = Number(config.auto_save_debounce ?? 800);\n    this.containerBackground      = config.container_background ?? 'transparent';\n    this.cardBackground           = config.card_background ?? 'var(--ha-card-background, var(--card-background-color))';\n    this.debug                    = !!config.debug;\n    this.editMode                 = false;\n    this._backendOK               = false;\n    this.disableOverlap           = !!config.disable_overlap;\n    this.containerSizeMode        = config.container_size_mode || 'dynamic';\n    this.containerFixedWidth      = Number(config.container_fixed_width ?? 0) || null;\n    this.containerFixedHeight     = Number(config.container_fixed_height ?? 0) || null;\n    this.containerPreset          = config.container_preset || 'fullhd';\n    this.containerPresetOrient    = config.container_preset_orientation || 'auto';\n    this.heroImage = config?.hero_image || \"https://i.postimg.cc/CxsWQgwp/Chat-GPT-Image-Sep-5-2025-09-26-16-AM.png\";\n\n\n    if (this.cardContainer) this._applyContainerSizingFromConfig(false);\n\n    const keyChanged = prevKey !== this.storageKey;\n\n      // IMPORTANT: do NOT autosave a layout snapshot while the key is changing/booting\n    if (this.editMode && !this.__booting && !keyChanged) {\n      try { if (!this._isInHaEditorPreview()) this._queueSave('config-change'); } catch {}\n    }\n    // Grid-related\n    this._applyGridVars();\n\n    // Overlay fix for UI based cards\n    this._ensureOverlayZFix();\n\n    // selection state\n    this._selection = new Set();\n    this.__groupDrag = null;\n\n    // caches for speed\n    this.__editorCache = new Map(); // type -> element\n    this.__stubCache = new Map();\n\n    this._dbgInit();\n    this._dbgPush('init', 'Card configured', {\n      storageKey_raw: config.storage_key,\n      storageKey_slug: this.storageKey,\n      autoSave: this.autoSave,\n      grid: this.gridSize\n    });\n\n    this.style.setProperty('--ddc-bg', this.containerBackground);\n    this.style.setProperty('--ddc-card-bg', this.cardBackground);\n\n    // preload libs\n    if (!window.jsyaml) {\n      const s = document.createElement('script');\n      s.src = 'https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js';\n      document.head.appendChild(s);\n    }\n    if (!window.interact) {\n      const s = document.createElement('script');\n      s.src = 'https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js';\n      s.onload = () => this._initInteract();\n      document.head.appendChild(s);\n    }\n    // preload helpers early to avoid lag on first pick\n    this._helpersPromise = (typeof window.loadCardHelpers === 'function')\n      ? window.loadCardHelpers().catch(()=>null)\n      : Promise.resolve(null);\n\n    if (!this._built) {\n      this._built = true;\n      this.shadowRoot.innerHTML = `\n        <style>\n          .ddc-root{\n            position:relative;\n            /* JS will keep this in sync with your \u201CGrid (px)\u201D */\n            --ddc-grid-size: 10px;\n            /* Good contrast on light/dark themes */\n            --ddc-grid-color: color-mix(in srgb, var(--primary-text-color) 22%, transparent);\n          }\n          .toolbar{display:flex;gap:8px;margin:6px 0;align-items:center;flex-wrap:wrap}\n          .btn{\n            background:var(--primary-color);color:#fff;border:none;padding:8px 12px;border-radius:10px;\n            cursor:pointer;font:inherit;box-shadow:0 2px 6px rgba(0,0,0,.12)\n          }\n          .btn.secondary{background:var(--secondary-background-color);color:var(--primary-text-color);border:1px solid var(--divider-color)}\n          .btn.ghost{background:transparent;color:var(--primary-text-color);border:1px dashed var(--divider-color)}\n          .store-badge {\n            margin-left: auto;\n            border: 1px solid var(--divider-color);\n            border-radius: 999px;\n            padding: 4px 10px;\n            font-size: .85rem;\n            background: rgba(255,193,7,.15);\n            display: none; /* hidden by default, shown only in edit mode */\n          }\n\n          .card-container{\n            position: relative;\n            padding: 10px;\n            border: 1px solid var(--divider-color);\n            background: var(--ddc-bg, transparent);\n            width: auto; height: auto; border-radius: 12px; overflow: hidden;\n            isolation: isolate; z-index: 0; -webkit-touch-callout: none;\n            user-select: none;\n          }\n          /* make the grid only on the background, aligned to the same origin as cards */\n          .card-container::before{\n            content:'';\n            position:absolute; inset:0;                 /* same origin as absolutely positioned children */\n            background-image:\n              linear-gradient(var(--ddc-grid-color, rgba(120,120,120,.25)) 1px, transparent 1px),\n              linear-gradient(90deg, var(--ddc-grid-color, rgba(120,120,120,.25)) 1px, transparent 1px);\n            background-size: var(--ddc-grid-size) var(--ddc-grid-size);\n            background-origin: content-box;              /* align pattern to the content/padding edge */\n            background-clip: content-box;\n            pointer-events:none;\n            opacity:0;\n            transition: opacity .15s;\n            z-index:0;\n          }\n          .card-container.grid-on::before{\n            opacity:.28;\n          }\n\n          .card-wrapper{\n            position:absolute;\n            left: 0;                     /* <<< important: unify origin with the grid */\n            top:  0;                     /* <<< important: unify origin with the grid */\n            box-sizing: border-box;      /* include the 2px border in the set width/height */\n            border:2px solid transparent;\n            background:var(--ddc-card-bg, var(--card-background-color));\n            cursor:grab;\n            /* ensure buttons and resize handles remain visible on very small cards */\n            overflow:auto;\n            border-radius:14px;\n            box-shadow:var(--ha-card-box-shadow,0 2px 12px rgba(0,0,0,.18));\n            will-change:transform,width,height,box-shadow; touch-action:auto;\n            z-index:1;\n          }\n          .card-wrapper.dragging{\n            cursor:grabbing;\n            touch-action: none;\n            }\n          .card-wrapper.editing.selected{\n            border-color:var(--primary-color,#03a9f4);\n            box-shadow:0 0 0 2px var(--primary-color,#03a9f4)!important;\n          }\n\n          /* ---- empty-state of the card---- */\n          .btn.cta-empty{\n            position:relative;\n            padding:12px 16px;\n            font-weight:600;\n            border-radius:14px;\n            display:inline-flex !important;\n            align-items:center;\n            gap:8px;\n            box-shadow:0 6px 18px rgba(3,169,244,.25);\n          }\n          .btn.cta-empty::after{\n            content:\"\";\n            position:absolute; inset:-4px;\n            border-radius:16px;\n            border:2px solid rgba(3,169,244,.35);\n            animation: ddc-cta-pulse 1.8s ease-out infinite;\n            pointer-events:none;\n          }\n          @keyframes ddc-cta-pulse{\n            0%   { opacity:.85; transform:scale(.98); }\n            70%  { opacity:0;   transform:scale(1.12); }\n            100% { opacity:0;   transform:scale(1.18); }\n          }    \n            \n          /* pleasant buttons: info (light blue) & warning (orange) */\n          .btn.info{\n            background: var(--ddc-info,#4db6ff);\n            color:#0b2537;\n            border:1px solid color-mix(in srgb, var(--ddc-info,#4db6ff) 55%, #000 15%);\n          }\n          .btn.info:hover{ filter: brightness(1.06); transform: translateY(-1px); box-shadow:0 4px 14px rgba(0,0,0,.18) }\n          .btn.info:active{ transform: translateY(0) }\n\n          .btn.warning{\n            background: var(--ddc-warning,#ff9800);\n            color:#210b00;\n            border:1px solid color-mix(in srgb, var(--ddc-warning,#ff9800) 55%, #000 15%);\n          }\n          .btn.warning:hover{ filter: brightness(1.07); transform: translateY(-1px); box-shadow:0 4px 14px rgba(0,0,0,.18) }\n          .btn.warning:active{ transform: translateY(0) }\n\n          /* small quality-of-life for all .btn */\n          .btn{\n            display:inline-flex; align-items:center; gap:8px;\n            border-radius:12px; transition: transform .08s ease, box-shadow .12s ease, filter .12s ease;\n          }\n          .btn ha-icon{ --mdc-icon-size:18px; width:18px; height:18px }\n\n          /* ---- chip ---- */\n        .chip{\n            position:absolute;\n            top:8px;\n            right:8px;\n            display:flex;\n            gap:6px;\n            flex-wrap:wrap;             /* allow chip buttons to wrap when space is limited */\n            opacity:0;\n            transition:opacity .15s;\n            z-index:30;\n            pointer-events: none;\n          }\n          .card-wrapper.editing .chip{\n            opacity:1;\n            pointer-events: auto;\n          }\n          .card-wrapper.editing .chip{\n            opacity:1;\n            pointer-events: auto;\n          }\n          .chip .mini{\n            display:inline-flex;align-items:center;gap:6px;\n            background:rgba(28,28,30,.78);color:#fff;border:1px solid rgba(255,255,255,.18);\n            border-radius:999px;padding:6px 10px;font-size:.76rem;cursor:pointer;letter-spacing:.2px;\n            box-shadow:0 2px 6px rgba(0,0,0,.25); transition:transform .08s, background .12s, box-shadow .12s\n          }\n          .chip .mini:hover{transform:translateY(-1px); background:rgba(28,28,30,.95); box-shadow:0 3px 10px rgba(0,0,0,.35)}\n          .chip .mini ha-icon{--mdc-icon-size:18px;width:18px;height:18px}\n          .chip .mini.danger{background:rgba(220, 38, 38, .9);border-color:rgba(255,255,255,.22)}\n          .chip .mini.danger:hover{background:rgba(220, 38, 38, 1)}\n          .chip .mini.pill{padding:6px}\n\n          /* Edit highlight */\n          .card-wrapper.editing{ \n            border-color:var(--primary-color,#03a9f4);\n            touch-action: none;\n          }\n          .card-wrapper.editing::after{\n            content:\"\";position:absolute;inset:0;border:1px dashed var(--primary-color,#03a9f4);\n            border-radius:12px;pointer-events:none;opacity:.35;z-index:5;box-sizing:border-box\n          }\n\n          .shield{position:absolute;inset:0;z-index:10;background:transparent;pointer-events:none}\n          .card-wrapper.editing .shield,\n          .card-wrapper.dragging .shield{pointer-events:auto;cursor:grab}\n\n          .resize-handle{\n            display:none;                 /* shown in edit mode via your existing rule */\n            position:absolute;\n            bottom:8px;                   /* move INSIDE the wrapper bounds */\n            right:8px;                    /* so it can't be clipped by overflow */\n            width:28px;\n            height:28px;\n            border-radius:50%;\n            background:var(--primary-color);\n            color:#fff;\n            border:1px solid rgba(255,255,255,.25);\n            cursor:se-resize;\n            z-index:999;                  /* above the card content */\n            box-shadow:0 3px 8px rgba(0,0,0,.28);\n            align-items:center;\n            justify-content:center;\n          }\n          .resize-handle:hover{transform:scale(1.08);box-shadow:0 6px 16px rgba(0,0,0,.35)}\n          .card-wrapper.editing .resize-handle{display:flex}\n          .resize-handle ha-icon{--mdc-icon-size:18px;width:18px;height:18px;pointer-events:none}\n\n          /* modal */\n          .modal{\n            position:fixed;inset:0;background:rgba(0,0,0,.45);\n            display:flex;align-items:center;justify-content:center;z-index:9000\n          }\n          .dialog{\n            width:min(1220px,96vw);max-height:min(90vh, 900px);\n            display:flex;flex-direction:column;\n            background:var(--card-background-color);border-radius:20px;padding:0;\n            border:1px solid var(--divider-color);\n            /* was overflow:auto; \u2014 allow fly-out menus to escape the dialog box */\n            overflow:visible;\n          }\n          .dlg-head{\n            display:flex;align-items:center;gap:12px;padding:12px 16px;border-bottom:1px solid var(--divider-color);\n            background:\n              radial-gradient(1200px 120px at 20% -40px, rgba(3,169,244,.21), transparent 60%),\n              radial-gradient(900px 110px at 80% -40px, rgba(0,150,136,.18), transparent 60%);\n          }\n          .dlg-head h3{margin:0;font-size:1.1rem;letter-spacing:.2px}\n          .dlg-foot{display:flex;gap:10px;justify-content:flex-end;padding:12px;border-top:1px solid var(--divider-color);background:var(--primary-background-color)}\n          .btn:disabled{opacity:.6;cursor:not-allowed}\n\n          /* picker layout */\n          .layout{display:grid;height:min(84vh,820px);grid-template-columns:260px 1fr}\n          #leftPane{border-right:1px solid var(--divider-color);overflow:auto;background:var(--primary-background-color);contain:content}\n          #rightPane{overflow:visible;background:var(--primary-background-color)}\n          .rightGrid{\n            display:grid;grid-template-columns:540px 1fr;grid-template-rows:auto auto 1fr;gap:12px;padding:12px;height:100%;\n            box-sizing:border-box;position:relative; overflow:auto;\n          }\n          .sec{border:1px solid var(--divider-color);border-radius:12px;background:var(--card-background-color);overflow:visible;position:relative;contain:content}\n          /* header previously had z-index:10; remove to avoid invisible overlay eating clicks */\n          .sec .hd{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid var(--divider-color);font-weight:600;position: relative;z-index:auto}\n          .sec .bd{padding:12px;overflow:visible}\n          .tabs{display:flex;gap:6px;margin-left:auto}\n          .tab{\n            font-size:.85rem;padding:6px 10px;border-radius:10px;border:1px solid var(--divider-color);\n            background:var(--primary-background-color);color:var(--primary-text-color);cursor:pointer\n          }\n          .tab.active{background:var(--primary-color);color:#fff;border-color:var(--primary-color)}\n\n          /* --- FIX: YAML editor should scroll and not overflow --- */\n          #yamlSec { min-height: 0; overflow: visible !important; }\n          #yamlSec .bd { \n            /* allow scrolling inside the YAML section */\n            overflow: auto;\n            max-height: none;\n            height: 100%;\n          }\n\n          /* --- FIX: Visual editor menus (ha-select/mwc-menu) must escape containers --- */\n          /* Keep the outer containers visible so fly-out menus are not clipped */\n          #optionsSec { min-height: 0; overflow: visible !important; }\n          #optionsSec .bd { overflow: visible !important; }\n\n          /* Allow the editor host and descendants to let menus render outside bounds */\n          #editorHost { display:block; min-height:0; position:relative; overflow:visible !important; }\n          mushroom-lock-card-editor,\n          mushroom-lock-card-editor * { overflow: visible !important; }\n\n          /* Provide an inner scroller so the section is still usable without clipping menus */\n          #optionsSec .bd > div {\n            max-height: min(70vh, 700px);\n            overflow: auto;\n          }\n\n          /* Ensure the menu surface renders above the dialog and any headers */\n          mwc-menu-surface,\n          mwc-menu {\n            z-index: 10001 !important;\n          }\n\n\n          #quickFillSec { \n            display: flex; \n            flex-direction: column; \n            min-height: 0; \n          }\n          #quickFillSec .bd { \n            overflow: auto;          /* scroll inside the card */\n            max-height: 320px;       /* keep it contained; tweak as you wish */\n          }\n\n          /* ha-code-editor / CodeMirror height: fixed and scroll inside */\n          ha-code-editor { \n            display: block; \n            height: 260px !important; \n          }\n          .CodeMirror { \n            height: 260px !important; \n          }\n\n          /* host that wraps the editor should also allow scroll if content grows */\n          #yamlHost { \n            max-height: 260px; \n            overflow: auto; \n          }\n\n          /* CodeMirror */\n          .CodeMirror{\n            height:260px;border:1px solid var(--divider-color);border-radius:12px;\n            background:var(--primary-background-color);color:var(--primary-text-color);\n            z-index:6;\n          }\n\n          /* YAML editor safety / visibility */\n          #yamlSec{ z-index:5; }\n          #yamlHost, #yamlHost * { touch-action: auto; }\n          ha-code-editor, ha-code-editor * { touch-action: auto; }\n          ha-code-editor{ display:block; height:260px; z-index:6; }\n\n          /* loading spinners */\n          .spin-center{\n            position:absolute;inset:0;display:flex;align-items:center;justify-content:center;pointer-events: none; /* let clicks pass through to tabs and controls */\n          }\n\n\n          /* marquee selection rectangle */\n          .marquee{\n            position:absolute; border:1px dashed var(--primary-color);\n            background: color-mix(in srgb, var(--primary-color) 10%, transparent);\n            pointer-events:none; z-index:50;\n          }\n\n          /* placeholder tile */\n          .ddc-placeholder-inner{\n            position: relative;\n            display:flex; align-items:center; justify-content:center;\n            width:100%; height:100%;\n            border-radius:16px;\n            overflow: hidden;\n            /* cool gradient derived from HA primary color */\n            background:\n              radial-gradient(120% 120% at 100% 0%,\n                color-mix(in srgb, var(--primary-color) 18%, #000 0%) 0%,\n                transparent 60%),\n              linear-gradient(135deg,\n                color-mix(in srgb, var(--primary-color) 70%, #000 0%) 0%,\n                color-mix(in srgb, var(--primary-color) 35%, #000 0%) 100%);\n          }\n\n          /* subtle shine */\n          .ddc-placeholder-inner::after{\n            content:\"\";\n            position:absolute; inset:0;\n            background: radial-gradient(120% 90% at 0% 100%, rgba(255,255,255,.15), transparent 60%);\n            pointer-events:none;\n          }\n\n          /* center stack */\n          .ddc-hero{\n            position:absolute; inset:0;\n            display:flex; flex-direction:column; align-items:center; justify-content:center;\n            gap:16px; text-align:center; padding:24px;\n            color:rgba(255,255,255,.98);\n            text-shadow:0 1px 2px rgba(0,0,0,.35);\n            user-select:none; pointer-events:none; /* click goes to shield below */\n          }\n\n          .ddc-hero img{\n            width:128px; height:128px; object-fit:contain; opacity:.95; filter: drop-shadow(0 4px 14px rgba(0,0,0,.25));\n          }\n\n          .ddc-hero .ddc-title{\n            font-weight:800; font-size:1.25rem; letter-spacing:.2px;\n          }\n\n          .ddc-hero .ddc-sub{\n            font-weight:600; opacity:.95;\n          }\n\n          /* --- hold-to-edit ring (cursor progress) --- */\n          .ddc-press-ring{\n            position:fixed; z-index:100000; width:44px; height:44px; pointer-events:none;\n            margin-left:-22px; margin-top:-22px;\n            filter: drop-shadow(0 2px 6px rgba(0,0,0,.35));\n          }\n          .ddc-press-ring svg{width:44px;height:44px}\n          .ddc-press-ring .pr-bg{stroke: rgba(255,255,255,.45); stroke-width:4; fill:none}\n          .ddc-press-ring .pr-fg{stroke: var(--primary-color); stroke-width:4; fill:none; stroke-linecap:round}\n          .ddc-press-ring .pr-dot{fill: var(--primary-color); opacity:.95}\n\n          /* --- edit-mode ripple transition --- */\n          .ddc-ripple-veil{\n            position:absolute; inset:0; pointer-events:none; z-index:80; overflow:hidden;\n            mix-blend-mode: screen;\n          }\n          .ddc-ripple-veil::before{\n            content:\"\"; position:absolute; left: var(--rip-x, 50%); top: var(--rip-y, 50%);\n            width:0px; height:0px; transform: translate(-50%,-50%);\n            border-radius:50%;\n            background:\n              radial-gradient(closest-side, rgba(3,169,244,.55), rgba(3,169,244,.25) 45%, rgba(0,0,0,0) 65%),\n              radial-gradient(closest-side, rgba(0,150,136,.35), rgba(0,150,136,.15) 50%, rgba(0,0,0,0) 70%);\n            filter: blur(12px);\n            animation: ddc-ripple-grow 900ms ease-out forwards;\n          }\n          .ddc-ripple-veil::after{\n            content:\"\"; position:absolute; inset:-20%;\n            background:\n              repeating-linear-gradient(115deg, rgba(3,169,244,.09) 0 12px, rgba(0,0,0,0) 12px 24px);\n            opacity:0;\n            animation: ddc-ripple-scan 900ms ease-out forwards;\n          }\n          @keyframes ddc-ripple-grow{\n            0%   { width:0; height:0; opacity:.9 }\n            60%  { width:150vmax; height:150vmax; opacity:.9 }\n            100% { width:170vmax; height:170vmax; opacity:0 }\n          }\n          @keyframes ddc-ripple-scan{\n            0%   { transform:scale(.96) rotate(0deg); opacity:0 }\n            40%  { opacity:.7 }\n            100% { transform:scale(1.06) rotate(2deg); opacity:0 }\n          }\n        </style>\n        <div class=\"ddc-root\">\n          <div class=\"toolbar\">\n            <button class=\"btn\" id=\"addCardBtn\" style=\"display:none\">\n              <ha-icon icon=\"mdi:plus\"></ha-icon>\n              <span style=\"margin-left:6px\">Add Card</span>\n            </button>\n            <button class=\"btn secondary\" id=\"reloadBtn\" style=\"display:none\">\n              <ha-icon icon=\"mdi:refresh\"></ha-icon>\n              <span style=\"margin-left:6px\">Reload</span>\n            </button>\n            <button class=\"btn secondary\" id=\"diagBtn\" style=\"display:none\">\n              <ha-icon icon=\"mdi:play-circle-outline\"></ha-icon>\n              <span style=\"margin-left:6px\">Diagnostics</span>\n            </button>\n            <button class=\"btn secondary\" id=\"exportBtn\" style=\"display:none\">\n              <ha-icon icon=\"mdi:download\"></ha-icon>\n              <span style=\"margin-left:6px\">Export Design</span>\n            </button>\n            <button class=\"btn secondary\" id=\"importBtn\" style=\"display:none\">\n              <ha-icon icon=\"mdi:upload\"></ha-icon>\n              <span style=\"margin-left:6px\">Import Design</span>\n            </button>\n            <button class=\"btn\" id=\"applyLayoutBtn\" style=\"display:none\">\n              <ha-icon icon=\"mdi:content-save\"></ha-icon>\n              <span style=\"margin-left:6px\">Apply</span>\n            </button>\n            <button class=\"btn info\" id=\"exploreBtn\" style=\"display:none\" title=\"Open HADS (Home Assistant Dashboard Store)\">\n              <ha-icon icon=\"mdi:storefront-outline\"></ha-icon>\n              <span>Open HADS</span>\n            </button>\n            <button class=\"btn warning\" id=\"exitEditBtn\" style=\"display:none\">\n              <ha-icon icon=\"mdi:exit-run\"></ha-icon>\n              <span>Exit edit mode</span>\n            </button>\n            <span class=\"store-badge\" id=\"storeBadge\" title=\"where layout is persisted\">storage: local</span>\n          </div>\n          <div class=\"card-container\" id=\"cardContainer\"></div>\n        </div>\n      `;\n      this.cardContainer = this.shadowRoot.querySelector('#cardContainer');\n      this.addButton     = this.shadowRoot.querySelector('#addCardBtn');\n      this.reloadBtn     = this.shadowRoot.querySelector('#reloadBtn');\n      this.diagBtn       = this.shadowRoot.querySelector('#diagBtn');\n      this.exitEditBtn   = this.shadowRoot.querySelector('#exitEditBtn');\n      this.storeBadge    = this.shadowRoot.querySelector('#storeBadge');\n      this.exportBtn     = this.shadowRoot.querySelector('#exportBtn');\n      this.importBtn     = this.shadowRoot.querySelector('#importBtn');\n      this.exploreBtn    = this.shadowRoot.querySelector('#exploreBtn'); \n      this.applyLayoutBtn= this.shadowRoot.querySelector('#applyLayoutBtn');     \n\n      this._applyGridVars();\n      \n      this.addButton.addEventListener('click', () => {\n        if (!this.editMode) this._toggleEditMode(true);\n        this._openCardManager();\n      });      \n      this.reloadBtn.addEventListener('click', () => this._initialLoad(true));\n      this.diagBtn.addEventListener('click', () => this._openDiagnostics());\n      this.exitEditBtn.addEventListener('click', () => this._toggleEditMode(false));\n      this.exportBtn.addEventListener('click', () => this._exportDesign());\n      this.importBtn.addEventListener('click', () => this._importDesign());\n      this.applyLayoutBtn.addEventListener('click', () => this._saveLayout(false));\n       // Ctrl/Cmd + S to Apply while in DDC edit mode\n       window.addEventListener('keydown', (e) => {\n         if (!this.editMode) return;\n         if ((e.ctrlKey || e.metaKey) && (e.key === 's' || e.key === 'S')) {\n           e.preventDefault();\n           this._saveLayout(false);\n         }\n       });\n\n      this.exploreBtn.addEventListener('click', () =>\n        window.open('https://hads.smarti.dev/', '_blank', 'noopener,noreferrer')\n      );\n\n      // apply container sizing early\n      this._applyContainerSizingFromConfig(true);\n      // Long-press on blank space (4s) to enter edit; Esc exits\n      this._installLongPressToEnterEdit();\n      window.addEventListener('keydown', (e)=>{ if (e.key === 'Escape' && this.editMode) this._toggleEditMode(false); });\n\n      // selection interactions in container\n      this._installSelectionMarquee();\n      this.cardContainer.addEventListener('mousedown', (e) => {\n        if (!this.editMode) return;\n        if (e.target.closest('.card-wrapper')) return; // handled per-card\n        if (!e.shiftKey && !e.ctrlKey && !e.metaKey) this._clearSelection();\n      });\n    }\n\n    // Persist new option knobs into storage so next load matches the config.\n    // Skip while in HA\u2019s editor preview to avoid churn. Only queue save in edit mode (handled in _queueSave)\n    try { if (!this._isInHaEditorPreview()) this._queueSave('config-change'); } catch {}\n\n    this._updateStoreBadge();\n    if (this.cardContainer) this._toggleEditMode(false);\n\n    // Only rebuild from storage on first boot or when storage_key changes.\n    // For normal config tweaks, just reflow with the new options.\n   // Boot/rebuild logic\n    this.__cfgReady = true;\n    if (keyChanged && this.__booted) {\n      this._initialLoad(true);\n    } else if (!this.__booted && this.__probed) {\n      this.__booted = true;\n      this._initialLoad();\n    } else {\n      this._applyContainerSizingFromConfig(true);\n      this._resizeContainer();\n    }\n  }\n\n  connectedCallback() {\n    if (!this.__boundExitEdit) {\n      this.__boundExitEdit = () => this._toggleEditMode(false);\n    }\n    window.addEventListener('pagehide', this.__boundExitEdit);\n    window.addEventListener('beforeunload', this.__boundExitEdit);\n  \n    this.__onVis = () => { if (document.visibilityState === 'hidden') this._toggleEditMode(false); };\n    document.addEventListener('visibilitychange', this.__onVis);\n  \n    // NEW: ensure we never boot in edit mode\n    this._toggleEditMode(false);\n  }\n  \n  disconnectedCallback() {\n    window.removeEventListener('pagehide', this.__boundExitEdit);\n    window.removeEventListener('beforeunload', this.__boundExitEdit);\n    document.removeEventListener('visibilitychange', this.__onVis);\n  \n    // NEW: remove long-press listeners if installed\n    if (this.__lpInstalled && this.__lpHandlers) {\n      const cont = this.cardContainer;\n      cont?.removeEventListener('mousedown', this.__lpHandlers.mouseDown);\n      window.removeEventListener('mousemove', this.__lpHandlers.mouseMove);\n      window.removeEventListener('mouseup', this.__lpHandlers.mouseUp);\n      window.removeEventListener('contextmenu', this.__lpHandlers.contextMenu);\n      cont?.removeEventListener('touchstart', this.__lpHandlers.touchStart);\n      window.removeEventListener('touchmove', this.__lpHandlers.touchMove);\n      window.removeEventListener('touchend', this.__lpHandlers.touchEnd);\n      window.removeEventListener('touchcancel', this.__lpHandlers.touchCancel);\n      this.__lpInstalled = false;\n      this.__lpHandlers = null;\n    }\n  }\n  \n\n  set hass(hass) {\n    this._hass = hass;\n    LOG('set hass');\n    if (!this.__probed && hass) {\n      this.__probed = true;\n      this._probeBackend().then(() => { \n        this.__probed = true; \n        if (!this.__booted && this.__cfgReady) { \n          this.__booted = true; \n          this._initialLoad(true); \n        } \n      });\n    }\n    \n    const wraps = this.cardContainer?.children || [];\n    for (const wrap of wraps) {\n      const c = wrap.firstElementChild;\n      if (c && c.hass !== hass) {\n        c.hass = hass;\n        // Don't reprocess card_mod here - it will be handled by _processCardModOnce\n      }\n    }\n  }\n  \n  get hass() { return this._hass; }\n\n  /* ------------------------ Initial load / rebuild ------------------------ */\n  async _initialLoad(force = false) {\n    // prevent multiple parallel boots\n    if (this.__booting) return;\n    this.__booting = true;\n\n    try {\n      // mark loading in progress to prevent autosave during rebuild\n      this._loading = true;\n\n      if (force && this.cardContainer) {\n        this.cardContainer.innerHTML = '';\n      }\n\n      this._dbgPush('boot', 'Initial load start', { force });\n\n      const __rebuildAfter = [];\n      let saved = null;\n\n      // Try backend first if available\n      if (this._backendOK && this.storageKey) {\n        try {\n          saved = await this._loadLayoutFromBackend(this.storageKey);\n        } catch (e) {\n          this._dbgPush('boot', 'Backend load failed', { error: String(e) });\n        }\n      }\n\n      // Fallback: localStorage (and migrate to backend if possible)\n      if (!saved && this.storageKey) {\n        let local = null;\n        try {\n          local = JSON.parse(localStorage.getItem(`ddc_local_${this.storageKey}`) || 'null');\n        } catch {}\n        if (local) {\n          this._dbgPush('boot', 'Found local snapshot', { bytes: JSON.stringify(local).length });\n\n          if (this._backendOK) {\n            try {\n              await this._saveLayoutToBackend(this.storageKey, local);\n              this._dbgPush('boot', 'Migrated local -> backend');\n              saved = local;\n            } catch (e) {\n              this._dbgPush('boot', 'Migration failed, staying local', { error: String(e) });\n              saved = local;\n            }\n          } else {\n            saved = local;\n          }\n        }\n      }\n\n      // Fallback: embedded YAML config\n      if (!saved && this._config?.cards?.length) {\n        this._dbgPush('boot', 'Using embedded config');\n        saved = { cards: this._config.cards };\n      }\n\n      // Snapshot of YAML before we overlay anything\n      const yamlCfg = { ...(this._config || {}) };\n\n      // 1) Apply persisted options as baseline\n        if (saved?.options) {\n          const { storage_key, ...optsNoKey } = saved.options;\n          this._applyImportedOptions(optsNoKey, true);\n        } else if (typeof saved?.grid === 'number') {\n        this._applyImportedOptions({ grid: saved.grid }, true);\n      }\n\n      // 2) Overlay explicit YAML options (take precedence)\n      const overrideKeys = [\n        'storage_key','grid','drag_live_snap','auto_save','auto_save_debounce',\n        'container_background','card_background','debug','disable_overlap',\n        'container_size_mode','container_fixed_width','container_fixed_height',\n        'container_preset','container_preset_orientation'\n      ];\n      const cfgOpts = {};\n      for (const k of overrideKeys) {\n        if (yamlCfg[k] !== undefined) cfgOpts[k] = yamlCfg[k];\n      }\n      if (Object.keys(cfgOpts).length) {\n        this._applyImportedOptions(cfgOpts, true);\n      }\n\n      // Build cards\n      let builtAny = false;\n\n      if (saved?.cards?.length) {\n        for (const conf of saved.cards) {\n          if (!conf?.card || (typeof conf.card === 'object' && Object.keys(conf.card).length === 0)) {\n            // empty/placeholder\n            const wrap = this._makePlaceholderAt(\n              conf.position?.x || 0,\n              conf.position?.y || 0,\n              conf.size?.width  || 200,\n              conf.size?.height || 200\n            );\n            this.cardContainer.appendChild(wrap);\n            try { this._rebuildOnce(wrap.firstElementChild); } catch {}\n            builtAny = true;\n            continue;\n          }\n\n          const cardEl = await this._createCard(conf.card);\n          const wrap = this._makeWrapper(cardEl);\n          if (this.editMode) wrap.classList.add('editing');\n\n          this._setCardPosition(wrap, conf.position?.x || 0, conf.position?.y || 0);\n          wrap.style.width  = `${conf.size?.width  ?? 14 * this.gridSize}px`;\n          wrap.style.height = `${conf.size?.height ?? 10 * this.gridSize}px`;\n          if (conf.z != null) wrap.style.zIndex = String(conf.z);\n\n          this.cardContainer.appendChild(wrap);\n\n          try { this._rebuildOnce(wrap.firstElementChild); } catch {}\n          this._initCardInteract(wrap);\n          builtAny = true;\n        }\n\n        this._resizeContainer();\n        this._dbgPush('boot', 'Layout applied', { count: saved.cards.length });\n      }\n\n      if (!builtAny) {\n        this._showEmptyPlaceholder();\n        this._dbgPush('boot', 'No saved layout found; showing placeholder');\n      }\n\n      this._updateStoreBadge();\n      this._syncEmptyStateUI();\n\n      // Ensure card-mod runs once after first paint\n      if (force) this._cardModProcessed = false;\n      setTimeout(() => {\n        this._processCardModOnce();\n      }, 100);\n\n      // Rebuild signals for nested cards\n      try {\n        __rebuildAfter.forEach((el) => {\n          try {\n            el.dispatchEvent(new Event('ll-rebuild', { bubbles: true, composed: true }));\n          } catch {}\n        });\n      } catch {}\n    } finally {\n      this._loading = false;\n      this.__booting = false;\n      this.__dirty = false;\n      this._updateApplyBtn?.();\n    }\n  }\n\n\n  /* ------------------------------ Edit mode ------------------------------ */\n  _toggleEditMode(force=null) {\n    // NEW: kill any in-flight \u201Center edit\u201D timer \n    try { this.__clearPressTimer?.(); } catch {}\n    const entering = (force === null) ? !this.editMode : !!force;\n    const wasOff = !this.editMode && entering;\n  \n    this.editMode = entering;\n\n    this.editMode = entering;\n    this.addButton.style.display   = this.editMode ? 'inline-block' : 'none';\n    this.reloadBtn.style.display   = this.editMode ? 'inline-block' : 'none';\n    this.diagBtn.style.display     = this.editMode ? 'inline-block' : 'none';\n    this.exitEditBtn.style.display = this.editMode ? 'inline-block' : 'none';\n    this.exportBtn.style.display   = this.editMode ? 'inline-block' : 'none';\n    this.importBtn.style.display   = this.editMode ? 'inline-block' : 'none';\n    this.exploreBtn.style.display  = this.editMode ? 'inline-block' : 'none';\n    this.storeBadge.style.display  = this.editMode ? 'inline-block' : 'none';\n    this.applyLayoutBtn.style.display = this.editMode ? 'inline-block' : 'none';\n    this._syncEmptyStateUI();\n    \n    this.cardContainer.classList.toggle('grid-on', this.editMode);\n\n    const wraps = this.cardContainer.querySelectorAll('.card-wrapper');\n    wraps.forEach((w) => {\n      w.classList.toggle('editing', this.editMode);\n      const handle = w.querySelector('.resize-handle');\n      if (handle) handle.style.display = this.editMode ? 'flex' : 'none';\n      if (!w.dataset.placeholder && window.interact) {\n        window.interact(w).draggable(this.editMode).resizable(this.editMode);\n      }\n      w.style.touchAction = this.editMode ? 'none' : 'auto';\n    });\n    if (!this.editMode) this._clearSelection();\n\n    if (!this.editMode) {\n      // clear any stale dragging classes\n      this.cardContainer?.querySelectorAll('.card-wrapper.dragging')\n        .forEach(w => w.classList.remove('dragging'));\n    }\n\n    // Play ripple when switching ON\n    if (wasOff) {\n      // center by default, unless last hold coords known\n      const ox = this.__lastHoldX ?? null;\n      const oy = this.__lastHoldY ?? null;\n      this._playEditRipple(ox, oy);\n    }\n  }\n\n  _isInHaEditorPreview() {\n    // Walk up through parents and shadow hosts to detect HA's edit/preview dialog\n    let n = this;\n    while (n) {\n      const tag = (n.nodeType === 1 && n.localName) ? n.localName.toLowerCase() : '';\n      if (tag === 'hui-card-editor' || tag === 'hui-dialog-edit-card' || tag === 'hui-card-preview') return true;\n      if (tag === 'ha-dialog' || tag === 'mwc-dialog') return true; // general HA dialogs (edit card, more-info, etc.)\n      const root = n.getRootNode && n.getRootNode();\n      n = n.parentElement || (root && root.host) || null;\n    }\n    return false;\n  }\n\n  // Replace your _installLongPressToEnterEdit with this version:\n  /* 2) Install long-press ONCE, keep handles so we can remove them later */\n  // Replace your existing _installLongPressToEnterEdit() with this:\n// Robust, pointer-events-based long-press to enter edit mode\n_installLongPressToEnterEdit() {\n  if (this.__lpInstalled) return;\n  this.__lpInstalled = true;\n\n  const cont = this.cardContainer;\n  if (!cont) return;\n\n  // Tunables\n  const HOLD_MS  = 800;  // how long to hold\n  const DRIFT_PX = 18;   // cancel if the pointer drifts more than this\n\n  // ---- helpers ------------------------------------------------------------\n  const isElem = (n) => !!n && typeof n === 'object' && n.nodeType === 1; // Element node\n  const containsSafe = (root, node) => {\n    try { return !!(root && node && typeof root.contains === 'function' && isElem(node) && root.contains(node)); }\n    catch { return false; }\n  };\n  const within = (el) => containsSafe(this.cardContainer, el);\n\n  const isOverCard = (ev) => {\n    // 1) Fast path via target.closest\n    const hit = ev.target?.closest?.('.card-wrapper');\n    if (isElem(hit) && within(hit) && !hit.classList.contains('ddc-placeholder')) return true;\n\n    // 2) Robust path via composedPath() (skip non-Elements like window/document)\n    const path = typeof ev.composedPath === 'function' ? ev.composedPath() : [];\n    for (const n of path) {\n      if (!isElem(n)) continue;\n      if (!within(n)) continue;\n      if (n.classList?.contains('card-wrapper') && !n.classList.contains('ddc-placeholder')) return true;\n    }\n    return false;\n  };  \n\n  const makeRing = (x, y) => {\n    const el = document.createElement('div');\n    el.className = 'ddc-press-ring';\n    document.body.appendChild(el); // ensure always visible\n    Object.assign(el.style, {\n      position: 'fixed', left: `${x}px`, top: `${y}px`,\n      zIndex: '100000', width: '44px', height: '44px',\n      pointerEvents: 'none', marginLeft: '-22px', marginTop: '-22px',\n      filter: 'drop-shadow(0 2px 6px rgba(0,0,0,.35))'\n    });\n    el.innerHTML = `\n      <svg viewBox=\"0 0 44 44\" aria-hidden=\"true\" style=\"width:44px;height:44px\">\n        <circle cx=\"22\" cy=\"22\" r=\"18\" style=\"stroke:rgba(255,255,255,.45);stroke-width:4;fill:none\"></circle>\n        <circle class=\"pr-fg\" cx=\"22\" cy=\"22\" r=\"18\" style=\"stroke:var(--primary-color);stroke-width:4;fill:none;stroke-linecap:round\"></circle>\n        <circle cx=\"22\" cy=\"22\" r=\"2\" style=\"fill:var(--primary-color);opacity:.95\"></circle>\n      </svg>`;\n    const fg = el.querySelector('.pr-fg');\n    const r = 18, circ = 2 * Math.PI * r;\n    fg.style.strokeDasharray = `${circ}`;\n    fg.style.strokeDashoffset = `${circ}`;\n    requestAnimationFrame(() => {\n      fg.style.transition = `stroke-dashoffset ${HOLD_MS}ms linear`;\n      fg.style.strokeDashoffset = '0';\n    });\n    return {\n      el,\n      move(nx, ny) { el.style.left = `${nx}px`; el.style.top = `${ny}px`; },\n      remove() { try { el.remove(); } catch {} }\n    };\n  };  \n\n  // ---- state --------------------------------------------------------------\n  let timer = null;\n  let ring  = null;\n  let startX = 0, startY = 0;\n  let activePointerId = null;\n\n  const clearTimer = () => { if (timer) clearTimeout(timer); timer = null; ring?.remove(); ring = null; };\n  this.__clearPressTimer = clearTimer; // allow external cancel on mode changes\n\n\n  \n  // ---- handlers -----------------------------------------------------------\n  const onPointerDown = (e) => {\n    // Left mouse / primary touch only\n    if (e.pointerType === 'mouse' && e.button !== 0) return;\n    if (this._isInHaEditorPreview()) return;\n\n    // Only trigger on empty space *within this container*\n    if (!within(e.target) || isOverCard(e)) return;\n\n    activePointerId = e.pointerId;\n    startX = e.clientX; startY = e.clientY;\n    this.__lastHoldX = startX; this.__lastHoldY = startY;\n\n    // visual progress ring\n    ring = makeRing(startX, startY);\n\n    timer = setTimeout(() => {\n      clearTimer();\n      const toState = !this.editMode;\n      this._toggleEditMode(toState);\n      this._toast?.(`Edit mode ${toState ? 'enabled' : 'disabled'}`);\n    }, HOLD_MS);\n  };\n\n  const onPointerMove = (e) => {\n    if (timer == null || e.pointerId !== activePointerId) return;\n    ring?.move(e.clientX, e.clientY);\n    if (Math.abs(e.clientX - startX) > DRIFT_PX || Math.abs(e.clientY - startY) > DRIFT_PX) {\n      clearTimer();\n    }\n  };\n\n  const onPointerUpOrCancel = (e) => {\n    if (e.pointerId !== activePointerId) return;\n    clearTimer();\n    activePointerId = null;\n  };\n\n  const onContextMenu = (e) => {\n    // prevent the OS context menu *only while* long-press is pending\n    if (timer) { e.preventDefault(); e.stopPropagation(); return false; }\n  };\n\n  const onDblClick = (e) => {\n    if (this._isInHaEditorPreview()) return;\n    if (!within(e.target) || isOverCard(e)) return;\n    const toState = !this.editMode;\n    this._toggleEditMode(toState);\n    this._toast?.(`Edit mode ${toState ? 'enabled' : 'disabled'}`);\n  };\n\n  // ---- wire up ------------------------------------------------------------\n  cont.addEventListener('pointerdown', onPointerDown);\n  window.addEventListener('pointermove', onPointerMove, { passive: true });\n  window.addEventListener('pointerup', onPointerUpOrCancel, { passive: true });\n  window.addEventListener('pointercancel', onPointerUpOrCancel, { passive: true });\n  window.addEventListener('contextmenu', onContextMenu);\n\n  cont.addEventListener('dblclick', onDblClick);\n\n  // keep references for clean-up in disconnectedCallback\n  this.__lpHandlers = { onPointerDown, onPointerMove, onPointerUpOrCancel, onContextMenu, onDblClick };\n}\n\n\n_isLayoutEmpty() {\n  const c = this.cardContainer;\n  if (!c) return true;\n  return c.querySelectorAll('.card-wrapper:not(.ddc-placeholder)').length === 0;\n}\n\n_syncEmptyStateUI() {\n  // Show Add button even outside edit mode when empty; style it as a CTA.\n  const empty = this._isLayoutEmpty();\n  if (this.addButton) {\n    const show = this.editMode || empty;\n    this.addButton.style.display = show ? 'inline-block' : 'none';\n    this.addButton.classList.toggle('cta-empty', !this.editMode && empty);\n  }\n\n  // Keep other toolbar buttons hidden unless we\u2019re in edit mode\n  const toggle = (el) => el && (el.style.display = this.editMode ? 'inline-block' : 'none');\n  toggle(this.reloadBtn);\n  toggle(this.diagBtn);\n  toggle(this.exitEditBtn);\n  toggle(this.exportBtn);\n  toggle(this.importBtn);\n  toggle(this.exploreBtn);\n  toggle(this.storeBadge);\n  toggle(this.applyLayoutBtn);\n  }\n\n    _updateApplyBtn() {\n    if (this.applyLayoutBtn) this.applyLayoutBtn.disabled = !this.__dirty;\n  }\n  _markDirty(reason='') {\n    this.__dirty = true;\n    this._updateApplyBtn();\n    this._dbgPush?.('dirty', 'Marked dirty', { reason });\n  }\n\n  _playEditRipple(clientX=null, clientY=null) {\n    const cont = this.cardContainer;\n    if (!cont) return;\n    const r = cont.getBoundingClientRect();\n    const x = clientX == null ? (r.left + r.width/2) : clientX;\n    const y = clientY == null ? (r.top  + r.height/2) : clientY;\n    const localX = x - r.left;\n    const localY = y - r.top;\n\n    const veil = document.createElement('div');\n    veil.className = 'ddc-ripple-veil';\n    veil.style.setProperty('--rip-x', `${localX}px`);\n    veil.style.setProperty('--rip-y', `${localY}px`);\n    cont.appendChild(veil);\n    setTimeout(()=> veil.remove(), 450);\n  }\n\n  /* ------------------------- Drag/Resize via Interact ------------------------- */\n  _initInteract() {\n    const wraps = this.cardContainer.querySelectorAll('.card-wrapper');\n    wraps.forEach((w) => this._initCardInteract(w));\n  }\n  _initCardInteract(wrap) {\n    if (!window.interact || wrap.dataset.placeholder) return;\n    const gs = this.gridSize, live = !!this.dragLiveSnap;\n\n    // DRAG (supports multi\u2011select move with optional live snap)\n    const restrictMod = window.interact.modifiers.restrictRect({\n      restriction: 'parent',\n      endOnly: true\n    });\n    const mods = [restrictMod];\n\n    // When dragLiveSnap is true, use Interact\u2019s built\u2011in snap modifier so the pointer\n    // (and therefore the element) is snapped to the grid before your handler runs.\n    if (this.dragLiveSnap) {\n      const gridSnap = window.interact.snappers.grid({ x: this.gridSize, y: this.gridSize });\n      mods.push(window.interact.modifiers.snap({\n        targets: [gridSnap],\n        range: Infinity,\n        offset: 'startCoords'\n      }));\n    }\n\n    window.interact(wrap).draggable({\n      enabled: this.editMode,\n      inertia: false,\n      modifiers: mods,\n      listeners: {\n        start: (ev) => {\n          // ensure the clicked card is in the selection\n          if (!this._selection.has(wrap)) {\n            if (!ev?.shiftKey && !ev?.ctrlKey && !ev?.metaKey) this._clearSelection();\n            this._toggleSelection(wrap, true);\n          }\n          const group = Array.from(this._selection);\n          this.__groupDrag = {\n            leader: wrap,\n            members: group,\n            startRaw: new Map(group.map(w => [w, {\n              x: parseFloat(w.getAttribute('data-x-raw')) || parseFloat(w.getAttribute('data-x')) || 0,\n              y: parseFloat(w.getAttribute('data-y-raw')) || parseFloat(w.getAttribute('data-y')) || 0,\n              w: parseFloat(w.style.width)  || w.getBoundingClientRect().width,\n              h: parseFloat(w.style.height) || w.getBoundingClientRect().height,\n            }]))\n          };\n\n          // Capture original raw positions of all cards (non\u2011placeholders) so we can restore them\n          this.__collisionOriginals = new Map();\n          const allCardsStart = this.cardContainer.querySelectorAll('.card-wrapper:not(.ddc-placeholder)');\n          allCardsStart.forEach(c => {\n            const rawX = parseFloat(c.getAttribute('data-x-raw')) || parseFloat(c.getAttribute('data-x')) || 0;\n            const rawY = parseFloat(c.getAttribute('data-y-raw')) || parseFloat(c.getAttribute('data-y')) || 0;\n            this.__collisionOriginals.set(c, { x: rawX, y: rawY });\n          });\n\n          group.forEach(w => {\n            w.classList.add('dragging');\n            if (w.getAttribute('data-x-raw') === null) {\n              w.setAttribute('data-x-raw', w.getAttribute('data-x') || '0');\n            }\n            if (w.getAttribute('data-y-raw') === null) {\n              w.setAttribute('data-y-raw', w.getAttribute('data-y') || '0');\n            }\n          });\n        },\n\n        move: (ev) => {\n          if (!this.__groupDrag) return;\n          const gs   = this.gridSize;\n          const live = !!this.dragLiveSnap;\n          const lead = this.__groupDrag.leader;\n          const srL  = this.__groupDrag.startRaw.get(lead);\n\n          // Compute new raw leader coordinates using pointer delta\n          const curLeadX = (parseFloat(lead.getAttribute('data-x-raw')) || srL.x) + ev.dx;\n          const curLeadY = (parseFloat(lead.getAttribute('data-y-raw')) || srL.y) + ev.dy;\n          const dxLead   = curLeadX - srL.x;\n          const dyLead   = curLeadY - srL.y;\n\n          // Build proposed positions for all selected cards\n          const proposed = this.__groupDrag.members.map(m => {\n            const sr = this.__groupDrag.startRaw.get(m);\n            const rawX  = sr.x + dxLead;\n            const rawY  = sr.y + dyLead;\n            const snapX = live ? Math.round(rawX / gs) * gs : rawX;\n            const snapY = live ? Math.round(rawY / gs) * gs : rawY;\n            return { el: m, rawX, rawY, snapX, snapY, w: sr.w, h: sr.h };\n          });\n\n          // If overlap protection is on, restore other cards and push them out of the way\n          if (this.disableOverlap) {\n            this._pushCardsOutOfTheWay(proposed, dxLead, dyLead, live, gs);\n          }\n\n          // Commit the move: update raw coordinates and apply snapped transform\n          lead.setAttribute('data-x-raw', String(curLeadX));\n          lead.setAttribute('data-y-raw', String(curLeadY));\n          for (const pr of proposed) {\n            pr.el.setAttribute('data-x-raw', String(pr.rawX));\n            pr.el.setAttribute('data-y-raw', String(pr.rawY));\n            this._setCardPosition(pr.el, pr.snapX, pr.snapY);\n          }\n          this._resizeContainer();\n        },\n\n        end: (ev) => {\n          if (!this.__groupDrag) return;\n          const gs = this.gridSize;\n\n          // Gather final positions (unsnapped and snapped) for the dragged group\n          const endRects = this.__groupDrag.members.map(m => {\n            const rawX = parseFloat(m.getAttribute('data-x-raw')) || parseFloat(m.getAttribute('data-x')) || 0;\n            const rawY = parseFloat(m.getAttribute('data-y-raw')) || parseFloat(m.getAttribute('data-y')) || 0;\n            const snapX = Math.round(rawX / gs) * gs;\n            const snapY = Math.round(rawY / gs) * gs;\n            const w  = parseFloat(m.style.width)  || m.getBoundingClientRect().width;\n            const h  = parseFloat(m.style.height) || m.getBoundingClientRect().height;\n            return { el: m, rawX, rawY, snapX, snapY, w, h };\n          });\n\n          // On end, do a final restore/push to prevent leftover overlaps\n          if (this.disableOverlap) {\n            this._pushCardsOutOfTheWay(endRects, 0, 0, false, gs);\n          }\n\n          // Snap cards to the grid and update raw coordinates\n          for (const pr of endRects) {\n            this._setCardPosition(pr.el, pr.snapX, pr.snapY);\n            pr.el.setAttribute('data-x-raw', String(pr.snapX));\n            pr.el.setAttribute('data-y-raw', String(pr.snapY));\n          }\n\n          // Cleanup\n          for (const m of this.__groupDrag.members) m.classList.remove('dragging');\n          this._resizeContainer();\n          if (this._isContainerFixed()) this._clampAllCardsInside();\n          this._queueSave(this.__groupDrag.members.length > 1 ? 'group-drag-end' : 'drag-end');\n          this.__groupDrag = null;\n          this.__collisionOriginals = null;\n        }\n      }\n    });\n\n\n\n    // RESIZE \u2014 bottom-right handle only (single card)\n    window.interact(wrap).resizable({\n      enabled: this.editMode,\n      edges: { right: '.resize-handle', bottom: '.resize-handle' },\n      inertia:false,\n      listeners:{\n        move:(ev)=>{\n          const gs   = this.gridSize;\n          const live = !!this.dragLiveSnap;\n          const curW = parseFloat(wrap.style.width)  || wrap.getBoundingClientRect().width;\n          const curH = parseFloat(wrap.style.height) || wrap.getBoundingClientRect().height;\n    \n          let {width, height} = ev.rect;\n          const wTry = live ? Math.max(gs, Math.round(width/gs)*gs) : width;\n          const hTry = live ? Math.max(gs, Math.round(height/gs)*gs) : height;\n        \n          const x = parseFloat(wrap.getAttribute('data-x')) || 0;\n          const y = parseFloat(wrap.getAttribute('data-y')) || 0;\n        \n          // \u2B07\uFE0F clamp size if container is fixed\n          let nextW = wTry;\n          let nextH = hTry;\n          if (this._isContainerFixed()) {\n            const { w: cw, h: ch } = this._getContainerSize();\n            nextW = Math.min(wTry, Math.max(this.gridSize, cw - x));\n            nextH = Math.min(hTry, Math.max(this.gridSize, ch - y));\n          }\n        \n          const proposed = [ this._rectFor(wrap, x, y, nextW, nextH) ];\n        \n          if (this.disableOverlap && this._anyCollisionFor(proposed, new Set([wrap]))) {\n            return;\n          }\n          wrap.style.width  = `${nextW}px`;\n          wrap.style.height = `${nextH}px`;\n          this._resizeContainer();\n        },\n        end:()=>{\n          const gs = this.gridSize;\n          const prevW = parseFloat(wrap.style.width)  || wrap.getBoundingClientRect().width;\n          const prevH = parseFloat(wrap.style.height) || wrap.getBoundingClientRect().height;\n        \n          let wSnap = Math.max(gs, Math.round(prevW/gs)*gs);\n          let hSnap = Math.max(gs, Math.round(prevH/gs)*gs);\n        \n          const x = parseFloat(wrap.getAttribute('data-x')) || 0;\n          const y = parseFloat(wrap.getAttribute('data-y')) || 0;\n        \n          // \u2B07\uFE0F clamp snapped size if container is fixed\n          if (this._isContainerFixed()) {\n            const { w: cw, h: ch } = this._getContainerSize();\n            wSnap = Math.min(wSnap, Math.max(gs, cw - x));\n            hSnap = Math.min(hSnap, Math.max(gs, ch - y));\n          }\n        \n          const proposed = [ this._rectFor(wrap, x, y, wSnap, hSnap) ];\n        \n          if (this.disableOverlap && this._anyCollisionFor(proposed, new Set([wrap]))) {\n            // keep pre-snap size (already applied)\n          } else {\n            wrap.style.width  = `${wSnap}px`;\n            wrap.style.height = `${hSnap}px`;\n          }\n        \n          this._resizeContainer();\n          if (this._isContainerFixed()) this._clampAllCardsInside();   // optional safety\n          this._queueSave('resize-end');\n        }\n      }\n    });\n\n    // selection with clicks\n    wrap.addEventListener('mousedown', (e) => {\n      if (!this.editMode) return;\n      if (e.target.closest('.resize-handle') || e.target.closest('.chip')) return;\n      if (e.shiftKey || e.ctrlKey || e.metaKey) {\n        e.stopPropagation();\n        this._toggleSelection(wrap); // toggle in multi\n      } else {\n        if (!this._selection.has(wrap)) {\n          this._clearSelection();\n          this._toggleSelection(wrap, true);\n        }\n      }\n    });\n  }\n\n  /* ------------------------ Card creation & wrapper ------------------------ */\n  async _createCard(cfg) {\n    const helpers = (await this._helpersPromise) || await window.loadCardHelpers();\n    const el = helpers.createCardElement(cfg);\n    el.hass = this.hass;\n    \n    // Special handling for mod-card\n    if (cfg.type === 'custom:mod-card') {\n      // mod-card needs to be fully initialized before we can work with it\n      await new Promise(resolve => setTimeout(resolve, 0));\n      \n      // Force mod-card to apply its styles\n      if (el.setConfig && typeof el.setConfig === 'function') {\n        try {\n          // Re-apply config to ensure mod-card processes it\n          el.setConfig(cfg);\n        } catch {}\n      }\n    }\n    \n    return el;\n  }\n\n  _makeWrapper(cardEl) {\n    const wrap = document.createElement('div');\n    wrap.classList.add('card-wrapper');\n    if (this.editMode) wrap.classList.add('editing');\n    if (!wrap.style.zIndex) wrap.style.zIndex = String(this._highestZ() + 1);\n\n    const chip = document.createElement('div');\n    chip.className = 'chip';\n    chip.innerHTML = `\n      <button class=\"mini\" data-act=\"edit\" title=\"Edit\" aria-label=\"Edit\">\n        <ha-icon icon=\"mdi:pencil\"></ha-icon><span>Edit</span>\n      </button>\n      <button class=\"mini\" data-act=\"duplicate\" title=\"Duplicate\" aria-label=\"Duplicate\">\n        <ha-icon icon=\"mdi:content-copy\"></ha-icon><span>Duplicate</span>\n      </button>\n      <button class=\"mini pill\" data-act=\"front\" title=\"Bring forward\" aria-label=\"Bring forward\">\n        <ha-icon icon=\"mdi:arrange-bring-forward\"></ha-icon>\n      </button>\n      <button class=\"mini pill\" data-act=\"back\" title=\"Send backward\" aria-label=\"Send backward\">\n        <ha-icon icon=\"mdi:arrange-send-backward\"></ha-icon>\n      </button>\n      <button class=\"mini danger pill\" data-act=\"delete\" title=\"Delete card\" aria-label=\"Delete card\">\n        <ha-icon icon=\"mdi:close-thick\"></ha-icon>\n      </button>\n    `;\n\n    chip.addEventListener('click', async (e) => {\n      e.stopPropagation();\n      const act = e.target?.closest('button')?.dataset?.act; if (!act) return;\n\n      if (act === 'delete') {\n        if (this._selection.size > 1 && this._selection.has(wrap)) {\n          const toDel = Array.from(this._selection);\n          toDel.forEach(w => w.remove());\n          this._clearSelection();\n          this._resizeContainer(); this._queueSave('delete-multi'); this._ensurePlaceholderIfEmpty();\n        } else {\n          wrap.remove(); this._resizeContainer(); this._queueSave('delete'); this._ensurePlaceholderIfEmpty();\n        }\n      } else if (act === 'duplicate' || act === 'copy') {\n        const targets = (this._selection.size > 1 && this._selection.has(wrap)) ? Array.from(this._selection) : [wrap];\n        for (const t of targets) {\n          const cfg = this._extractCardConfig(t.firstElementChild) || {};\n          const dup = await this._createCard(cfg);\n          const w2 = this._makeWrapper(dup);\n          w2.style.width  = t.style.width;\n          w2.style.height = t.style.height;\n          const x = (parseFloat(t.getAttribute('data-x')) || 0) + this.gridSize;\n          const y = (parseFloat(t.getAttribute('data-y')) || 0) + this.gridSize;\n          this._setCardPosition(w2, x, y);\n          w2.style.zIndex = String(this._highestZ() + 1);\n          this.cardContainer.appendChild(w2);\n          try { this._rebuildOnce(w2.firstElementChild); } catch {}\n          this._initCardInteract(w2);\n        }\n        this._resizeContainer();\n        this._queueSave('duplicate');\n      } else if (act === 'front') {\n        this._adjustZ(wrap, +1);\n      } else if (act === 'back')  {\n        this._adjustZ(wrap, -1);\n      } else if (act === 'edit') {\n        const cfg = this._extractCardConfig(wrap.firstElementChild) || {};\n        await this._openSmartPicker('edit', cfg, async (newCfg) => {\n          const oldEl = wrap.firstElementChild;\n          const newEl = await this._createCard(newCfg);\n\n          // persist cfg on wrapper (and card-mod flag if you use it)\n          try {\n            wrap.dataset.cfg = JSON.stringify(newCfg);\n            if (this._hasCardModDeep?.(newCfg)) wrap.dataset.needsCardMod = 'true';\n            else delete wrap.dataset.needsCardMod;\n          } catch {}\n\n          // swap the element\n          wrap.replaceChild(newEl, oldEl);\n\n          // ensure connected before driving updates (important for Lit cards)\n          await raf();\n          try {\n            newEl.hass = this.hass;\n            newEl.requestUpdate?.();\n            if (newEl.updateComplete) { try { await newEl.updateComplete; } catch {} }\n          } catch {}\n\n          try { this._rebuildOnce(newEl); } catch {}\n          try { newEl.dispatchEvent(new Event('ll-rebuild', { bubbles: true, composed: true })); } catch {}\n\n          this._resizeContainer?.();\n\n          // SAVE -> THEN HARD RELOAD (avoid debounce race)\n          try {\n            clearTimeout(this._saveTimer);           // cancel debounced save\n            await this._saveLayout(true);            // flush save now\n          } catch (e) { console.warn('Save before reload failed', e); }\n\n          window.location.reload();                  // force refresh so edited card appears\n        });\n      }\n    });\n\n    // ADD THE MISSING SHIELD ELEMENT\n    const shield = document.createElement('div');\n    shield.className = 'shield';\n\n    // ADD THE MISSING HANDLE ELEMENT\n    const handle = document.createElement('div');\n    handle.classList.add('resize-handle');\n    if (!this.editMode) handle.style.display = 'none';  // hide handle if not editing\n    handle.title = 'Resize';\n    handle.innerHTML = `<ha-icon icon=\"mdi:resize-bottom-right\"></ha-icon>`;\n\n    // cache the card config on the wrapper\n    try {\n      const cfg = cardEl._config || cardEl.config;\n      if (cfg && typeof cfg === 'object' && Object.keys(cfg).length) {\n        wrap.dataset.cfg = JSON.stringify(cfg);\n        \n        // Mark if this needs card_mod processing\n        if (this._hasCardModDeep(cfg)) { wrap.dataset.needsCardMod = 'true'; }\n      }\n    } catch {}\n\n    wrap.append(cardEl, shield, chip, handle);\n    // DDC patch: trigger one-time rebuild so nested card_mod attaches\n    try { this._rebuildOnce(cardEl); } catch {}\n    return wrap;\n  }\n\n  _makePlaceholderAt(x=0,y=0,w=400,h=400) {\n    const wrap = document.createElement('div');\n    wrap.classList.add('card-wrapper','ddc-placeholder');\n    wrap.dataset.placeholder = '1';\n    if (this.editMode) wrap.classList.add('editing');\n    this._setCardPosition(wrap, x, y);\n    wrap.style.width = `${w}px`;\n    wrap.style.height = `${h}px`;\n    wrap.style.zIndex = String(this._highestZ() + 1);\n  \n    const inner = document.createElement('div');\n    inner.className = 'ddc-placeholder-inner';\n    // purely decorative; nothing clickable\n    inner.setAttribute('aria-hidden','true');\n\n    // --- Hero UI (image + text) ---\n    const hero = document.createElement('div');\n    hero.className = 'ddc-hero';\n\n    // Optional image: from config.hero_image (e.g. /local/dragdrop-hero.png)\n    // If not provided, this block simply won\u2019t render an <img>.\n    const heroImgUrl = this.heroImage; // already set to default or config override\n    if (heroImgUrl) {\n      const img = document.createElement('img');\n      img.src = heroImgUrl;\n      img.alt = \"\";\n      hero.appendChild(img);\n    }\n\n    // Title + subtitle\n    const title = document.createElement('div');\n    title.className = 'ddc-title';\n    title.textContent = 'Drag & Drop Card';\n    const sub = document.createElement('div');\n    sub.className   = 'ddc-sub';\n    sub.textContent = 'Hold me / double click me to enter Edit mode';\n\n    hero.append(title, sub);\n    inner.appendChild(hero);\n\n    // Let users double-click anywhere on the placeholder to enter edit\n    wrap.addEventListener('dblclick', (e) => {\n      e.stopPropagation();\n      this._toggleEditMode(true);\n    });\n  \n    const shield = document.createElement('div');\n    shield.className = 'shield';\n  \n    wrap.append(inner, shield);\n    return wrap;\n  }\n\n    _processCardModOnce() {\n    // Only run once per load\n    if (this._cardModProcessed) return;\n    this._cardModProcessed = true;\n    \n    const wraps = this.cardContainer?.querySelectorAll('[data-needs-card-mod=\"true\"]') || [];\n    \n    wraps.forEach(wrap => {\n      const card = wrap.firstElementChild;\n      if (!card) return;\n      \n      const config = card._config || card.config;\n      if (!config) return;\n      \n      // For mod-card specifically, we need to wait for it to be fully initialized\n      if (config.type === 'custom:mod-card') {\n        // mod-card needs its inner card to be ready\n        setTimeout(() => {\n          if (card.updateComplete) {\n            card.updateComplete.then(() => {\n              card.requestUpdate();\n            });\n          } else if (card.setConfig) {\n            try {\n              card.setConfig({...config});\n            } catch {}\n          }\n        }, 100);\n      } else if (config.card_mod && card.setConfig) {\n        // Regular card_mod\n        try {\n          card.setConfig({...config});\n        } catch {}\n      }\n    });\n  }\n\n  _showEmptyPlaceholder() {\n    if (this.cardContainer.querySelector('.ddc-placeholder')) return;\n    const p = this._makePlaceholderAt(0,0,200,200);\n    this.cardContainer.appendChild(p);\n    this._resizeContainer();\n    this._syncEmptyStateUI();\n\n  }\n  _hideEmptyPlaceholder() { this.cardContainer.querySelectorAll('.ddc-placeholder').forEach(n => n.remove()); }\n  _ensurePlaceholderIfEmpty() {\n    const realCards = this.cardContainer.querySelectorAll('.card-wrapper:not(.ddc-placeholder)');\n    if (realCards.length === 0) this._showEmptyPlaceholder();\n    this._syncEmptyStateUI();\n  }\n\n  _adjustZ(wrap, delta) {\n    const cur = parseInt(wrap.style.zIndex || '1', 10);\n    let next = cur + delta;\n    next = Math.max(1, Math.min(9999, next));\n    wrap.style.zIndex = String(next);\n    this._queueSave('z-change');\n  }\n\n  _highestZ() {\n    let max = 0;\n    this.cardContainer.querySelectorAll('.card-wrapper').forEach(w => {\n      const z = parseInt(w.style.zIndex || '0', 10);\n      if (z > max) max = z;\n    });\n    return max;\n  }\n\n  _setCardPosition(el, x, y) {\n    // ensure integer CSS pixels and use 3D translate to avoid compositor fuzz\n    const nx = Math.round(x);\n    const ny = Math.round(y);\n    el.style.transform = `translate3d(${nx}px, ${ny}px, 0)`;\n    el.setAttribute('data-x', String(nx));\n    el.setAttribute('data-y', String(ny));\n    el.setAttribute('data-x-raw', String(nx));\n    el.setAttribute('data-y-raw', String(ny));\n  }\n  \n\n  _resizeContainer() {\n    const c = this.cardContainer; if (!c) return;\n  \n    // In fixed modes, do NOT auto-grow/shrink \u2014 the box is hard-locked.\n    if (this._isContainerFixed()) return;\n  \n    // Dynamic mode: compute based on content\n    const cards = Array.from(c.querySelectorAll('.card-wrapper'));\n    let maxX = 0, maxY = 0;\n    cards.forEach((card) => {\n      const r  = card.getBoundingClientRect();\n      const cr = c.getBoundingClientRect();\n      const right  = r.left - cr.left + r.width;\n      const bottom = r.top  - cr.top  + r.height;\n      maxX = Math.max(maxX, right);\n      maxY = Math.max(maxY, bottom);\n    });\n    c.style.width  = `${Math.ceil(maxX/this.gridSize)*this.gridSize || 100}px`;\n    c.style.height = `${Math.ceil(maxY/this.gridSize)*this.gridSize || 100}px`;\n  }\n  \n  /**\n  /**\n   * Restore original positions for non-selected cards, then push out of the way.\n   * This uses this.__collisionOriginals (captured on drag start) and avoids overlaps.\n   * @param {Array} proposedRects \u2013 array of { el, rawX, rawY, snapX, snapY, w, h }\n   * @param {number} dxLead \u2013 leader's delta X (to decide horizontal push direction)\n   * @param {number} dyLead \u2013 leader's delta Y (to decide vertical push direction)\n   * @param {boolean} liveSnap \u2013 true if we should snap positions visually\n   * @param {number} gridSize \u2013 current grid size\n   */\n  _pushCardsOutOfTheWay(proposedRects, dxLead, dyLead, liveSnap, gridSize) {\n    if (!this.__collisionOriginals) return;\n\n    const selectedSet = new Set(proposedRects.map(pr => pr.el));\n    const allCards = Array.from(this.cardContainer.querySelectorAll('.card-wrapper'))\n      .filter(w => !w.dataset.placeholder);\n\n    // Determine container bounds (for fixed modes)\n    const isFixed = this._isContainerFixed();\n    const { w: cw, h: ch } = this._getContainerSize();\n\n    // Restore every non-selected card to its original raw position\n    for (const w of allCards) {\n      if (selectedSet.has(w)) continue;\n      const orig = this.__collisionOriginals.get(w);\n      if (orig) {\n        w.setAttribute('data-x-raw', String(orig.x));\n        w.setAttribute('data-y-raw', String(orig.y));\n        const snX = liveSnap ? Math.round(orig.x / gridSize) * gridSize : orig.x;\n        const snY = liveSnap ? Math.round(orig.y / gridSize) * gridSize : orig.y;\n        this._setCardPosition(w, snX, snY);\n      }\n    }\n\n    // Prepare lists for collision checks\n    const selectedRects = proposedRects.map(pr => ({\n      x: pr.snapX,\n      y: pr.snapY,\n      w: pr.w,\n      h: pr.h,\n    }));\n\n    // Map to store the final pushed positions of non-selected cards\n    const finalPos = new Map();\n\n    // Store original widths and heights\n    const cardSizes = new Map();\n    for (const w of allCards) {\n      const width  = parseFloat(w.style.width)  || w.getBoundingClientRect().width;\n      const height = parseFloat(w.style.height) || w.getBoundingClientRect().height;\n      cardSizes.set(w, { w: width, h: height });\n    }\n\n    // Decide primary push direction based on leader movement\n    const signX = (dxLead > 0) ? 1 : (dxLead < 0 ? -1 : 0);\n    const signY = (dyLead > 0) ? 1 : (dyLead < 0 ? -1 : 0);\n    const horizontal = Math.abs(dxLead) >= Math.abs(dyLead);\n\n    // For each non-selected card, compute its new position\n    for (const other of allCards) {\n      if (selectedSet.has(other)) continue;\n      const orig = this.__collisionOriginals.get(other);\n      if (!orig) continue;\n\n      let { x: candidateX, y: candidateY } = orig;\n      const { w: ow, h: oh } = cardSizes.get(other);\n\n      // Determine if it overlaps with any selected rectangle\n      let overlaps = false;\n      for (const sr of selectedRects) {\n        if (this._rectsOverlap({ x: sr.x, y: sr.y, w: sr.w, h: sr.h },\n                              { x: candidateX, y: candidateY, w: ow, h: oh })) {\n          overlaps = true;\n          // Choose initial push direction\n          if (horizontal && signX !== 0) {\n            candidateX = signX > 0 ? sr.x + sr.w : sr.x - ow;\n          } else if (!horizontal && signY !== 0) {\n            candidateY = signY > 0 ? sr.y + sr.h : sr.y - oh;\n          } else {\n            // default horizontal push when no obvious direction\n            candidateX = sr.x + sr.w;\n          }\n          break;\n        }\n      }\n\n      // If overlapping, keep shifting until no collision\n      if (overlaps) {\n        let guard = 0;\n        const dx = horizontal ? (signX !== 0 ? signX * gridSize : gridSize) : 0;\n        const dy = !horizontal ? (signY !== 0 ? signY * gridSize : gridSize) : 0;\n        while (guard < 100) {\n          const candidateRect = { x: candidateX, y: candidateY, w: ow, h: oh };\n          let collision = false;\n\n          // Check against selected\n          for (const sr of selectedRects) {\n            if (this._rectsOverlap(candidateRect, sr)) {\n              collision = true;\n              break;\n            }\n          }\n          // Check against cards already assigned new positions\n          if (!collision) {\n            for (const [, fp] of finalPos) {\n              if (this._rectsOverlap(candidateRect, fp)) {\n                collision = true;\n                break;\n              }\n            }\n          }\n          // Check against container bounds (for fixed container)\n          if (!collision && isFixed) {\n            if (candidateX < 0 || candidateY < 0 ||\n                candidateX + ow > cw || candidateY + oh > ch) {\n              collision = true;\n            }\n          }\n\n          if (!collision) break;\n          // Move further along the chosen axis\n          candidateX += dx;\n          candidateY += dy;\n          guard++;\n        }\n\n        // Finally, clamp to container boundaries for fixed containers\n        if (isFixed) {\n          candidateX = Math.max(0, Math.min(candidateX, Math.max(0, cw - ow)));\n          candidateY = Math.max(0, Math.min(candidateY, Math.max(0, ch - oh)));\n        }\n      }\n\n      finalPos.set(other, { x: candidateX, y: candidateY, w: ow, h: oh });\n      selectedRects.push({ x: candidateX, y: candidateY, w: ow, h: oh });\n    }\n\n    // Apply final positions to non-selected cards\n    for (const [card, pos] of finalPos) {\n      card.setAttribute('data-x-raw', String(pos.x));\n      card.setAttribute('data-y-raw', String(pos.y));\n      const snX = liveSnap ? Math.round(pos.x / gridSize) * gridSize : pos.x;\n      const snY = liveSnap ? Math.round(pos.y / gridSize) * gridSize : pos.y;\n      this._setCardPosition(card, snX, snY);\n    }\n  }\n\n  _rectFor(el, x = null, y = null, wpx = null, hpx = null) {\n    const x0 = x ?? (parseFloat(el.getAttribute('data-x')) || 0);\n    const y0 = y ?? (parseFloat(el.getAttribute('data-y')) || 0);\n    const w  = wpx ?? (parseFloat(el.style.width)  || el.getBoundingClientRect().width  || 0);\n    const h  = hpx ?? (parseFloat(el.style.height) || el.getBoundingClientRect().height || 0);\n    return { x: x0, y: y0, w, h, el };\n  }\n  _rectsOverlap(a, b, eps = 0.5) {\n    return !(a.x + a.w <= b.x + eps || b.x + b.w <= a.x + eps ||\n             a.y + a.h <= b.y + eps || b.y + b.h <= a.y + eps);\n  }\n  _anyCollisionFor(proposedRects, ignoreSet) {\n    const others = Array.from(this.cardContainer.querySelectorAll('.card-wrapper'))\n      .filter(w => !ignoreSet.has(w) && !w.dataset.placeholder);\n    if (!others.length) return false;\n    const otherRects = others.map(w => this._rectFor(w));\n    for (const pr of proposedRects) for (const or of otherRects) {\n      if (this._rectsOverlap(pr, or)) return true;\n    }\n    return false;\n  }\n  _extractCardConfig(cardEl){\n    if (!cardEl) return {};\n    // attempt to read the card's own config\n    const cfg = cardEl._config || cardEl.config;\n    if (cfg && typeof cfg === 'object' && Object.keys(cfg).length) {\n      return cfg;\n    }\n    // fallback: if the wrapper cached a config, use it\n    try {\n      // walk up to the wrapper; .closest may not exist on text nodes\n      const wrap = cardEl.closest ? cardEl.closest('.card-wrapper') : null;\n      const raw  = wrap?.dataset?.cfg;\n      if (raw) {\n        const parsed = JSON.parse(raw);\n        if (parsed && typeof parsed === 'object') return parsed;\n      }\n    } catch {}\n    return {};\n  }\n\n  /* ------------------------------- Picker UI ------------------------------- */\n  async _openCardManager() { await this._openSmartPicker('add'); }\n\n  _catalog() {\n    return [\n      { id:'favorites', name:'Favorites', items:[] },\n      { id:'recent',    name:'Recent',    items:[] },\n      { id:'basics',    name:'Basics', items:[\n        {type:'entities',          name:'Entities',          icon:'mdi:format-list-bulleted'},\n        {type:'entity',            name:'Entity',            icon:'mdi:checkbox-blank-circle-outline'},\n        {type:'tile',              name:'Tile',              icon:'mdi:view-grid-outline'},\n        {type:'button',            name:'Button',            icon:'mdi:gesture-tap-button'},\n        {type:'glance',            name:'Glance',            icon:'mdi:eye-outline'},\n        {type:'markdown',          name:'Markdown',          icon:'mdi:language-markdown'},\n        // NEW: allow adding an empty custom card that the user can edit manually\n        {type:'custom_card',       name:'Custom Card',       icon:'mdi:puzzle-outline'},\n      ]},\n\n      { id:'sensors',   name:'Sensors', items:[\n        {type:'sensor',            name:'Sensor',            icon:'mdi:antenna'},\n        {type:'gauge',             name:'Gauge',             icon:'mdi:gauge'},\n        {type:'history-graph',     name:'History graph',     icon:'mdi:chart-line'},\n        {type:'statistics-graph',  name:'Statistics graph',  icon:'mdi:chart-bar'},\n      ]},\n      { id:'visual', name:'Visual', items:[\n        {type:'picture-entity',    name:'Picture entity',    icon:'mdi:image-outline'},\n        {type:'picture-glance',    name:'Picture glance',    icon:'mdi:image-multiple-outline'},\n        {type:'weather-forecast',  name:'Weather',           icon:'mdi:weather-partly-cloudy'},\n        {type:'map',               name:'Map',               icon:'mdi:map'},\n        {type:'iframe',            name:'iFrame',            icon:'mdi:application'},\n      ]},\n      { id:'controls', name:'Controls', items:[\n        {type:'light',             name:'Light',             icon:'mdi:lightbulb-outline'},\n        {type:'thermostat',        name:'Thermostat',        icon:'mdi:thermostat'},\n        {type:'media-control',     name:'Media control',     icon:'mdi:play-circle-outline'},\n        {type:'alarm-panel',       name:'Alarm panel',       icon:'mdi:shield-home-outline'},\n        {type:'area',              name:'Area',              icon:'mdi:map-marker'},\n      ]},\n    ];\n  }\n\n  /* ---- Find/create a config editor element for a given card type ---- */\n  async _getEditorElementForType(type, cfg) {\n    // Log the start of an editor lookup; this uses console.debug so it is visible\n    try { console.info('[ddc:editor] Requesting editor element', { type, cfg }); } catch {}\n    const helpers = (await this._helpersPromise) || await window.loadCardHelpers();\n  \n    // Warm the module before asking for the class only for built\u2011in HA cards.\n    // Skip preloading for custom cards (including the \"custom_card\" placeholder) since they have no core modules.\n    try {\n      if (typeof type === 'string' && type && !type.startsWith('custom:') && type !== 'custom_card') {\n        await this._ensureCardModuleLoaded(type, cfg);\n      }\n    } catch {}\n  \n    // We will compute the card class on demand when needed. Avoid keeping a reference\n    // to a potentially undefined variable across different scopes.\n    const getCardClass = async () => {\n      try {\n        if (helpers.getCardElementClass) {\n          // Use the helper if available\n          return await helpers.getCardElementClass(type);\n        }\n        // Fallback: instantiate the card (using a stub) and return its constructor.\n        let baseCfg;\n        if (cfg && typeof cfg === 'object') {\n          // Use the provided config if available to obtain the constructor\n          baseCfg = { type, ...cfg };\n        } else {\n          let stubCfg;\n          try { stubCfg = await this._getStubConfigForType(type); } catch {}\n          baseCfg = stubCfg && typeof stubCfg === 'object' ? { ...stubCfg } : { type };\n        }\n        const inst = helpers.createCardElement(baseCfg);\n        return inst?.constructor || null;\n      } catch {\n        return null;\n      }\n    };\n\n  \n    // 1) Static class-provided editor (preferred)\n    try {\n      const CardClass = await getCardClass();\n      if (CardClass && typeof CardClass.getConfigElement === 'function') {\n        const el = await CardClass.getConfigElement();\n        if (el) {\n          try { console.info('[ddc:editor] Found static class editor', { type }); } catch {}\n          return el;\n        }\n      }\n    } catch {}\n\n    // 2) Instance-provided editor. Only try this for custom cards. Most built\u2011in\n    // cards either expose a static editor or register a `hui-<type>-card-editor`\n    // tag; instantiating them with invalid or empty configs causes errors (e.g.\n    // \"Entities must be specified\"). For custom cards, we derive a stub config\n    // to satisfy basic validation and then ask the instance for its editor.\n    if (typeof type === 'string' && (type.startsWith('custom:') || type === 'custom_card' || type === 'entity')) {\n      try {\n        let stubCfg = undefined;\n        try { stubCfg = await this._getStubConfigForType(type); } catch {}\n        const baseCfg = stubCfg && typeof stubCfg === 'object' ? { ...stubCfg } : { type };\n        const inst = helpers.createCardElement(baseCfg);\n        inst.hass = this.hass;\n        if (typeof inst.getConfigElement === 'function') {\n          const el = await inst.getConfigElement();\n          if (el) {\n            try { console.info('[ddc:editor] Found instance-level editor', { type }); } catch {}\n            return el;\n          }\n        }\n      } catch {}\n    }\n\n\n  \n    // 3) Known/custom-tag editors (registry hint + common conventions) with retries\n    const base = String(type).replace(/^custom:/, '');\n    const reg = Array.isArray(window.customCards) ? window.customCards : [];\n    const entry = reg.find(c =>\n      c?.type === base || c?.type === type || c?.type === `custom:${base}`\n    );\n\n    \n  \n\n    const candidates = [];\n    if (entry?.editor) candidates.push(entry.editor);            // from registry, if present\n    candidates.push(`${base}-editor`, `${base}-config-editor`);  // common conventions\n\n    // New: add the \u201Chui-<type>-card-editor\u201D convention used by core HA cards\n    if (base && typeof base === 'string') {\n      candidates.push(`hui-${base}-card-editor`);\n    }\n\n  \n    for (const tag of candidates) {\n      if (!tag || typeof tag !== 'string') continue;\n      // Try multiple times: immediate and with increasing delays up to ~3s\n      for (const delay of [0, 100, 300, 700, 1500, 3000]) {\n        try {\n          if (!customElements.get(tag)) {\n            await Promise.race([\n              customElements.whenDefined(tag),\n              new Promise(r => setTimeout(r, delay))\n            ]);\n          }\n          if (customElements.get(tag)) {\n            try { console.info('[ddc:editor] Found editor by tag', { type, tag }); } catch {}\n            return document.createElement(tag);\n          }\n        } catch {}\n      }\n    }\n  \n    // No UI editor available\n    return null;\n  }\n\n  // This helps custom cards that register their editor tag after the element loads.\n  async _ensureCardModuleLoaded(type, cfg) {\n    try {\n      const helpers = (await this._helpersPromise) || await window.loadCardHelpers();\n      // Use stub configuration to warm the module by instantiating the card. This\n      // triggers the dynamic import of the card and its editor without causing\n      // validation errors (we'll ignore errors silently). After warmup, the\n      // module should have registered its static methods and editor tags.\n      // Use the provided cfg if present (for existing cards) to ensure valid keys,\n      // otherwise fall back to a stub. Spreading cfg over type ensures the card\n      // receives all its current properties, avoiding validation errors.\n      let baseCfg;\n      if (cfg && typeof cfg === 'object') {\n        baseCfg = { type, ...cfg };\n      } else {\n        let stubCfg = undefined;\n        try { stubCfg = await this._getStubConfigForType(type); } catch {}\n        baseCfg = stubCfg && typeof stubCfg === 'object' ? { ...stubCfg } : { type };\n      }\n      const el = helpers.createCardElement(baseCfg);\n      el.hass = this.hass;\n      const tmp = document.createElement('div');\n      tmp.style.cssText = 'position:fixed;left:-9999px;top:-9999px;opacity:0;pointer-events:none;';\n      tmp.appendChild(el);\n      document.body.appendChild(tmp);\n      await new Promise(r => requestAnimationFrame(r));\n      tmp.remove();\n      try { console.info('[ddc:editor] Warmed card module', { type }); } catch {}\n    } catch {\n      // swallow errors \u2013 the module may still register\n    }\n  }\n  \n  _ensureOverlayZFix() {\n    if (document.querySelector('style[data-ddc-overlay-fix]')) return;\n    const s = document.createElement('style');\n    s.setAttribute('data-ddc-overlay-fix', '');\n    s.textContent = `\n      /* Make common HA overlays float above our modal */\n      vaadin-combo-box-overlay,\n      vaadin-overlay-backdrop,\n      mwc-menu-surface,\n      .mdc-menu-surface--open {\n        z-index: 1000000 !important;\n      }\n    `;\n    document.head.appendChild(s);\n  }\n  \n\n  _customCardsFromRegistry() {\n    const reg = Array.isArray(window.customCards) ? window.customCards : [];\n    return reg\n      .map((cc) => ({\n        type: cc?.type?.startsWith('custom:') ? cc.type : `custom:${cc?.type}`,\n        name: cc?.name || cc?.type || 'Custom card',\n        icon: 'mdi:puzzle-outline',\n        description: cc?.description || '',\n        editorTag: cc?.editor || null,  // <- keep if provided\n      }))\n      .filter((it) => typeof it.type === 'string' && it.type.startsWith('custom:'));\n  }\n\n  _schemaForType(type) {\n    const S = (o) => o; const any = [];\n    return ({\n      'entities': S({ fields:[ {key:'entities', type:'entities', multi:true, domains:any, label:'Entities'} ]}),\n      'entity':   S({ fields:[ {key:'entity', type:'entity', multi:false, domains:any, label:'Entity'} ]}),\n      'sensor':   S({ fields:[ {key:'entity', type:'entity', multi:false, domains:['sensor'], label:'Sensor'}, {key:'name', type:'text', label:'Name (optional)'} ]}),\n      'gauge':    S({ fields:[ {key:'entity', type:'entity', multi:false, domains:['sensor','number','input_number'], label:'Numeric entity'}, {key:'min', type:'number', label:'Min', step:'any'}, {key:'max', type:'number', label:'Max', step:'any'} ]}),\n      'history-graph': S({ fields:[ {key:'entities', type:'entities', multi:true, domains:any, label:'Entities (multiselect)'}, {key:'hours_to_show', type:'number', label:'Hours to show', default:24} ]}),\n      'statistics-graph': S({ fields:[ {key:'entities', type:'entities', multi:true, domains:['sensor','number','input_number'], label:'Entities (multiselect)'}, {key:'chart_type', type:'select', options:['line','bar'], label:'Chart type', default:'line'}, {key:'statistic', type:'select', options:['mean','min','max','sum'], label:'Statistic', default:'mean'} ]}),\n      'glance':   S({ fields:[ {key:'entities', type:'entities', multi:true, domains:any, label:'Entities (multiselect)'} ]}),\n      'picture-glance': S({ fields:[ {key:'entities', type:'entities', multi:true, domains:any, label:'Entities (multiselect)'}, {key:'image', type:'text', label:'Image URL (optional)'} ]}),\n      'picture-entity': S({ fields:[ {key:'entity', type:'entity', multi:false, domains:any, label:'Entity'}, {key:'image', type:'text', label:'Image URL (optional)'} ]}),\n      'weather-forecast': S({ fields:[ {key:'entity', type:'entity', multi:false, domains:['weather'], label:'Weather entity'} ]}),\n      'map': S({ fields:[ {key:'entities', type:'entities', multi:true, domains:['device_tracker','person'], label:'Trackers / people (multiselect)'}, {key:'default_zoom', type:'number', label:'Default zoom', default:14} ]}),\n      'media-control': S({ fields:[ {key:'entity', type:'entity', multi:false, domains:['media_player'], label:'Media player'} ]}),\n      'light': S({ fields:[ {key:'entity', type:'entity', multi:false, domains:['light'], label:'Light'} ]}),\n      'thermostat': S({ fields:[ {key:'entity', type:'entity', multi:false, domains:['climate'], label:'Climate'} ]}),\n      'alarm-panel': S({ fields:[ {key:'entity', type:'entity', multi:false, domains:['alarm_control_panel'], label:'Alarm'} ]}),\n      'markdown': S({ fields:[ {key:'content', type:'textarea', label:'Markdown'} ]}),\n      'tile': S({ fields:[ {key:'entity', type:'entity', multi:false, domains:any, label:'Entity'} ]}),\n      'button': S({ fields:[ {key:'entity', type:'entity', multi:false, domains:any, label:'Entity (optional)'} ]}),\n      'iframe': S({ fields:[ {key:'url', type:'text', label:'URL'} ]}),\n      'area': S({ fields:[ {key:'area', type:'text', label:'Area ID'} ]}),\n    })[type] || { fields: [] };\n  }\n\n  _shapeBySchema(type, cfg = {}) {\n    const sc = this._schemaForType(type) || { fields: [] };\n    const out = { ...cfg, type };\n\n    for (const f of sc.fields) {\n      let v = out[f.key];\n\n      if (f.type === 'entities') {\n        const arr = Array.isArray(v) ? v : (v != null && v !== '' ? [v] : []);\n        const clean = arr.filter(Boolean);\n        if (clean.length) out[f.key] = clean;\n        else delete out[f.key];\n      }\n      else if (f.type === 'entity') {\n        if (Array.isArray(v)) v = v[0];\n        if (v == null || v === '') delete out[f.key];\n        else out[f.key] = String(v);\n      }\n      else if (f.type === 'number') {\n        if (v == null || v === '') { delete out[f.key]; }\n        else {\n          const n = Number(v);\n          if (Number.isFinite(n)) out[f.key] = n;\n          else delete out[f.key];\n        }\n      }\n      else if (f.type === 'select' || f.type === 'text' || f.type === 'textarea') {\n        if (v == null || v === '') delete out[f.key];\n        else out[f.key] = v;\n      }\n    }\n    return out;\n  }\n\n  _statesList(domains) {\n    const all = Object.keys(this.hass?.states || {});\n    if (!domains || !domains.length) return all;\n\n    if (!this.__domainIndex || this.__domainIndex._gen !== all.length) {\n      const map = {};\n      for (const id of all) {\n        const d = id.split('.')[0];\n        (map[d] ||= []).push(id);\n      }\n      this.__domainIndex = { _gen: all.length, map };\n    }\n    const out = [];\n    for (const d of domains) if (this.__domainIndex.map[d]) out.push(...this.__domainIndex.map[d]);\n    return out;\n  }\n  _isNumericEntity(eid) {\n    const st = this.hass?.states?.[eid]; if (!st) return false;\n    const v = Number(st.state); return Number.isFinite(v);\n  }\n\n  _getFaves(){ try { return new Set(JSON.parse(localStorage.getItem('ddc_faves')||'[]')); } catch { return new Set(); } }\n  _setFaves(set){ try { localStorage.setItem('ddc_faves', JSON.stringify(Array.from(set))); } catch {} }\n  _getRecent(){ try { return JSON.parse(localStorage.getItem('ddc_recent_types')||'[]'); } catch { return []; } }\n  _pushRecent(type){ try { const r = this._getRecent().filter(t=>t!==type); r.unshift(type); if (r.length>10) r.length=10; localStorage.setItem('ddc_recent_types', JSON.stringify(r)); } catch{} }\n\n  /* ----------------------------- YAML editor helpers ----------------------------- */\n  async _ensureCodeMirror() {\n    if (this.__cmReady) return;\n    if (!document.querySelector('link[data-cm-core]')) {\n      const l = document.createElement('link');\n      l.rel = 'stylesheet';\n      l.href = 'https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css';\n      l.setAttribute('data-cm-core','');\n      document.head.appendChild(l);\n    }\n    await new Promise((resolve) => {\n      if (window.CodeMirror) return resolve();\n      const s = document.createElement('script');\n      s.src = 'https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js';\n      s.onload = resolve;\n      document.head.appendChild(s);\n    });\n    await new Promise((resolve) => {\n      if (window.CodeMirror?.mimeModes?.yaml) return resolve();\n      const s = document.createElement('script');\n      s.src = 'https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/yaml/yaml.min.js';\n      s.onload = resolve;\n      document.head.appendChild(s);\n    });\n    this.__cmReady = true;\n  }\n\n  async _mountYamlEditor(hostEl, initialCfg, onValidChange, onInvalidChange) {\n    const dump = (o) => (window.jsyaml ? window.jsyaml.dump(o) : JSON.stringify(o, null, 2));\n    const parse = (t) => (window.jsyaml ? window.jsyaml.load(t) : JSON.parse(t));\n    hostEl.innerHTML = '';\n    const initialText = dump(initialCfg);\n\n    if (customElements.get('ha-code-editor')) {\n      const ed = document.createElement('ha-code-editor');\n      ed.mode = 'yaml';\n      ed.hass = this.hass;\n      ed.value = initialText;\n      ed.style.display = 'block';\n      ed.style.height = '260px';\n      hostEl.appendChild(ed);\n\n      let programmatic = false;\n      ed.addEventListener('value-changed', (e) => {\n        if (programmatic) return;\n        const txt = e.detail?.value ?? ed.value ?? '';\n        try { onValidChange(parse(txt)); }\n        catch (err) { onInvalidChange?.(err); }\n      });\n      return {\n        setValue: (cfg) => {\n          const txt = dump(cfg);\n          if ((ed.value ?? '') !== txt) { programmatic = true; ed.value = txt; programmatic = false; }\n        }\n      };\n    }\n\n    try {\n      await this._ensureCodeMirror();\n      const cm = window.CodeMirror(hostEl, {\n        value: initialText,\n        mode: 'yaml',\n        lineNumbers: true,\n        lineWrapping: true,\n        indentUnit: 2,\n        tabSize: 2\n      });\n      let programmatic = false;\n      cm.on('change', () => {\n        if (programmatic) return;\n        const text = cm.getValue();\n        try { onValidChange(parse(text)); }\n        catch (e) { onInvalidChange?.(e); }\n      });\n      return {\n        setValue: (cfg) => {\n          const txt = dump(cfg);\n          if (cm.getValue() !== txt) { programmatic = true; cm.setValue(txt); programmatic = false; }\n        }\n      };\n    } catch {\n      const ta = document.createElement('textarea');\n      ta.style.width = '100%';\n      ta.style.height = '260px';\n      ta.value = initialText;\n      ta.addEventListener('input', () => {\n        try { onValidChange(parse(ta.value)); }\n        catch (e) { onInvalidChange?.(e); }\n      });\n      hostEl.appendChild(ta);\n      return { setValue: (cfg) => { const txt = dump(cfg); if (ta.value !== txt) ta.value = txt; } };\n    }\n  }\n\n  /* ----------------------- Picker (fast, cached) ----------------------- */\n  \n    _createVirtualList({ container, items, rowHeight = 36, renderRow }) {\n    container.style.position = 'relative';\n    container.style.overflow = 'auto';\n    const spacer = document.createElement('div');\n    spacer.style.height = `${items.length * rowHeight}px`;\n    container.innerHTML = '';\n    container.appendChild(spacer);\n\n    const mount = new Map(); // index -> element\n    const render = () => {\n      const scrollTop = container.scrollTop;\n      const h = container.clientHeight;\n      const first = Math.max(0, Math.floor(scrollTop / rowHeight) - 6);\n      const last  = Math.min(items.length - 1, Math.ceil((scrollTop + h) / rowHeight) + 6);\n\n      // remove out-of-window rows\n      for (const [i, el] of mount) {\n        if (i < first || i > last) { el.remove(); mount.delete(i); }\n      }\n      // add visible rows\n      for (let i = first; i <= last; i++) {\n        if (mount.has(i)) continue;\n        const el = renderRow(items[i], i);\n        el.style.position = 'absolute';\n        el.style.left = '0';\n        el.style.right = '0';\n        el.style.top = `${i * rowHeight}px`;\n        mount.set(i, el);\n        container.appendChild(el);\n      }\n    };\n\n    container.addEventListener('scroll', render, { passive: true });\n    new ResizeObserver(render).observe(container);\n    render();\n\n    return {\n      refresh(newItems) {\n        if (newItems) {\n          items = newItems;\n          spacer.style.height = `${items.length * rowHeight}px`;\n          for (const [, el] of mount) el.remove();\n          mount.clear();\n        }\n        render();\n      }\n    };\n  }\n  \n  async _openSmartPicker(mode='add', initialCfg=null, onCommit=null) {\n\n    \n    const close = () => modal.remove();\n    const modal = document.createElement('div'); modal.className='modal';\n    modal.innerHTML = `\n      <div class=\"dialog\" role=\"dialog\" aria-modal=\"true\">\n        <div class=\"dlg-head\">\n          <h3>${mode==='edit'?'Edit card':'Add a card'}</h3>\n          <div style=\"display:flex;gap:10px;flex:1\">\n            <input id=\"search\" placeholder=\"Search cards (name or type)\u2026\" aria-label=\"search\" style=\"flex:1;padding:10px 12px;border-radius:12px;border:1px solid var(--divider-color);background:var(--primary-background-color);color:var(--primary-text-color)\">\n          </div>\n          <button class=\"btn secondary\" id=\"cancelBtn\"><ha-icon icon=\"mdi:close\"></ha-icon><span style=\"margin-left:6px\">Cancel</span></button>\n          <button class=\"btn\" id=\"addBtn\" disabled>${mode==='edit'\n            ? '<ha-icon icon=\"mdi:content-save\"></ha-icon><span style=\"margin-left:6px\">Update</span>'\n            : '<ha-icon icon=\"mdi:plus\"></ha-icon><span style=\"margin-left:6px\">Add</span>'}\n          </button>\n        </div>\n        <div id=\"layoutGrid\" class=\"layout\">\n          <div class=\"pane\" id=\"leftPane\"></div>\n          <div class=\"pane\" id=\"rightPane\">\n            <div class=\"rightGrid\">\n              <div class=\"sec\" id=\"quickFillSec\" style=\"grid-column:1;grid-row:1\">\n                <div class=\"hd\">Quick fill <span style=\"opacity:.7;font-size:.85rem\">card-aware</span></div>\n                <div class=\"bd\" id=\"quickFill\"></div>\n              </div>\n\n              <div class=\"sec\" style=\"grid-column:2;grid-row:1 / span 3;min-height:0;position:relative\">\n                <div class=\"hd\">Preview</div>\n                <div class=\"spin-center\" id=\"previewSpin\" hidden>\n                  <ha-circular-progress indeterminate></ha-circular-progress>\n                </div>\n                <div class=\"bd\" style=\"min-height:0\"><div id=\"cardHost\"></div></div>\n              </div>\n\n              <div class=\"sec\" id=\"optionsSec\" style=\"grid-column:1;grid-row:2;min-height:0;position:relative\">\n                <div class=\"hd\">\n                  <span>Card options (official editor)</span>\n                  <div id=\"optTabs\" class=\"tabs\">\n                    <button id=\"tabVisual\" class=\"tab active\" aria-selected=\"true\">Visual</button>\n                    <button id=\"tabYaml\" class=\"tab\">YAML</button>\n                  </div>\n                </div>\n                <div class=\"spin-center\" id=\"editorSpin\" hidden>\n                  <ha-circular-progress indeterminate></ha-circular-progress>\n                </div>\n                <div class=\"bd\" style=\"min-height:0\">\n                  <div id=\"editorHost\"></div>\n                  <div id=\"err\" class=\"err\" hidden style=\"color:var(--error-color);font-size:.9rem\"></div>\n                </div>\n              </div>\n\n              <div class=\"sec\" id=\"yamlSec\" style=\"grid-column:1;grid-row:3;min-height:0\">\n                <div class=\"hd\">YAML editor</div>\n                <div class=\"bd\" style=\"min-height:0\">\n                  <div id=\"yamlHost\"></div>\n                  <div id=\"yamlErr\" class=\"err\" hidden style=\"color:var(--error-color);font-size:.9rem;margin-top:8px\"></div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"dlg-foot\">\n          <span style=\"flex:1;opacity:.75;font-size:.85rem\">Tip: use <ha-icon icon=\"mdi:star-outline\"></ha-icon> to favorite cards you use often</span>\n          <button class=\"btn secondary\" id=\"footCancel\"><ha-icon icon=\"mdi:close\"></ha-icon><span style=\"margin-left:6px\">Cancel</span></button>\n          <button class=\"btn\" id=\"footAdd\" disabled>${mode==='edit'\n            ? '<ha-icon icon=\"mdi:content-save\"></ha-icon><span style=\"margin-left:6px\">Update</span>'\n            : '<ha-icon icon=\"mdi:plus\"></ha-icon><span style=\"margin-left:6px\">Add</span>'}\n          </button>\n        </div>\n      </div>`;\n    this.shadowRoot.appendChild(modal);\n\n    const left = modal.querySelector('#leftPane');\n    const addTop = modal.querySelector('#addBtn');\n    const addBottom = modal.querySelector('#footAdd');\n    const cancelTop = modal.querySelector('#cancelBtn');\n    const cancelBot = modal.querySelector('#footCancel');\n    const search = modal.querySelector('#search');\n    const cardHost = modal.querySelector('#cardHost');\n    const editorHost = modal.querySelector('#editorHost');\n    const editorSpin = modal.querySelector('#editorSpin');\n    const quickFill = modal.querySelector('#quickFill');\n    const yamlHost = modal.querySelector('#yamlHost');\n    const yamlErr = modal.querySelector('#yamlErr');\n    const yamlSec = modal.querySelector('#yamlSec');\n    const tabVisual = modal.querySelector('#tabVisual');\n    const tabYaml = modal.querySelector('#tabYaml');\n    const err = modal.querySelector('#err');\n    const previewSpin = modal.querySelector('#previewSpin');\n    const enableCommit = (on) => { addTop.disabled = addBottom.disabled = !on; };\n    const setError = (msg) => { if (!msg){ err.hidden=true; err.textContent=''; } else { err.hidden=false; err.textContent=msg; } };\n\n    const faves = this._getFaves();\n    const recent = this._getRecent();\n    const catalog = this._catalog();\n    const favSection = catalog.find(c=>c.id==='favorites');\n    const recSection = catalog.find(c=>c.id==='recent');\n    const allItems = catalog.flatMap(c => c.items || []);\n    favSection.items = allItems.filter(i => faves.has(i.type));\n    recSection.items = recent.map(t => allItems.find(i => i.type===t)).filter(Boolean);\n\n    const customItems = this._customCardsFromRegistry();\n    if (customItems.length) {\n      catalog.push({\n        id: 'custom',\n        name: 'Custom (installed)',\n        items: customItems,\n      });\n    }\n\n    // ---------------------------------------------------------------------------\n    // UI tweaks: hide quick fill area, add selected-card headline and fave toggle\n    // Hide the quick fill section entirely so the editor can use the full height.\n    const quickFillSecDiv = modal.querySelector('#quickFillSec');\n    if (quickFillSecDiv) quickFillSecDiv.style.display = 'none';\n    // Reposition the options and YAML sections upward now that quick fill is hidden\n    const optionsSecDiv = modal.querySelector('#optionsSec');\n    const yamlSecDiv = modal.querySelector('#yamlSec');\n    if (optionsSecDiv) optionsSecDiv.style.gridRow = '1';\n    if (yamlSecDiv) yamlSecDiv.style.gridRow = '2';\n\n    // Set up a header in the editor for showing the selected card and a star to\n    // favorite the current card.  We create the elements once and update them\n    // whenever a different card is selected.  Favorites are persisted using\n    // existing _getFaves/_setFaves helpers.\n    const optionsHd = modal.querySelector('#optionsSec .hd');\n    // Local references for the header label and star button\n    let selInfo;\n    let favBtn;\n    // Function to update the star icon state based on whether the current card\n    // type is favorited.  Called whenever the favorites set or currentType changes.\n    const updateFavStar = () => {\n      if (!favBtn) return;\n      const on = currentType && faves.has(currentType);\n      const icon = favBtn.querySelector('ha-icon');\n      if (icon) icon.setAttribute('icon', on ? 'mdi:star' : 'mdi:star-outline');\n    };\n    // Function to update the headline text and star icon.  Called from selectType.\n    const updateHeader = (type) => {\n      if (selInfo) {\n        const item = allItems.find(i => i.type === type);\n        const nm = item ? item.name : (type || '');\n        selInfo.textContent = nm;\n      }\n      updateFavStar();\n    };\n    // Only initialize the header once.\n    if (optionsHd && !optionsHd.querySelector('.sel-info')) {\n      // Hide the existing static label if present\n      const titleSpan = optionsHd.querySelector('span');\n      if (titleSpan) {\n        titleSpan.style.display = 'none';\n      }\n      // Create the dynamic selected-card label\n      selInfo = document.createElement('span');\n      selInfo.className = 'sel-info';\n      // Flex so it grows to fill space before the star button\n      selInfo.style.flex = '1';\n      selInfo.style.fontWeight = 'bold';\n      selInfo.style.paddingRight = '8px';\n      optionsHd.insertBefore(selInfo, optionsHd.firstChild);\n      // Create the favorite star button\n      favBtn = document.createElement('button');\n      favBtn.className = 'icon-btn';\n      favBtn.setAttribute('title','Favorite');\n      Object.assign(favBtn.style, {\n        display: 'inline-flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        width: '28px',\n        height: '28px',\n        borderRadius: '6px',\n        border: '1px solid var(--divider-color)',\n        background: 'var(--primary-background-color)',\n        padding: '0',\n        marginLeft: '4px',\n        cursor: 'pointer'\n      });\n      favBtn.innerHTML = '<ha-icon icon=\"mdi:star-outline\"></ha-icon>';\n      optionsHd.appendChild(favBtn);\n      // Clicking the star toggles favorite status for the current card.\n      favBtn.addEventListener('click', (e) => {\n        e.stopPropagation();\n        if (!currentType) return;\n        if (faves.has(currentType)) {\n          faves.delete(currentType);\n        } else {\n          faves.add(currentType);\n        }\n        this._setFaves(faves);\n        updateFavStar();\n        // Re-render the list so the favorites section reflects the new state\n        renderLeft();\n      });\n    }\n    // End of UI tweaks\n\n    let __activeTab = 'visual';\n\n    const showTab = (name) => {\n      const wantYaml = name === 'yaml';\n      tabVisual.classList.toggle('active', !wantYaml);\n      tabVisual.setAttribute('aria-selected', String(!wantYaml));\n      tabYaml.classList.toggle('active', wantYaml);\n      tabYaml.setAttribute('aria-selected', String(wantYaml));\n    \n      // Show/hide the two editors\n      editorHost.parentElement.style.display = wantYaml ? 'none' : '';\n      yamlSec.style.display = wantYaml ? '' : 'none';\n    \n      if (wantYaml) yamlSec.scrollIntoView({ behavior:'smooth', block:'start' });\n      __activeTab = wantYaml ? 'yaml' : 'visual';\n    };\n    \n    tabVisual.addEventListener('click', async () => {\n      showTab('visual');\n      // Mount a new editor the first time; reuse it afterward by updating config.\n      // Because visualEditor is reset in selectType(), this will always mount a fresh editor for a new card type.\n      if (!visualEditor) {\n        await mountVisualEditor(currentConfig);\n      } else {\n        try { visualEditor.setConfig?.(currentConfig); } catch {}\n      }\n    });\n\n    tabYaml.addEventListener('click', () => showTab('yaml'));\n    \n    // default: Visual\n    showTab('visual');\n\n    const filteredCatalog = () => {\n      const q = search.value.trim().toLowerCase();\n      return catalog\n        .map(section => ({\n          ...section,\n          items: (section.items || []).filter(\n            it => !q || it.name.toLowerCase().includes(q) || it.type.toLowerCase().includes(q)\n          )\n        }))\n        .filter(sec => (sec.items && sec.items.length) || sec.id === 'favorites' || sec.id === 'recent');\n    };\n\n    const renderLeft = () => {\n      const view = filteredCatalog();\n      left.innerHTML = '';\n      view.forEach(cat => {\n        const div = document.createElement('div');\n        div.style.padding = '12px';\n        div.style.borderBottom = '1px solid var(--divider-color)';\n        const h = document.createElement('h4'); h.textContent = cat.name; h.style.margin='0 0 10px 0'; h.style.fontSize='.92rem'; h.style.opacity='.85';\n        div.appendChild(h);\n\n        if (!cat.items.length && (cat.id==='favorites' || cat.id==='recent')) {\n          const p = document.createElement('div'); p.style.opacity='.6'; p.style.fontSize='.85rem'; p.textContent = cat.id==='favorites' ? 'No favorites yet.' : 'No recent items yet.'; div.appendChild(p);\n        } else {\n          cat.items.forEach(item => {\n            const b = document.createElement('button');\n            b.innerHTML = `<span style=\"display:inline-flex;align-items:center;gap:8px\">\n              <ha-icon icon=\"${item.icon}\"></ha-icon><span>${item.name}</span>\n            </span>`;\n            Object.assign(b.style,{display:'block',width:'100%',textAlign:'left',border:'none',background:'transparent',padding:'8px',borderRadius:'10px',cursor:'pointer'});\n            b.addEventListener('click', async () => { highlight(b); await selectType(item.type); });\n            div.appendChild(b);\n          });\n        }\n        left.appendChild(div);\n      });\n    };\n\n    const highlight = (btn) => {\n      // Reset all buttons to default appearance\n      left.querySelectorAll('button').forEach(b => {\n        b.classList.remove('active');\n        b.style.background = 'transparent';\n        b.style.color = '';\n      });\n      // Highlight the selected button so it is obvious which one is active.\n      if (btn) {\n        btn.classList.add('active');\n        // Soft highlight background and primary color text for contrast\n        btn.style.background = 'rgba(3,169,244,.12)';\n        btn.style.color = 'var(--primary-color)';\n      }\n    };\n\n    let currentConfig = null;\n    let currentType = null;\n    let yamlEditorApi = null;\n    let visualEditor = null;\n    let pickSeq = 0; // stale-select guard\n    let __previewTimer = null;\n    let __lastPreviewCfgJSON = '';\n\n    const buildQuickFill = (type, cfg) => {\n      const sc = this._schemaForType(type);\n      quickFill.innerHTML = '';\n      if (!sc.fields.length) {\n        quickFill.innerHTML = `<div style=\"opacity:.7;font-size:.9rem\">No quick fill for this card \u2014 use the editors below.</div>`;\n        return;\n      }\n      const all = Object.keys(this.hass?.states || {});\n      const fieldWrap = document.createElement('div');\n\n      const addEntityItem = (eid, arr, container, keyForMulti) => {\n        const div = document.createElement('div');\n        Object.assign(div.style,{padding:'8px 10px',border:'1px solid var(--divider-color)',borderRadius:'10px',cursor:'pointer',userSelect:'none',display:'flex',alignItems:'center',gap:'8px'});\n        div.innerHTML = `<ha-icon icon=\"mdi:checkbox-blank-outline\"></ha-icon><span>${eid}</span>`;\n        if (arr.includes(eid)) {\n          div.style.background='rgba(3,169,244,.12)'; div.style.borderColor='var(--primary-color)';\n          div.querySelector('ha-icon').setAttribute('icon','mdi:checkbox-marked');\n        }\n        div.addEventListener('click', async () => {\n          const idx = arr.indexOf(eid);\n          if (idx>=0) arr.splice(idx,1); else arr.push(eid);\n          const on = arr.includes(eid);\n          div.style.background = on ? 'rgba(3,169,244,.12)' : '';\n          div.style.borderColor = on ? 'var(--primary-color)' : 'var(--divider-color)';\n          div.querySelector('ha-icon').setAttribute('icon', on ? 'mdi:checkbox-marked' : 'mdi:checkbox-blank-outline');\n          currentConfig = this._shapeBySchema(type, {...currentConfig, [keyForMulti]: [...arr]});\n          mountPreview(currentConfig);\n          yamlEditorApi?.setValue(currentConfig);\n        });\n        container.appendChild(div);\n      };\n\n      sc.fields.forEach(f => {\n        const row = document.createElement('div'); Object.assign(row.style,{display:'flex',gap:'8px',alignItems:'center',marginBottom:'8px'});\n        const label = document.createElement('label'); label.textContent = f.label || f.key; label.style.minWidth='130px';\n\n        if (f.type === 'entities') {\n          const wrap = document.createElement('div'); wrap.style.flex='1';\n          const filter = document.createElement('input');\n          Object.assign(filter, { placeholder:'Filter entities\u2026' });\n          Object.assign(filter.style, {\n            width:'100%', padding:'8px 10px', borderRadius:'10px',\n            border:'1px solid var(--divider-color)',\n            background:'var(--card-background-color)', color:'var(--primary-text-color)'\n          });\n          const list = document.createElement('div');\n          Object.assign(list.style, {\n            maxHeight:'220px', overflow:'auto', marginTop:'8px',\n            border:'1px solid var(--divider-color)', borderRadius:'10px', padding:'6px'\n          });\n          const pool = (f.domains && f.domains.length) ? this._statesList(f.domains) : all;\n          const selected = Array.isArray(cfg[f.key]) ? [...cfg[f.key]] : (cfg[f.key] ? [cfg[f.key]] : []);\n\n          // virtualized row renderer\n          const renderRow = (eid) => {\n            const div = document.createElement('div');\n            Object.assign(div.style, {\n              padding:'6px 10px', margin:'4px 0',\n              border:'1px solid var(--divider-color)', borderRadius:'10px',\n              cursor:'pointer', display:'flex', alignItems:'center', gap:'8px', background:''\n            });\n            const icon = document.createElement('ha-icon');\n            icon.setAttribute('icon','mdi:checkbox-blank-outline');\n            icon.style.setProperty('--mdc-icon-size','18px');\n            const text = document.createElement('span');\n            text.textContent = eid;\n            text.style.whiteSpace = 'nowrap';\n            text.style.overflow = 'hidden';\n            text.style.textOverflow = 'ellipsis';\n            div.append(icon, text);\n\n            const paint = () => {\n              const on = selected.includes(eid);\n              div.style.background = on ? 'rgba(3,169,244,.12)' : '';\n              div.style.borderColor = on ? 'var(--primary-color)' : 'var(--divider-color)';\n              icon.setAttribute('icon', on ? 'mdi:checkbox-marked' : 'mdi:checkbox-blank-outline');\n            };\n            paint();\n\n            div.addEventListener('click', () => {\n              const idx = selected.indexOf(eid);\n              if (idx >= 0) selected.splice(idx, 1); else selected.push(eid);\n              currentConfig = this._shapeBySchema(type, {...currentConfig, [f.key]: [...selected]});\n              mountPreview(currentConfig);\n              yamlEditorApi?.setValue(currentConfig);\n              paint();\n            });\n\n            return div;\n          };\n\n          let filtered = pool;\n          this._createVirtualList({ container: list, items: filtered, rowHeight: 36, renderRow });\n\n          filter.addEventListener('input', () => {\n            const q = filter.value.trim().toLowerCase();\n            filtered = pool.filter(eid => !q || eid.toLowerCase().includes(q));\n            this._createVirtualList({ container: list, items: filtered, rowHeight: 36, renderRow });\n          });\n\n          wrap.append(filter, list);\n          row.append(label, wrap);\n          currentConfig = this._shapeBySchema(type, {...cfg, [f.key]: selected});\n        }\n\n        if (f.type === 'entity') {\n          const dsWrap = document.createElement('div'); dsWrap.style.flex='1'; dsWrap.style.position='relative';\n          const ds = document.createElement('input'); ds.setAttribute('list', 'ddc_entlist_'+f.key);\n          Object.assign(ds.style,{width:'100%',padding:'8px 10px 8px 36px',borderRadius:'10px',border:'1px solid var(--divider-color)'});\n          ds.placeholder = `Select ${f.label?.toLowerCase() || 'entity'}\u2026`;\n          const iconLead = document.createElement('ha-icon'); iconLead.setAttribute('icon','mdi:magnify');\n          Object.assign(iconLead.style,{position:'absolute',left:'10px',top:'8px',width:'18px',height:'18px','--mdc-icon-size':'18px',opacity:'.7'});\n          const dl = document.createElement('datalist'); dl.id = 'ddc_entlist_'+f.key;\n          const pool = (f.domains && f.domains.length) ? this._statesList(f.domains) : Object.keys(this.hass?.states || {});\n          dl.innerHTML = pool.map(e => `<option value=\"${e}\">`).join('');\n          ds.value = Array.isArray(cfg[f.key]) ? (cfg[f.key][0] || '') : (cfg[f.key] || '');\n          ds.addEventListener('change', async () => {\n            currentConfig = this._shapeBySchema(type, {...currentConfig, [f.key]: ds.value || undefined});\n            mountPreview(currentConfig);\n            yamlEditorApi?.setValue(currentConfig);\n          });\n          dsWrap.append(iconLead, ds, dl);\n          row.append(label, dsWrap);\n        }\n\n        if (f.type === 'number') {\n          const inpWrap = document.createElement('div'); inpWrap.style.flex='1'; inpWrap.style.position='relative';\n          const inp = document.createElement('input'); inp.type='number'; if (f.step) inp.step=f.step;\n          Object.assign(inp.style,{width:'100%',padding:'8px 10px 8px 36px',borderRadius:'10px',border:'1px solid var(--divider-color)'});\n          const numIcon = document.createElement('ha-icon'); numIcon.setAttribute('icon','mdi:counter'); Object.assign(numIcon.style,{position:'absolute',left:'10px',top:'8px','--mdc-icon-size':'18px',width:'18px',height:'18px',opacity:'.7'});\n          inp.value = cfg[f.key] ?? f.default ?? '';\n          inp.addEventListener('input', async () => {\n            const v = inp.value==='' ? undefined : Number(inp.value);\n            currentConfig = this._shapeBySchema(type, {...currentConfig, [f.key]: isNaN(v)? undefined : v});\n            mountPreview(currentConfig);\n            yamlEditorApi?.setValue(currentConfig);\n          });\n          inpWrap.append(numIcon, inp);\n          row.append(label, inpWrap);\n        }\n\n        if (f.type === 'select') {\n          const selWrap = document.createElement('div'); selWrap.style.flex='1'; selWrap.style.position='relative';\n          const sel = document.createElement('select'); Object.assign(sel.style,{width:'100%',padding:'8px 10px 8px 36px',borderRadius:'10px',border:'1px solid var(--divider-color)'});\n          const selIcon = document.createElement('ha-icon'); selIcon.setAttribute('icon','mdi:format-list-bulleted'); Object.assign(selIcon.style,{position:'absolute',left:'10px',top:'8px','--mdc-icon-size':'18px',width:'18px',height:'18px',opacity:'.7'});\n          (f.options||[]).forEach(o => { const opt = document.createElement('option'); opt.value = o; sel.appendChild(opt); });\n          sel.value = cfg[f.key] ?? f.default ?? (f.options?.[0] || '');\n          sel.addEventListener('change', async () => {\n            currentConfig = this._shapeBySchema(type, {...currentConfig, [f.key]: sel.value});\n            mountPreview(currentConfig);\n            yamlEditorApi?.setValue(currentConfig);\n          });\n          selWrap.append(selIcon, sel);\n          row.append(label, selWrap);\n        }\n\n        if (f.type === 'text') {\n          const inpWrap = document.createElement('div'); inpWrap.style.flex='1'; inpWrap.style.position='relative';\n          const inp = document.createElement('input'); inp.type='text';\n          Object.assign(inp.style,{width:'100%',padding:'8px 10px 8px 36px',borderRadius:'10px',border:'1px solid var(--divider-color)'});\n          const tIcon = document.createElement('ha-icon'); tIcon.setAttribute('icon','mdi:text'); Object.assign(tIcon.style,{position:'absolute',left:'10px',top:'8px','--mdc-icon-size':'18px',width:'18px',height:'18px',opacity:'.7'});\n          inp.value = cfg[f.key] ?? '';\n          inp.addEventListener('input', async () => {\n            currentConfig = this._shapeBySchema(type, {...currentConfig, [f.key]: inp.value || undefined});\n            mountPreview(currentConfig);\n            yamlEditorApi?.setValue(currentConfig);\n          });\n          inpWrap.append(tIcon, inp);\n          row.append(label, inpWrap);\n        }\n\n        if (f.type === 'textarea') {\n          const ta = document.createElement('textarea');\n          Object.assign(ta.style,{flex:'1',minHeight:'120px',padding:'8px 10px',borderRadius:'10px',border:'1px solid var(--divider-color)'});\n          ta.value = cfg[f.key] ?? '';\n          ta.addEventListener('input', async () => {\n            currentConfig = this._shapeBySchema(type, {...currentConfig, [f.key]: ta.value || ''});\n            mountPreview(currentConfig);\n            yamlEditorApi?.setValue(currentConfig);\n          });\n          row.append(label, ta);\n        }\n\n        fieldWrap.appendChild(row);\n      });\n\n      quickFill.innerHTML = '';\n      quickFill.appendChild(fieldWrap);\n    };\n\n    const mountPreview = (cfg) => {\n      const cfgJSON = JSON.stringify(cfg || {});\n      if (cfgJSON === __lastPreviewCfgJSON) return; // same config, skip\n      __lastPreviewCfgJSON = cfgJSON;\n      if (__previewTimer) clearTimeout(__previewTimer);\n      __previewTimer = setTimeout(async () => {\n        const seq = ++pickSeq;\n        previewSpin.hidden = false;\n        cardHost.innerHTML = '';\n        await raf();\n        try {\n          const helpers = (await this._helpersPromise) || await window.loadCardHelpers();\n          if (seq !== pickSeq) return;\n          const temp = helpers.createCardElement(cfg); temp.hass = this.hass;\n          if (seq !== pickSeq) return;\n          cardHost.appendChild(temp);\n        } catch {}\n        finally { if (seq === pickSeq) previewSpin.hidden = true; }\n      }, 150); // 150\u2013250ms is a sweet spot\n    };\n\n    const mountVisualEditor = async (cfg) => {\n      const seq = ++pickSeq;\n      editorSpin.hidden = false;\n      editorHost.innerHTML = '';\n      await idle();\n      if (seq !== pickSeq) { editorSpin.hidden = true; return false; }\n    \n      // Try to get a UI editor for *any* card type (core or custom)\n      const wantType = cfg.type || currentType;\n      let editor = await this._getEditorElementForType(wantType, cfg);\n\n      // If not available yet, warm the card module and retry a few times\n      if (!editor) {\n        await this._ensureCardModuleLoaded(wantType, cfg);\n        for (const delay of [0, 120, 250, 500, 900, 2000, 4000]) {\n          if (delay) await new Promise(r => setTimeout(r, delay));\n          editor = await this._getEditorElementForType(wantType, cfg);\n          if (editor) break;\n        }\n      }\n\n      if (!editor) {\n        // No UI editor \u2192 show YAML (unless user explicitly selected Visual)\n        const p = document.createElement('div');\n        p.style.opacity = '.7'; p.style.fontSize = '.9rem';\n        p.textContent = 'This card does not support a visual editor. Please use the YAML tab to configure it.';\n        if (seq === pickSeq) {\n          editorHost.appendChild(p);\n          editorSpin.hidden = true;\n        }\n        visualEditor = null;\n        enableCommit(true);\n        if (__activeTab !== 'visual') showTab('yaml');\n        return false;\n}\n    \n      try {\n        editor.hass = this.hass;\n        if (!editor.isConnected) editorHost.appendChild(editor);\n\n        // small yield before setConfig to help late-attaching internals\n        await Promise.resolve();\n        try { editor.setConfig(cfg); } catch (e) { /* YAML still works */ }\n\n        // Try official getStubConfig once (may load modules) to improve defaults\n        try {\n          const helpers = (await this._helpersPromise) || await window.loadCardHelpers();\n          const CardClass = helpers.getCardElementClass ? await helpers.getCardElementClass(cfg.type || currentType) : null;\n          if (CardClass?.getStubConfig) {\n            const all = Object.keys(this.hass?.states || {});\n            const byDomain = (d)=>all.filter((e)=>e.startsWith(d+'.'));\n            const better = await CardClass.getStubConfig(this.hass, all, byDomain);\n            if (better) cfg = this._shapeBySchema(cfg.type || currentType, { ...better });\n          }\n        } catch {}\n\n        // small yield before setConfig to help late-attaching internals\n        await Promise.resolve();\n        try { editor.setConfig(cfg); } catch (e) { /* YAML still works */ }\n    \n        // Remove old listeners if any\n        if (visualEditor && this.__onEditorChange) {\n          visualEditor.removeEventListener('config-changed', this.__onEditorChange);\n          visualEditor.removeEventListener('value-changed', this.__onEditorChange);\n        }\n    \n        const onChange = async (e) => {\n          const next = e.detail?.config ?? e.detail?.value; // some editors fire value-changed\n          if (!next) return;\n          const nextType = next.type || currentType;\n          currentType = nextType;\n          currentConfig = this._shapeBySchema(nextType, next);\n    \n          setError('');\n          enableCommit(true);\n          buildQuickFill(currentType, currentConfig);\n          mountPreview(currentConfig);\n          yamlEditorApi?.setValue(currentConfig);\n        };\n    \n        this.__onEditorChange = onChange;\n        editor.addEventListener('config-changed', onChange);\n        editor.addEventListener('value-changed', onChange);\n    \n        visualEditor = editor;\n    \n        // If a UI exists and the user hasn\u2019t explicitly chosen YAML \u2192 show Visual\n        if (__activeTab !== 'yaml') showTab('visual');\n    \n        enableCommit(true);\n        return true;\n      } finally {\n        if (seq === pickSeq) editorSpin.hidden = true;\n      }\n    };\n    \n\n    const mountYaml = async (cfg) => {\n      yamlEditorApi = await this._mountYamlEditor(\n        yamlHost,\n        cfg,\n        async (parsed) => {\n          try {\n            const nextType = parsed?.type || currentType;\n            const shaped = this._shapeBySchema(nextType, parsed || {});\n            const typeChanged = nextType !== currentType;\n    \n            currentType = nextType;\n            currentConfig = shaped;\n    \n            yamlErr.hidden = true; yamlErr.textContent = '';\n            enableCommit(true);\n    \n            if (typeChanged) {\n              buildQuickFill(currentType, currentConfig);\n              // Only update Visual if it\u2019s already mounted\n              if (visualEditor) {\n                try { visualEditor.setConfig?.(currentConfig); } catch {}\n                if (__activeTab !== 'yaml') showTab('visual');\n              }\n            } else {\n              try { visualEditor?.setConfig?.(currentConfig); } catch {}\n              mountPreview(currentConfig);\n            }\n\n          } catch (e) {\n            yamlErr.hidden = false;\n            yamlErr.textContent = `Invalid config: ${String(e?.message || e)}`;\n            enableCommit(false);\n          }\n        },\n        (e) => {\n          yamlErr.hidden = false;\n          yamlErr.textContent = `Invalid YAML: ${String(e?.message || e)}`;\n          enableCommit(false);\n        }\n      );\n    };\n    \n\n    const getStub = async (type) => {\n      if (this.__stubCache.has(type)) return { ...this.__stubCache.get(type) };\n      // Fast local stub first (no heavy module loads)\n      let cfg = await this._getStubConfigForType(type);\n      this.__stubCache.set(type, { ...cfg });\n      return { ...cfg };\n    };\n\n    const selectType = async (type) => {\n      yamlErr.hidden = true; yamlErr.textContent = '';\n      setError('');\n      currentType = type;\n      // Update the selected-card headline and favorite star when a new card is chosen\n      try {\n        if (typeof updateHeader === 'function') updateHeader(type);\n      } catch {\n        // ignore if updateHeader is undefined or throws\n      }\n    \n      const cfg = (mode==='edit' && initialCfg && initialCfg.type===type)\n        ? { ...initialCfg }\n        : await getStub(type);\n    \n      currentConfig = this._shapeBySchema(type, cfg);\n\n      // Reset any previously mounted visual editor so the correct one loads for this card\n      visualEditor = null;\n\n      buildQuickFill(type, currentConfig);\n      await mountYaml(currentConfig);\n      await raf();\n      mountPreview(currentConfig); // debounced version\n\n      // Do not reuse an old editor; a new one will be created on demand when the user clicks \u201CVisual\u201D\n      showTab('yaml');\n      enableCommit(true);\n\n    };\n    const commit = async () => {\n      if (!currentConfig) return;\n      const finalCfg = this._shapeBySchema(currentType, currentConfig);\n      if (mode === 'edit' && typeof onCommit === 'function') {\n        await onCommit(finalCfg);\n      } else {\n        await this._addPickedCardToLayout(finalCfg);\n        this._pushRecent((finalCfg||{}).type);\n      }\n      close();\n    };\n\n    cancelTop.addEventListener('click', close);\n    cancelBot.addEventListener('click', close);\n    addTop.addEventListener('click', commit);\n    addBottom.addEventListener('click', commit);\n    modal.addEventListener('keydown', (e) => { if (e.key === 'Escape') close(); if (e.key === 'Enter' && !addTop.disabled) commit(); });\n\n    let __searchTimer = null;\n    search.addEventListener('input', () => {\n      if (__searchTimer) clearTimeout(__searchTimer);\n      __searchTimer = setTimeout(renderLeft, 120);\n    });\n\n\n    renderLeft();\n    // --- Ensure something is selected so YAML/preview mount immediately ---\n    const pickDefaultType = () => {\n      // Prefer recent if present; otherwise fall back to 'entities'\n      const r = this._getRecent?.() || [];\n      const firstRecent = r.find(Boolean);\n      return firstRecent || 'entities';\n    };\n\n    await selectType(pickDefaultType());\n    enableCommit(true);\n\n    // default selection\n    if (mode === 'edit' && initialCfg) {\n      await selectType(initialCfg.type || 'entities');\n      enableCommit(true);\n    }\n  }\n\n  /* ------------------------- Stubs / helpers (cards) ------------------------- */\nasync _getStubConfigForType(type) {\n    const helpers = (await this._helpersPromise) || await window.loadCardHelpers();\n    let CardClass = null;\n\n    // Provide a blank stub when the user selects the \"Custom Card\" entry.\n    // A blank type lets the YAML editor drive the configuration entirely.\n    if (type === 'custom_card') {\n      return { type: 'custom_card' };\n    }\n\n    try { if (helpers.getCardElementClass) CardClass = await helpers.getCardElementClass(type); } catch {}\n    const all = Object.keys(this.hass?.states || {});\n    const byDomain = (d)=>all.filter((e)=>e.startsWith(d+'.'));\n    if (CardClass?.getStubConfig) {\n      try { return await CardClass.getStubConfig(this.hass, all, byDomain); } catch {}\n    }\n    const base = { type };\n    const first = all[0];\n    const firstSensor = byDomain('sensor')[0] || first;\n\n    if (['entity','sensor','button','gauge','tile','light','thermostat','media-control','alarm-panel','picture-entity','weather-forecast','map'].includes(type)) {\n      // Provide sensible defaults for cards that require an `entity` field.\n      const defaultEntity = ({\n        'sensor': firstSensor,\n        'gauge':  (byDomain('sensor').find(this._isNumericEntity.bind(this)) || firstSensor),\n        'media-control': byDomain('media_player')[0] || first,\n        'light': byDomain('light')[0] || first,\n        'thermostat': byDomain('climate')[0] || first,\n        'alarm-panel': byDomain('alarm_control_panel')[0] || first,\n        'weather-forecast': byDomain('weather')[0] || first,\n        'map': byDomain('device_tracker')[0] || byDomain('person')[0] || first,\n      })[type] || firstSensor || first;\n      if (['entity','sensor','button','gauge','tile','light','thermostat','media-control','alarm-panel','picture-entity'].includes(type)) {\n        base.entity = defaultEntity;\n      } else if (type === 'weather-forecast') {\n        base.entity = defaultEntity;\n        base.show_current = true;\n        base.show_forecast = true;\n        base.forecast_type = 'daily';\n      } else if (type === 'map') {\n        base.entities = [defaultEntity].filter(Boolean);\n        base.theme_mode = 'auto';\n      }\n    }\n    if (['entities','glance','picture-glance','history-graph','statistics-graph'].includes(type)) {\n      const pick = (domains) => (domains?.length ? all.filter(e => domains.includes(e.split('.')[0])) : all).slice(0,3);\n      if (type === 'statistics-graph') base.entities = pick(['sensor','number','input_number']);\n      else base.entities = pick();\n    }\n    if (type === 'markdown') {\n      // Provide a minimal content so the card does not error\n      base.content = 'Markdown card';\n    }\n    if (type === 'sensor') {\n      base.graph = 'line';\n    }\n    if (type === 'button') {\n      base.show_name = true;\n      base.show_icon = true;\n    }\n    if (type === 'tile') {\n      base.features_position = 'bottom';\n      base.vertical = false;\n    }\n    if (type === 'picture-glance') {\n      base.title = base.title || 'Glance';\n      // Provide placeholder image if none available\n      base.image = base.image || 'https://demo.home-assistant.io/stub_config/kitchen.png';\n    }\n    if (type === 'picture-entity') {\n      base.image = base.image || 'https://demo.home-assistant.io/stub_config/bedroom.png';\n    }\n    if (type === 'iframe') {\n      base.url = base.url || 'https://www.home-assistant.io';\n      base.aspect_ratio = base.aspect_ratio || '50%';\n    }\n    if (type === 'history-graph') {\n      // Entities already set; nothing extra\n    }\n    if (type === 'statistics-graph') {\n      // Entities already set; nothing extra\n    }\n    if (type === 'alarm-panel') {\n      base.states = base.states || ['arm_home','arm_away'];\n    }\n    if (type === 'area') {\n      // pick first area from hass.areas if available; else use the first area name from states (area). This is a guess.\n      try {\n        const areas = (this.hass && this.hass.areas) ? Object.values(this.hass.areas) : [];\n        if (areas.length) {\n          base.area = areas[0].area_id || areas[0].name || areas[0].id;\n        } else {\n          // fallback: pick the domain of the first entity as area name\n          base.area = first ? first.split('.')[0] : 'default_area';\n        }\n        // Add optional defaults similar to built-in card example\n        base.display_type = 'picture';\n        base.alert_classes = base.alert_classes || ['moisture','motion'];\n        base.sensor_classes = base.sensor_classes || ['temperature','humidity'];\n        base.features_position = 'bottom';\n      } catch {}\n    }\n    // Note: area card and other complex cards are not given defaults here\n    return base;\n  }\n\n  _getNextAvailablePosition() {\n    const wraps = Array.from(this.cardContainer.querySelectorAll('.card-wrapper:not(.ddc-placeholder)'));\n    const occupied = new Set();\n    const gs = this.gridSize;\n    wraps.forEach((w) => {\n      const x = (parseFloat(w.getAttribute('data-x')) || 0);\n      const y = (parseFloat(w.getAttribute('data-y')) || 0);\n      const width  = parseFloat(getComputedStyle(w).width)  || 100;\n      const height = parseFloat(getComputedStyle(w).height) || 100;\n      const xStart = Math.floor(x/gs), yStart = Math.floor(y/gs);\n      const xEnd   = Math.floor((x+width)/gs), yEnd = Math.floor((y+height)/gs);\n      for (let xi=xStart; xi<xEnd; xi++) for (let yi=yStart; yi<yEnd; yi++) occupied.add(`${xi}-${yi}`);\n    });\n    let xi=0, yi=0;\n    while (occupied.has(`${xi}-${yi}`)) { xi+=6; if (xi>60) { xi=0; yi+=6; } }\n    return { x: xi*gs, y: yi*gs };\n  }\n\n  async _addPickedCardToLayout(cardConfig) {\n    this._hideEmptyPlaceholder();\n    const cardEl = await this._createCard(cardConfig);\n    const wrap = this._makeWrapper(cardEl);\n    const next = this._getNextAvailablePosition();\n    this._setCardPosition(wrap, next.x, next.y);\n    wrap.style.width  = `${14*this.gridSize}px`;\n    wrap.style.height = `${10*this.gridSize}px`;\n    wrap.style.zIndex = String(this._highestZ() + 1);\n    this.cardContainer.appendChild(wrap);\n    \n        try { this._rebuildOnce(wrap.firstElementChild); } catch {}\nthis._initCardInteract(wrap);\n    this._resizeContainer();\n    this._queueSave('add');\n    this._toast('Card added to layout.');\n    this._syncEmptyStateUI();\n  }\n\n  /* ------------------------------ Selection utils ------------------------------ */\n  _toggleSelection(wrap, force=null) {\n    const on = force==null ? !this._selection.has(wrap) : !!force;\n    if (on) this._selection.add(wrap); else this._selection.delete(wrap);\n    wrap.classList.toggle('selected', on);\n  }\n  _clearSelection() {\n    for (const w of this._selection) w.classList.remove('selected');\n    this._selection.clear();\n  }\n\n  _installSelectionMarquee() {\n    const cont = this.cardContainer;\n    let startX=0, startY=0, marquee=null, active=false;\n\n    const toLocal = (ev) => {\n      const r = cont.getBoundingClientRect();\n      const x = ('touches' in ev && ev.touches[0]) ? ev.touches[0].clientX : ev.clientX;\n      const y = ('touches' in ev && ev.touches[0]) ? ev.touches[0].clientY : ev.clientY;\n      return { x: x - r.left, y: y - r.top };\n    };\n\n    const updateSel = (x,y) => {\n      const minX = Math.min(x, startX), maxX = Math.max(x, startX);\n      const minY = Math.min(y, startY), maxY = Math.max(y, startY);\n      marquee.style.left = `${minX}px`;\n      marquee.style.top = `${minY}px`;\n      marquee.style.width = `${maxX-minX}px`;\n      marquee.style.height= `${maxY-minY}px`;\n\n      const rRect = marquee.getBoundingClientRect();\n      const wraps = cont.querySelectorAll('.card-wrapper:not(.ddc-placeholder)');\n      this._clearSelection();\n      wraps.forEach(w => {\n        const wr = w.getBoundingClientRect();\n        const overlap = !(wr.right < rRect.left || wr.left > rRect.right || wr.bottom < rRect.top || wr.top > rRect.bottom);\n        if (overlap) this._toggleSelection(w, true);\n      });\n    };\n\n    const down = (e) => {\n      if (!this.editMode) return;\n      if (e.target.closest('.card-wrapper')) return;\n      active = true;\n      const p = toLocal(e);\n      startX = p.x; startY = p.y;\n      marquee = document.createElement('div');\n      marquee.className = 'marquee';\n      marquee.style.left = `${startX}px`;\n      marquee.style.top  = `${startY}px`;\n      cont.appendChild(marquee);\n      e.preventDefault();\n    };\n    const move = (e) => { if (!active || !marquee) return; updateSel(toLocal(e).x, toLocal(e).y); };\n    const up = () => { if (!active) return; active = false; if (marquee) marquee.remove(); marquee = null; };\n\n    cont.addEventListener('mousedown', down);\n    window.addEventListener('mousemove', move);\n    window.addEventListener('mouseup', up);\n    cont.addEventListener('touchstart', (e)=>{ if (!this.editMode) return; if (e.target.closest('.card-wrapper')) return; down(e); }, {passive:false});\n    window.addEventListener('touchmove', (e)=>{ move(e); }, {passive:false});\n    window.addEventListener('touchend', up);\n    window.addEventListener('touchcancel', up);\n  }\n\n  /* ------------------------------ Diagnostics ------------------------------ */\n  async _openDiagnostics() {\n    const modal = document.createElement('div');\n    modal.className = 'modal';\n    const sk = this.storageKey || '(none)';\n    const usingHost = this._backendOK && !!this.storageKey;\n\n    const logsToHtml = (rows) => rows.slice(-200).map(r =>\n      `<div style=\"font-family:monospace;font-size:.85rem;line-height:1.3\">\n        <span style=\"opacity:.6\">${r.t}</span>\n        <b style=\"margin-left:6px;color:#03a9f4\">[${r.kind}]</b>\n        <span style=\"margin-left:6px\">${this._safe(r.msg)}</span>\n        ${r.extra ? `<pre style=\"margin:4px 0 0 0;white-space:pre-wrap;background:var(--card-background-color);border:1px solid var(--divider-color);border-radius:8px;padding:6px;max-height:160px;overflow:auto\">${this._safe(JSON.stringify(r.extra, null, 2))}</pre>` : ''}\n      </div>`\n    ).join('');\n\n    modal.innerHTML = `\n      <div class=\"dialog\" style=\"max-width:1100px;width:min(1100px,95vw);height:min(90vh,860px)\">\n        <div class=\"dlg-head\">\n          <h3>Drag & Drop \u2014 Diagnostics</h3>\n          <button class=\"btn secondary\" id=\"closeDiag\"><ha-icon icon=\"mdi:close\"></ha-icon><span style=\"margin-left:6px\">Close</span></button>\n        </div>\n        <div style=\"display:block;overflow:auto;padding:12px\">\n          <div class=\"section\" style=\"border:1px solid var(--divider-color);border-radius:12px;background:var(--card-background-color);margin-bottom:10px\">\n            <div class=\"hd\" style=\"display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid var(--divider-color);font-weight:600\">Status</div>\n            <div class=\"bd\" style=\"padding:12px\">\n              <div style=\"display:grid;grid-template-columns:220px 1fr;gap:6px;align-items:center\">\n                <div>Storage key (raw \u2192 slug)</div><div><code>${this._safe(this._config?.storage_key || '')}</code> \u2192 <code>${this._safe(sk)}</code></div>\n                <div>Backend reachable</div><div><b>${this._backendOK ? 'YES' : 'NO'}</b></div>\n                <div>Persist target</div><div><b>${usingHost ? 'Host (backend)' : 'Browser (localStorage)'}</b></div>\n                <div>Auto-save</div><div>${this.autoSave ? `ON (${this.autoSaveDebounce} ms)` : 'OFF'}</div>\n                <div>Cards mounted</div><div>${this.cardContainer?.querySelectorAll('.card-wrapper:not(.ddc-placeholder)').length || 0}</div>\n              </div>\n              <div style=\"margin-top:10px;display:flex;gap:8px;flex-wrap:wrap\">\n                <button class=\"btn\" id=\"testRoundtrip\"><ha-icon icon=\"mdi:sync\"></ha-icon><span style=\"margin-left:6px\">Test backend round-trip</span></button>\n                <button class=\"btn secondary\" id=\"exportJson\"><ha-icon icon=\"mdi:download\"></ha-icon><span style=\"margin-left:6px\">Export JSON</span></button>\n                <button class=\"btn secondary\" id=\"importJson\"><ha-icon icon=\"mdi:upload\"></ha-icon><span style=\"margin-left:6px\">Import JSON</span></button>\n                <button class=\"btn\" id=\"forceSave\"><ha-icon icon=\"mdi:content-save\"></ha-icon><span style=\"margin-left:6px\">Force save now</span></button>\n                <button class=\"btn secondary\" id=\"refreshKeys\"><ha-icon icon=\"mdi:refresh\"></ha-icon><span style=\"margin-left:6px\">Refresh backend keys</span></button>\n              </div>\n            </div>\n          </div>\n          <div class=\"section\" style=\"border:1px solid var(--divider-color);border-radius:12px;background:var(--card-background-color)\">\n            <div class=\"hd\" style=\"display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid var(--divider-color);font-weight:600\">Logs (latest)</div>\n            <div class=\"bd\" id=\"logArea\" style=\"padding:12px;max-height:420px;overflow:auto\">${logsToHtml(this._dbgDump())}</div>\n          </div>\n        </div>\n      </div>`;\n\n    const close = () => modal.remove();\n    modal.querySelector('#closeDiag').addEventListener('click', close);\n    this.shadowRoot.appendChild(modal);\n\n    const refreshLogs = () => {\n      const logArea = modal.querySelector('#logArea');\n      const logsToHtmlLocal = (rows) => rows.slice(-200).map(r =>\n        `<div style=\"font-family:monospace;font-size:.85rem;line-height:1.3\">\n          <span style=\"opacity:.6\">${r.t}</span>\n          <b style=\"margin-left:6px;color:#03a9f4\">[${r.kind}]</b>\n          <span style=\"margin-left:6px\">${this._safe(r.msg)}</span>\n          ${r.extra ? `<pre style=\"margin:4px 0 0 0;white-space:pre-wrap;background:var(--card-background-color);border:1px solid var(--divider-color);border-radius:8px;padding:6px;max-height:160px;overflow:auto\">${this._safe(JSON.stringify(r.extra, null, 2))}</pre>` : ''}\n        </div>`\n      ).join('');\n      logArea.innerHTML = logsToHtmlLocal(this._dbgDump());\n      logArea.scrollTop = logArea.scrollHeight;\n    };\n\n    modal.querySelector('#refreshKeys').addEventListener('click', async () => {\n      try { this._dbgPush('probe', 'Manual refresh'); await this._probeBackend(); }\n      finally { refreshLogs(); }\n    });\n\n    modal.querySelector('#forceSave').addEventListener('click', async () => {\n      await this._saveLayout(false);\n      refreshLogs();\n    });\n\n    modal.querySelector('#exportJson').addEventListener('click', () => {\n      const wraps = Array.from(this.cardContainer.querySelectorAll('.card-wrapper:not(.ddc-placeholder)'));\n      const saved = wraps.map((w)=>{\n        const x = parseFloat(w.getAttribute('data-x')) || 0;\n        const y = parseFloat(w.getAttribute('data-y')) || 0;\n        const width  = parseFloat(w.style.width)  || w.getBoundingClientRect().width;\n        const height = parseFloat(w.style.height) || w.getBoundingClientRect().height;\n        const z = parseInt(w.style.zIndex || '1', 10);\n        const cardCfg = this._extractCardConfig(w.firstElementChild);\n        return { card: cardCfg, position:{x,y}, size:{width,height}, z };\n      });\n        const payload = {\n            version: 2,\n            options: this._exportableOptions(),\n            cards: saved\n        };\n      const blob = new Blob([JSON.stringify(payload,null,2)], {type:'application/json'});\n      const a = document.createElement('a');\n      a.href = URL.createObjectURL(blob);\n      a.download = `ddc_${this.storageKey || 'layout'}.json`;\n      a.click();\n      URL.revokeObjectURL(a.href);\n    });\n\n    modal.querySelector('#importJson').addEventListener('click', async () => {\n      const inp = document.createElement('input');\n      inp.type = 'file'; inp.accept = 'application/json';\n      inp.onchange = async () => {\n        const file = inp.files?.[0]; if (!file) return;\n        const txt = await file.text();\n        try {\n          const json = JSON.parse(txt);\n          this._dbgPush('import', 'Loaded file', { bytes: txt.length });\n          this.cardContainer.innerHTML = '';\n          if (json.cards?.length) {\n            for (const conf of json.cards) {\n              if (!conf?.card || (typeof conf.card === 'object' && Object.keys(conf.card).length === 0)) {\n                const p = this._makePlaceholderAt(conf.position?.x||0, conf.position?.y||0, conf.size?.width||200, conf.size?.height||200);\n                this.cardContainer.appendChild(p);\n              } else {\n                const el = await this._createCard(conf.card);\n                const wrap = this._makeWrapper(el);\n                this._setCardPosition(wrap, conf.position?.x||0, conf.position?.y||0);\n                wrap.style.width = `${conf.size?.width||140}px`;\n                wrap.style.height= `${conf.size?.height||100}px`;\n                this.cardContainer.appendChild(wrap);\n                \n        try { this._rebuildOnce(wrap.firstElementChild); } catch {}\nthis._initCardInteract(wrap);\n              }\n            }\n          } else {\n            this._showEmptyPlaceholder();\n          }\n          this._resizeContainer();\n          await this._saveLayout(false);\n        } catch (e) {\n          this._dbgPush('import', 'Parse failed', { error: String(e) });\n        }\n        const ev = new Event('ddc-logrefresh'); window.dispatchEvent(ev);\n      };\n      inp.click();\n    });\n\n    modal.querySelector('#testRoundtrip').addEventListener('click', async () => {\n      if (!this._backendOK) {\n        this._dbgPush('test', 'Backend not reachable, aborting');\n        return refreshLogs();\n      }\n      const key = (this.storageKey || 'ddc_test') + '_selftest';\n      const payload = { t: Date.now(), msg: 'roundtrip' };\n      try {\n        await this._saveLayoutToBackend(key, payload);\n        const back = await this._loadLayoutFromBackend(key);\n        this._dbgPush('test', 'Round-trip result', { wrote: payload, read: back });\n      } catch (e) {\n        this._dbgPush('test', 'Round-trip failed', { error: String(e) });\n      }\n      refreshLogs();\n    });\n\n    refreshLogs();\n  }\n\n  \n  /* ----------------------------- Export / Import Design ----------------------------- */\n\n\n  // Put these inside the class\n\n  /** Only the exportable knobs the user set in the UI */\n  _exportableOptions() {\n    const opt = {\n      storage_key: this.storageKey || undefined,\n      grid: this.gridSize,\n      container_background: this.containerBackground,\n      card_background: this.cardBackground,\n      disable_overlap: !!this.disableOverlap,\n      drag_live_snap: !!this.dragLiveSnap,\n      auto_save: !!this.autoSave,\n      auto_save_debounce: this.autoSaveDebounce,\n      debug: !!this.debug,\n      container_size_mode: this.containerSizeMode,\n      container_preset_orientation: this.containerPresetOrient,\n      container_fixed_width: this.containerFixedWidth ?? undefined,\n      container_fixed_height: this.containerFixedHeight ?? undefined,\n      container_preset: this.containerPreset,\n    };\n    // strip undefined to keep files tidy\n    Object.keys(opt).forEach(k => opt[k] === undefined && delete opt[k]);\n    return opt;\n  }\n\n  /** Apply options WITHOUT triggering a full rebuild */\n  _applyImportedOptions(opts = {}, recalc = true) {\n    if (opts && Object.prototype.hasOwnProperty.call(opts, 'storage_key')) {\n    // If storage_key changed, push it into HA editor immediately\n     if (this._isInHaEditorPreview()) {\n       try {\n         const updatedCfg = { type: 'custom:drag-and-drop-card', ...(this._config || {}) };\n         this.dispatchEvent(new CustomEvent('config-changed', {\n           detail: { config: updatedCfg },\n           bubbles: true,\n           composed: true,\n         }));\n       } catch {}\n     }\n    }\n\n    // keep the original config around, but merge options into live props\n    this._config = { ...(this._config || {}), ...opts };\n\n    if ('storage_key' in opts)        this.storageKey = opts.storage_key || undefined;\n    this._syncEditorsStorageKey();\n    if ('grid' in opts)               this.gridSize = Number(opts.grid) || 10;\n    if ('drag_live_snap' in opts)     this.dragLiveSnap = !!opts.drag_live_snap;\n    if ('auto_save' in opts)          this.autoSave = !!opts.auto_save;\n    if ('auto_save_debounce' in opts) this.autoSaveDebounce = Number(opts.auto_save_debounce) || 800;\n    if ('container_background' in opts) this.containerBackground = opts.container_background ?? 'transparent';\n    if ('card_background' in opts)      this.cardBackground = opts.card_background ?? 'var(--ha-card-background, var(--card-background-color))';\n    if ('debug' in opts)              this.debug = !!opts.debug;\n    if ('disable_overlap' in opts)    this.disableOverlap = !!opts.disable_overlap;\n\n    if ('container_size_mode' in opts)        this.containerSizeMode = opts.container_size_mode || 'dynamic';\n    if ('container_fixed_width' in opts)      this.containerFixedWidth  = Number(opts.container_fixed_width)  || null;\n    if ('container_fixed_height' in opts)     this.containerFixedHeight = Number(opts.container_fixed_height) || null;\n    if ('container_preset' in opts)           this.containerPreset = opts.container_preset || 'fhd';\n    if ('container_preset_orientation' in opts) this.containerPresetOrient = opts.container_preset_orientation || 'auto';\n\n    // reflect to CSS\n    this.style.setProperty('--ddc-bg', this.containerBackground);\n    this.style.setProperty('--ddc-card-bg', this.cardBackground);\n    this._applyGridVars();\n\n    if (recalc) {\n      this._applyContainerSizingFromConfig(true);\n      this._resizeContainer();\n      this._updateStoreBadge?.();\n    }\n  }\n\n\n  _exportDesign() {\n    const wraps = Array.from(this.cardContainer.querySelectorAll('.card-wrapper:not(.ddc-placeholder)'));\n    const saved = wraps.map((w)=>{\n      const x = parseFloat(w.getAttribute('data-x')) || 0;\n      const y = parseFloat(w.getAttribute('data-y')) || 0;\n      const width  = parseFloat(w.style.width)  || w.getBoundingClientRect().width;\n      const height = parseFloat(w.style.height) || w.getBoundingClientRect().height;\n      const z = parseInt(w.style.zIndex || '1', 10);\n      const cardCfg = this._extractCardConfig(w.firstElementChild);\n      return { card: cardCfg, position:{x,y}, size:{width,height}, z };\n    });\n    const payload = {\n        version: 2,\n        options: this._exportableOptions(),\n        cards: saved\n      };\n    const name = `ddc_design_${this.storageKey || 'layout'}.json`;\n    const blob = new Blob([JSON.stringify(payload, null, 2)], { type:'application/json' });\n    const a = document.createElement('a');\n    a.href = URL.createObjectURL(blob);\n    a.download = name;\n    a.click();\n    URL.revokeObjectURL(a.href);\n    this._toast('Design exported.');\n  }\n  \n  _importDesign() {\n    const inp = document.createElement('input');\n    inp.type = 'file'; inp.accept = 'application/json';\n    inp.onchange = async () => {\n      const file = inp.files?.[0]; if (!file) return;\n        const txt = await file.text();\n      try {\n        const json = JSON.parse(txt);\n        const __prevStorageKey = this.storageKey || (this._config && this._config.storage_key) || null;\n\n        // Apply options (if present) before building cards\n          if (json.options) {\n            const { storage_key, ...optsNoKey } = json.options;\n            this._applyImportedOptions(optsNoKey, true);\n          }\n        else if (typeof json.grid === 'number') this._applyImportedOptions({ grid: json.grid }, true); // v1 fallback     \n\n        // v1 fallback     \n                \n          // DDC: Persist imported design (options + cards) into stored Lovelace YAML\n          try {\n            const targetKey = (this._config && this._config.storage_key) || this.storageKey || null;\n\n            // Persist OPTIONS (not cards) to Lovelace YAML for this card only\n            const importedOptions =\n              json.options ?? (typeof json.grid === 'number' ? { grid: json.grid } : {});\n\n            if (!targetKey) {\n              console.warn('[ddc:import] No storage_key on this card; aborting persist.');\n            } else {\n              const result = await this._persistOptionsToYaml(importedOptions, {\n                forceTargetKey: String(targetKey),\n                noDownload: true,\n              });\n              const yamlOk = !!(result && result.yamlSaved);\n              console.debug('[ddc:import] YAML persist result:', yamlOk);\n            }\n\n\n          } catch (e) {\n            console.warn('[ddc:import] YAML persist failed:', e);\n          }\n\n          this.cardContainer.innerHTML = '';\n          if (json.cards?.length) {\n            for (const conf of json.cards) {\n                if (!conf?.card || (typeof conf.card === 'object' && Object.keys(conf.card).length === 0)) {\n                  const p = this._makePlaceholderAt(conf.position?.x||0, conf.position?.y||0, conf.size?.width||200, conf.size?.height||200);\n                  this.cardContainer.appendChild(p);\n                } else {\n                  const el = await this._createCard(conf.card);\n                  const wrap = this._makeWrapper(el);\n                  this._setCardPosition(wrap, conf.position?.x||0, conf.position?.y||0);\n                  wrap.style.width  = `${conf.size?.width||140}px`;\n                  wrap.style.height = `${conf.size?.height||100}px`;\n                  if (conf.z != null) wrap.style.zIndex = String(conf.z);\n                  this.cardContainer.appendChild(wrap);\n                  \n                try { this._rebuildOnce(wrap.firstElementChild); } catch {}\n                this._initCardInteract(wrap);\n                }\n          }\n        } else {\n          this._showEmptyPlaceholder();\n        }\n        this._resizeContainer();\n        // Persist the imported layout (cards) to our storage (backend/local) for THIS storage_key\n        try {\n          // cancel any pending debounced save (if any)\n          if (this._saveTimer) clearTimeout(this._saveTimer);\n\n          // flush save immediately so changes are persisted before reload\n          await this._saveLayout(true);  // 'true' = silent toast in your implementation\n\n          // optional toast before reload\n          this._toast('Design imported & saved. Reloading...');\n\n          // hard refresh so the imported design shows up right away\n          window.location.reload();\n        } catch (e) {\n          console.warn('[ddc:import] saveLayout failed', e);\n          this._markDirty('import');\n          this._toast('Design imported \u2014 click Apply to save.');\n        }\n      } catch (e) {\n        console.error('Import failed', e);\n        this._toast('Import failed \u2014 invalid file.');\n      }\n    };\n    inp.click();\n  }\n  \n\n  \n  // ===== DDC: Lovelace persistence helpers (import options -> stored YAML) =====\n  _getLovelace() {\n    // Walk up from this element through shadow roots\n    let hop = 0, host = this;\n    while (host && hop++ < 20) {\n      const root = host.getRootNode?.();\n      const rHost = root?.host;\n      if (rHost?.tagName === 'HUI-ROOT') return rHost.lovelace;\n      host = rHost || host.parentElement;\n    }\n    // Breadth-first fallback\n    const seen = new Set(), q = [document];\n    while (q.length) {\n      const n = q.shift();\n      if (!n || seen.has(n)) continue;\n      seen.add(n);\n      if (n.host?.tagName === 'HUI-ROOT') return n.host.lovelace;\n      if (n.tagName === 'HUI-ROOT') return n.lovelace;\n      if (n.shadowRoot) q.push(n.shadowRoot);\n      if (n.children) for (const c of n.children) q.push(c);\n    }\n    return undefined;\n  }\n\n  _scanDdcCards(cfg) {\n    const hits = []; // { view:number, path:string[], card:object }\n    const push = (view, path, obj) => {\n      if (obj?.type === 'custom:drag-and-drop-card') hits.push({ view, path: [...path], card: obj });\n    };\n    const visit = (node, viewIdx, path) => {\n      if (!node) return;\n      if (Array.isArray(node)) { node.forEach((n, i) => visit(n, viewIdx, path.concat(i))); return; }\n      if (typeof node !== 'object') return;\n\n      if ('type' in node) push(viewIdx, path, node);\n\n      for (const [k, v] of Object.entries(node)) {\n        if (k === 'views' && Array.isArray(v)) v.forEach((vv, i) => visit(vv, i, ['views', i]));\n        else if (Array.isArray(v)) visit(v, viewIdx, path.concat(k));\n        else if (v && typeof v === 'object') visit(v, viewIdx, path.concat(k));\n      }\n    };\n    visit(cfg, -1, []);\n    return hits;\n  }\n\n  async _persistOptionsToYaml(opts, { prevKey = null, patchAllInCurrentViewIfNoKey = false } = {}) {\n    try {\n      const ll = this._getLovelace();\n      if (!ll) { console.debug('[ddc:import] persist: no lovelace root'); return false; }\n      if (typeof ll.saveConfig !== 'function') { console.debug('[ddc:import] persist: dashboard not in Storage mode'); return false; }\n\n      // Deep clone to avoid mutating live config\n      const cfg = JSON.parse(JSON.stringify(ll.config));\n      const hits = this._scanDdcCards(cfg);\n      const curView = ll.current_view ?? 0;\n\n      console.debug('[ddc:import] persist: found DDC cards', hits.map(h => ({ view: h.view, path: h.path.join('.'), storage_key: h.card.storage_key || null })));\n\n      const newKey = opts?.storage_key ?? null;\n      const keys = [];\n      if (prevKey) keys.push(prevKey);\n      if (newKey) keys.push(newKey);\n      if (this.storageKey) keys.push(this.storageKey);\n      if (this._config?.storage_key) keys.push(this._config.storage_key);\n\n      // Prefer exact key matches (either previous or new)\n      let targets = hits.filter(h => h.card.storage_key && keys.includes(h.card.storage_key));\n\n      // If no exact match: if only one DDC in current view, target it\n       if (!targets.length) {\n        const inCur = hits.filter(h => h.view === curView);\n         if (inCur.length === 1) targets = inCur;   // safe only if exactly one\n         // else: no target \u2192 abort instead of touching multiple cards\n       }\n\n      // As a last resort, if there is only one DDC overall, patch it\n      if (!targets.length && hits.length === 1) targets = hits;\n\n      if (!targets.length) {\n        console.debug('[ddc:import] persist: no target. Provide a unique storage_key on this card and import again.', { prevKey, newKey, storageKey: this.storageKey });\n        return false;\n      }\n\n       // Build a patch for options ONLY \u2014 never stamp a global storage_key into multiple cards\n       const basePatch = { type: 'custom:drag-and-drop-card', ...opts };\n       // Remove any incoming storage_key so it doesn't overwrite per-card keys accidentally\n       if ('storage_key' in basePatch) delete basePatch.storage_key;\n       if ('storageKey' in basePatch)  delete basePatch.storageKey;\n \n       for (const t of targets) {\n         // Resolve the YAML object to patch\n         let ref = cfg;\n         for (const seg of t.path) ref = ref[seg];\n \n         // Remember the card\u2019s existing key (support legacy camelCase & nested)\n         const existingKey =\n           ref?.storage_key ?? ref?.storageKey ?? ref?.options?.storage_key ?? ref?.options?.storageKey ?? null;\n \n         // Decide if this specific card is being renamed (only when prevKey\u2192newKey and it matches)\n         const shouldRename = !!(prevKey && newKey && existingKey === prevKey && newKey !== prevKey);\n \n         // Apply options WITHOUT a key\n         Object.assign(ref, basePatch);\n \n         // Restore / set the right key per-card\n         if (shouldRename) {\n           ref.storage_key = String(newKey);\n         } else if (existingKey) {\n           ref.storage_key = String(existingKey);\n         }\n         // Clean up legacy field\n         if ('storageKey' in ref) delete ref.storageKey;\n       }\n\n      console.debug('[ddc:import] persist \u2192 saving', { patched: targets.length, keysTried: keys, patch });\n      await ll.saveConfig(cfg);\n      return true;\n    } catch (e) {\n      console.warn('[ddc:import] persist error', e);\n      return false;\n    }\n  }\n/* ----------------------------- Save / load ----------------------------- */\n  _queueSave(reason='auto') {\n    // Always mark dirty so Apply becomes enabled\n    this._markDirty(reason);\n    // only queue save when autosave is enabled, not loading, and in edit mode\n    if (!this.autoSave) return;\n    // skip saving while the layout is still loading\n    if (this._loading) return;\n    // respect the user expectation that saving should only happen in edit mode\n    if (!this.editMode) return;\n    this._dbgPush('autosave', 'Queued', { reason, debounce: this.autoSaveDebounce });\n    clearTimeout(this._saveTimer);\n    this._saveTimer = setTimeout(() => this._saveLayout(true), this.autoSaveDebounce);\n  }\n\n  async _saveLayout(silent = true) {\n    const wraps = Array.from(this.cardContainer.querySelectorAll('.card-wrapper:not(.ddc-placeholder)'));\n    const saved = wraps.map((w)=>{\n      const x = parseFloat(w.getAttribute('data-x')) || 0;\n      const y = parseFloat(w.getAttribute('data-y')) || 0;\n      const width  = parseFloat(w.style.width)  || w.getBoundingClientRect().width;\n      const height = parseFloat(w.style.height) || w.getBoundingClientRect().height;\n      const z = parseInt(w.style.zIndex || '1', 10);\n      const cardCfg = this._extractCardConfig(w.firstElementChild);\n      return { card: cardCfg, position:{x,y}, size:{width,height}, z };\n    });\n    const payload = {\n       version: 2,\n       options: this._exportableOptions(),\n       cards: saved\n     };\n\n    try { localStorage.setItem(`ddc_local_${this.storageKey || 'default'}`, JSON.stringify(payload)); } catch {}\n\n    if (!this.storageKey) { if (!silent) this._toast('Saved locally (no storage_key set).');\n      this.__dirty = false; this._updateApplyBtn();\n      return; }\n\n    try {\n      await this._saveLayoutToBackend(this.storageKey, payload);\n      if (!silent) this._toast('Layout saved.');\n      this.__dirty = false; this._updateApplyBtn();\n    } catch (e) {\n      console.error('Backend save failed', e);\n      this._dbgPush('save', 'Backend save failed', { error: String(e) });\n      if (!silent) this._toast('Backend save failed \u2014 kept local copy.');\n    }\n  }\n\n  async _probeBackend() {\n    this._backendOK = false;\n    const t0 = performance.now();\n    try {\n      this._dbgPush('probe', 'GET /api/dragdrop_storage (list keys)');\n      const r = await this.hass.callApi('get', 'dragdrop_storage');\n      const ms = Math.round(performance.now() - t0);\n      this._dbgPush('probe', `OK (${ms} ms)`, r);\n      this._backendOK = !!r;\n    } catch (e) {\n      const ms = Math.round(performance.now() - t0);\n      this._dbgPush('probe', `FAILED (${ms} ms)`, { error: String(e) });\n      this._backendOK = false;\n    }\n    this._updateStoreBadge();\n  }\n\n  async _loadLayoutFromBackend(key) {\n    const url = `dragdrop_storage/${encodeURIComponent(key)}`;\n    const t0 = performance.now();\n    try {\n      this._dbgPush('load', `GET /api/${url}`);\n      const data = await this.hass.callApi('get', url);\n      const ms = Math.round(performance.now() - t0);\n      this._dbgPush('load', `OK (${ms} ms)`, { bytes: JSON.stringify(data||'').length });\n      return data;\n    } catch (e) {\n      const ms = Math.round(performance.now() - t0);\n      this._dbgPush('load', `FAILED (${ms} ms)`, { error: String(e) });\n      return null;\n    }\n  }\n\n  async _saveLayoutToBackend(key, data) {\n    const url = `dragdrop_storage/${encodeURIComponent(key)}`;\n    const size = JSON.stringify(data).length;\n    const t0 = performance.now();\n    try {\n      this._dbgPush('save', `POST /api/${url}`, { bytes: size });\n      const res = await this.hass.callApi('post', url, data);\n      const ms = Math.round(performance.now() - t0);\n      this._dbgPush('save', `OK (${ms} ms)`, res);\n      return res;\n    } catch (e) {\n      const ms = Math.round(performance.now() - t0);\n      this._dbgPush('save', `FAILED (${ms} ms)`, { error: String(e), bytes: size });\n      throw e;\n    }\n  }\n\n  _updateStoreBadge() {\n    const el = this.storeBadge; if (!el) return;\n    const usingHost = this._backendOK && !!this.storageKey;\n    el.textContent = usingHost ? 'storage: backend' : 'storage: local';\n    el.style.background = usingHost ? 'rgba(76,175,80,.15)' : 'rgba(255,193,7,.15)';\n    el.style.borderColor = usingHost ? 'rgba(76,175,80,.45)' : 'rgba(255,193,7,.45)';\n  }\n\n  /* ----------------------------- Utilities ----------------------------- */\n  _toast(message) {\n    const ev = new Event('hass-notification');\n    ev.detail = { message };\n    window.dispatchEvent(ev);\n  }\n  _huiRoot() {\n    try {\n      const ha   = document.querySelector('home-assistant');\n      const main = ha?.shadowRoot?.querySelector('home-assistant-main');\n      const drawer = main?.shadowRoot?.querySelector('ha-drawer') || main;\n      const ppr = drawer?.shadowRoot?.querySelector('partial-panel-resolver') || drawer;\n      const panel = ppr?.shadowRoot?.querySelector('ha-panel-lovelace') || drawer?.shadowRoot?.querySelector('ha-panel-lovelace');\n      return panel?.shadowRoot?.querySelector('hui-root') || null;\n    } catch { return null; }\n  }\n  getCardSize(){ return 3; }\n}\n\nif (!customElements.get('drag-and-drop-card')) {\n  customElements.define('drag-and-drop-card', DragAndDropCard);\n}\n\n/* Register in HA's card picker */\n(() => {\n  try {\n    const list = (window.customCards = window.customCards || []);\n    if (!list.some(c => c.type === 'drag-and-drop-card')) {\n      list.push({\n        type: 'drag-and-drop-card',   // no \"custom:\" here\n        name: 'Drag & Drop Card',\n        description: 'Freeform drag/resize/snap-to-grid canvas for Lovelace cards.',\n        preview: false\n      });\n    }\n  } catch (e) { /* no-op */ }\n})();\n\n\n/* ==========================================================================\n   Integrated card-mod compatibility enhancements\n   - Ensures card-mod styles apply to nested cards inside drag-and-drop-card\n   - No extra resource needed; executed as part of this script\n   - Uses a guarded (WeakSet) ll-rebuild dispatch on newly added card elements\n   ========================================================================== */\n(() => {\n  const SEEN = new WeakSet();\n\n  const isLikelyCard = (el) => {\n    try {\n      if (!(el instanceof Element)) return false;\n      const n = el.localName || \"\";\n      if (!n) return false;\n      if (n === \"ha-card\") return true;\n      if (n.endsWith(\"-card\")) return true; // hui-*, custom:*, mushroom-*, etc.\n      return false;\n    } catch { return false; }\n  };\n\n  const rebuildOnce = (el) => {\n    try {\n      if (!el || SEEN.has(el)) return;\n      SEEN.add(el);\n      el.dispatchEvent(new Event('ll-rebuild', { bubbles: true, composed: true }));\n    } catch {}\n  };\n\n  const deepScan = (root) => {\n    try {\n      if (!root) return;\n      if (root instanceof Element && isLikelyCard(root)) rebuildOnce(root);\n      const all = (root instanceof ShadowRoot ? root : root).querySelectorAll?.(\"*\");\n      if (!all) return;\n      for (const el of all) {\n        if (isLikelyCard(el)) rebuildOnce(el);\n        const sr = el.shadowRoot;\n        if (sr) { try { deepScan(sr); } catch {} }\n      }\n    } catch {}\n  };\n\n  const installOnInstance = (host) => {\n    try {\n      if (!host || host.__ddcCardModIntegrated) return;\n      host.__ddcCardModIntegrated = true;\n      const root = host.shadowRoot || host;\n\n      // Initial scan (covers already rendered children)\n      deepScan(root);\n\n      // Observe newly added content within the card\n      const mo = new MutationObserver((muts) => {\n        for (const m of muts) {\n          if (!m.addedNodes || !m.addedNodes.length) continue;\n          for (const n of m.addedNodes) {\n            if (n instanceof Element || n instanceof ShadowRoot) {\n              deepScan(n);\n            }\n          }\n        }\n      });\n      mo.observe(root, { childList: true, subtree: true });\n      host.__ddcCardModIntegratedObserver = mo;\n\n      // Follow-up scans for lazy renders\n      setTimeout(() => { try { deepScan(root); } catch {} }, 250);\n      setTimeout(() => { try { deepScan(root); } catch {} }, 1000);\n    } catch {}\n  };\n\n  const hookExisting = () => {\n    try {\n      document.querySelectorAll(\"drag-and-drop-card\").forEach(installOnInstance);\n    } catch {}\n  };\n\n  if (window.customElements && window.customElements.whenDefined) {\n    window.customElements.whenDefined(\"drag-and-drop-card\").then(() => {\n      // Install on existing instances\n      hookExisting();\n      // Patch prototype to auto-install on future instances\n      const ctor = window.customElements.get(\"drag-and-drop-card\");\n      if (ctor && ctor.prototype) {\n        const origConnected = ctor.prototype.connectedCallback;\n        ctor.prototype.connectedCallback = function() {\n          try { origConnected && origConnected.call(this); } finally {\n            installOnInstance(this);\n          }\n        };\n      }\n      // As a fallback, watch the DOM for new instances\n      const docObserver = new MutationObserver(() => hookExisting());\n      docObserver.observe(document.documentElement, { childList: true, subtree: true });\n    });\n  } else {\n    // Very old environment: periodic best-effort scan\n    const iv = setInterval(hookExisting, 1000);\n    setTimeout(() => clearInterval(iv), 10000);\n  }\n})();\n\n/* ==== DDC AUGMENTATION v6: backup on persist + inline toolbar switcher + load-by-key + edit-mode visibility ==== */\n(function(){\n  const tag = 'drag-and-drop-card';\n  const Cls = customElements.get(tag);\n  if (!Cls) { console.warn('[ddc:augment] Could not find custom element', tag); return; }\n\n  function _getLovelace() {\n    try {\n      let hop = 0, host = this;\n      while (host && hop++ < 20) {\n        const root = host.getRootNode?.();\n        const rHost = root?.host;\n        if (rHost?.tagName === 'HUI-ROOT') return rHost.lovelace;\n        host = rHost || host.parentElement;\n      }\n      const seen = new Set(), q = [document];\n      while (q.length) {\n        const n = q.shift();\n        if (!n || seen.has(n)) continue;\n        seen.add(n);\n        if (n.host?.tagName === 'HUI-ROOT') return n.host.lovelace;\n        if (n.tagName === 'HUI-ROOT') return n.lovelace;\n        if (n.shadowRoot) q.push(n.shadowRoot);\n        if (n.children) for (const c of n.children) q.push(c);\n      }\n    } catch(e) {}\n    return undefined;\n  }\n  function _scanDdcCards(cfg) {\n    const hits = [];\n    const push = (view, path, obj) => { if (obj?.type === 'custom:drag-and-drop-card') hits.push({ view, path: [...path], card: obj }); };\n    const visit = (node, viewIdx, path) => {\n      if (!node) return;\n      if (Array.isArray(node)) { node.forEach((n, i) => visit(n, viewIdx, path.concat(i))); return; }\n      if (typeof node !== 'object') return;\n      if ('type' in node) push(viewIdx, path, node);\n      for (const [k, v] of Object.entries(node)) {\n        if (k === 'views' && Array.isArray(v)) v.forEach((vv, i) => visit(vv, i, ['views', i]));\n        else if (Array.isArray(v)) visit(v, viewIdx, path.concat(k));\n        else if (v && typeof v === 'object') visit(v, viewIdx, path.concat(k));\n      }\n    };\n    visit(cfg, -1, []);\n    return hits;\n  }\n  function _makeYamlBackup(llConfig, targets, patch) {\n    const when = new Date().toISOString().replace(/[:.]/g,'-');\n    const items = targets.map(t => {\n      let ref = llConfig;\n      for (const seg of t.path) ref = ref[seg];\n      return { view: t.view, path: t.path, storage_key: (ref && ref.storage_key) || null, before: ref, patch };\n    });\n    const backup = { kind: 'ddc-import-backup', created_at: when, count: items.length, items };\n    try {\n      const key = `ddc.backup.${when}`;\n      localStorage.setItem(key, JSON.stringify(backup));\n      const all = Object.keys(localStorage).filter(k => k.startsWith('ddc.backup.')).sort().reverse();\n      for (const k of all.slice(10)) localStorage.removeItem(k);\n    } catch(e){}\n    return { name: `ddc_backup_${when}.json`, data: backup };\n  }\n  function _offerBackupDownload(name, obj) {\n    try {\n      const blob = new Blob([JSON.stringify(obj, null, 2)], { type: 'application/json' });\n      const url  = URL.createObjectURL(blob);\n      const a    = document.createElement('a');\n      a.href = url; a.download = name;\n      document.body.appendChild(a); a.click(); a.remove();\n      setTimeout(() => URL.revokeObjectURL(url), 1500);\n    } catch(e){ console.warn('[ddc:backup] download failed', e); }\n  }\n  function _recordRecentKey(key) {\n    if (!key) return;\n    try {\n      const K = 'ddc.recent.keys';\n      const arr = JSON.parse(localStorage.getItem(K) || '[]');\n      if (!arr.includes(key)) arr.unshift(key);\n      localStorage.setItem(K, JSON.stringify(arr.slice(0, 20)));\n    } catch {}\n  }\n  function _getRecentKeys() {\n    try { return JSON.parse(localStorage.getItem('ddc.recent.keys') || '[]'); } catch { return []; }\n  }\n  function _collectBackupKeys() {\n    const keys = new Set();\n    try {\n      const names = Object.keys(localStorage).filter(k => k.startsWith('ddc.backup.')).sort().reverse();\n      for (const name of names) {\n        try {\n          const obj = JSON.parse(localStorage.getItem(name) || 'null');\n          if (obj && obj.items) {\n            for (const it of obj.items) {\n              const sk = it?.before?.storage_key || it?.patch?.storage_key;\n              if (sk) keys.add(sk);\n            }\n          }\n        } catch {}\n      }\n    } catch {}\n    return Array.from(keys);\n  }\nasync function _persistOptionsToYaml(opts, {\n  forceTargetKey = null,   // when set, import ONLY into card with this key\n  onlyThisCard   = false,  // reserved; current impl always enforces single-card import\n  prevKey,\n  noDownload\n} = {}) {\n  const ll = this._getLovelace?.() || _getLovelace.call(this);\n  if (!ll) { console.debug('[ddc:import] persist: no lovelace root'); return false; }\n  if (typeof ll.saveConfig !== 'function') { console.debug('[ddc:import] persist: dashboard not in Storage mode'); return false; }\n\n  // Determine the EXACT key we will import into (the clicked card)\n  const norm = (s) => (typeof s === 'string' ? s.trim() : null);\n  const myKey =\n    norm(forceTargetKey) ||\n    norm(this?._config?.storage_key) ||\n    norm(this?.storageKey) ||\n    norm(prevKey);\n\n  if (!myKey) {\n    console.warn('[ddc:import] persist: missing target storage_key on this card; aborting');\n    return false;\n  }\n\n  // Clone config and scan\n  const cfg  = JSON.parse(JSON.stringify(ll.config));\n  const hits = (this._scanDdcCards || _scanDdcCards)(cfg);\n\n  console.debug('[ddc:import] persist: found DDC cards',\n    hits.map(h => ({\n      view: h.view,\n      path: h.path.join('.'),\n      storage_key: (h.card && (h.card.storage_key || h.card.storageKey)) || null\n    }))\n  );\n\n  // Select exactly one target by key (no \u201Cpatch-all-in-view\u201D fallback)\n  let targets = hits.filter(h => {\n    const sk =\n      norm(h.card?.storage_key) ??\n      norm(h.card?.storageKey) ??\n      norm(h.card?.options?.storage_key) ??\n      norm(h.card?.options?.storageKey);\n    return sk === myKey;\n  });\n\n  if (targets.length !== 1) {\n    console.warn('[ddc:import] persist: expected exactly one target with key, got', targets.length, { myKey });\n    return false;\n  }\n\n  // Build patch WITHOUT storage_key so we don't overwrite per-card keys\n  const patch = { type: 'custom:drag-and-drop-card', ...(opts || {}) };\n  if ('storage_key' in patch)  delete patch.storage_key;\n  if ('storageKey'  in patch)  delete patch.storageKey;\n  if (patch?.options) {\n    if ('storage_key' in patch.options) delete patch.options.storage_key;\n    if ('storageKey'  in patch.options) delete patch.options.storageKey;\n  }\n     // IMPORTANT: do NOT put the actual layout into Lovelace YAML\n   const cardsForStorage = Array.isArray(patch.cards) ? patch.cards : null;\n   delete patch.cards;\n\n  // Optional: backup (keeps your previous behavior if helpers exist)\n  try {\n    const backup = _makeYamlBackup?.(ll.config, targets, patch);\n    if (backup) {\n      console.debug('[ddc:import] backup created', { file: backup.name, items: backup.data?.count });\n      if (!noDownload && typeof _offerBackupDownload === 'function') _offerBackupDownload(backup.name, backup.data);\n    }\n  } catch (e) {\n    console.debug('[ddc:import] backup skipped/error:', e?.message || e);\n  }\n\n  // Apply to the single matched ref\n  const t = targets[0];\n  let ref = cfg;\n  for (const seg of t.path) ref = ref[seg];\n\n  const existingKey =\n    norm(ref?.storage_key) ??\n    norm(ref?.storageKey) ?? null;\n\n  Object.assign(ref, patch);\n\n  // Preserve the original key on this card\n  if (existingKey) {\n    ref.storage_key = existingKey;\n  } else {\n    ref.storage_key = myKey;\n  }\n  if ('storageKey' in ref) delete ref.storageKey;\n\n  console.debug('[ddc:import] persist \u2192 saving', {\n    patched: 1,\n    into_key: ref.storage_key,\n    ignored_file_key: norm(opts?.storage_key) || norm(opts?.storageKey) || null\n  });\n\n  await ll.saveConfig(cfg);\n  // Let the caller know if there were cards to save elsewhere\n  return { yamlSaved: true, cardsForStorage };\n}\n\n  async function _fetchBackendKeys() {\n    const parseKeys = (data) => {\n      if (!data) return [];\n      if (Array.isArray(data)) return data;\n      if (Array.isArray(data?.keys)) return data.keys;\n      if (Array.isArray(data?.dashboards)) return data.dashboards;\n      if (Array.isArray(data?.entries)) return data.entries.map(e => e.key || e.id || e.name).filter(Boolean);\n      if (Array.isArray(data?.items)) return data.items.map(e => e.key || e.id || e.name).filter(Boolean);\n      if (typeof data === 'object') {\n        for (const v of Object.values(data)) {\n          if (Array.isArray(v) && v.every(x => typeof x === 'string')) return v;\n        }\n      }\n      return [];\n    };\n    try {\n      if (this?.hass?.callApi) {\n        const r = await this.hass.callApi('get', 'dragdrop_storage');\n        const k = parseKeys(r);\n        if (k.length) return k;\n      }\n    } catch(e) { console.debug('[ddc:switcher] hass.callApi dragdrop_storage failed', e); }\n    const urls = ['/api/dragdrop_storage', '/api/dragdrop_storage/keys', '/api/dragdrop_storage/list', '/api/dragdrop_storage?all=1'];\n    for (const url of urls) {\n      try {\n        const resp = await fetch(url, { cache: 'no-store' });\n        const json = await resp.json();\n        const k = parseKeys(json);\n        if (k.length) return k;\n      } catch(e) {}\n    }\n    return [];\n  }\n  async function _fetchLayoutByKey(key) {\n    const parseDesign = (data) => {\n      if (!data) return null;\n      if (data.options || data.cards) return data;\n      if (typeof data.design === 'object') return data.design;\n      if (typeof data.payload === 'object') return data.payload;\n      try { if (typeof data === 'string') return JSON.parse(data); } catch {}\n      return null;\n    };\n    const tryCall = async (method, path, params) => {\n      try {\n        if (this?.hass?.callApi) {\n          const r = await this.hass.callApi(method, path, params);\n          const d = parseDesign(r);\n          if (d) return d;\n        }\n      } catch(e) {}\n      return null;\n    };\n    const tryFetch = async (url) => {\n      try {\n        const resp = await fetch(url, { cache: 'no-store' });\n        const ct = resp.headers.get('content-type') || '';\n        if (ct.includes('application/json') || ct.includes('text/plain')) {\n          const j = await resp.json().catch(()=>null) || await resp.text().catch(()=>null);\n          const d = parseDesign(j);\n          if (d) return d;\n        }\n      } catch(e) {}\n      return null;\n    };\n    const enc = encodeURIComponent(key);\n    return await (tryCall('get', `dragdrop_storage/${enc}`)\n      || tryFetch(`/api/dragdrop_storage/${enc}`)\n      || tryFetch(`/api/dragdrop_storage?key=${enc}`)\n      || tryCall('post', 'dragdrop_storage/get', { key })\n      || null);\n  }\n  async function _applyDesignObject(json, { source='switcher', newKey=null } = {}) {\n    if (!json || typeof json !== 'object') throw new Error('Invalid design payload');\n    const prevKey = this.storageKey || this._config?.storage_key || null;\n    try { this._dbgInit?.(); this._dbgPush?.('import', 'Begin import (programmatic)', { source, newKey }); } catch {}\n    if (json.options) {\n      const { storage_key, ...optsNoKey } = json.options;\n      this._applyImportedOptions?.(optsNoKey, true);\n    } else if (typeof json.grid === 'number') {\n      this._applyImportedOptions?.({ grid: json.grid }, true);\n    }\n    const key = newKey || json?.options?.storage_key || prevKey;\n    if (key) {\n      this.storageKey = key;\n      this._config = { ...(this._config || {}), storage_key: key };\n      try { this._syncEditorsStorageKey?.(); } catch {}\n    }\n    try {\n      const toPersist = json.options ?? (typeof json.grid === 'number' ? { grid: json.grid } : {});\n      await (this._persistOptionsToYaml?.call(this, { ...toPersist, storage_key: key }, { prevKey, noDownload: (source==='switcher') }));\n    } catch(e) { console.warn('[ddc:apply] persist failed', e); }\n    try {\n      this.cardContainer.innerHTML = '';\n      if (Array.isArray(json.cards) && json.cards.length) {\n        for (const conf of json.cards) {\n          if (!conf?.card || (typeof conf.card === 'object' && Object.keys(conf.card).length === 0)) {\n            const p = this._makePlaceholderAt?.(conf.position?.x||0, conf.position?.y||0, conf.size?.width||200, conf.size?.height||200);\n            if (p) this.cardContainer.appendChild(p);\n          } else {\n            const el = await this._createCard(conf.card);\n            const wrap = this._makeWrapper(el);\n            this._setCardPosition?.(wrap, conf.position?.x||0, conf.position?.y||0);\n            wrap.style.width  = `${conf.size?.width||140}px`;\n            wrap.style.height = `${conf.size?.height||100}px`;\n            if (conf.z != null) wrap.style.zIndex = String(conf.z);\n            this.cardContainer.appendChild(wrap);\n            try { this._rebuildOnce?.(wrap.firstElementChild); } catch {}\n            this._initCardInteract?.(wrap);\n          }\n        }\n      } else {\n        this._showEmptyPlaceholder?.();\n      }\n      this._resizeContainer?.();\n      this._markDirty?.('import');\n      this._toast?.(source==='switcher' ? `Loaded layout \"${key}\"` : 'Design imported');\n    } catch(e) {\n      console.error('[ddc:apply] rebuild failed', e);\n      this._toast?.('Import failed during rebuild.');\n    }\n  }\n  function _updateSwitcherVisibility() {\n    try {\n      const host = this.shadowRoot || this.renderRoot || this;\n      const el = host.querySelector('.ddc-switcher-inline');\n      if (!el) return;\n      const ll = this._getLovelace?.() || _getLovelace.call(this);\n      let edit = false;\n      try {\n        const hui = (host.getRootNode && host.getRootNode())?.host;\n        edit = !!(ll && (ll.editMode === true || (hui && hui.editMode === true)));\n      } catch {}\n      el.style.display = edit ? 'inline-flex' : 'none';\n    } catch {}\n  }\n  function _ensureInlineSwitcher() {\n    try {\n      if (this._ddcSwitcherInstalled) return;\n      const host = this.shadowRoot || this.renderRoot || this;\n      const toolbar = host.querySelector('.toolbar');\n      if (!toolbar) return;\n      const wrap = document.createElement('div');\n      wrap.className = 'ddc-switcher-inline';\n      Object.assign(wrap.style, { display: 'inline-flex', gap: '6px', alignItems: 'center', marginLeft: 'auto' });\n      const label = document.createElement('span');\n      label.textContent = 'Layout:';\n      label.style.fontSize = '12px';\n      label.style.opacity = '0.8';\n      const select = document.createElement('select');\n      Object.assign(select.style, {\n        fontSize: '12px', padding: '4px 6px', borderRadius: '8px',\n        border: '1px solid var(--divider-color, #999)',\n        background: 'var(--card-background-color, #fff)'\n      });\n      select.title = 'Select stored layout (storage_key)';\n      select.id = 'ddcKeySelect';\n      const btn = document.createElement('button');\n      btn.className = 'btn secondary';\n      btn.type = 'button';\n      btn.style.padding = '6px 10px';\n      btn.innerHTML = '<ha-icon icon=\"mdi:refresh\"></ha-icon><span style=\"margin-left:6px\">Refresh</span>';\n      wrap.appendChild(label);\n      wrap.appendChild(select);\n      wrap.appendChild(btn);\n      toolbar.appendChild(wrap);\n      this._ddcSwitcherInstalled = true;\n      const fill = async () => {\n        const current = this.storageKey || (this._config && this._config.storage_key) || '';\n        const serverKeys = await _fetchBackendKeys.call(this);\n        const backupKeys = _collectBackupKeys();\n        const recentKeys = _getRecentKeys();\n        const toUnique = (arr) => Array.from(new Set(arr.filter(Boolean)));\n        const server = toUnique(serverKeys);\n        const backups = toUnique(backupKeys);\n        const recent = toUnique(recentKeys);\n        select.innerHTML = '';\n        if (current && !server.includes(current) && !backups.includes(current) && !recent.includes(current)) {\n          const opt = document.createElement('option'); opt.value=current; opt.textContent = `${current} (current)`; select.appendChild(opt);\n        }\n        const makeGroup = (label, list) => {\n          if (!list.length) return;\n          const og = document.createElement('optgroup'); og.label = label;\n          list.forEach(k => {\n            const o = document.createElement('option'); o.value = k; o.textContent = k; if (k===current) o.selected = true;\n            og.appendChild(o);\n          });\n          select.appendChild(og);\n        };\n        makeGroup('Server', server);\n        makeGroup('Backups', backups);\n        makeGroup('Recent', recent);\n        if (!select.children.length) {\n          const none = document.createElement('option'); none.value=''; none.textContent='\u2014 none \u2014'; none.selected = true;\n          select.appendChild(none);\n        }\n        _updateSwitcherVisibility.call(this);\n      };\n      fill();\n      btn.addEventListener('click', fill);\n      \n      select.addEventListener('change', async (e) => {\n        const newKey = String(e.target.value || '');\n        if (!newKey) return;\n        if (this._ddcLoadingFromKey) return;\n        this._ddcLoadingFromKey = true;\n\n        try {\n          const design = await _fetchLayoutByKey.call(this, newKey);\n          if (!design) {\n            this._toast?.(`No layout found for \"${newKey}\"`);\n            return;\n          }\n\n          // Apply the newly selected design to the canvas\n          await _applyDesignObject.call(this, design, { source: 'switcher', newKey });\n          this._resizeContainer?.();\n          this._toast?.(`Loaded layout \"${newKey}\"`);\n\n          // ---- PERSIST THE SELECTED KEY *TO THE CARD OPTIONS* ----\n          // IMPORTANT: persist against the *old* key so the YAML updater finds this card\n          const oldKey = String(this._config?.storage_key || this.storageKey || '');\n\n          try {\n            const persistOpts = oldKey\n              ? { forceTargetKey: oldKey, noDownload: true }\n              : { noDownload: true };\n\n            await this._persistOptionsToYaml({ storage_key: newKey }, persistOpts);\n\n            // Only after successful persist, update in-memory config\n            this.storageKey = newKey;\n            if (this._config) this._config.storage_key = newKey;\n          } catch (err) {\n            console.warn('[ddc:switcher] failed to persist storage_key to YAML', err);\n            this._toast?.('Failed to persist selected layout. Keeping current.');\n            return; // bail so we don't reload into the wrong key\n          }\n\n          // ---- FLUSH SAVE UNDER THE *NEW* KEY, THEN HARD-RELOAD ----\n          try {\n            if (this._saveTimer) clearTimeout(this._saveTimer);\n            await this._saveLayout(true);      // writes under this.storageKey (now newKey)\n          } catch (e2) {\n            console.warn('[ddc:switcher] saveLayout failed', e2);\n            this._markDirty?.('switcher');\n            this._toast?.('Layout loaded \u2014 click Apply to save.');\n            return;\n          }\n\n          // Finally, reload so the selected layout is what loads on startup\n          window.location.reload();\n\n        } catch (err) {\n          console.warn('[ddc:switcher] load/apply failed', err);\n          this._toast?.('Failed to load layout.');\n        } finally {\n          this._ddcLoadingFromKey = false;\n        }\n      });\n      this._ddcVisTimer && clearInterval(this._ddcVisTimer);\n      this._ddcVisTimer = setInterval(() => _updateSwitcherVisibility.call(this), 800);\n      _updateSwitcherVisibility.call(this);\n    } catch(e) {\n      console.warn('[ddc:switcher] inline install failed', e);\n    }\n  }\n  if (!Cls.prototype._getLovelace) Cls.prototype._getLovelace = _getLovelace;\n  if (!Cls.prototype._scanDdcCards) Cls.prototype._scanDdcCards = _scanDdcCards;\n  Cls.prototype._persistOptionsToYaml = _persistOptionsToYaml;\n  if (!Cls.prototype._applyDesignObject) Cls.prototype._applyDesignObject = _applyDesignObject;\n  try {\n    const desc = Object.getOwnPropertyDescriptor(Cls.prototype, 'hass');\n    if (desc && (desc.set || desc.get)) {\n      const origSet = desc.set;\n      Object.defineProperty(Cls.prototype, 'hass', {\n        configurable: true, enumerable: true,\n        set(v) { if (origSet) origSet.call(this, v); try { _ensureInlineSwitcher.call(this); } catch(e){} },\n        get: desc.get || function(){ return this._hass; }\n      });\n    } else if (typeof Cls.prototype.setHass === 'function') {\n      const orig = Cls.prototype.setHass;\n      Cls.prototype.setHass = function(v){ if (orig) orig.call(this, v); try { _ensureInlineSwitcher.call(this); } catch(e){} }\n    } else {\n      const origUpdate = Cls.prototype.updated || Cls.prototype.firstUpdated;\n      Cls.prototype.updated = function(...args){ if (origUpdate) origUpdate.apply(this, args); try { _ensureInlineSwitcher.call(this); } catch(e){} }\n    }\n  } catch(e){ console.warn('[ddc:switcher] wrap hass setter failed', e); }\n})();\n/* ==== /DDC AUGMENTATION v6 ==== */", "\n/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */\nfunction isNothing(subject) {\n  return (typeof subject === 'undefined') || (subject === null);\n}\n\n\nfunction isObject(subject) {\n  return (typeof subject === 'object') && (subject !== null);\n}\n\n\nfunction toArray(sequence) {\n  if (Array.isArray(sequence)) return sequence;\n  else if (isNothing(sequence)) return [];\n\n  return [ sequence ];\n}\n\n\nfunction extend(target, source) {\n  var index, length, key, sourceKeys;\n\n  if (source) {\n    sourceKeys = Object.keys(source);\n\n    for (index = 0, length = sourceKeys.length; index < length; index += 1) {\n      key = sourceKeys[index];\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\n\nfunction repeat(string, count) {\n  var result = '', cycle;\n\n  for (cycle = 0; cycle < count; cycle += 1) {\n    result += string;\n  }\n\n  return result;\n}\n\n\nfunction isNegativeZero(number) {\n  return (number === 0) && (Number.NEGATIVE_INFINITY === 1 / number);\n}\n\n\nvar isNothing_1      = isNothing;\nvar isObject_1       = isObject;\nvar toArray_1        = toArray;\nvar repeat_1         = repeat;\nvar isNegativeZero_1 = isNegativeZero;\nvar extend_1         = extend;\n\nvar common = {\n\tisNothing: isNothing_1,\n\tisObject: isObject_1,\n\ttoArray: toArray_1,\n\trepeat: repeat_1,\n\tisNegativeZero: isNegativeZero_1,\n\textend: extend_1\n};\n\n// YAML error class. http://stackoverflow.com/questions/8458984\n\n\nfunction formatError(exception, compact) {\n  var where = '', message = exception.reason || '(unknown reason)';\n\n  if (!exception.mark) return message;\n\n  if (exception.mark.name) {\n    where += 'in \"' + exception.mark.name + '\" ';\n  }\n\n  where += '(' + (exception.mark.line + 1) + ':' + (exception.mark.column + 1) + ')';\n\n  if (!compact && exception.mark.snippet) {\n    where += '\\n\\n' + exception.mark.snippet;\n  }\n\n  return message + ' ' + where;\n}\n\n\nfunction YAMLException$1(reason, mark) {\n  // Super constructor\n  Error.call(this);\n\n  this.name = 'YAMLException';\n  this.reason = reason;\n  this.mark = mark;\n  this.message = formatError(this, false);\n\n  // Include stack trace in error object\n  if (Error.captureStackTrace) {\n    // Chrome and NodeJS\n    Error.captureStackTrace(this, this.constructor);\n  } else {\n    // FF, IE 10+ and Safari 6+. Fallback for others\n    this.stack = (new Error()).stack || '';\n  }\n}\n\n\n// Inherit from Error\nYAMLException$1.prototype = Object.create(Error.prototype);\nYAMLException$1.prototype.constructor = YAMLException$1;\n\n\nYAMLException$1.prototype.toString = function toString(compact) {\n  return this.name + ': ' + formatError(this, compact);\n};\n\n\nvar exception = YAMLException$1;\n\n// get snippet for a single line, respecting maxLength\nfunction getLine(buffer, lineStart, lineEnd, position, maxLineLength) {\n  var head = '';\n  var tail = '';\n  var maxHalfLength = Math.floor(maxLineLength / 2) - 1;\n\n  if (position - lineStart > maxHalfLength) {\n    head = ' ... ';\n    lineStart = position - maxHalfLength + head.length;\n  }\n\n  if (lineEnd - position > maxHalfLength) {\n    tail = ' ...';\n    lineEnd = position + maxHalfLength - tail.length;\n  }\n\n  return {\n    str: head + buffer.slice(lineStart, lineEnd).replace(/\\t/g, '\u2192') + tail,\n    pos: position - lineStart + head.length // relative position\n  };\n}\n\n\nfunction padStart(string, max) {\n  return common.repeat(' ', max - string.length) + string;\n}\n\n\nfunction makeSnippet(mark, options) {\n  options = Object.create(options || null);\n\n  if (!mark.buffer) return null;\n\n  if (!options.maxLength) options.maxLength = 79;\n  if (typeof options.indent      !== 'number') options.indent      = 1;\n  if (typeof options.linesBefore !== 'number') options.linesBefore = 3;\n  if (typeof options.linesAfter  !== 'number') options.linesAfter  = 2;\n\n  var re = /\\r?\\n|\\r|\\0/g;\n  var lineStarts = [ 0 ];\n  var lineEnds = [];\n  var match;\n  var foundLineNo = -1;\n\n  while ((match = re.exec(mark.buffer))) {\n    lineEnds.push(match.index);\n    lineStarts.push(match.index + match[0].length);\n\n    if (mark.position <= match.index && foundLineNo < 0) {\n      foundLineNo = lineStarts.length - 2;\n    }\n  }\n\n  if (foundLineNo < 0) foundLineNo = lineStarts.length - 1;\n\n  var result = '', i, line;\n  var lineNoLength = Math.min(mark.line + options.linesAfter, lineEnds.length).toString().length;\n  var maxLineLength = options.maxLength - (options.indent + lineNoLength + 3);\n\n  for (i = 1; i <= options.linesBefore; i++) {\n    if (foundLineNo - i < 0) break;\n    line = getLine(\n      mark.buffer,\n      lineStarts[foundLineNo - i],\n      lineEnds[foundLineNo - i],\n      mark.position - (lineStarts[foundLineNo] - lineStarts[foundLineNo - i]),\n      maxLineLength\n    );\n    result = common.repeat(' ', options.indent) + padStart((mark.line - i + 1).toString(), lineNoLength) +\n      ' | ' + line.str + '\\n' + result;\n  }\n\n  line = getLine(mark.buffer, lineStarts[foundLineNo], lineEnds[foundLineNo], mark.position, maxLineLength);\n  result += common.repeat(' ', options.indent) + padStart((mark.line + 1).toString(), lineNoLength) +\n    ' | ' + line.str + '\\n';\n  result += common.repeat('-', options.indent + lineNoLength + 3 + line.pos) + '^' + '\\n';\n\n  for (i = 1; i <= options.linesAfter; i++) {\n    if (foundLineNo + i >= lineEnds.length) break;\n    line = getLine(\n      mark.buffer,\n      lineStarts[foundLineNo + i],\n      lineEnds[foundLineNo + i],\n      mark.position - (lineStarts[foundLineNo] - lineStarts[foundLineNo + i]),\n      maxLineLength\n    );\n    result += common.repeat(' ', options.indent) + padStart((mark.line + i + 1).toString(), lineNoLength) +\n      ' | ' + line.str + '\\n';\n  }\n\n  return result.replace(/\\n$/, '');\n}\n\n\nvar snippet = makeSnippet;\n\nvar TYPE_CONSTRUCTOR_OPTIONS = [\n  'kind',\n  'multi',\n  'resolve',\n  'construct',\n  'instanceOf',\n  'predicate',\n  'represent',\n  'representName',\n  'defaultStyle',\n  'styleAliases'\n];\n\nvar YAML_NODE_KINDS = [\n  'scalar',\n  'sequence',\n  'mapping'\n];\n\nfunction compileStyleAliases(map) {\n  var result = {};\n\n  if (map !== null) {\n    Object.keys(map).forEach(function (style) {\n      map[style].forEach(function (alias) {\n        result[String(alias)] = style;\n      });\n    });\n  }\n\n  return result;\n}\n\nfunction Type$1(tag, options) {\n  options = options || {};\n\n  Object.keys(options).forEach(function (name) {\n    if (TYPE_CONSTRUCTOR_OPTIONS.indexOf(name) === -1) {\n      throw new exception('Unknown option \"' + name + '\" is met in definition of \"' + tag + '\" YAML type.');\n    }\n  });\n\n  // TODO: Add tag format check.\n  this.options       = options; // keep original options in case user wants to extend this type later\n  this.tag           = tag;\n  this.kind          = options['kind']          || null;\n  this.resolve       = options['resolve']       || function () { return true; };\n  this.construct     = options['construct']     || function (data) { return data; };\n  this.instanceOf    = options['instanceOf']    || null;\n  this.predicate     = options['predicate']     || null;\n  this.represent     = options['represent']     || null;\n  this.representName = options['representName'] || null;\n  this.defaultStyle  = options['defaultStyle']  || null;\n  this.multi         = options['multi']         || false;\n  this.styleAliases  = compileStyleAliases(options['styleAliases'] || null);\n\n  if (YAML_NODE_KINDS.indexOf(this.kind) === -1) {\n    throw new exception('Unknown kind \"' + this.kind + '\" is specified for \"' + tag + '\" YAML type.');\n  }\n}\n\nvar type = Type$1;\n\n/*eslint-disable max-len*/\n\n\n\n\n\nfunction compileList(schema, name) {\n  var result = [];\n\n  schema[name].forEach(function (currentType) {\n    var newIndex = result.length;\n\n    result.forEach(function (previousType, previousIndex) {\n      if (previousType.tag === currentType.tag &&\n          previousType.kind === currentType.kind &&\n          previousType.multi === currentType.multi) {\n\n        newIndex = previousIndex;\n      }\n    });\n\n    result[newIndex] = currentType;\n  });\n\n  return result;\n}\n\n\nfunction compileMap(/* lists... */) {\n  var result = {\n        scalar: {},\n        sequence: {},\n        mapping: {},\n        fallback: {},\n        multi: {\n          scalar: [],\n          sequence: [],\n          mapping: [],\n          fallback: []\n        }\n      }, index, length;\n\n  function collectType(type) {\n    if (type.multi) {\n      result.multi[type.kind].push(type);\n      result.multi['fallback'].push(type);\n    } else {\n      result[type.kind][type.tag] = result['fallback'][type.tag] = type;\n    }\n  }\n\n  for (index = 0, length = arguments.length; index < length; index += 1) {\n    arguments[index].forEach(collectType);\n  }\n  return result;\n}\n\n\nfunction Schema$1(definition) {\n  return this.extend(definition);\n}\n\n\nSchema$1.prototype.extend = function extend(definition) {\n  var implicit = [];\n  var explicit = [];\n\n  if (definition instanceof type) {\n    // Schema.extend(type)\n    explicit.push(definition);\n\n  } else if (Array.isArray(definition)) {\n    // Schema.extend([ type1, type2, ... ])\n    explicit = explicit.concat(definition);\n\n  } else if (definition && (Array.isArray(definition.implicit) || Array.isArray(definition.explicit))) {\n    // Schema.extend({ explicit: [ type1, type2, ... ], implicit: [ type1, type2, ... ] })\n    if (definition.implicit) implicit = implicit.concat(definition.implicit);\n    if (definition.explicit) explicit = explicit.concat(definition.explicit);\n\n  } else {\n    throw new exception('Schema.extend argument should be a Type, [ Type ], ' +\n      'or a schema definition ({ implicit: [...], explicit: [...] })');\n  }\n\n  implicit.forEach(function (type$1) {\n    if (!(type$1 instanceof type)) {\n      throw new exception('Specified list of YAML types (or a single Type object) contains a non-Type object.');\n    }\n\n    if (type$1.loadKind && type$1.loadKind !== 'scalar') {\n      throw new exception('There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.');\n    }\n\n    if (type$1.multi) {\n      throw new exception('There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.');\n    }\n  });\n\n  explicit.forEach(function (type$1) {\n    if (!(type$1 instanceof type)) {\n      throw new exception('Specified list of YAML types (or a single Type object) contains a non-Type object.');\n    }\n  });\n\n  var result = Object.create(Schema$1.prototype);\n\n  result.implicit = (this.implicit || []).concat(implicit);\n  result.explicit = (this.explicit || []).concat(explicit);\n\n  result.compiledImplicit = compileList(result, 'implicit');\n  result.compiledExplicit = compileList(result, 'explicit');\n  result.compiledTypeMap  = compileMap(result.compiledImplicit, result.compiledExplicit);\n\n  return result;\n};\n\n\nvar schema = Schema$1;\n\nvar str = new type('tag:yaml.org,2002:str', {\n  kind: 'scalar',\n  construct: function (data) { return data !== null ? data : ''; }\n});\n\nvar seq = new type('tag:yaml.org,2002:seq', {\n  kind: 'sequence',\n  construct: function (data) { return data !== null ? data : []; }\n});\n\nvar map = new type('tag:yaml.org,2002:map', {\n  kind: 'mapping',\n  construct: function (data) { return data !== null ? data : {}; }\n});\n\nvar failsafe = new schema({\n  explicit: [\n    str,\n    seq,\n    map\n  ]\n});\n\nfunction resolveYamlNull(data) {\n  if (data === null) return true;\n\n  var max = data.length;\n\n  return (max === 1 && data === '~') ||\n         (max === 4 && (data === 'null' || data === 'Null' || data === 'NULL'));\n}\n\nfunction constructYamlNull() {\n  return null;\n}\n\nfunction isNull(object) {\n  return object === null;\n}\n\nvar _null = new type('tag:yaml.org,2002:null', {\n  kind: 'scalar',\n  resolve: resolveYamlNull,\n  construct: constructYamlNull,\n  predicate: isNull,\n  represent: {\n    canonical: function () { return '~';    },\n    lowercase: function () { return 'null'; },\n    uppercase: function () { return 'NULL'; },\n    camelcase: function () { return 'Null'; },\n    empty:     function () { return '';     }\n  },\n  defaultStyle: 'lowercase'\n});\n\nfunction resolveYamlBoolean(data) {\n  if (data === null) return false;\n\n  var max = data.length;\n\n  return (max === 4 && (data === 'true' || data === 'True' || data === 'TRUE')) ||\n         (max === 5 && (data === 'false' || data === 'False' || data === 'FALSE'));\n}\n\nfunction constructYamlBoolean(data) {\n  return data === 'true' ||\n         data === 'True' ||\n         data === 'TRUE';\n}\n\nfunction isBoolean(object) {\n  return Object.prototype.toString.call(object) === '[object Boolean]';\n}\n\nvar bool = new type('tag:yaml.org,2002:bool', {\n  kind: 'scalar',\n  resolve: resolveYamlBoolean,\n  construct: constructYamlBoolean,\n  predicate: isBoolean,\n  represent: {\n    lowercase: function (object) { return object ? 'true' : 'false'; },\n    uppercase: function (object) { return object ? 'TRUE' : 'FALSE'; },\n    camelcase: function (object) { return object ? 'True' : 'False'; }\n  },\n  defaultStyle: 'lowercase'\n});\n\nfunction isHexCode(c) {\n  return ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */)) ||\n         ((0x41/* A */ <= c) && (c <= 0x46/* F */)) ||\n         ((0x61/* a */ <= c) && (c <= 0x66/* f */));\n}\n\nfunction isOctCode(c) {\n  return ((0x30/* 0 */ <= c) && (c <= 0x37/* 7 */));\n}\n\nfunction isDecCode(c) {\n  return ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */));\n}\n\nfunction resolveYamlInteger(data) {\n  if (data === null) return false;\n\n  var max = data.length,\n      index = 0,\n      hasDigits = false,\n      ch;\n\n  if (!max) return false;\n\n  ch = data[index];\n\n  // sign\n  if (ch === '-' || ch === '+') {\n    ch = data[++index];\n  }\n\n  if (ch === '0') {\n    // 0\n    if (index + 1 === max) return true;\n    ch = data[++index];\n\n    // base 2, base 8, base 16\n\n    if (ch === 'b') {\n      // base 2\n      index++;\n\n      for (; index < max; index++) {\n        ch = data[index];\n        if (ch === '_') continue;\n        if (ch !== '0' && ch !== '1') return false;\n        hasDigits = true;\n      }\n      return hasDigits && ch !== '_';\n    }\n\n\n    if (ch === 'x') {\n      // base 16\n      index++;\n\n      for (; index < max; index++) {\n        ch = data[index];\n        if (ch === '_') continue;\n        if (!isHexCode(data.charCodeAt(index))) return false;\n        hasDigits = true;\n      }\n      return hasDigits && ch !== '_';\n    }\n\n\n    if (ch === 'o') {\n      // base 8\n      index++;\n\n      for (; index < max; index++) {\n        ch = data[index];\n        if (ch === '_') continue;\n        if (!isOctCode(data.charCodeAt(index))) return false;\n        hasDigits = true;\n      }\n      return hasDigits && ch !== '_';\n    }\n  }\n\n  // base 10 (except 0)\n\n  // value should not start with `_`;\n  if (ch === '_') return false;\n\n  for (; index < max; index++) {\n    ch = data[index];\n    if (ch === '_') continue;\n    if (!isDecCode(data.charCodeAt(index))) {\n      return false;\n    }\n    hasDigits = true;\n  }\n\n  // Should have digits and should not end with `_`\n  if (!hasDigits || ch === '_') return false;\n\n  return true;\n}\n\nfunction constructYamlInteger(data) {\n  var value = data, sign = 1, ch;\n\n  if (value.indexOf('_') !== -1) {\n    value = value.replace(/_/g, '');\n  }\n\n  ch = value[0];\n\n  if (ch === '-' || ch === '+') {\n    if (ch === '-') sign = -1;\n    value = value.slice(1);\n    ch = value[0];\n  }\n\n  if (value === '0') return 0;\n\n  if (ch === '0') {\n    if (value[1] === 'b') return sign * parseInt(value.slice(2), 2);\n    if (value[1] === 'x') return sign * parseInt(value.slice(2), 16);\n    if (value[1] === 'o') return sign * parseInt(value.slice(2), 8);\n  }\n\n  return sign * parseInt(value, 10);\n}\n\nfunction isInteger(object) {\n  return (Object.prototype.toString.call(object)) === '[object Number]' &&\n         (object % 1 === 0 && !common.isNegativeZero(object));\n}\n\nvar int = new type('tag:yaml.org,2002:int', {\n  kind: 'scalar',\n  resolve: resolveYamlInteger,\n  construct: constructYamlInteger,\n  predicate: isInteger,\n  represent: {\n    binary:      function (obj) { return obj >= 0 ? '0b' + obj.toString(2) : '-0b' + obj.toString(2).slice(1); },\n    octal:       function (obj) { return obj >= 0 ? '0o'  + obj.toString(8) : '-0o'  + obj.toString(8).slice(1); },\n    decimal:     function (obj) { return obj.toString(10); },\n    /* eslint-disable max-len */\n    hexadecimal: function (obj) { return obj >= 0 ? '0x' + obj.toString(16).toUpperCase() :  '-0x' + obj.toString(16).toUpperCase().slice(1); }\n  },\n  defaultStyle: 'decimal',\n  styleAliases: {\n    binary:      [ 2,  'bin' ],\n    octal:       [ 8,  'oct' ],\n    decimal:     [ 10, 'dec' ],\n    hexadecimal: [ 16, 'hex' ]\n  }\n});\n\nvar YAML_FLOAT_PATTERN = new RegExp(\n  // 2.5e4, 2.5 and integers\n  '^(?:[-+]?(?:[0-9][0-9_]*)(?:\\\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?' +\n  // .2e4, .2\n  // special case, seems not from spec\n  '|\\\\.[0-9_]+(?:[eE][-+]?[0-9]+)?' +\n  // .inf\n  '|[-+]?\\\\.(?:inf|Inf|INF)' +\n  // .nan\n  '|\\\\.(?:nan|NaN|NAN))$');\n\nfunction resolveYamlFloat(data) {\n  if (data === null) return false;\n\n  if (!YAML_FLOAT_PATTERN.test(data) ||\n      // Quick hack to not allow integers end with `_`\n      // Probably should update regexp & check speed\n      data[data.length - 1] === '_') {\n    return false;\n  }\n\n  return true;\n}\n\nfunction constructYamlFloat(data) {\n  var value, sign;\n\n  value  = data.replace(/_/g, '').toLowerCase();\n  sign   = value[0] === '-' ? -1 : 1;\n\n  if ('+-'.indexOf(value[0]) >= 0) {\n    value = value.slice(1);\n  }\n\n  if (value === '.inf') {\n    return (sign === 1) ? Number.POSITIVE_INFINITY : Number.NEGATIVE_INFINITY;\n\n  } else if (value === '.nan') {\n    return NaN;\n  }\n  return sign * parseFloat(value, 10);\n}\n\n\nvar SCIENTIFIC_WITHOUT_DOT = /^[-+]?[0-9]+e/;\n\nfunction representYamlFloat(object, style) {\n  var res;\n\n  if (isNaN(object)) {\n    switch (style) {\n      case 'lowercase': return '.nan';\n      case 'uppercase': return '.NAN';\n      case 'camelcase': return '.NaN';\n    }\n  } else if (Number.POSITIVE_INFINITY === object) {\n    switch (style) {\n      case 'lowercase': return '.inf';\n      case 'uppercase': return '.INF';\n      case 'camelcase': return '.Inf';\n    }\n  } else if (Number.NEGATIVE_INFINITY === object) {\n    switch (style) {\n      case 'lowercase': return '-.inf';\n      case 'uppercase': return '-.INF';\n      case 'camelcase': return '-.Inf';\n    }\n  } else if (common.isNegativeZero(object)) {\n    return '-0.0';\n  }\n\n  res = object.toString(10);\n\n  // JS stringifier can build scientific format without dots: 5e-100,\n  // while YAML requres dot: 5.e-100. Fix it with simple hack\n\n  return SCIENTIFIC_WITHOUT_DOT.test(res) ? res.replace('e', '.e') : res;\n}\n\nfunction isFloat(object) {\n  return (Object.prototype.toString.call(object) === '[object Number]') &&\n         (object % 1 !== 0 || common.isNegativeZero(object));\n}\n\nvar float = new type('tag:yaml.org,2002:float', {\n  kind: 'scalar',\n  resolve: resolveYamlFloat,\n  construct: constructYamlFloat,\n  predicate: isFloat,\n  represent: representYamlFloat,\n  defaultStyle: 'lowercase'\n});\n\nvar json = failsafe.extend({\n  implicit: [\n    _null,\n    bool,\n    int,\n    float\n  ]\n});\n\nvar core = json;\n\nvar YAML_DATE_REGEXP = new RegExp(\n  '^([0-9][0-9][0-9][0-9])'          + // [1] year\n  '-([0-9][0-9])'                    + // [2] month\n  '-([0-9][0-9])$');                   // [3] day\n\nvar YAML_TIMESTAMP_REGEXP = new RegExp(\n  '^([0-9][0-9][0-9][0-9])'          + // [1] year\n  '-([0-9][0-9]?)'                   + // [2] month\n  '-([0-9][0-9]?)'                   + // [3] day\n  '(?:[Tt]|[ \\\\t]+)'                 + // ...\n  '([0-9][0-9]?)'                    + // [4] hour\n  ':([0-9][0-9])'                    + // [5] minute\n  ':([0-9][0-9])'                    + // [6] second\n  '(?:\\\\.([0-9]*))?'                 + // [7] fraction\n  '(?:[ \\\\t]*(Z|([-+])([0-9][0-9]?)' + // [8] tz [9] tz_sign [10] tz_hour\n  '(?::([0-9][0-9]))?))?$');           // [11] tz_minute\n\nfunction resolveYamlTimestamp(data) {\n  if (data === null) return false;\n  if (YAML_DATE_REGEXP.exec(data) !== null) return true;\n  if (YAML_TIMESTAMP_REGEXP.exec(data) !== null) return true;\n  return false;\n}\n\nfunction constructYamlTimestamp(data) {\n  var match, year, month, day, hour, minute, second, fraction = 0,\n      delta = null, tz_hour, tz_minute, date;\n\n  match = YAML_DATE_REGEXP.exec(data);\n  if (match === null) match = YAML_TIMESTAMP_REGEXP.exec(data);\n\n  if (match === null) throw new Error('Date resolve error');\n\n  // match: [1] year [2] month [3] day\n\n  year = +(match[1]);\n  month = +(match[2]) - 1; // JS month starts with 0\n  day = +(match[3]);\n\n  if (!match[4]) { // no hour\n    return new Date(Date.UTC(year, month, day));\n  }\n\n  // match: [4] hour [5] minute [6] second [7] fraction\n\n  hour = +(match[4]);\n  minute = +(match[5]);\n  second = +(match[6]);\n\n  if (match[7]) {\n    fraction = match[7].slice(0, 3);\n    while (fraction.length < 3) { // milli-seconds\n      fraction += '0';\n    }\n    fraction = +fraction;\n  }\n\n  // match: [8] tz [9] tz_sign [10] tz_hour [11] tz_minute\n\n  if (match[9]) {\n    tz_hour = +(match[10]);\n    tz_minute = +(match[11] || 0);\n    delta = (tz_hour * 60 + tz_minute) * 60000; // delta in mili-seconds\n    if (match[9] === '-') delta = -delta;\n  }\n\n  date = new Date(Date.UTC(year, month, day, hour, minute, second, fraction));\n\n  if (delta) date.setTime(date.getTime() - delta);\n\n  return date;\n}\n\nfunction representYamlTimestamp(object /*, style*/) {\n  return object.toISOString();\n}\n\nvar timestamp = new type('tag:yaml.org,2002:timestamp', {\n  kind: 'scalar',\n  resolve: resolveYamlTimestamp,\n  construct: constructYamlTimestamp,\n  instanceOf: Date,\n  represent: representYamlTimestamp\n});\n\nfunction resolveYamlMerge(data) {\n  return data === '<<' || data === null;\n}\n\nvar merge = new type('tag:yaml.org,2002:merge', {\n  kind: 'scalar',\n  resolve: resolveYamlMerge\n});\n\n/*eslint-disable no-bitwise*/\n\n\n\n\n\n// [ 64, 65, 66 ] -> [ padding, CR, LF ]\nvar BASE64_MAP = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\\n\\r';\n\n\nfunction resolveYamlBinary(data) {\n  if (data === null) return false;\n\n  var code, idx, bitlen = 0, max = data.length, map = BASE64_MAP;\n\n  // Convert one by one.\n  for (idx = 0; idx < max; idx++) {\n    code = map.indexOf(data.charAt(idx));\n\n    // Skip CR/LF\n    if (code > 64) continue;\n\n    // Fail on illegal characters\n    if (code < 0) return false;\n\n    bitlen += 6;\n  }\n\n  // If there are any bits left, source was corrupted\n  return (bitlen % 8) === 0;\n}\n\nfunction constructYamlBinary(data) {\n  var idx, tailbits,\n      input = data.replace(/[\\r\\n=]/g, ''), // remove CR/LF & padding to simplify scan\n      max = input.length,\n      map = BASE64_MAP,\n      bits = 0,\n      result = [];\n\n  // Collect by 6*4 bits (3 bytes)\n\n  for (idx = 0; idx < max; idx++) {\n    if ((idx % 4 === 0) && idx) {\n      result.push((bits >> 16) & 0xFF);\n      result.push((bits >> 8) & 0xFF);\n      result.push(bits & 0xFF);\n    }\n\n    bits = (bits << 6) | map.indexOf(input.charAt(idx));\n  }\n\n  // Dump tail\n\n  tailbits = (max % 4) * 6;\n\n  if (tailbits === 0) {\n    result.push((bits >> 16) & 0xFF);\n    result.push((bits >> 8) & 0xFF);\n    result.push(bits & 0xFF);\n  } else if (tailbits === 18) {\n    result.push((bits >> 10) & 0xFF);\n    result.push((bits >> 2) & 0xFF);\n  } else if (tailbits === 12) {\n    result.push((bits >> 4) & 0xFF);\n  }\n\n  return new Uint8Array(result);\n}\n\nfunction representYamlBinary(object /*, style*/) {\n  var result = '', bits = 0, idx, tail,\n      max = object.length,\n      map = BASE64_MAP;\n\n  // Convert every three bytes to 4 ASCII characters.\n\n  for (idx = 0; idx < max; idx++) {\n    if ((idx % 3 === 0) && idx) {\n      result += map[(bits >> 18) & 0x3F];\n      result += map[(bits >> 12) & 0x3F];\n      result += map[(bits >> 6) & 0x3F];\n      result += map[bits & 0x3F];\n    }\n\n    bits = (bits << 8) + object[idx];\n  }\n\n  // Dump tail\n\n  tail = max % 3;\n\n  if (tail === 0) {\n    result += map[(bits >> 18) & 0x3F];\n    result += map[(bits >> 12) & 0x3F];\n    result += map[(bits >> 6) & 0x3F];\n    result += map[bits & 0x3F];\n  } else if (tail === 2) {\n    result += map[(bits >> 10) & 0x3F];\n    result += map[(bits >> 4) & 0x3F];\n    result += map[(bits << 2) & 0x3F];\n    result += map[64];\n  } else if (tail === 1) {\n    result += map[(bits >> 2) & 0x3F];\n    result += map[(bits << 4) & 0x3F];\n    result += map[64];\n    result += map[64];\n  }\n\n  return result;\n}\n\nfunction isBinary(obj) {\n  return Object.prototype.toString.call(obj) ===  '[object Uint8Array]';\n}\n\nvar binary = new type('tag:yaml.org,2002:binary', {\n  kind: 'scalar',\n  resolve: resolveYamlBinary,\n  construct: constructYamlBinary,\n  predicate: isBinary,\n  represent: representYamlBinary\n});\n\nvar _hasOwnProperty$3 = Object.prototype.hasOwnProperty;\nvar _toString$2       = Object.prototype.toString;\n\nfunction resolveYamlOmap(data) {\n  if (data === null) return true;\n\n  var objectKeys = [], index, length, pair, pairKey, pairHasKey,\n      object = data;\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    pair = object[index];\n    pairHasKey = false;\n\n    if (_toString$2.call(pair) !== '[object Object]') return false;\n\n    for (pairKey in pair) {\n      if (_hasOwnProperty$3.call(pair, pairKey)) {\n        if (!pairHasKey) pairHasKey = true;\n        else return false;\n      }\n    }\n\n    if (!pairHasKey) return false;\n\n    if (objectKeys.indexOf(pairKey) === -1) objectKeys.push(pairKey);\n    else return false;\n  }\n\n  return true;\n}\n\nfunction constructYamlOmap(data) {\n  return data !== null ? data : [];\n}\n\nvar omap = new type('tag:yaml.org,2002:omap', {\n  kind: 'sequence',\n  resolve: resolveYamlOmap,\n  construct: constructYamlOmap\n});\n\nvar _toString$1 = Object.prototype.toString;\n\nfunction resolveYamlPairs(data) {\n  if (data === null) return true;\n\n  var index, length, pair, keys, result,\n      object = data;\n\n  result = new Array(object.length);\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    pair = object[index];\n\n    if (_toString$1.call(pair) !== '[object Object]') return false;\n\n    keys = Object.keys(pair);\n\n    if (keys.length !== 1) return false;\n\n    result[index] = [ keys[0], pair[keys[0]] ];\n  }\n\n  return true;\n}\n\nfunction constructYamlPairs(data) {\n  if (data === null) return [];\n\n  var index, length, pair, keys, result,\n      object = data;\n\n  result = new Array(object.length);\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    pair = object[index];\n\n    keys = Object.keys(pair);\n\n    result[index] = [ keys[0], pair[keys[0]] ];\n  }\n\n  return result;\n}\n\nvar pairs = new type('tag:yaml.org,2002:pairs', {\n  kind: 'sequence',\n  resolve: resolveYamlPairs,\n  construct: constructYamlPairs\n});\n\nvar _hasOwnProperty$2 = Object.prototype.hasOwnProperty;\n\nfunction resolveYamlSet(data) {\n  if (data === null) return true;\n\n  var key, object = data;\n\n  for (key in object) {\n    if (_hasOwnProperty$2.call(object, key)) {\n      if (object[key] !== null) return false;\n    }\n  }\n\n  return true;\n}\n\nfunction constructYamlSet(data) {\n  return data !== null ? data : {};\n}\n\nvar set = new type('tag:yaml.org,2002:set', {\n  kind: 'mapping',\n  resolve: resolveYamlSet,\n  construct: constructYamlSet\n});\n\nvar _default = core.extend({\n  implicit: [\n    timestamp,\n    merge\n  ],\n  explicit: [\n    binary,\n    omap,\n    pairs,\n    set\n  ]\n});\n\n/*eslint-disable max-len,no-use-before-define*/\n\n\n\n\n\n\n\nvar _hasOwnProperty$1 = Object.prototype.hasOwnProperty;\n\n\nvar CONTEXT_FLOW_IN   = 1;\nvar CONTEXT_FLOW_OUT  = 2;\nvar CONTEXT_BLOCK_IN  = 3;\nvar CONTEXT_BLOCK_OUT = 4;\n\n\nvar CHOMPING_CLIP  = 1;\nvar CHOMPING_STRIP = 2;\nvar CHOMPING_KEEP  = 3;\n\n\nvar PATTERN_NON_PRINTABLE         = /[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7F-\\x84\\x86-\\x9F\\uFFFE\\uFFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF]/;\nvar PATTERN_NON_ASCII_LINE_BREAKS = /[\\x85\\u2028\\u2029]/;\nvar PATTERN_FLOW_INDICATORS       = /[,\\[\\]\\{\\}]/;\nvar PATTERN_TAG_HANDLE            = /^(?:!|!!|![a-z\\-]+!)$/i;\nvar PATTERN_TAG_URI               = /^(?:!|[^,\\[\\]\\{\\}])(?:%[0-9a-f]{2}|[0-9a-z\\-#;\\/\\?:@&=\\+\\$,_\\.!~\\*'\\(\\)\\[\\]])*$/i;\n\n\nfunction _class(obj) { return Object.prototype.toString.call(obj); }\n\nfunction is_EOL(c) {\n  return (c === 0x0A/* LF */) || (c === 0x0D/* CR */);\n}\n\nfunction is_WHITE_SPACE(c) {\n  return (c === 0x09/* Tab */) || (c === 0x20/* Space */);\n}\n\nfunction is_WS_OR_EOL(c) {\n  return (c === 0x09/* Tab */) ||\n         (c === 0x20/* Space */) ||\n         (c === 0x0A/* LF */) ||\n         (c === 0x0D/* CR */);\n}\n\nfunction is_FLOW_INDICATOR(c) {\n  return c === 0x2C/* , */ ||\n         c === 0x5B/* [ */ ||\n         c === 0x5D/* ] */ ||\n         c === 0x7B/* { */ ||\n         c === 0x7D/* } */;\n}\n\nfunction fromHexCode(c) {\n  var lc;\n\n  if ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */)) {\n    return c - 0x30;\n  }\n\n  /*eslint-disable no-bitwise*/\n  lc = c | 0x20;\n\n  if ((0x61/* a */ <= lc) && (lc <= 0x66/* f */)) {\n    return lc - 0x61 + 10;\n  }\n\n  return -1;\n}\n\nfunction escapedHexLen(c) {\n  if (c === 0x78/* x */) { return 2; }\n  if (c === 0x75/* u */) { return 4; }\n  if (c === 0x55/* U */) { return 8; }\n  return 0;\n}\n\nfunction fromDecimalCode(c) {\n  if ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */)) {\n    return c - 0x30;\n  }\n\n  return -1;\n}\n\nfunction simpleEscapeSequence(c) {\n  /* eslint-disable indent */\n  return (c === 0x30/* 0 */) ? '\\x00' :\n        (c === 0x61/* a */) ? '\\x07' :\n        (c === 0x62/* b */) ? '\\x08' :\n        (c === 0x74/* t */) ? '\\x09' :\n        (c === 0x09/* Tab */) ? '\\x09' :\n        (c === 0x6E/* n */) ? '\\x0A' :\n        (c === 0x76/* v */) ? '\\x0B' :\n        (c === 0x66/* f */) ? '\\x0C' :\n        (c === 0x72/* r */) ? '\\x0D' :\n        (c === 0x65/* e */) ? '\\x1B' :\n        (c === 0x20/* Space */) ? ' ' :\n        (c === 0x22/* \" */) ? '\\x22' :\n        (c === 0x2F/* / */) ? '/' :\n        (c === 0x5C/* \\ */) ? '\\x5C' :\n        (c === 0x4E/* N */) ? '\\x85' :\n        (c === 0x5F/* _ */) ? '\\xA0' :\n        (c === 0x4C/* L */) ? '\\u2028' :\n        (c === 0x50/* P */) ? '\\u2029' : '';\n}\n\nfunction charFromCodepoint(c) {\n  if (c <= 0xFFFF) {\n    return String.fromCharCode(c);\n  }\n  // Encode UTF-16 surrogate pair\n  // https://en.wikipedia.org/wiki/UTF-16#Code_points_U.2B010000_to_U.2B10FFFF\n  return String.fromCharCode(\n    ((c - 0x010000) >> 10) + 0xD800,\n    ((c - 0x010000) & 0x03FF) + 0xDC00\n  );\n}\n\nvar simpleEscapeCheck = new Array(256); // integer, for fast access\nvar simpleEscapeMap = new Array(256);\nfor (var i = 0; i < 256; i++) {\n  simpleEscapeCheck[i] = simpleEscapeSequence(i) ? 1 : 0;\n  simpleEscapeMap[i] = simpleEscapeSequence(i);\n}\n\n\nfunction State$1(input, options) {\n  this.input = input;\n\n  this.filename  = options['filename']  || null;\n  this.schema    = options['schema']    || _default;\n  this.onWarning = options['onWarning'] || null;\n  // (Hidden) Remove? makes the loader to expect YAML 1.1 documents\n  // if such documents have no explicit %YAML directive\n  this.legacy    = options['legacy']    || false;\n\n  this.json      = options['json']      || false;\n  this.listener  = options['listener']  || null;\n\n  this.implicitTypes = this.schema.compiledImplicit;\n  this.typeMap       = this.schema.compiledTypeMap;\n\n  this.length     = input.length;\n  this.position   = 0;\n  this.line       = 0;\n  this.lineStart  = 0;\n  this.lineIndent = 0;\n\n  // position of first leading tab in the current line,\n  // used to make sure there are no tabs in the indentation\n  this.firstTabInLine = -1;\n\n  this.documents = [];\n\n  /*\n  this.version;\n  this.checkLineBreaks;\n  this.tagMap;\n  this.anchorMap;\n  this.tag;\n  this.anchor;\n  this.kind;\n  this.result;*/\n\n}\n\n\nfunction generateError(state, message) {\n  var mark = {\n    name:     state.filename,\n    buffer:   state.input.slice(0, -1), // omit trailing \\0\n    position: state.position,\n    line:     state.line,\n    column:   state.position - state.lineStart\n  };\n\n  mark.snippet = snippet(mark);\n\n  return new exception(message, mark);\n}\n\nfunction throwError(state, message) {\n  throw generateError(state, message);\n}\n\nfunction throwWarning(state, message) {\n  if (state.onWarning) {\n    state.onWarning.call(null, generateError(state, message));\n  }\n}\n\n\nvar directiveHandlers = {\n\n  YAML: function handleYamlDirective(state, name, args) {\n\n    var match, major, minor;\n\n    if (state.version !== null) {\n      throwError(state, 'duplication of %YAML directive');\n    }\n\n    if (args.length !== 1) {\n      throwError(state, 'YAML directive accepts exactly one argument');\n    }\n\n    match = /^([0-9]+)\\.([0-9]+)$/.exec(args[0]);\n\n    if (match === null) {\n      throwError(state, 'ill-formed argument of the YAML directive');\n    }\n\n    major = parseInt(match[1], 10);\n    minor = parseInt(match[2], 10);\n\n    if (major !== 1) {\n      throwError(state, 'unacceptable YAML version of the document');\n    }\n\n    state.version = args[0];\n    state.checkLineBreaks = (minor < 2);\n\n    if (minor !== 1 && minor !== 2) {\n      throwWarning(state, 'unsupported YAML version of the document');\n    }\n  },\n\n  TAG: function handleTagDirective(state, name, args) {\n\n    var handle, prefix;\n\n    if (args.length !== 2) {\n      throwError(state, 'TAG directive accepts exactly two arguments');\n    }\n\n    handle = args[0];\n    prefix = args[1];\n\n    if (!PATTERN_TAG_HANDLE.test(handle)) {\n      throwError(state, 'ill-formed tag handle (first argument) of the TAG directive');\n    }\n\n    if (_hasOwnProperty$1.call(state.tagMap, handle)) {\n      throwError(state, 'there is a previously declared suffix for \"' + handle + '\" tag handle');\n    }\n\n    if (!PATTERN_TAG_URI.test(prefix)) {\n      throwError(state, 'ill-formed tag prefix (second argument) of the TAG directive');\n    }\n\n    try {\n      prefix = decodeURIComponent(prefix);\n    } catch (err) {\n      throwError(state, 'tag prefix is malformed: ' + prefix);\n    }\n\n    state.tagMap[handle] = prefix;\n  }\n};\n\n\nfunction captureSegment(state, start, end, checkJson) {\n  var _position, _length, _character, _result;\n\n  if (start < end) {\n    _result = state.input.slice(start, end);\n\n    if (checkJson) {\n      for (_position = 0, _length = _result.length; _position < _length; _position += 1) {\n        _character = _result.charCodeAt(_position);\n        if (!(_character === 0x09 ||\n              (0x20 <= _character && _character <= 0x10FFFF))) {\n          throwError(state, 'expected valid JSON character');\n        }\n      }\n    } else if (PATTERN_NON_PRINTABLE.test(_result)) {\n      throwError(state, 'the stream contains non-printable characters');\n    }\n\n    state.result += _result;\n  }\n}\n\nfunction mergeMappings(state, destination, source, overridableKeys) {\n  var sourceKeys, key, index, quantity;\n\n  if (!common.isObject(source)) {\n    throwError(state, 'cannot merge mappings; the provided source object is unacceptable');\n  }\n\n  sourceKeys = Object.keys(source);\n\n  for (index = 0, quantity = sourceKeys.length; index < quantity; index += 1) {\n    key = sourceKeys[index];\n\n    if (!_hasOwnProperty$1.call(destination, key)) {\n      destination[key] = source[key];\n      overridableKeys[key] = true;\n    }\n  }\n}\n\nfunction storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, valueNode,\n  startLine, startLineStart, startPos) {\n\n  var index, quantity;\n\n  // The output is a plain object here, so keys can only be strings.\n  // We need to convert keyNode to a string, but doing so can hang the process\n  // (deeply nested arrays that explode exponentially using aliases).\n  if (Array.isArray(keyNode)) {\n    keyNode = Array.prototype.slice.call(keyNode);\n\n    for (index = 0, quantity = keyNode.length; index < quantity; index += 1) {\n      if (Array.isArray(keyNode[index])) {\n        throwError(state, 'nested arrays are not supported inside keys');\n      }\n\n      if (typeof keyNode === 'object' && _class(keyNode[index]) === '[object Object]') {\n        keyNode[index] = '[object Object]';\n      }\n    }\n  }\n\n  // Avoid code execution in load() via toString property\n  // (still use its own toString for arrays, timestamps,\n  // and whatever user schema extensions happen to have @@toStringTag)\n  if (typeof keyNode === 'object' && _class(keyNode) === '[object Object]') {\n    keyNode = '[object Object]';\n  }\n\n\n  keyNode = String(keyNode);\n\n  if (_result === null) {\n    _result = {};\n  }\n\n  if (keyTag === 'tag:yaml.org,2002:merge') {\n    if (Array.isArray(valueNode)) {\n      for (index = 0, quantity = valueNode.length; index < quantity; index += 1) {\n        mergeMappings(state, _result, valueNode[index], overridableKeys);\n      }\n    } else {\n      mergeMappings(state, _result, valueNode, overridableKeys);\n    }\n  } else {\n    if (!state.json &&\n        !_hasOwnProperty$1.call(overridableKeys, keyNode) &&\n        _hasOwnProperty$1.call(_result, keyNode)) {\n      state.line = startLine || state.line;\n      state.lineStart = startLineStart || state.lineStart;\n      state.position = startPos || state.position;\n      throwError(state, 'duplicated mapping key');\n    }\n\n    // used for this specific key only because Object.defineProperty is slow\n    if (keyNode === '__proto__') {\n      Object.defineProperty(_result, keyNode, {\n        configurable: true,\n        enumerable: true,\n        writable: true,\n        value: valueNode\n      });\n    } else {\n      _result[keyNode] = valueNode;\n    }\n    delete overridableKeys[keyNode];\n  }\n\n  return _result;\n}\n\nfunction readLineBreak(state) {\n  var ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch === 0x0A/* LF */) {\n    state.position++;\n  } else if (ch === 0x0D/* CR */) {\n    state.position++;\n    if (state.input.charCodeAt(state.position) === 0x0A/* LF */) {\n      state.position++;\n    }\n  } else {\n    throwError(state, 'a line break is expected');\n  }\n\n  state.line += 1;\n  state.lineStart = state.position;\n  state.firstTabInLine = -1;\n}\n\nfunction skipSeparationSpace(state, allowComments, checkIndent) {\n  var lineBreaks = 0,\n      ch = state.input.charCodeAt(state.position);\n\n  while (ch !== 0) {\n    while (is_WHITE_SPACE(ch)) {\n      if (ch === 0x09/* Tab */ && state.firstTabInLine === -1) {\n        state.firstTabInLine = state.position;\n      }\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    if (allowComments && ch === 0x23/* # */) {\n      do {\n        ch = state.input.charCodeAt(++state.position);\n      } while (ch !== 0x0A/* LF */ && ch !== 0x0D/* CR */ && ch !== 0);\n    }\n\n    if (is_EOL(ch)) {\n      readLineBreak(state);\n\n      ch = state.input.charCodeAt(state.position);\n      lineBreaks++;\n      state.lineIndent = 0;\n\n      while (ch === 0x20/* Space */) {\n        state.lineIndent++;\n        ch = state.input.charCodeAt(++state.position);\n      }\n    } else {\n      break;\n    }\n  }\n\n  if (checkIndent !== -1 && lineBreaks !== 0 && state.lineIndent < checkIndent) {\n    throwWarning(state, 'deficient indentation');\n  }\n\n  return lineBreaks;\n}\n\nfunction testDocumentSeparator(state) {\n  var _position = state.position,\n      ch;\n\n  ch = state.input.charCodeAt(_position);\n\n  // Condition state.position === state.lineStart is tested\n  // in parent on each call, for efficiency. No needs to test here again.\n  if ((ch === 0x2D/* - */ || ch === 0x2E/* . */) &&\n      ch === state.input.charCodeAt(_position + 1) &&\n      ch === state.input.charCodeAt(_position + 2)) {\n\n    _position += 3;\n\n    ch = state.input.charCodeAt(_position);\n\n    if (ch === 0 || is_WS_OR_EOL(ch)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction writeFoldedLines(state, count) {\n  if (count === 1) {\n    state.result += ' ';\n  } else if (count > 1) {\n    state.result += common.repeat('\\n', count - 1);\n  }\n}\n\n\nfunction readPlainScalar(state, nodeIndent, withinFlowCollection) {\n  var preceding,\n      following,\n      captureStart,\n      captureEnd,\n      hasPendingContent,\n      _line,\n      _lineStart,\n      _lineIndent,\n      _kind = state.kind,\n      _result = state.result,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (is_WS_OR_EOL(ch)      ||\n      is_FLOW_INDICATOR(ch) ||\n      ch === 0x23/* # */    ||\n      ch === 0x26/* & */    ||\n      ch === 0x2A/* * */    ||\n      ch === 0x21/* ! */    ||\n      ch === 0x7C/* | */    ||\n      ch === 0x3E/* > */    ||\n      ch === 0x27/* ' */    ||\n      ch === 0x22/* \" */    ||\n      ch === 0x25/* % */    ||\n      ch === 0x40/* @ */    ||\n      ch === 0x60/* ` */) {\n    return false;\n  }\n\n  if (ch === 0x3F/* ? */ || ch === 0x2D/* - */) {\n    following = state.input.charCodeAt(state.position + 1);\n\n    if (is_WS_OR_EOL(following) ||\n        withinFlowCollection && is_FLOW_INDICATOR(following)) {\n      return false;\n    }\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n  captureStart = captureEnd = state.position;\n  hasPendingContent = false;\n\n  while (ch !== 0) {\n    if (ch === 0x3A/* : */) {\n      following = state.input.charCodeAt(state.position + 1);\n\n      if (is_WS_OR_EOL(following) ||\n          withinFlowCollection && is_FLOW_INDICATOR(following)) {\n        break;\n      }\n\n    } else if (ch === 0x23/* # */) {\n      preceding = state.input.charCodeAt(state.position - 1);\n\n      if (is_WS_OR_EOL(preceding)) {\n        break;\n      }\n\n    } else if ((state.position === state.lineStart && testDocumentSeparator(state)) ||\n               withinFlowCollection && is_FLOW_INDICATOR(ch)) {\n      break;\n\n    } else if (is_EOL(ch)) {\n      _line = state.line;\n      _lineStart = state.lineStart;\n      _lineIndent = state.lineIndent;\n      skipSeparationSpace(state, false, -1);\n\n      if (state.lineIndent >= nodeIndent) {\n        hasPendingContent = true;\n        ch = state.input.charCodeAt(state.position);\n        continue;\n      } else {\n        state.position = captureEnd;\n        state.line = _line;\n        state.lineStart = _lineStart;\n        state.lineIndent = _lineIndent;\n        break;\n      }\n    }\n\n    if (hasPendingContent) {\n      captureSegment(state, captureStart, captureEnd, false);\n      writeFoldedLines(state, state.line - _line);\n      captureStart = captureEnd = state.position;\n      hasPendingContent = false;\n    }\n\n    if (!is_WHITE_SPACE(ch)) {\n      captureEnd = state.position + 1;\n    }\n\n    ch = state.input.charCodeAt(++state.position);\n  }\n\n  captureSegment(state, captureStart, captureEnd, false);\n\n  if (state.result) {\n    return true;\n  }\n\n  state.kind = _kind;\n  state.result = _result;\n  return false;\n}\n\nfunction readSingleQuotedScalar(state, nodeIndent) {\n  var ch,\n      captureStart, captureEnd;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x27/* ' */) {\n    return false;\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n  state.position++;\n  captureStart = captureEnd = state.position;\n\n  while ((ch = state.input.charCodeAt(state.position)) !== 0) {\n    if (ch === 0x27/* ' */) {\n      captureSegment(state, captureStart, state.position, true);\n      ch = state.input.charCodeAt(++state.position);\n\n      if (ch === 0x27/* ' */) {\n        captureStart = state.position;\n        state.position++;\n        captureEnd = state.position;\n      } else {\n        return true;\n      }\n\n    } else if (is_EOL(ch)) {\n      captureSegment(state, captureStart, captureEnd, true);\n      writeFoldedLines(state, skipSeparationSpace(state, false, nodeIndent));\n      captureStart = captureEnd = state.position;\n\n    } else if (state.position === state.lineStart && testDocumentSeparator(state)) {\n      throwError(state, 'unexpected end of the document within a single quoted scalar');\n\n    } else {\n      state.position++;\n      captureEnd = state.position;\n    }\n  }\n\n  throwError(state, 'unexpected end of the stream within a single quoted scalar');\n}\n\nfunction readDoubleQuotedScalar(state, nodeIndent) {\n  var captureStart,\n      captureEnd,\n      hexLength,\n      hexResult,\n      tmp,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x22/* \" */) {\n    return false;\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n  state.position++;\n  captureStart = captureEnd = state.position;\n\n  while ((ch = state.input.charCodeAt(state.position)) !== 0) {\n    if (ch === 0x22/* \" */) {\n      captureSegment(state, captureStart, state.position, true);\n      state.position++;\n      return true;\n\n    } else if (ch === 0x5C/* \\ */) {\n      captureSegment(state, captureStart, state.position, true);\n      ch = state.input.charCodeAt(++state.position);\n\n      if (is_EOL(ch)) {\n        skipSeparationSpace(state, false, nodeIndent);\n\n        // TODO: rework to inline fn with no type cast?\n      } else if (ch < 256 && simpleEscapeCheck[ch]) {\n        state.result += simpleEscapeMap[ch];\n        state.position++;\n\n      } else if ((tmp = escapedHexLen(ch)) > 0) {\n        hexLength = tmp;\n        hexResult = 0;\n\n        for (; hexLength > 0; hexLength--) {\n          ch = state.input.charCodeAt(++state.position);\n\n          if ((tmp = fromHexCode(ch)) >= 0) {\n            hexResult = (hexResult << 4) + tmp;\n\n          } else {\n            throwError(state, 'expected hexadecimal character');\n          }\n        }\n\n        state.result += charFromCodepoint(hexResult);\n\n        state.position++;\n\n      } else {\n        throwError(state, 'unknown escape sequence');\n      }\n\n      captureStart = captureEnd = state.position;\n\n    } else if (is_EOL(ch)) {\n      captureSegment(state, captureStart, captureEnd, true);\n      writeFoldedLines(state, skipSeparationSpace(state, false, nodeIndent));\n      captureStart = captureEnd = state.position;\n\n    } else if (state.position === state.lineStart && testDocumentSeparator(state)) {\n      throwError(state, 'unexpected end of the document within a double quoted scalar');\n\n    } else {\n      state.position++;\n      captureEnd = state.position;\n    }\n  }\n\n  throwError(state, 'unexpected end of the stream within a double quoted scalar');\n}\n\nfunction readFlowCollection(state, nodeIndent) {\n  var readNext = true,\n      _line,\n      _lineStart,\n      _pos,\n      _tag     = state.tag,\n      _result,\n      _anchor  = state.anchor,\n      following,\n      terminator,\n      isPair,\n      isExplicitPair,\n      isMapping,\n      overridableKeys = Object.create(null),\n      keyNode,\n      keyTag,\n      valueNode,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch === 0x5B/* [ */) {\n    terminator = 0x5D;/* ] */\n    isMapping = false;\n    _result = [];\n  } else if (ch === 0x7B/* { */) {\n    terminator = 0x7D;/* } */\n    isMapping = true;\n    _result = {};\n  } else {\n    return false;\n  }\n\n  if (state.anchor !== null) {\n    state.anchorMap[state.anchor] = _result;\n  }\n\n  ch = state.input.charCodeAt(++state.position);\n\n  while (ch !== 0) {\n    skipSeparationSpace(state, true, nodeIndent);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if (ch === terminator) {\n      state.position++;\n      state.tag = _tag;\n      state.anchor = _anchor;\n      state.kind = isMapping ? 'mapping' : 'sequence';\n      state.result = _result;\n      return true;\n    } else if (!readNext) {\n      throwError(state, 'missed comma between flow collection entries');\n    } else if (ch === 0x2C/* , */) {\n      // \"flow collection entries can never be completely empty\", as per YAML 1.2, section 7.4\n      throwError(state, \"expected the node content, but found ','\");\n    }\n\n    keyTag = keyNode = valueNode = null;\n    isPair = isExplicitPair = false;\n\n    if (ch === 0x3F/* ? */) {\n      following = state.input.charCodeAt(state.position + 1);\n\n      if (is_WS_OR_EOL(following)) {\n        isPair = isExplicitPair = true;\n        state.position++;\n        skipSeparationSpace(state, true, nodeIndent);\n      }\n    }\n\n    _line = state.line; // Save the current line.\n    _lineStart = state.lineStart;\n    _pos = state.position;\n    composeNode(state, nodeIndent, CONTEXT_FLOW_IN, false, true);\n    keyTag = state.tag;\n    keyNode = state.result;\n    skipSeparationSpace(state, true, nodeIndent);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if ((isExplicitPair || state.line === _line) && ch === 0x3A/* : */) {\n      isPair = true;\n      ch = state.input.charCodeAt(++state.position);\n      skipSeparationSpace(state, true, nodeIndent);\n      composeNode(state, nodeIndent, CONTEXT_FLOW_IN, false, true);\n      valueNode = state.result;\n    }\n\n    if (isMapping) {\n      storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, valueNode, _line, _lineStart, _pos);\n    } else if (isPair) {\n      _result.push(storeMappingPair(state, null, overridableKeys, keyTag, keyNode, valueNode, _line, _lineStart, _pos));\n    } else {\n      _result.push(keyNode);\n    }\n\n    skipSeparationSpace(state, true, nodeIndent);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if (ch === 0x2C/* , */) {\n      readNext = true;\n      ch = state.input.charCodeAt(++state.position);\n    } else {\n      readNext = false;\n    }\n  }\n\n  throwError(state, 'unexpected end of the stream within a flow collection');\n}\n\nfunction readBlockScalar(state, nodeIndent) {\n  var captureStart,\n      folding,\n      chomping       = CHOMPING_CLIP,\n      didReadContent = false,\n      detectedIndent = false,\n      textIndent     = nodeIndent,\n      emptyLines     = 0,\n      atMoreIndented = false,\n      tmp,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch === 0x7C/* | */) {\n    folding = false;\n  } else if (ch === 0x3E/* > */) {\n    folding = true;\n  } else {\n    return false;\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n\n  while (ch !== 0) {\n    ch = state.input.charCodeAt(++state.position);\n\n    if (ch === 0x2B/* + */ || ch === 0x2D/* - */) {\n      if (CHOMPING_CLIP === chomping) {\n        chomping = (ch === 0x2B/* + */) ? CHOMPING_KEEP : CHOMPING_STRIP;\n      } else {\n        throwError(state, 'repeat of a chomping mode identifier');\n      }\n\n    } else if ((tmp = fromDecimalCode(ch)) >= 0) {\n      if (tmp === 0) {\n        throwError(state, 'bad explicit indentation width of a block scalar; it cannot be less than one');\n      } else if (!detectedIndent) {\n        textIndent = nodeIndent + tmp - 1;\n        detectedIndent = true;\n      } else {\n        throwError(state, 'repeat of an indentation width identifier');\n      }\n\n    } else {\n      break;\n    }\n  }\n\n  if (is_WHITE_SPACE(ch)) {\n    do { ch = state.input.charCodeAt(++state.position); }\n    while (is_WHITE_SPACE(ch));\n\n    if (ch === 0x23/* # */) {\n      do { ch = state.input.charCodeAt(++state.position); }\n      while (!is_EOL(ch) && (ch !== 0));\n    }\n  }\n\n  while (ch !== 0) {\n    readLineBreak(state);\n    state.lineIndent = 0;\n\n    ch = state.input.charCodeAt(state.position);\n\n    while ((!detectedIndent || state.lineIndent < textIndent) &&\n           (ch === 0x20/* Space */)) {\n      state.lineIndent++;\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    if (!detectedIndent && state.lineIndent > textIndent) {\n      textIndent = state.lineIndent;\n    }\n\n    if (is_EOL(ch)) {\n      emptyLines++;\n      continue;\n    }\n\n    // End of the scalar.\n    if (state.lineIndent < textIndent) {\n\n      // Perform the chomping.\n      if (chomping === CHOMPING_KEEP) {\n        state.result += common.repeat('\\n', didReadContent ? 1 + emptyLines : emptyLines);\n      } else if (chomping === CHOMPING_CLIP) {\n        if (didReadContent) { // i.e. only if the scalar is not empty.\n          state.result += '\\n';\n        }\n      }\n\n      // Break this `while` cycle and go to the funciton's epilogue.\n      break;\n    }\n\n    // Folded style: use fancy rules to handle line breaks.\n    if (folding) {\n\n      // Lines starting with white space characters (more-indented lines) are not folded.\n      if (is_WHITE_SPACE(ch)) {\n        atMoreIndented = true;\n        // except for the first content line (cf. Example 8.1)\n        state.result += common.repeat('\\n', didReadContent ? 1 + emptyLines : emptyLines);\n\n      // End of more-indented block.\n      } else if (atMoreIndented) {\n        atMoreIndented = false;\n        state.result += common.repeat('\\n', emptyLines + 1);\n\n      // Just one line break - perceive as the same line.\n      } else if (emptyLines === 0) {\n        if (didReadContent) { // i.e. only if we have already read some scalar content.\n          state.result += ' ';\n        }\n\n      // Several line breaks - perceive as different lines.\n      } else {\n        state.result += common.repeat('\\n', emptyLines);\n      }\n\n    // Literal style: just add exact number of line breaks between content lines.\n    } else {\n      // Keep all line breaks except the header line break.\n      state.result += common.repeat('\\n', didReadContent ? 1 + emptyLines : emptyLines);\n    }\n\n    didReadContent = true;\n    detectedIndent = true;\n    emptyLines = 0;\n    captureStart = state.position;\n\n    while (!is_EOL(ch) && (ch !== 0)) {\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    captureSegment(state, captureStart, state.position, false);\n  }\n\n  return true;\n}\n\nfunction readBlockSequence(state, nodeIndent) {\n  var _line,\n      _tag      = state.tag,\n      _anchor   = state.anchor,\n      _result   = [],\n      following,\n      detected  = false,\n      ch;\n\n  // there is a leading tab before this token, so it can't be a block sequence/mapping;\n  // it can still be flow sequence/mapping or a scalar\n  if (state.firstTabInLine !== -1) return false;\n\n  if (state.anchor !== null) {\n    state.anchorMap[state.anchor] = _result;\n  }\n\n  ch = state.input.charCodeAt(state.position);\n\n  while (ch !== 0) {\n    if (state.firstTabInLine !== -1) {\n      state.position = state.firstTabInLine;\n      throwError(state, 'tab characters must not be used in indentation');\n    }\n\n    if (ch !== 0x2D/* - */) {\n      break;\n    }\n\n    following = state.input.charCodeAt(state.position + 1);\n\n    if (!is_WS_OR_EOL(following)) {\n      break;\n    }\n\n    detected = true;\n    state.position++;\n\n    if (skipSeparationSpace(state, true, -1)) {\n      if (state.lineIndent <= nodeIndent) {\n        _result.push(null);\n        ch = state.input.charCodeAt(state.position);\n        continue;\n      }\n    }\n\n    _line = state.line;\n    composeNode(state, nodeIndent, CONTEXT_BLOCK_IN, false, true);\n    _result.push(state.result);\n    skipSeparationSpace(state, true, -1);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if ((state.line === _line || state.lineIndent > nodeIndent) && (ch !== 0)) {\n      throwError(state, 'bad indentation of a sequence entry');\n    } else if (state.lineIndent < nodeIndent) {\n      break;\n    }\n  }\n\n  if (detected) {\n    state.tag = _tag;\n    state.anchor = _anchor;\n    state.kind = 'sequence';\n    state.result = _result;\n    return true;\n  }\n  return false;\n}\n\nfunction readBlockMapping(state, nodeIndent, flowIndent) {\n  var following,\n      allowCompact,\n      _line,\n      _keyLine,\n      _keyLineStart,\n      _keyPos,\n      _tag          = state.tag,\n      _anchor       = state.anchor,\n      _result       = {},\n      overridableKeys = Object.create(null),\n      keyTag        = null,\n      keyNode       = null,\n      valueNode     = null,\n      atExplicitKey = false,\n      detected      = false,\n      ch;\n\n  // there is a leading tab before this token, so it can't be a block sequence/mapping;\n  // it can still be flow sequence/mapping or a scalar\n  if (state.firstTabInLine !== -1) return false;\n\n  if (state.anchor !== null) {\n    state.anchorMap[state.anchor] = _result;\n  }\n\n  ch = state.input.charCodeAt(state.position);\n\n  while (ch !== 0) {\n    if (!atExplicitKey && state.firstTabInLine !== -1) {\n      state.position = state.firstTabInLine;\n      throwError(state, 'tab characters must not be used in indentation');\n    }\n\n    following = state.input.charCodeAt(state.position + 1);\n    _line = state.line; // Save the current line.\n\n    //\n    // Explicit notation case. There are two separate blocks:\n    // first for the key (denoted by \"?\") and second for the value (denoted by \":\")\n    //\n    if ((ch === 0x3F/* ? */ || ch === 0x3A/* : */) && is_WS_OR_EOL(following)) {\n\n      if (ch === 0x3F/* ? */) {\n        if (atExplicitKey) {\n          storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, null, _keyLine, _keyLineStart, _keyPos);\n          keyTag = keyNode = valueNode = null;\n        }\n\n        detected = true;\n        atExplicitKey = true;\n        allowCompact = true;\n\n      } else if (atExplicitKey) {\n        // i.e. 0x3A/* : */ === character after the explicit key.\n        atExplicitKey = false;\n        allowCompact = true;\n\n      } else {\n        throwError(state, 'incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line');\n      }\n\n      state.position += 1;\n      ch = following;\n\n    //\n    // Implicit notation case. Flow-style node as the key first, then \":\", and the value.\n    //\n    } else {\n      _keyLine = state.line;\n      _keyLineStart = state.lineStart;\n      _keyPos = state.position;\n\n      if (!composeNode(state, flowIndent, CONTEXT_FLOW_OUT, false, true)) {\n        // Neither implicit nor explicit notation.\n        // Reading is done. Go to the epilogue.\n        break;\n      }\n\n      if (state.line === _line) {\n        ch = state.input.charCodeAt(state.position);\n\n        while (is_WHITE_SPACE(ch)) {\n          ch = state.input.charCodeAt(++state.position);\n        }\n\n        if (ch === 0x3A/* : */) {\n          ch = state.input.charCodeAt(++state.position);\n\n          if (!is_WS_OR_EOL(ch)) {\n            throwError(state, 'a whitespace character is expected after the key-value separator within a block mapping');\n          }\n\n          if (atExplicitKey) {\n            storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, null, _keyLine, _keyLineStart, _keyPos);\n            keyTag = keyNode = valueNode = null;\n          }\n\n          detected = true;\n          atExplicitKey = false;\n          allowCompact = false;\n          keyTag = state.tag;\n          keyNode = state.result;\n\n        } else if (detected) {\n          throwError(state, 'can not read an implicit mapping pair; a colon is missed');\n\n        } else {\n          state.tag = _tag;\n          state.anchor = _anchor;\n          return true; // Keep the result of `composeNode`.\n        }\n\n      } else if (detected) {\n        throwError(state, 'can not read a block mapping entry; a multiline key may not be an implicit key');\n\n      } else {\n        state.tag = _tag;\n        state.anchor = _anchor;\n        return true; // Keep the result of `composeNode`.\n      }\n    }\n\n    //\n    // Common reading code for both explicit and implicit notations.\n    //\n    if (state.line === _line || state.lineIndent > nodeIndent) {\n      if (atExplicitKey) {\n        _keyLine = state.line;\n        _keyLineStart = state.lineStart;\n        _keyPos = state.position;\n      }\n\n      if (composeNode(state, nodeIndent, CONTEXT_BLOCK_OUT, true, allowCompact)) {\n        if (atExplicitKey) {\n          keyNode = state.result;\n        } else {\n          valueNode = state.result;\n        }\n      }\n\n      if (!atExplicitKey) {\n        storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, valueNode, _keyLine, _keyLineStart, _keyPos);\n        keyTag = keyNode = valueNode = null;\n      }\n\n      skipSeparationSpace(state, true, -1);\n      ch = state.input.charCodeAt(state.position);\n    }\n\n    if ((state.line === _line || state.lineIndent > nodeIndent) && (ch !== 0)) {\n      throwError(state, 'bad indentation of a mapping entry');\n    } else if (state.lineIndent < nodeIndent) {\n      break;\n    }\n  }\n\n  //\n  // Epilogue.\n  //\n\n  // Special case: last mapping's node contains only the key in explicit notation.\n  if (atExplicitKey) {\n    storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, null, _keyLine, _keyLineStart, _keyPos);\n  }\n\n  // Expose the resulting mapping.\n  if (detected) {\n    state.tag = _tag;\n    state.anchor = _anchor;\n    state.kind = 'mapping';\n    state.result = _result;\n  }\n\n  return detected;\n}\n\nfunction readTagProperty(state) {\n  var _position,\n      isVerbatim = false,\n      isNamed    = false,\n      tagHandle,\n      tagName,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x21/* ! */) return false;\n\n  if (state.tag !== null) {\n    throwError(state, 'duplication of a tag property');\n  }\n\n  ch = state.input.charCodeAt(++state.position);\n\n  if (ch === 0x3C/* < */) {\n    isVerbatim = true;\n    ch = state.input.charCodeAt(++state.position);\n\n  } else if (ch === 0x21/* ! */) {\n    isNamed = true;\n    tagHandle = '!!';\n    ch = state.input.charCodeAt(++state.position);\n\n  } else {\n    tagHandle = '!';\n  }\n\n  _position = state.position;\n\n  if (isVerbatim) {\n    do { ch = state.input.charCodeAt(++state.position); }\n    while (ch !== 0 && ch !== 0x3E/* > */);\n\n    if (state.position < state.length) {\n      tagName = state.input.slice(_position, state.position);\n      ch = state.input.charCodeAt(++state.position);\n    } else {\n      throwError(state, 'unexpected end of the stream within a verbatim tag');\n    }\n  } else {\n    while (ch !== 0 && !is_WS_OR_EOL(ch)) {\n\n      if (ch === 0x21/* ! */) {\n        if (!isNamed) {\n          tagHandle = state.input.slice(_position - 1, state.position + 1);\n\n          if (!PATTERN_TAG_HANDLE.test(tagHandle)) {\n            throwError(state, 'named tag handle cannot contain such characters');\n          }\n\n          isNamed = true;\n          _position = state.position + 1;\n        } else {\n          throwError(state, 'tag suffix cannot contain exclamation marks');\n        }\n      }\n\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    tagName = state.input.slice(_position, state.position);\n\n    if (PATTERN_FLOW_INDICATORS.test(tagName)) {\n      throwError(state, 'tag suffix cannot contain flow indicator characters');\n    }\n  }\n\n  if (tagName && !PATTERN_TAG_URI.test(tagName)) {\n    throwError(state, 'tag name cannot contain such characters: ' + tagName);\n  }\n\n  try {\n    tagName = decodeURIComponent(tagName);\n  } catch (err) {\n    throwError(state, 'tag name is malformed: ' + tagName);\n  }\n\n  if (isVerbatim) {\n    state.tag = tagName;\n\n  } else if (_hasOwnProperty$1.call(state.tagMap, tagHandle)) {\n    state.tag = state.tagMap[tagHandle] + tagName;\n\n  } else if (tagHandle === '!') {\n    state.tag = '!' + tagName;\n\n  } else if (tagHandle === '!!') {\n    state.tag = 'tag:yaml.org,2002:' + tagName;\n\n  } else {\n    throwError(state, 'undeclared tag handle \"' + tagHandle + '\"');\n  }\n\n  return true;\n}\n\nfunction readAnchorProperty(state) {\n  var _position,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x26/* & */) return false;\n\n  if (state.anchor !== null) {\n    throwError(state, 'duplication of an anchor property');\n  }\n\n  ch = state.input.charCodeAt(++state.position);\n  _position = state.position;\n\n  while (ch !== 0 && !is_WS_OR_EOL(ch) && !is_FLOW_INDICATOR(ch)) {\n    ch = state.input.charCodeAt(++state.position);\n  }\n\n  if (state.position === _position) {\n    throwError(state, 'name of an anchor node must contain at least one character');\n  }\n\n  state.anchor = state.input.slice(_position, state.position);\n  return true;\n}\n\nfunction readAlias(state) {\n  var _position, alias,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x2A/* * */) return false;\n\n  ch = state.input.charCodeAt(++state.position);\n  _position = state.position;\n\n  while (ch !== 0 && !is_WS_OR_EOL(ch) && !is_FLOW_INDICATOR(ch)) {\n    ch = state.input.charCodeAt(++state.position);\n  }\n\n  if (state.position === _position) {\n    throwError(state, 'name of an alias node must contain at least one character');\n  }\n\n  alias = state.input.slice(_position, state.position);\n\n  if (!_hasOwnProperty$1.call(state.anchorMap, alias)) {\n    throwError(state, 'unidentified alias \"' + alias + '\"');\n  }\n\n  state.result = state.anchorMap[alias];\n  skipSeparationSpace(state, true, -1);\n  return true;\n}\n\nfunction composeNode(state, parentIndent, nodeContext, allowToSeek, allowCompact) {\n  var allowBlockStyles,\n      allowBlockScalars,\n      allowBlockCollections,\n      indentStatus = 1, // 1: this>parent, 0: this=parent, -1: this<parent\n      atNewLine  = false,\n      hasContent = false,\n      typeIndex,\n      typeQuantity,\n      typeList,\n      type,\n      flowIndent,\n      blockIndent;\n\n  if (state.listener !== null) {\n    state.listener('open', state);\n  }\n\n  state.tag    = null;\n  state.anchor = null;\n  state.kind   = null;\n  state.result = null;\n\n  allowBlockStyles = allowBlockScalars = allowBlockCollections =\n    CONTEXT_BLOCK_OUT === nodeContext ||\n    CONTEXT_BLOCK_IN  === nodeContext;\n\n  if (allowToSeek) {\n    if (skipSeparationSpace(state, true, -1)) {\n      atNewLine = true;\n\n      if (state.lineIndent > parentIndent) {\n        indentStatus = 1;\n      } else if (state.lineIndent === parentIndent) {\n        indentStatus = 0;\n      } else if (state.lineIndent < parentIndent) {\n        indentStatus = -1;\n      }\n    }\n  }\n\n  if (indentStatus === 1) {\n    while (readTagProperty(state) || readAnchorProperty(state)) {\n      if (skipSeparationSpace(state, true, -1)) {\n        atNewLine = true;\n        allowBlockCollections = allowBlockStyles;\n\n        if (state.lineIndent > parentIndent) {\n          indentStatus = 1;\n        } else if (state.lineIndent === parentIndent) {\n          indentStatus = 0;\n        } else if (state.lineIndent < parentIndent) {\n          indentStatus = -1;\n        }\n      } else {\n        allowBlockCollections = false;\n      }\n    }\n  }\n\n  if (allowBlockCollections) {\n    allowBlockCollections = atNewLine || allowCompact;\n  }\n\n  if (indentStatus === 1 || CONTEXT_BLOCK_OUT === nodeContext) {\n    if (CONTEXT_FLOW_IN === nodeContext || CONTEXT_FLOW_OUT === nodeContext) {\n      flowIndent = parentIndent;\n    } else {\n      flowIndent = parentIndent + 1;\n    }\n\n    blockIndent = state.position - state.lineStart;\n\n    if (indentStatus === 1) {\n      if (allowBlockCollections &&\n          (readBlockSequence(state, blockIndent) ||\n           readBlockMapping(state, blockIndent, flowIndent)) ||\n          readFlowCollection(state, flowIndent)) {\n        hasContent = true;\n      } else {\n        if ((allowBlockScalars && readBlockScalar(state, flowIndent)) ||\n            readSingleQuotedScalar(state, flowIndent) ||\n            readDoubleQuotedScalar(state, flowIndent)) {\n          hasContent = true;\n\n        } else if (readAlias(state)) {\n          hasContent = true;\n\n          if (state.tag !== null || state.anchor !== null) {\n            throwError(state, 'alias node should not have any properties');\n          }\n\n        } else if (readPlainScalar(state, flowIndent, CONTEXT_FLOW_IN === nodeContext)) {\n          hasContent = true;\n\n          if (state.tag === null) {\n            state.tag = '?';\n          }\n        }\n\n        if (state.anchor !== null) {\n          state.anchorMap[state.anchor] = state.result;\n        }\n      }\n    } else if (indentStatus === 0) {\n      // Special case: block sequences are allowed to have same indentation level as the parent.\n      // http://www.yaml.org/spec/1.2/spec.html#id2799784\n      hasContent = allowBlockCollections && readBlockSequence(state, blockIndent);\n    }\n  }\n\n  if (state.tag === null) {\n    if (state.anchor !== null) {\n      state.anchorMap[state.anchor] = state.result;\n    }\n\n  } else if (state.tag === '?') {\n    // Implicit resolving is not allowed for non-scalar types, and '?'\n    // non-specific tag is only automatically assigned to plain scalars.\n    //\n    // We only need to check kind conformity in case user explicitly assigns '?'\n    // tag, for example like this: \"!<?> [0]\"\n    //\n    if (state.result !== null && state.kind !== 'scalar') {\n      throwError(state, 'unacceptable node kind for !<?> tag; it should be \"scalar\", not \"' + state.kind + '\"');\n    }\n\n    for (typeIndex = 0, typeQuantity = state.implicitTypes.length; typeIndex < typeQuantity; typeIndex += 1) {\n      type = state.implicitTypes[typeIndex];\n\n      if (type.resolve(state.result)) { // `state.result` updated in resolver if matched\n        state.result = type.construct(state.result);\n        state.tag = type.tag;\n        if (state.anchor !== null) {\n          state.anchorMap[state.anchor] = state.result;\n        }\n        break;\n      }\n    }\n  } else if (state.tag !== '!') {\n    if (_hasOwnProperty$1.call(state.typeMap[state.kind || 'fallback'], state.tag)) {\n      type = state.typeMap[state.kind || 'fallback'][state.tag];\n    } else {\n      // looking for multi type\n      type = null;\n      typeList = state.typeMap.multi[state.kind || 'fallback'];\n\n      for (typeIndex = 0, typeQuantity = typeList.length; typeIndex < typeQuantity; typeIndex += 1) {\n        if (state.tag.slice(0, typeList[typeIndex].tag.length) === typeList[typeIndex].tag) {\n          type = typeList[typeIndex];\n          break;\n        }\n      }\n    }\n\n    if (!type) {\n      throwError(state, 'unknown tag !<' + state.tag + '>');\n    }\n\n    if (state.result !== null && type.kind !== state.kind) {\n      throwError(state, 'unacceptable node kind for !<' + state.tag + '> tag; it should be \"' + type.kind + '\", not \"' + state.kind + '\"');\n    }\n\n    if (!type.resolve(state.result, state.tag)) { // `state.result` updated in resolver if matched\n      throwError(state, 'cannot resolve a node with !<' + state.tag + '> explicit tag');\n    } else {\n      state.result = type.construct(state.result, state.tag);\n      if (state.anchor !== null) {\n        state.anchorMap[state.anchor] = state.result;\n      }\n    }\n  }\n\n  if (state.listener !== null) {\n    state.listener('close', state);\n  }\n  return state.tag !== null ||  state.anchor !== null || hasContent;\n}\n\nfunction readDocument(state) {\n  var documentStart = state.position,\n      _position,\n      directiveName,\n      directiveArgs,\n      hasDirectives = false,\n      ch;\n\n  state.version = null;\n  state.checkLineBreaks = state.legacy;\n  state.tagMap = Object.create(null);\n  state.anchorMap = Object.create(null);\n\n  while ((ch = state.input.charCodeAt(state.position)) !== 0) {\n    skipSeparationSpace(state, true, -1);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if (state.lineIndent > 0 || ch !== 0x25/* % */) {\n      break;\n    }\n\n    hasDirectives = true;\n    ch = state.input.charCodeAt(++state.position);\n    _position = state.position;\n\n    while (ch !== 0 && !is_WS_OR_EOL(ch)) {\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    directiveName = state.input.slice(_position, state.position);\n    directiveArgs = [];\n\n    if (directiveName.length < 1) {\n      throwError(state, 'directive name must not be less than one character in length');\n    }\n\n    while (ch !== 0) {\n      while (is_WHITE_SPACE(ch)) {\n        ch = state.input.charCodeAt(++state.position);\n      }\n\n      if (ch === 0x23/* # */) {\n        do { ch = state.input.charCodeAt(++state.position); }\n        while (ch !== 0 && !is_EOL(ch));\n        break;\n      }\n\n      if (is_EOL(ch)) break;\n\n      _position = state.position;\n\n      while (ch !== 0 && !is_WS_OR_EOL(ch)) {\n        ch = state.input.charCodeAt(++state.position);\n      }\n\n      directiveArgs.push(state.input.slice(_position, state.position));\n    }\n\n    if (ch !== 0) readLineBreak(state);\n\n    if (_hasOwnProperty$1.call(directiveHandlers, directiveName)) {\n      directiveHandlers[directiveName](state, directiveName, directiveArgs);\n    } else {\n      throwWarning(state, 'unknown document directive \"' + directiveName + '\"');\n    }\n  }\n\n  skipSeparationSpace(state, true, -1);\n\n  if (state.lineIndent === 0 &&\n      state.input.charCodeAt(state.position)     === 0x2D/* - */ &&\n      state.input.charCodeAt(state.position + 1) === 0x2D/* - */ &&\n      state.input.charCodeAt(state.position + 2) === 0x2D/* - */) {\n    state.position += 3;\n    skipSeparationSpace(state, true, -1);\n\n  } else if (hasDirectives) {\n    throwError(state, 'directives end mark is expected');\n  }\n\n  composeNode(state, state.lineIndent - 1, CONTEXT_BLOCK_OUT, false, true);\n  skipSeparationSpace(state, true, -1);\n\n  if (state.checkLineBreaks &&\n      PATTERN_NON_ASCII_LINE_BREAKS.test(state.input.slice(documentStart, state.position))) {\n    throwWarning(state, 'non-ASCII line breaks are interpreted as content');\n  }\n\n  state.documents.push(state.result);\n\n  if (state.position === state.lineStart && testDocumentSeparator(state)) {\n\n    if (state.input.charCodeAt(state.position) === 0x2E/* . */) {\n      state.position += 3;\n      skipSeparationSpace(state, true, -1);\n    }\n    return;\n  }\n\n  if (state.position < (state.length - 1)) {\n    throwError(state, 'end of the stream or a document separator is expected');\n  } else {\n    return;\n  }\n}\n\n\nfunction loadDocuments(input, options) {\n  input = String(input);\n  options = options || {};\n\n  if (input.length !== 0) {\n\n    // Add tailing `\\n` if not exists\n    if (input.charCodeAt(input.length - 1) !== 0x0A/* LF */ &&\n        input.charCodeAt(input.length - 1) !== 0x0D/* CR */) {\n      input += '\\n';\n    }\n\n    // Strip BOM\n    if (input.charCodeAt(0) === 0xFEFF) {\n      input = input.slice(1);\n    }\n  }\n\n  var state = new State$1(input, options);\n\n  var nullpos = input.indexOf('\\0');\n\n  if (nullpos !== -1) {\n    state.position = nullpos;\n    throwError(state, 'null byte is not allowed in input');\n  }\n\n  // Use 0 as string terminator. That significantly simplifies bounds check.\n  state.input += '\\0';\n\n  while (state.input.charCodeAt(state.position) === 0x20/* Space */) {\n    state.lineIndent += 1;\n    state.position += 1;\n  }\n\n  while (state.position < (state.length - 1)) {\n    readDocument(state);\n  }\n\n  return state.documents;\n}\n\n\nfunction loadAll$1(input, iterator, options) {\n  if (iterator !== null && typeof iterator === 'object' && typeof options === 'undefined') {\n    options = iterator;\n    iterator = null;\n  }\n\n  var documents = loadDocuments(input, options);\n\n  if (typeof iterator !== 'function') {\n    return documents;\n  }\n\n  for (var index = 0, length = documents.length; index < length; index += 1) {\n    iterator(documents[index]);\n  }\n}\n\n\nfunction load$1(input, options) {\n  var documents = loadDocuments(input, options);\n\n  if (documents.length === 0) {\n    /*eslint-disable no-undefined*/\n    return undefined;\n  } else if (documents.length === 1) {\n    return documents[0];\n  }\n  throw new exception('expected a single document in the stream, but found more');\n}\n\n\nvar loadAll_1 = loadAll$1;\nvar load_1    = load$1;\n\nvar loader = {\n\tloadAll: loadAll_1,\n\tload: load_1\n};\n\n/*eslint-disable no-use-before-define*/\n\n\n\n\n\nvar _toString       = Object.prototype.toString;\nvar _hasOwnProperty = Object.prototype.hasOwnProperty;\n\nvar CHAR_BOM                  = 0xFEFF;\nvar CHAR_TAB                  = 0x09; /* Tab */\nvar CHAR_LINE_FEED            = 0x0A; /* LF */\nvar CHAR_CARRIAGE_RETURN      = 0x0D; /* CR */\nvar CHAR_SPACE                = 0x20; /* Space */\nvar CHAR_EXCLAMATION          = 0x21; /* ! */\nvar CHAR_DOUBLE_QUOTE         = 0x22; /* \" */\nvar CHAR_SHARP                = 0x23; /* # */\nvar CHAR_PERCENT              = 0x25; /* % */\nvar CHAR_AMPERSAND            = 0x26; /* & */\nvar CHAR_SINGLE_QUOTE         = 0x27; /* ' */\nvar CHAR_ASTERISK             = 0x2A; /* * */\nvar CHAR_COMMA                = 0x2C; /* , */\nvar CHAR_MINUS                = 0x2D; /* - */\nvar CHAR_COLON                = 0x3A; /* : */\nvar CHAR_EQUALS               = 0x3D; /* = */\nvar CHAR_GREATER_THAN         = 0x3E; /* > */\nvar CHAR_QUESTION             = 0x3F; /* ? */\nvar CHAR_COMMERCIAL_AT        = 0x40; /* @ */\nvar CHAR_LEFT_SQUARE_BRACKET  = 0x5B; /* [ */\nvar CHAR_RIGHT_SQUARE_BRACKET = 0x5D; /* ] */\nvar CHAR_GRAVE_ACCENT         = 0x60; /* ` */\nvar CHAR_LEFT_CURLY_BRACKET   = 0x7B; /* { */\nvar CHAR_VERTICAL_LINE        = 0x7C; /* | */\nvar CHAR_RIGHT_CURLY_BRACKET  = 0x7D; /* } */\n\nvar ESCAPE_SEQUENCES = {};\n\nESCAPE_SEQUENCES[0x00]   = '\\\\0';\nESCAPE_SEQUENCES[0x07]   = '\\\\a';\nESCAPE_SEQUENCES[0x08]   = '\\\\b';\nESCAPE_SEQUENCES[0x09]   = '\\\\t';\nESCAPE_SEQUENCES[0x0A]   = '\\\\n';\nESCAPE_SEQUENCES[0x0B]   = '\\\\v';\nESCAPE_SEQUENCES[0x0C]   = '\\\\f';\nESCAPE_SEQUENCES[0x0D]   = '\\\\r';\nESCAPE_SEQUENCES[0x1B]   = '\\\\e';\nESCAPE_SEQUENCES[0x22]   = '\\\\\"';\nESCAPE_SEQUENCES[0x5C]   = '\\\\\\\\';\nESCAPE_SEQUENCES[0x85]   = '\\\\N';\nESCAPE_SEQUENCES[0xA0]   = '\\\\_';\nESCAPE_SEQUENCES[0x2028] = '\\\\L';\nESCAPE_SEQUENCES[0x2029] = '\\\\P';\n\nvar DEPRECATED_BOOLEANS_SYNTAX = [\n  'y', 'Y', 'yes', 'Yes', 'YES', 'on', 'On', 'ON',\n  'n', 'N', 'no', 'No', 'NO', 'off', 'Off', 'OFF'\n];\n\nvar DEPRECATED_BASE60_SYNTAX = /^[-+]?[0-9_]+(?::[0-9_]+)+(?:\\.[0-9_]*)?$/;\n\nfunction compileStyleMap(schema, map) {\n  var result, keys, index, length, tag, style, type;\n\n  if (map === null) return {};\n\n  result = {};\n  keys = Object.keys(map);\n\n  for (index = 0, length = keys.length; index < length; index += 1) {\n    tag = keys[index];\n    style = String(map[tag]);\n\n    if (tag.slice(0, 2) === '!!') {\n      tag = 'tag:yaml.org,2002:' + tag.slice(2);\n    }\n    type = schema.compiledTypeMap['fallback'][tag];\n\n    if (type && _hasOwnProperty.call(type.styleAliases, style)) {\n      style = type.styleAliases[style];\n    }\n\n    result[tag] = style;\n  }\n\n  return result;\n}\n\nfunction encodeHex(character) {\n  var string, handle, length;\n\n  string = character.toString(16).toUpperCase();\n\n  if (character <= 0xFF) {\n    handle = 'x';\n    length = 2;\n  } else if (character <= 0xFFFF) {\n    handle = 'u';\n    length = 4;\n  } else if (character <= 0xFFFFFFFF) {\n    handle = 'U';\n    length = 8;\n  } else {\n    throw new exception('code point within a string may not be greater than 0xFFFFFFFF');\n  }\n\n  return '\\\\' + handle + common.repeat('0', length - string.length) + string;\n}\n\n\nvar QUOTING_TYPE_SINGLE = 1,\n    QUOTING_TYPE_DOUBLE = 2;\n\nfunction State(options) {\n  this.schema        = options['schema'] || _default;\n  this.indent        = Math.max(1, (options['indent'] || 2));\n  this.noArrayIndent = options['noArrayIndent'] || false;\n  this.skipInvalid   = options['skipInvalid'] || false;\n  this.flowLevel     = (common.isNothing(options['flowLevel']) ? -1 : options['flowLevel']);\n  this.styleMap      = compileStyleMap(this.schema, options['styles'] || null);\n  this.sortKeys      = options['sortKeys'] || false;\n  this.lineWidth     = options['lineWidth'] || 80;\n  this.noRefs        = options['noRefs'] || false;\n  this.noCompatMode  = options['noCompatMode'] || false;\n  this.condenseFlow  = options['condenseFlow'] || false;\n  this.quotingType   = options['quotingType'] === '\"' ? QUOTING_TYPE_DOUBLE : QUOTING_TYPE_SINGLE;\n  this.forceQuotes   = options['forceQuotes'] || false;\n  this.replacer      = typeof options['replacer'] === 'function' ? options['replacer'] : null;\n\n  this.implicitTypes = this.schema.compiledImplicit;\n  this.explicitTypes = this.schema.compiledExplicit;\n\n  this.tag = null;\n  this.result = '';\n\n  this.duplicates = [];\n  this.usedDuplicates = null;\n}\n\n// Indents every line in a string. Empty lines (\\n only) are not indented.\nfunction indentString(string, spaces) {\n  var ind = common.repeat(' ', spaces),\n      position = 0,\n      next = -1,\n      result = '',\n      line,\n      length = string.length;\n\n  while (position < length) {\n    next = string.indexOf('\\n', position);\n    if (next === -1) {\n      line = string.slice(position);\n      position = length;\n    } else {\n      line = string.slice(position, next + 1);\n      position = next + 1;\n    }\n\n    if (line.length && line !== '\\n') result += ind;\n\n    result += line;\n  }\n\n  return result;\n}\n\nfunction generateNextLine(state, level) {\n  return '\\n' + common.repeat(' ', state.indent * level);\n}\n\nfunction testImplicitResolving(state, str) {\n  var index, length, type;\n\n  for (index = 0, length = state.implicitTypes.length; index < length; index += 1) {\n    type = state.implicitTypes[index];\n\n    if (type.resolve(str)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n// [33] s-white ::= s-space | s-tab\nfunction isWhitespace(c) {\n  return c === CHAR_SPACE || c === CHAR_TAB;\n}\n\n// Returns true if the character can be printed without escaping.\n// From YAML 1.2: \"any allowed characters known to be non-printable\n// should also be escaped. [However,] This isn\u2019t mandatory\"\n// Derived from nb-char - \\t - #x85 - #xA0 - #x2028 - #x2029.\nfunction isPrintable(c) {\n  return  (0x00020 <= c && c <= 0x00007E)\n      || ((0x000A1 <= c && c <= 0x00D7FF) && c !== 0x2028 && c !== 0x2029)\n      || ((0x0E000 <= c && c <= 0x00FFFD) && c !== CHAR_BOM)\n      ||  (0x10000 <= c && c <= 0x10FFFF);\n}\n\n// [34] ns-char ::= nb-char - s-white\n// [27] nb-char ::= c-printable - b-char - c-byte-order-mark\n// [26] b-char  ::= b-line-feed | b-carriage-return\n// Including s-white (for some reason, examples doesn't match specs in this aspect)\n// ns-char ::= c-printable - b-line-feed - b-carriage-return - c-byte-order-mark\nfunction isNsCharOrWhitespace(c) {\n  return isPrintable(c)\n    && c !== CHAR_BOM\n    // - b-char\n    && c !== CHAR_CARRIAGE_RETURN\n    && c !== CHAR_LINE_FEED;\n}\n\n// [127]  ns-plain-safe(c) ::= c = flow-out  \u21D2 ns-plain-safe-out\n//                             c = flow-in   \u21D2 ns-plain-safe-in\n//                             c = block-key \u21D2 ns-plain-safe-out\n//                             c = flow-key  \u21D2 ns-plain-safe-in\n// [128] ns-plain-safe-out ::= ns-char\n// [129]  ns-plain-safe-in ::= ns-char - c-flow-indicator\n// [130]  ns-plain-char(c) ::=  ( ns-plain-safe(c) - \u201C:\u201D - \u201C#\u201D )\n//                            | ( /* An ns-char preceding */ \u201C#\u201D )\n//                            | ( \u201C:\u201D /* Followed by an ns-plain-safe(c) */ )\nfunction isPlainSafe(c, prev, inblock) {\n  var cIsNsCharOrWhitespace = isNsCharOrWhitespace(c);\n  var cIsNsChar = cIsNsCharOrWhitespace && !isWhitespace(c);\n  return (\n    // ns-plain-safe\n    inblock ? // c = flow-in\n      cIsNsCharOrWhitespace\n      : cIsNsCharOrWhitespace\n        // - c-flow-indicator\n        && c !== CHAR_COMMA\n        && c !== CHAR_LEFT_SQUARE_BRACKET\n        && c !== CHAR_RIGHT_SQUARE_BRACKET\n        && c !== CHAR_LEFT_CURLY_BRACKET\n        && c !== CHAR_RIGHT_CURLY_BRACKET\n  )\n    // ns-plain-char\n    && c !== CHAR_SHARP // false on '#'\n    && !(prev === CHAR_COLON && !cIsNsChar) // false on ': '\n    || (isNsCharOrWhitespace(prev) && !isWhitespace(prev) && c === CHAR_SHARP) // change to true on '[^ ]#'\n    || (prev === CHAR_COLON && cIsNsChar); // change to true on ':[^ ]'\n}\n\n// Simplified test for values allowed as the first character in plain style.\nfunction isPlainSafeFirst(c) {\n  // Uses a subset of ns-char - c-indicator\n  // where ns-char = nb-char - s-white.\n  // No support of ( ( \u201C?\u201D | \u201C:\u201D | \u201C-\u201D ) /* Followed by an ns-plain-safe(c)) */ ) part\n  return isPrintable(c) && c !== CHAR_BOM\n    && !isWhitespace(c) // - s-white\n    // - (c-indicator ::=\n    // \u201C-\u201D | \u201C?\u201D | \u201C:\u201D | \u201C,\u201D | \u201C[\u201D | \u201C]\u201D | \u201C{\u201D | \u201C}\u201D\n    && c !== CHAR_MINUS\n    && c !== CHAR_QUESTION\n    && c !== CHAR_COLON\n    && c !== CHAR_COMMA\n    && c !== CHAR_LEFT_SQUARE_BRACKET\n    && c !== CHAR_RIGHT_SQUARE_BRACKET\n    && c !== CHAR_LEFT_CURLY_BRACKET\n    && c !== CHAR_RIGHT_CURLY_BRACKET\n    // | \u201C#\u201D | \u201C&\u201D | \u201C*\u201D | \u201C!\u201D | \u201C|\u201D | \u201C=\u201D | \u201C>\u201D | \u201C'\u201D | \u201C\"\u201D\n    && c !== CHAR_SHARP\n    && c !== CHAR_AMPERSAND\n    && c !== CHAR_ASTERISK\n    && c !== CHAR_EXCLAMATION\n    && c !== CHAR_VERTICAL_LINE\n    && c !== CHAR_EQUALS\n    && c !== CHAR_GREATER_THAN\n    && c !== CHAR_SINGLE_QUOTE\n    && c !== CHAR_DOUBLE_QUOTE\n    // | \u201C%\u201D | \u201C@\u201D | \u201C`\u201D)\n    && c !== CHAR_PERCENT\n    && c !== CHAR_COMMERCIAL_AT\n    && c !== CHAR_GRAVE_ACCENT;\n}\n\n// Simplified test for values allowed as the last character in plain style.\nfunction isPlainSafeLast(c) {\n  // just not whitespace or colon, it will be checked to be plain character later\n  return !isWhitespace(c) && c !== CHAR_COLON;\n}\n\n// Same as 'string'.codePointAt(pos), but works in older browsers.\nfunction codePointAt(string, pos) {\n  var first = string.charCodeAt(pos), second;\n  if (first >= 0xD800 && first <= 0xDBFF && pos + 1 < string.length) {\n    second = string.charCodeAt(pos + 1);\n    if (second >= 0xDC00 && second <= 0xDFFF) {\n      // https://mathiasbynens.be/notes/javascript-encoding#surrogate-formulae\n      return (first - 0xD800) * 0x400 + second - 0xDC00 + 0x10000;\n    }\n  }\n  return first;\n}\n\n// Determines whether block indentation indicator is required.\nfunction needIndentIndicator(string) {\n  var leadingSpaceRe = /^\\n* /;\n  return leadingSpaceRe.test(string);\n}\n\nvar STYLE_PLAIN   = 1,\n    STYLE_SINGLE  = 2,\n    STYLE_LITERAL = 3,\n    STYLE_FOLDED  = 4,\n    STYLE_DOUBLE  = 5;\n\n// Determines which scalar styles are possible and returns the preferred style.\n// lineWidth = -1 => no limit.\n// Pre-conditions: str.length > 0.\n// Post-conditions:\n//    STYLE_PLAIN or STYLE_SINGLE => no \\n are in the string.\n//    STYLE_LITERAL => no lines are suitable for folding (or lineWidth is -1).\n//    STYLE_FOLDED => a line > lineWidth and can be folded (and lineWidth != -1).\nfunction chooseScalarStyle(string, singleLineOnly, indentPerLevel, lineWidth,\n  testAmbiguousType, quotingType, forceQuotes, inblock) {\n\n  var i;\n  var char = 0;\n  var prevChar = null;\n  var hasLineBreak = false;\n  var hasFoldableLine = false; // only checked if shouldTrackWidth\n  var shouldTrackWidth = lineWidth !== -1;\n  var previousLineBreak = -1; // count the first line correctly\n  var plain = isPlainSafeFirst(codePointAt(string, 0))\n          && isPlainSafeLast(codePointAt(string, string.length - 1));\n\n  if (singleLineOnly || forceQuotes) {\n    // Case: no block styles.\n    // Check for disallowed characters to rule out plain and single.\n    for (i = 0; i < string.length; char >= 0x10000 ? i += 2 : i++) {\n      char = codePointAt(string, i);\n      if (!isPrintable(char)) {\n        return STYLE_DOUBLE;\n      }\n      plain = plain && isPlainSafe(char, prevChar, inblock);\n      prevChar = char;\n    }\n  } else {\n    // Case: block styles permitted.\n    for (i = 0; i < string.length; char >= 0x10000 ? i += 2 : i++) {\n      char = codePointAt(string, i);\n      if (char === CHAR_LINE_FEED) {\n        hasLineBreak = true;\n        // Check if any line can be folded.\n        if (shouldTrackWidth) {\n          hasFoldableLine = hasFoldableLine ||\n            // Foldable line = too long, and not more-indented.\n            (i - previousLineBreak - 1 > lineWidth &&\n             string[previousLineBreak + 1] !== ' ');\n          previousLineBreak = i;\n        }\n      } else if (!isPrintable(char)) {\n        return STYLE_DOUBLE;\n      }\n      plain = plain && isPlainSafe(char, prevChar, inblock);\n      prevChar = char;\n    }\n    // in case the end is missing a \\n\n    hasFoldableLine = hasFoldableLine || (shouldTrackWidth &&\n      (i - previousLineBreak - 1 > lineWidth &&\n       string[previousLineBreak + 1] !== ' '));\n  }\n  // Although every style can represent \\n without escaping, prefer block styles\n  // for multiline, since they're more readable and they don't add empty lines.\n  // Also prefer folding a super-long line.\n  if (!hasLineBreak && !hasFoldableLine) {\n    // Strings interpretable as another type have to be quoted;\n    // e.g. the string 'true' vs. the boolean true.\n    if (plain && !forceQuotes && !testAmbiguousType(string)) {\n      return STYLE_PLAIN;\n    }\n    return quotingType === QUOTING_TYPE_DOUBLE ? STYLE_DOUBLE : STYLE_SINGLE;\n  }\n  // Edge case: block indentation indicator can only have one digit.\n  if (indentPerLevel > 9 && needIndentIndicator(string)) {\n    return STYLE_DOUBLE;\n  }\n  // At this point we know block styles are valid.\n  // Prefer literal style unless we want to fold.\n  if (!forceQuotes) {\n    return hasFoldableLine ? STYLE_FOLDED : STYLE_LITERAL;\n  }\n  return quotingType === QUOTING_TYPE_DOUBLE ? STYLE_DOUBLE : STYLE_SINGLE;\n}\n\n// Note: line breaking/folding is implemented for only the folded style.\n// NB. We drop the last trailing newline (if any) of a returned block scalar\n//  since the dumper adds its own newline. This always works:\n//    \u2022 No ending newline => unaffected; already using strip \"-\" chomping.\n//    \u2022 Ending newline    => removed then restored.\n//  Importantly, this keeps the \"+\" chomp indicator from gaining an extra line.\nfunction writeScalar(state, string, level, iskey, inblock) {\n  state.dump = (function () {\n    if (string.length === 0) {\n      return state.quotingType === QUOTING_TYPE_DOUBLE ? '\"\"' : \"''\";\n    }\n    if (!state.noCompatMode) {\n      if (DEPRECATED_BOOLEANS_SYNTAX.indexOf(string) !== -1 || DEPRECATED_BASE60_SYNTAX.test(string)) {\n        return state.quotingType === QUOTING_TYPE_DOUBLE ? ('\"' + string + '\"') : (\"'\" + string + \"'\");\n      }\n    }\n\n    var indent = state.indent * Math.max(1, level); // no 0-indent scalars\n    // As indentation gets deeper, let the width decrease monotonically\n    // to the lower bound min(state.lineWidth, 40).\n    // Note that this implies\n    //  state.lineWidth \u2264 40 + state.indent: width is fixed at the lower bound.\n    //  state.lineWidth > 40 + state.indent: width decreases until the lower bound.\n    // This behaves better than a constant minimum width which disallows narrower options,\n    // or an indent threshold which causes the width to suddenly increase.\n    var lineWidth = state.lineWidth === -1\n      ? -1 : Math.max(Math.min(state.lineWidth, 40), state.lineWidth - indent);\n\n    // Without knowing if keys are implicit/explicit, assume implicit for safety.\n    var singleLineOnly = iskey\n      // No block styles in flow mode.\n      || (state.flowLevel > -1 && level >= state.flowLevel);\n    function testAmbiguity(string) {\n      return testImplicitResolving(state, string);\n    }\n\n    switch (chooseScalarStyle(string, singleLineOnly, state.indent, lineWidth,\n      testAmbiguity, state.quotingType, state.forceQuotes && !iskey, inblock)) {\n\n      case STYLE_PLAIN:\n        return string;\n      case STYLE_SINGLE:\n        return \"'\" + string.replace(/'/g, \"''\") + \"'\";\n      case STYLE_LITERAL:\n        return '|' + blockHeader(string, state.indent)\n          + dropEndingNewline(indentString(string, indent));\n      case STYLE_FOLDED:\n        return '>' + blockHeader(string, state.indent)\n          + dropEndingNewline(indentString(foldString(string, lineWidth), indent));\n      case STYLE_DOUBLE:\n        return '\"' + escapeString(string) + '\"';\n      default:\n        throw new exception('impossible error: invalid scalar style');\n    }\n  }());\n}\n\n// Pre-conditions: string is valid for a block scalar, 1 <= indentPerLevel <= 9.\nfunction blockHeader(string, indentPerLevel) {\n  var indentIndicator = needIndentIndicator(string) ? String(indentPerLevel) : '';\n\n  // note the special case: the string '\\n' counts as a \"trailing\" empty line.\n  var clip =          string[string.length - 1] === '\\n';\n  var keep = clip && (string[string.length - 2] === '\\n' || string === '\\n');\n  var chomp = keep ? '+' : (clip ? '' : '-');\n\n  return indentIndicator + chomp + '\\n';\n}\n\n// (See the note for writeScalar.)\nfunction dropEndingNewline(string) {\n  return string[string.length - 1] === '\\n' ? string.slice(0, -1) : string;\n}\n\n// Note: a long line without a suitable break point will exceed the width limit.\n// Pre-conditions: every char in str isPrintable, str.length > 0, width > 0.\nfunction foldString(string, width) {\n  // In folded style, $k$ consecutive newlines output as $k+1$ newlines\u2014\n  // unless they're before or after a more-indented line, or at the very\n  // beginning or end, in which case $k$ maps to $k$.\n  // Therefore, parse each chunk as newline(s) followed by a content line.\n  var lineRe = /(\\n+)([^\\n]*)/g;\n\n  // first line (possibly an empty line)\n  var result = (function () {\n    var nextLF = string.indexOf('\\n');\n    nextLF = nextLF !== -1 ? nextLF : string.length;\n    lineRe.lastIndex = nextLF;\n    return foldLine(string.slice(0, nextLF), width);\n  }());\n  // If we haven't reached the first content line yet, don't add an extra \\n.\n  var prevMoreIndented = string[0] === '\\n' || string[0] === ' ';\n  var moreIndented;\n\n  // rest of the lines\n  var match;\n  while ((match = lineRe.exec(string))) {\n    var prefix = match[1], line = match[2];\n    moreIndented = (line[0] === ' ');\n    result += prefix\n      + (!prevMoreIndented && !moreIndented && line !== ''\n        ? '\\n' : '')\n      + foldLine(line, width);\n    prevMoreIndented = moreIndented;\n  }\n\n  return result;\n}\n\n// Greedy line breaking.\n// Picks the longest line under the limit each time,\n// otherwise settles for the shortest line over the limit.\n// NB. More-indented lines *cannot* be folded, as that would add an extra \\n.\nfunction foldLine(line, width) {\n  if (line === '' || line[0] === ' ') return line;\n\n  // Since a more-indented line adds a \\n, breaks can't be followed by a space.\n  var breakRe = / [^ ]/g; // note: the match index will always be <= length-2.\n  var match;\n  // start is an inclusive index. end, curr, and next are exclusive.\n  var start = 0, end, curr = 0, next = 0;\n  var result = '';\n\n  // Invariants: 0 <= start <= length-1.\n  //   0 <= curr <= next <= max(0, length-2). curr - start <= width.\n  // Inside the loop:\n  //   A match implies length >= 2, so curr and next are <= length-2.\n  while ((match = breakRe.exec(line))) {\n    next = match.index;\n    // maintain invariant: curr - start <= width\n    if (next - start > width) {\n      end = (curr > start) ? curr : next; // derive end <= length-2\n      result += '\\n' + line.slice(start, end);\n      // skip the space that was output as \\n\n      start = end + 1;                    // derive start <= length-1\n    }\n    curr = next;\n  }\n\n  // By the invariants, start <= length-1, so there is something left over.\n  // It is either the whole string or a part starting from non-whitespace.\n  result += '\\n';\n  // Insert a break if the remainder is too long and there is a break available.\n  if (line.length - start > width && curr > start) {\n    result += line.slice(start, curr) + '\\n' + line.slice(curr + 1);\n  } else {\n    result += line.slice(start);\n  }\n\n  return result.slice(1); // drop extra \\n joiner\n}\n\n// Escapes a double-quoted string.\nfunction escapeString(string) {\n  var result = '';\n  var char = 0;\n  var escapeSeq;\n\n  for (var i = 0; i < string.length; char >= 0x10000 ? i += 2 : i++) {\n    char = codePointAt(string, i);\n    escapeSeq = ESCAPE_SEQUENCES[char];\n\n    if (!escapeSeq && isPrintable(char)) {\n      result += string[i];\n      if (char >= 0x10000) result += string[i + 1];\n    } else {\n      result += escapeSeq || encodeHex(char);\n    }\n  }\n\n  return result;\n}\n\nfunction writeFlowSequence(state, level, object) {\n  var _result = '',\n      _tag    = state.tag,\n      index,\n      length,\n      value;\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    value = object[index];\n\n    if (state.replacer) {\n      value = state.replacer.call(object, String(index), value);\n    }\n\n    // Write only valid elements, put null instead of invalid elements.\n    if (writeNode(state, level, value, false, false) ||\n        (typeof value === 'undefined' &&\n         writeNode(state, level, null, false, false))) {\n\n      if (_result !== '') _result += ',' + (!state.condenseFlow ? ' ' : '');\n      _result += state.dump;\n    }\n  }\n\n  state.tag = _tag;\n  state.dump = '[' + _result + ']';\n}\n\nfunction writeBlockSequence(state, level, object, compact) {\n  var _result = '',\n      _tag    = state.tag,\n      index,\n      length,\n      value;\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    value = object[index];\n\n    if (state.replacer) {\n      value = state.replacer.call(object, String(index), value);\n    }\n\n    // Write only valid elements, put null instead of invalid elements.\n    if (writeNode(state, level + 1, value, true, true, false, true) ||\n        (typeof value === 'undefined' &&\n         writeNode(state, level + 1, null, true, true, false, true))) {\n\n      if (!compact || _result !== '') {\n        _result += generateNextLine(state, level);\n      }\n\n      if (state.dump && CHAR_LINE_FEED === state.dump.charCodeAt(0)) {\n        _result += '-';\n      } else {\n        _result += '- ';\n      }\n\n      _result += state.dump;\n    }\n  }\n\n  state.tag = _tag;\n  state.dump = _result || '[]'; // Empty sequence if no valid values.\n}\n\nfunction writeFlowMapping(state, level, object) {\n  var _result       = '',\n      _tag          = state.tag,\n      objectKeyList = Object.keys(object),\n      index,\n      length,\n      objectKey,\n      objectValue,\n      pairBuffer;\n\n  for (index = 0, length = objectKeyList.length; index < length; index += 1) {\n\n    pairBuffer = '';\n    if (_result !== '') pairBuffer += ', ';\n\n    if (state.condenseFlow) pairBuffer += '\"';\n\n    objectKey = objectKeyList[index];\n    objectValue = object[objectKey];\n\n    if (state.replacer) {\n      objectValue = state.replacer.call(object, objectKey, objectValue);\n    }\n\n    if (!writeNode(state, level, objectKey, false, false)) {\n      continue; // Skip this pair because of invalid key;\n    }\n\n    if (state.dump.length > 1024) pairBuffer += '? ';\n\n    pairBuffer += state.dump + (state.condenseFlow ? '\"' : '') + ':' + (state.condenseFlow ? '' : ' ');\n\n    if (!writeNode(state, level, objectValue, false, false)) {\n      continue; // Skip this pair because of invalid value.\n    }\n\n    pairBuffer += state.dump;\n\n    // Both key and value are valid.\n    _result += pairBuffer;\n  }\n\n  state.tag = _tag;\n  state.dump = '{' + _result + '}';\n}\n\nfunction writeBlockMapping(state, level, object, compact) {\n  var _result       = '',\n      _tag          = state.tag,\n      objectKeyList = Object.keys(object),\n      index,\n      length,\n      objectKey,\n      objectValue,\n      explicitPair,\n      pairBuffer;\n\n  // Allow sorting keys so that the output file is deterministic\n  if (state.sortKeys === true) {\n    // Default sorting\n    objectKeyList.sort();\n  } else if (typeof state.sortKeys === 'function') {\n    // Custom sort function\n    objectKeyList.sort(state.sortKeys);\n  } else if (state.sortKeys) {\n    // Something is wrong\n    throw new exception('sortKeys must be a boolean or a function');\n  }\n\n  for (index = 0, length = objectKeyList.length; index < length; index += 1) {\n    pairBuffer = '';\n\n    if (!compact || _result !== '') {\n      pairBuffer += generateNextLine(state, level);\n    }\n\n    objectKey = objectKeyList[index];\n    objectValue = object[objectKey];\n\n    if (state.replacer) {\n      objectValue = state.replacer.call(object, objectKey, objectValue);\n    }\n\n    if (!writeNode(state, level + 1, objectKey, true, true, true)) {\n      continue; // Skip this pair because of invalid key.\n    }\n\n    explicitPair = (state.tag !== null && state.tag !== '?') ||\n                   (state.dump && state.dump.length > 1024);\n\n    if (explicitPair) {\n      if (state.dump && CHAR_LINE_FEED === state.dump.charCodeAt(0)) {\n        pairBuffer += '?';\n      } else {\n        pairBuffer += '? ';\n      }\n    }\n\n    pairBuffer += state.dump;\n\n    if (explicitPair) {\n      pairBuffer += generateNextLine(state, level);\n    }\n\n    if (!writeNode(state, level + 1, objectValue, true, explicitPair)) {\n      continue; // Skip this pair because of invalid value.\n    }\n\n    if (state.dump && CHAR_LINE_FEED === state.dump.charCodeAt(0)) {\n      pairBuffer += ':';\n    } else {\n      pairBuffer += ': ';\n    }\n\n    pairBuffer += state.dump;\n\n    // Both key and value are valid.\n    _result += pairBuffer;\n  }\n\n  state.tag = _tag;\n  state.dump = _result || '{}'; // Empty mapping if no valid pairs.\n}\n\nfunction detectType(state, object, explicit) {\n  var _result, typeList, index, length, type, style;\n\n  typeList = explicit ? state.explicitTypes : state.implicitTypes;\n\n  for (index = 0, length = typeList.length; index < length; index += 1) {\n    type = typeList[index];\n\n    if ((type.instanceOf  || type.predicate) &&\n        (!type.instanceOf || ((typeof object === 'object') && (object instanceof type.instanceOf))) &&\n        (!type.predicate  || type.predicate(object))) {\n\n      if (explicit) {\n        if (type.multi && type.representName) {\n          state.tag = type.representName(object);\n        } else {\n          state.tag = type.tag;\n        }\n      } else {\n        state.tag = '?';\n      }\n\n      if (type.represent) {\n        style = state.styleMap[type.tag] || type.defaultStyle;\n\n        if (_toString.call(type.represent) === '[object Function]') {\n          _result = type.represent(object, style);\n        } else if (_hasOwnProperty.call(type.represent, style)) {\n          _result = type.represent[style](object, style);\n        } else {\n          throw new exception('!<' + type.tag + '> tag resolver accepts not \"' + style + '\" style');\n        }\n\n        state.dump = _result;\n      }\n\n      return true;\n    }\n  }\n\n  return false;\n}\n\n// Serializes `object` and writes it to global `result`.\n// Returns true on success, or false on invalid object.\n//\nfunction writeNode(state, level, object, block, compact, iskey, isblockseq) {\n  state.tag = null;\n  state.dump = object;\n\n  if (!detectType(state, object, false)) {\n    detectType(state, object, true);\n  }\n\n  var type = _toString.call(state.dump);\n  var inblock = block;\n  var tagStr;\n\n  if (block) {\n    block = (state.flowLevel < 0 || state.flowLevel > level);\n  }\n\n  var objectOrArray = type === '[object Object]' || type === '[object Array]',\n      duplicateIndex,\n      duplicate;\n\n  if (objectOrArray) {\n    duplicateIndex = state.duplicates.indexOf(object);\n    duplicate = duplicateIndex !== -1;\n  }\n\n  if ((state.tag !== null && state.tag !== '?') || duplicate || (state.indent !== 2 && level > 0)) {\n    compact = false;\n  }\n\n  if (duplicate && state.usedDuplicates[duplicateIndex]) {\n    state.dump = '*ref_' + duplicateIndex;\n  } else {\n    if (objectOrArray && duplicate && !state.usedDuplicates[duplicateIndex]) {\n      state.usedDuplicates[duplicateIndex] = true;\n    }\n    if (type === '[object Object]') {\n      if (block && (Object.keys(state.dump).length !== 0)) {\n        writeBlockMapping(state, level, state.dump, compact);\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + state.dump;\n        }\n      } else {\n        writeFlowMapping(state, level, state.dump);\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + ' ' + state.dump;\n        }\n      }\n    } else if (type === '[object Array]') {\n      if (block && (state.dump.length !== 0)) {\n        if (state.noArrayIndent && !isblockseq && level > 0) {\n          writeBlockSequence(state, level - 1, state.dump, compact);\n        } else {\n          writeBlockSequence(state, level, state.dump, compact);\n        }\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + state.dump;\n        }\n      } else {\n        writeFlowSequence(state, level, state.dump);\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + ' ' + state.dump;\n        }\n      }\n    } else if (type === '[object String]') {\n      if (state.tag !== '?') {\n        writeScalar(state, state.dump, level, iskey, inblock);\n      }\n    } else if (type === '[object Undefined]') {\n      return false;\n    } else {\n      if (state.skipInvalid) return false;\n      throw new exception('unacceptable kind of an object to dump ' + type);\n    }\n\n    if (state.tag !== null && state.tag !== '?') {\n      // Need to encode all characters except those allowed by the spec:\n      //\n      // [35] ns-dec-digit    ::=  [#x30-#x39] /* 0-9 */\n      // [36] ns-hex-digit    ::=  ns-dec-digit\n      //                         | [#x41-#x46] /* A-F */ | [#x61-#x66] /* a-f */\n      // [37] ns-ascii-letter ::=  [#x41-#x5A] /* A-Z */ | [#x61-#x7A] /* a-z */\n      // [38] ns-word-char    ::=  ns-dec-digit | ns-ascii-letter | \u201C-\u201D\n      // [39] ns-uri-char     ::=  \u201C%\u201D ns-hex-digit ns-hex-digit | ns-word-char | \u201C#\u201D\n      //                         | \u201C;\u201D | \u201C/\u201D | \u201C?\u201D | \u201C:\u201D | \u201C@\u201D | \u201C&\u201D | \u201C=\u201D | \u201C+\u201D | \u201C$\u201D | \u201C,\u201D\n      //                         | \u201C_\u201D | \u201C.\u201D | \u201C!\u201D | \u201C~\u201D | \u201C*\u201D | \u201C'\u201D | \u201C(\u201D | \u201C)\u201D | \u201C[\u201D | \u201C]\u201D\n      //\n      // Also need to encode '!' because it has special meaning (end of tag prefix).\n      //\n      tagStr = encodeURI(\n        state.tag[0] === '!' ? state.tag.slice(1) : state.tag\n      ).replace(/!/g, '%21');\n\n      if (state.tag[0] === '!') {\n        tagStr = '!' + tagStr;\n      } else if (tagStr.slice(0, 18) === 'tag:yaml.org,2002:') {\n        tagStr = '!!' + tagStr.slice(18);\n      } else {\n        tagStr = '!<' + tagStr + '>';\n      }\n\n      state.dump = tagStr + ' ' + state.dump;\n    }\n  }\n\n  return true;\n}\n\nfunction getDuplicateReferences(object, state) {\n  var objects = [],\n      duplicatesIndexes = [],\n      index,\n      length;\n\n  inspectNode(object, objects, duplicatesIndexes);\n\n  for (index = 0, length = duplicatesIndexes.length; index < length; index += 1) {\n    state.duplicates.push(objects[duplicatesIndexes[index]]);\n  }\n  state.usedDuplicates = new Array(length);\n}\n\nfunction inspectNode(object, objects, duplicatesIndexes) {\n  var objectKeyList,\n      index,\n      length;\n\n  if (object !== null && typeof object === 'object') {\n    index = objects.indexOf(object);\n    if (index !== -1) {\n      if (duplicatesIndexes.indexOf(index) === -1) {\n        duplicatesIndexes.push(index);\n      }\n    } else {\n      objects.push(object);\n\n      if (Array.isArray(object)) {\n        for (index = 0, length = object.length; index < length; index += 1) {\n          inspectNode(object[index], objects, duplicatesIndexes);\n        }\n      } else {\n        objectKeyList = Object.keys(object);\n\n        for (index = 0, length = objectKeyList.length; index < length; index += 1) {\n          inspectNode(object[objectKeyList[index]], objects, duplicatesIndexes);\n        }\n      }\n    }\n  }\n}\n\nfunction dump$1(input, options) {\n  options = options || {};\n\n  var state = new State(options);\n\n  if (!state.noRefs) getDuplicateReferences(input, state);\n\n  var value = input;\n\n  if (state.replacer) {\n    value = state.replacer.call({ '': value }, '', value);\n  }\n\n  if (writeNode(state, 0, value, true, true)) return state.dump + '\\n';\n\n  return '';\n}\n\nvar dump_1 = dump$1;\n\nvar dumper = {\n\tdump: dump_1\n};\n\nfunction renamed(from, to) {\n  return function () {\n    throw new Error('Function yaml.' + from + ' is removed in js-yaml 4. ' +\n      'Use yaml.' + to + ' instead, which is now safe by default.');\n  };\n}\n\n\nvar Type                = type;\nvar Schema              = schema;\nvar FAILSAFE_SCHEMA     = failsafe;\nvar JSON_SCHEMA         = json;\nvar CORE_SCHEMA         = core;\nvar DEFAULT_SCHEMA      = _default;\nvar load                = loader.load;\nvar loadAll             = loader.loadAll;\nvar dump                = dumper.dump;\nvar YAMLException       = exception;\n\n// Re-export all types in case user wants to create custom schema\nvar types = {\n  binary:    binary,\n  float:     float,\n  map:       map,\n  null:      _null,\n  pairs:     pairs,\n  set:       set,\n  timestamp: timestamp,\n  bool:      bool,\n  int:       int,\n  merge:     merge,\n  omap:      omap,\n  seq:       seq,\n  str:       str\n};\n\n// Removed functions from JS-YAML 3.0.x\nvar safeLoad            = renamed('safeLoad', 'load');\nvar safeLoadAll         = renamed('safeLoadAll', 'loadAll');\nvar safeDump            = renamed('safeDump', 'dump');\n\nvar jsYaml = {\n\tType: Type,\n\tSchema: Schema,\n\tFAILSAFE_SCHEMA: FAILSAFE_SCHEMA,\n\tJSON_SCHEMA: JSON_SCHEMA,\n\tCORE_SCHEMA: CORE_SCHEMA,\n\tDEFAULT_SCHEMA: DEFAULT_SCHEMA,\n\tload: load,\n\tloadAll: loadAll,\n\tdump: dump,\n\tYAMLException: YAMLException,\n\ttypes: types,\n\tsafeLoad: safeLoad,\n\tsafeLoadAll: safeLoadAll,\n\tsafeDump: safeDump\n};\n\nexport default jsYaml;\nexport { CORE_SCHEMA, DEFAULT_SCHEMA, FAILSAFE_SCHEMA, JSON_SCHEMA, Schema, Type, YAMLException, dump, load, loadAll, safeDump, safeLoad, safeLoadAll, types };\n"],
  "mappings": "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A;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAk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",
  "names": ["isWindow", "thing", "Window", "realWindow", "win", "init", "window", "el", "document", "createTextNode", "ownerDocument", "wrap", "getWindow", "node", "defaultView", "object", "_typeof", "func", "is", "docFrag", "nodeType", "number", "bool", "string", "element", "_window", "test", "Element", "nodeName", "plainObject", "constructor", "toString", "array", "length", "splice", "beforeMove", "_ref", "interaction", "prepared", "name", "axis", "coords", "cur", "page", "y", "start", "client", "velocity", "x", "move", "_ref2", "iEvent", "opposite", "delta", "drag", "id", "install", "scope", "actions", "Interactable", "defaults", "prototype", "draggable", "map", "methodDict", "listeners", "arg", "interactable", "buttons", "dragOptions", "options", "enabled", "pointerIsDown", "pointerType", "mouseButtons", "action", "lockAxis", "startAxis", "this", "setPerAction", "setOnEvents", "getCursor", "filterEventType", "type", "search", "drag$1", "domObjects", "DocumentFragment", "blank", "SVGElement", "SVGSVGElement", "SVGElementInstance", "HTMLElement", "Event", "Touch", "PointerEvent", "MSPointerEvent", "domObjects$1", "browser", "navigator", "supportsTouch", "DocumentTouch", "supportsPointerEvent", "pointerEnabled", "isIOS", "platform", "isIOS7", "appVersion", "isIe9", "userAgent", "isOperaMobile", "appName", "prefixedMatchesSelector", "pEventTypes", "up", "down", "over", "out", "cancel", "wheelEvent", "browser$1", "nodeContains", "parent", "child", "contains", "parentNode", "closest", "selector", "matchesSelector", "host", "replace", "getParent", "getNodeParents", "limit", "parentParent", "parents", "unshift", "matchesUpTo", "getActualElement", "correspondingUseElement", "getElementClientRect", "clientRect", "getBoundingClientRect", "getClientRects", "left", "right", "top", "bottom", "width", "height", "getElementRect", "relevantWindow", "scroll", "scrollX", "documentElement", "scrollLeft", "scrollY", "scrollTop", "getPath", "path", "push", "trySelector", "value", "querySelector", "extend", "dest", "source", "prop", "getStringOptionResult", "target", "getRect", "resolveRectLike", "functionArgs", "returnValue", "apply", "rectToXY", "rect", "tlbrToXywh", "addEdges", "edges", "getOriginXY", "actionName", "actionOptions", "origin", "normalize", "filter", "arguments", "_typeOrPrefix", "result", "split", "forEach", "t", "_i2", "_listeners2", "l", "prefix", "p", "concat", "trim", "hypot", "Math", "sqrt", "VENDOR_PREFIXES", "pointerExtend", "__set", "_loop", "some", "indexOf", "Object", "defineProperty", "get", "set", "configurable", "copyCoords", "src", "timeStamp", "setZeroCoords", "targetObj", "isNativePointer", "pointer", "dom", "getXY", "xy", "getPageXY", "getPointerId", "pointerId", "identifier", "setCoords", "pointers", "pointerAverage", "getTouchPair", "event", "touches", "changedTouches", "average", "pageX", "pageY", "clientX", "clientY", "screenX", "screenY", "touchBBox", "minX", "min", "minY", "maxX", "max", "maxY", "touchDistance", "deltaSource", "sourceX", "sourceY", "dx", "dy", "touchAngle", "atan2", "PI", "getPointerType", "undefined", "getEventTargets", "composedPath", "domUtils", "currentTarget", "BaseEvent", "_classCallCheck", "immediatePropagationStopped", "propagationStopped", "_interaction", "_createClass", "key", "_proxy", "merge", "item", "from", "findIndex", "i", "find", "DropEvent", "_BaseEvent", "_inherits", "_super", "_createSuper", "dropState", "dragEvent", "_this", "call", "dropzone", "relatedTarget", "prev", "_this2", "rejected", "events", "enter", "stopImmediatePropagation", "activeDrops", "index", "arr", "deactivateEvent", "fire", "fireActivationEvents", "_i6", "_activeDrops$slice2", "slice", "_activeDrops$slice2$_", "getActiveDrops", "dragElement", "draggableElement", "drops", "_interactables$list2", "interactables", "list", "drop", "accept", "_i4", "_dropzone$getAllEleme2", "getAllElements", "dropzoneElement", "_i8", "activeDrop", "getDrop", "pointerEvent", "validDrops", "_i10", "_dropState$activeDrop2", "_dropState$activeDrop3", "isValid", "dropCheck", "dropIndex", "elements", "deepestNodeIndex", "higherNode", "lowerNode", "deepestNodeParents", "currentNode", "deepestNode", "currentNodeParent", "deepestNodeParent", "ancestryStart", "ownerSVGElement", "currentNodeParents", "commonIndex", "lastChild", "previousSibling", "parseInt", "getComputedStyle", "zIndex", "getDropEvents", "_pointerEvent", "dropEvents", "leave", "activate", "deactivate", "dragLeave", "prevDropzone", "dragEnter", "fireDropEvents", "onEventCreated", "_ref3", "dynamicDrop", "dropResult", "interact", "interactStatic", "usePlugin", "normalized", "normalizeListeners", "corrected", "keys", "reduce", "acc", "prevListeners", "off", "on", "ondrop", "ondropactivate", "ondropdeactivate", "ondragenter", "ondragleave", "ondropmove", "overlap", "checker", "dropElement", "dropped", "dropOverlap", "pointerUtils", "horizontal", "vertical", "dragRect", "cx", "cy", "newValue", "phaselessTypes", "dragenter", "dragleave", "dropactivate", "dropdeactivate", "dropmove", "_ref4", "_ref5", "_ref6", "_ref7", "drop$1", "updateGestureProps", "phase", "starting", "ending", "distance", "box", "scale", "ds", "angle", "da", "gesture", "startDistance", "startAngle", "prevEvent", "Infinity", "isNaN", "before", "gesturable", "gestureOptions", "gesture$1", "checkResizeEdge", "interactableElement", "margin", "abs", "edge", "updateEventAxes", "resizeAxes", "resizeEvent", "resize", "square", "axes", "request", "cursors", "topleft", "bottomright", "topright", "bottomleft", "defaultMargin", "resizable", "preserveAspectRatio", "_rects", "previous", "deltaRect", "invert", "invertible", "current", "_interaction$_rects", "startRect", "swap", "resizeOptions", "resizeEdges", "_latestPointer", "eventTarget", "NaN", "cursorKey", "_ref8", "resize$1", "lastTime", "raf", "callback", "token", "global", "requestAnimationFrame", "cancelAnimationFrame", "vendors", "vendor", "bind", "currTime", "Date", "now", "timeToCall", "setTimeout", "clearTimeout", "autoScroll", "container", "speed", "isScrolling", "prevTime", "stop", "getContainer", "dt", "s", "scrollBy", "prevScroll", "getScroll", "curScroll", "check", "_options$actionName$a", "onInteractionMove", "interacting", "simulation", "innerWidth", "innerHeight", "body", "autoScrollPlugin", "autoscroll", "perAction", "autoScroll$1", "warnOnce", "method", "message", "warned", "console", "warn", "copyAction", "styleCursor", "actionChecker", "InteractableMethods", "getAction", "button", "ignoreFrom", "_backCompatOption", "allowFrom", "validateAction", "testIgnoreAllow", "withinInteractionLimit", "validateMatches", "matches", "matchElements", "len", "match", "matchElement", "matchAction", "getActionInfo", "pushMatches", "forEachMatch", "actionInfo", "manualStart", "prepare", "setInteractionCursor", "maxActions", "maxPerElement", "autoStartMax", "autoStart", "maxInteractions", "activeInteractions", "interactableCount", "elementCount", "_scope$interactions$l2", "interactions", "otherAction", "setCursor", "cursor", "prevCursorElement", "cursorElement", "style", "cursorChecker", "_interacting", "base", "pointerWasMoved", "autoStart$2", "dragAxis", "absX", "absY", "targetOptions", "currentAxis", "getDraggable", "downPointer", "downEvent", "thisAxis", "getHoldDuration", "hold", "delay", "basePlugin", "autoStartHoldTimer", "duplicate", "hold$1", "preventDefault", "onInteractionEvent", "checkAndPreventDefault", "interactablePreventDefault", "setting", "supportsPassive", "doc", "docOptions", "getDocOptions", "passive", "docEvents", "listener", "eventType", "isNonNativeEvent", "substr", "phases", "clone", "Modification", "states", "startOffset", "startDelta", "endResult", "startEdges", "createResult", "pageCoords", "modifierList", "actionModifiers", "modifiers", "methods", "_methods", "m", "prepareStates", "fillArg", "preEnd", "startAll", "setAll", "_this$states2", "state", "skipModifiers", "unmodifiedRect", "unmodifiedEdges", "newResult", "_state$methods", "lastModifierCoords", "shouldDo", "rectUtils", "eventProps", "rectDelta", "prevCoords", "prevRect", "rectChanged", "changed", "curCoords", "startCoords", "curDelta", "_ref3$_i", "coordsSet", "modifiedCoords", "adjustment", "applyToInteraction", "doPreend", "endPosition", "beforeEnd", "modifierArg", "_this$states4", "_modifierList$index", "_ref4$interaction", "modification", "_modification$result", "_i12", "_ref6$_i", "requireEndOnly", "endOnly", "setStart", "other", "makeModifier", "module", "modifier", "_options", "enable", "disable", "_defaults", "addEventModifiers", "modifiersBase", "ret", "setAndApply", "restoreInteractionCoords", "InteractEvent", "ctrlKey", "shiftKey", "altKey", "metaKey", "x0", "y0", "t0", "duration", "clientX0", "clientY0", "swipe", "_assertThisInitialized", "downTime", "getSwipe", "velocityY", "velocityX", "defineProperties", "PointerInfo", "downTarget", "_ProxyValues", "_ProxyMethods", "idCounter", "Interaction", "scopeFire", "_scopeFire", "_ending", "_stopped", "doMove", "signalArg", "_id", "that", "_loop2", "_key", "pointerIndex", "updatePointer", "pointerInfo", "_doPhase", "duplicateMove", "pointerMoveTolerance", "getPointerIndex", "curEventTarget", "end", "removePointer", "endPhaseResult", "curPointer", "_now", "_updateLatestPointer", "_this$interactable", "_createPreparedEvent", "_fireEvent", "beforeAction", "applyPending", "offset", "pending", "addToCoords", "offsetBy", "total", "offset$1", "InertiaState", "active", "isModified", "smoothEnd", "allowResume", "modifierCount", "v0", "te", "targetOffset", "modifiedOffset", "currentOffset", "lambda_v0", "one_ve_v0", "timeout", "getOptions", "velocityClient", "pointerSpeed", "copyFrom", "minSpeed", "endSpeed", "startInertia", "startSmoothEnd", "startVelocity", "lambda", "resistance", "inertiaDur", "log", "onNextFrame", "inertiaTick", "smoothEndTick", "tickFn", "_this3", "startX", "startY", "cpX", "cpY", "endX", "endY", "position", "_this4", "newOffset", "progress", "exp", "_getQBezierValue", "_this5", "smoothEndDuration", "easeOutQuad", "inertia", "inertiastart", "resume", "p1", "p2", "p3", "iT", "b", "c", "d", "inertia$1", "fireUntilImmediateStopped", "Eventable", "types", "eventList", "_listeners$type2", "subListener", "_element", "FakeEvent", "originalEvent", "pExtend", "stopPropagation", "param", "capture", "optionsMatch", "a", "_scope$document", "targets", "delegatedEvents", "documents", "eventsMethods", "add", "remove", "addDelegate", "context", "optionalArg", "_i3", "delegateListener", "delegateUseCapture", "delegates", "delegate", "removeDelegate", "matchFound", "entry", "supportsOptions", "addEventListener", "removeEventListener", "targetIndex", "typeIsEmpty", "typeListeners", "hasOwnProperty", "fakeEvent", "_i5", "createElement", "finder", "methodOrder", "details", "_finder$methodOrder2", "simulationResume", "mouseOrPen", "firstNonActive", "_scope$interactions$l4", "hasPointerId", "_scope$interactions$l6", "hasPointer", "_scope$interactions$l8", "idle", "_scope$interactions$l10", "finder$1", "methodNames", "doOnInteractions", "_pointerUtils$getEven", "prevTouchTime", "_event$changedTouches2", "changedTouch", "searchDetails", "getInteraction", "invalidPointer", "_matches$_i", "new", "onDocSignal", "eventMethodName", "eventMethod", "eventOptions", "_i14", "_docEvents$_i", "releasePointersOnRemovedEls", "_interaction$pointers2", "pointerDown", "pointerMove", "pointerUp", "documentBlur", "_InteractionBase", "_class", "InteractionBase", "destroy", "interactions$1", "OnOffMethod", "defaultContext", "scopeEvents", "_actions", "_context", "_win", "_doc", "_scopeEvents", "onstart", "onmove", "onend", "oninertiastart", "_this$_actions$map$ac", "actionFilter", "_onOff", "Off", "On", "optionName_", "optionName", "optionValue", "updatePerActionListeners", "Array", "querySelectorAll", "targetNode", "testIgnore", "testAllow", "typeArg", "listenerArg", "_listeners$_type2", "actionName_", "methodName", "rectChecker", "delegated", "_delegated$i", "InteractableSet", "selectorMap", "addListeners", "interactablesOnTarget", "addDocument", "isSelector", "inContext", "_this$list2", "Scope", "floor", "random", "isInitialized", "listenerMaps", "getExisting", "globalEvents", "getPointerAverage", "getTouchBBox", "getTouchDistance", "getTouchAngle", "version", "process", "use", "plugin", "isSet", "_type2", "debug", "_this$scope$interacti2", "removeDocument", "_plugins", "onWindowUnload", "_InteractableBase", "_class2", "_get", "_getPrototypeOf", "InteractableBase", "_this$listenerMaps2", "pluginIsInstalled", "pluginIdRoot", "otherId", "getDocIndex", "docIndex", "interact$1", "_global", "globalThis", "fn", "grid", "coordFields", "xField", "yField", "gridFunc", "range", "_grid$limits", "limits", "_grid$offset", "_coordFields$_i", "gridx", "round", "gridy", "snappersPlugin", "snappers", "allSnappers", "createSnapGrid", "aspectRatio", "_state$options", "ratio", "_state$options2", "equalDelta", "linkedEdges", "xIsPrimaryAxis", "sign", "edgeSign", "subModification", "_objectSpread", "initialCoords", "aspectMethod", "setEqualDelta", "setRatio", "correctedRect", "newHeight", "newWidth", "aspectRatio$1", "noop", "rubberband", "getRestrictionRect", "restrict", "elementRect", "restriction", "widthDiff", "heightDiff", "restrict$1", "noInner", "noOuter", "fixRect", "restrictEdges", "inner", "outer", "restrictEdges$1", "_", "restrictRect$1", "noMin", "noMax", "restrictSize$1", "minSize", "maxSize", "snap", "snapOffset", "offsetWithOrigin", "optionsOrigin", "offsetRect", "relativePoints", "offsets", "relativePoint", "relativeX", "relativeY", "snapTarget", "inRange", "snap$1", "snapSize", "targetFields", "relative", "_state$targetFields2", "_state$targetFields2$", "snapSize$1", "all", "restrictRect", "restrictSize", "snapEdges", "spring", "avoid", "transform", "_all", "modifiers$1", "interval", "tapTime", "double", "prevTap", "originX", "originY", "pointerEvents", "clearHold", "timer", "minDuration", "_signalArg$targets2", "holdDuration", "eventable", "collectEventTargets", "tap", "doubletap", "_arg$targets", "props", "_subtractOrigin", "_addOrigin", "_interaction$pointers", "Nn", "Bn", "endHoldRepeat", "holdIntervalHandle", "clearInterval", "holdRepeat", "holdRepeatInterval", "holdrepeat", "enderTypes", "count", "holdRepeat$1", "__backCompatOption", "interactableTargets", "reflow", "Promise", "promises", "reflowPromise", "runningInteraction", "_reflowPromise", "resolve", "_reflowResolve", "xywh", "then", "reflow$1", "default", "exports", "_unused", "import_interactjs", "isNothing", "subject", "isObject", "toArray", "sequence", "extend", "target", "source", "index", "length", "key", "sourceKeys", "repeat", "string", "count", "result", "cycle", "isNegativeZero", "number", "isNothing_1", "isObject_1", "toArray_1", "repeat_1", "isNegativeZero_1", "extend_1", "common", "formatError", "exception", "compact", "where", "message", "YAMLException$1", "reason", "mark", "getLine", "buffer", "lineStart", "lineEnd", "position", "maxLineLength", "head", "tail", "maxHalfLength", "padStart", "max", "makeSnippet", "options", "re", "lineStarts", "lineEnds", "match", "foundLineNo", "i", "line", "lineNoLength", "snippet", "TYPE_CONSTRUCTOR_OPTIONS", "YAML_NODE_KINDS", "compileStyleAliases", "map", "style", "alias", "Type$1", "tag", "name", "data", "type", "compileList", "schema", "currentType", "newIndex", "previousType", "previousIndex", "compileMap", "collectType", "Schema$1", "definition", "implicit", "explicit", "type$1", "str", "seq", "failsafe", "resolveYamlNull", "constructYamlNull", "isNull", "object", "_null", "resolveYamlBoolean", "constructYamlBoolean", "isBoolean", "bool", "isHexCode", "c", "isOctCode", "isDecCode", "resolveYamlInteger", "hasDigits", "ch", "constructYamlInteger", "value", "sign", "isInteger", "int", "obj", "YAML_FLOAT_PATTERN", "resolveYamlFloat", "constructYamlFloat", "SCIENTIFIC_WITHOUT_DOT", "representYamlFloat", "res", "isFloat", "float", "json", "core", "YAML_DATE_REGEXP", "YAML_TIMESTAMP_REGEXP", "resolveYamlTimestamp", "constructYamlTimestamp", "year", "month", "day", "hour", "minute", "second", "fraction", "delta", "tz_hour", "tz_minute", "date", "representYamlTimestamp", "timestamp", "resolveYamlMerge", "merge", "BASE64_MAP", "resolveYamlBinary", "code", "idx", "bitlen", "constructYamlBinary", "tailbits", "input", "bits", "representYamlBinary", "isBinary", "binary", "_hasOwnProperty$3", "_toString$2", "resolveYamlOmap", "objectKeys", "pair", "pairKey", "pairHasKey", "constructYamlOmap", "omap", "_toString$1", "resolveYamlPairs", "keys", "constructYamlPairs", "pairs", "_hasOwnProperty$2", "resolveYamlSet", "constructYamlSet", "set", "_default", "_hasOwnProperty$1", "CONTEXT_FLOW_IN", "CONTEXT_FLOW_OUT", "CONTEXT_BLOCK_IN", "CONTEXT_BLOCK_OUT", "CHOMPING_CLIP", "CHOMPING_STRIP", "CHOMPING_KEEP", "PATTERN_NON_PRINTABLE", "PATTERN_NON_ASCII_LINE_BREAKS", "PATTERN_FLOW_INDICATORS", "PATTERN_TAG_HANDLE", "PATTERN_TAG_URI", "_class", "is_EOL", "is_WHITE_SPACE", "is_WS_OR_EOL", "is_FLOW_INDICATOR", "fromHexCode", "lc", "escapedHexLen", "fromDecimalCode", "simpleEscapeSequence", "charFromCodepoint", "simpleEscapeCheck", "simpleEscapeMap", "State$1", "generateError", "state", "throwError", "throwWarning", "directiveHandlers", "args", "major", "minor", "handle", "prefix", "captureSegment", "start", "end", "checkJson", "_position", "_length", "_character", "_result", "mergeMappings", "destination", "overridableKeys", "quantity", "storeMappingPair", "keyTag", "keyNode", "valueNode", "startLine", "startLineStart", "startPos", "readLineBreak", "skipSeparationSpace", "allowComments", "checkIndent", "lineBreaks", "testDocumentSeparator", "writeFoldedLines", "readPlainScalar", "nodeIndent", "withinFlowCollection", "preceding", "following", "captureStart", "captureEnd", "hasPendingContent", "_line", "_lineStart", "_lineIndent", "_kind", "readSingleQuotedScalar", "readDoubleQuotedScalar", "hexLength", "hexResult", "tmp", "readFlowCollection", "readNext", "_pos", "_tag", "_anchor", "terminator", "isPair", "isExplicitPair", "isMapping", "composeNode", "readBlockScalar", "folding", "chomping", "didReadContent", "detectedIndent", "textIndent", "emptyLines", "atMoreIndented", "readBlockSequence", "detected", "readBlockMapping", "flowIndent", "allowCompact", "_keyLine", "_keyLineStart", "_keyPos", "atExplicitKey", "readTagProperty", "isVerbatim", "isNamed", "tagHandle", "tagName", "readAnchorProperty", "readAlias", "parentIndent", "nodeContext", "allowToSeek", "allowBlockStyles", "allowBlockScalars", "allowBlockCollections", "indentStatus", "atNewLine", "hasContent", "typeIndex", "typeQuantity", "typeList", "blockIndent", "readDocument", "documentStart", "directiveName", "directiveArgs", "hasDirectives", "loadDocuments", "nullpos", "loadAll$1", "iterator", "documents", "load$1", "loadAll_1", "load_1", "loader", "_toString", "_hasOwnProperty", "CHAR_BOM", "CHAR_TAB", "CHAR_LINE_FEED", "CHAR_CARRIAGE_RETURN", "CHAR_SPACE", "CHAR_EXCLAMATION", "CHAR_DOUBLE_QUOTE", "CHAR_SHARP", "CHAR_PERCENT", "CHAR_AMPERSAND", "CHAR_SINGLE_QUOTE", "CHAR_ASTERISK", "CHAR_COMMA", "CHAR_MINUS", "CHAR_COLON", "CHAR_EQUALS", "CHAR_GREATER_THAN", "CHAR_QUESTION", "CHAR_COMMERCIAL_AT", "CHAR_LEFT_SQUARE_BRACKET", "CHAR_RIGHT_SQUARE_BRACKET", "CHAR_GRAVE_ACCENT", "CHAR_LEFT_CURLY_BRACKET", "CHAR_VERTICAL_LINE", "CHAR_RIGHT_CURLY_BRACKET", "ESCAPE_SEQUENCES", "DEPRECATED_BOOLEANS_SYNTAX", "DEPRECATED_BASE60_SYNTAX", "compileStyleMap", "encodeHex", "character", "QUOTING_TYPE_SINGLE", "QUOTING_TYPE_DOUBLE", "State", "indentString", "spaces", "ind", "next", "generateNextLine", "level", "testImplicitResolving", "isWhitespace", "isPrintable", "isNsCharOrWhitespace", "isPlainSafe", "prev", "inblock", "cIsNsCharOrWhitespace", "cIsNsChar", "isPlainSafeFirst", "isPlainSafeLast", "codePointAt", "pos", "first", "needIndentIndicator", "leadingSpaceRe", "STYLE_PLAIN", "STYLE_SINGLE", "STYLE_LITERAL", "STYLE_FOLDED", "STYLE_DOUBLE", "chooseScalarStyle", "singleLineOnly", "indentPerLevel", "lineWidth", "testAmbiguousType", "quotingType", "forceQuotes", "char", "prevChar", "hasLineBreak", "hasFoldableLine", "shouldTrackWidth", "previousLineBreak", "plain", "writeScalar", "iskey", "indent", "testAmbiguity", "blockHeader", "dropEndingNewline", "foldString", "escapeString", "indentIndicator", "clip", "keep", "chomp", "width", "lineRe", "nextLF", "foldLine", "prevMoreIndented", "moreIndented", "breakRe", "curr", "escapeSeq", "writeFlowSequence", "writeNode", "writeBlockSequence", "writeFlowMapping", "objectKeyList", "objectKey", "objectValue", "pairBuffer", "writeBlockMapping", "explicitPair", "detectType", "block", "isblockseq", "tagStr", "objectOrArray", "duplicateIndex", "duplicate", "getDuplicateReferences", "objects", "duplicatesIndexes", "inspectNode", "dump$1", "dump_1", "dumper", "renamed", "from", "to", "Type", "Schema", "FAILSAFE_SCHEMA", "JSON_SCHEMA", "CORE_SCHEMA", "DEFAULT_SCHEMA", "load", "loadAll", "dump", "YAMLException", "types", "safeLoad", "safeLoadAll", "safeDump", "jsYaml", "js_yaml_default", "interact", "js_yaml_default", "VERSION", "LOG", "m", "a", "raf", "r", "idle", "DragAndDropCard", "_DragAndDropCard", "__publicField", "cfg", "c", "el", "selector", "root", "results", "visit", "node", "treeWalker", "sr", "val", "inp", "_a", "_b", "og", "p", "o", "toggleSizeControls", "mode", "config", "_c", "_d", "_e", "_f", "_g", "_h", "_i", "presetSel", "presets", "updateButtons", "fire", "base", "applyBtn", "revertBtn", "isDirty", "on", "sel", "ev", "w", "h", "x", "initial", "cw", "ch", "y", "ww", "hh", "nx", "ny", "nw", "nh", "nx2", "ny2", "sz", "kind", "msg", "extra", "line", "s", "prevKey", "keyChanged", "e", "cont", "hass", "wraps", "wrap", "force", "_j", "_k", "_l", "_m", "_n", "__rebuildAfter", "saved", "local", "yamlCfg", "storage_key", "optsNoKey", "overrideKeys", "cfgOpts", "k", "builtAny", "conf", "cardEl", "entering", "wasOff", "handle", "ox", "oy", "n", "tag", "HOLD_MS", "DRIFT_PX", "isElem", "containsSafe", "within", "isOverCard", "hit", "path", "makeRing", "fg", "circ", "timer", "ring", "startX", "startY", "activePointerId", "clearTimer", "onPointerDown", "toState", "onPointerMove", "onPointerUpOrCancel", "onContextMenu", "onDblClick", "empty", "show", "toggle", "reason", "clientX", "clientY", "localX", "localY", "veil", "gs", "live", "mods", "gridSnap", "group", "rawX", "rawY", "lead", "srL", "curLeadX", "curLeadY", "dxLead", "dyLead", "proposed", "snapX", "snapY", "pr", "endRects", "curW", "curH", "width", "height", "wTry", "hTry", "nextW", "nextH", "prevW", "prevH", "wSnap", "hSnap", "resolve", "chip", "act", "targets", "t", "dup", "w2", "newCfg", "oldEl", "newEl", "shield", "inner", "hero", "heroImgUrl", "img", "title", "sub", "card", "delta", "next", "max", "z", "cards", "maxX", "maxY", "cr", "right", "bottom", "proposedRects", "liveSnap", "gridSize", "selectedSet", "allCards", "isFixed", "orig", "snX", "snY", "selectedRects", "finalPos", "cardSizes", "signX", "signY", "horizontal", "other", "candidateX", "candidateY", "ow", "oh", "overlaps", "guard", "dx", "dy", "candidateRect", "collision", "fp", "pos", "wpx", "hpx", "x0", "y0", "b", "eps", "ignoreSet", "others", "otherRects", "or", "raw", "parsed", "type", "helpers", "getCardClass", "baseCfg", "stubCfg", "inst", "CardClass", "entry", "candidates", "delay", "tmp", "cc", "it", "S", "any", "sc", "out", "f", "v", "clean", "domains", "all", "map", "id", "d", "eid", "st", "set", "l", "hostEl", "initialCfg", "onValidChange", "onInvalidChange", "dump", "parse", "initialText", "ed", "programmatic", "txt", "err", "cm", "text", "ta", "container", "items", "rowHeight", "renderRow", "spacer", "mount", "render", "scrollTop", "first", "last", "i", "newItems", "onCommit", "close", "modal", "left", "addTop", "addBottom", "cancelTop", "cancelBot", "search", "cardHost", "editorHost", "editorSpin", "quickFill", "yamlHost", "yamlErr", "yamlSec", "tabVisual", "tabYaml", "previewSpin", "enableCommit", "setError", "faves", "recent", "catalog", "favSection", "recSection", "allItems", "customItems", "quickFillSecDiv", "optionsSecDiv", "yamlSecDiv", "optionsHd", "selInfo", "favBtn", "updateFavStar", "currentType", "icon", "updateHeader", "item", "nm", "titleSpan", "renderLeft", "__activeTab", "showTab", "name", "wantYaml", "visualEditor", "mountVisualEditor", "currentConfig", "filteredCatalog", "q", "section", "sec", "view", "cat", "div", "highlight", "selectType", "btn", "yamlEditorApi", "pickSeq", "__previewTimer", "__lastPreviewCfgJSON", "buildQuickFill", "fieldWrap", "addEntityItem", "arr", "keyForMulti", "idx", "mountPreview", "row", "label", "filter", "list", "pool", "selected", "paint", "filtered", "dsWrap", "ds", "iconLead", "dl", "inpWrap", "numIcon", "selWrap", "selIcon", "opt", "tIcon", "cfgJSON", "seq", "temp", "wantType", "editor", "byDomain", "better", "onChange", "nextType", "mountYaml", "shaped", "typeChanged", "getStub", "commit", "finalCfg", "__searchTimer", "firstSensor", "defaultEntity", "pick", "areas", "occupied", "xStart", "yStart", "xEnd", "yEnd", "xi", "yi", "cardConfig", "marquee", "active", "toLocal", "updateSel", "minX", "minY", "rRect", "wr", "down", "move", "up", "sk", "usingHost", "logsToHtml", "rows", "refreshLogs", "logArea", "logsToHtmlLocal", "payload", "blob", "file", "json", "key", "back", "opts", "recalc", "updatedCfg", "__prevStorageKey", "targetKey", "importedOptions", "result", "yamlOk", "hop", "host", "rHost", "seen", "hits", "push", "obj", "viewIdx", "vv", "patchAllInCurrentViewIfNoKey", "ll", "curView", "newKey", "keys", "inCur", "basePatch", "ref", "seg", "existingKey", "shouldRename", "silent", "t0", "ms", "url", "data", "size", "res", "message", "ha", "main", "drawer", "ppr", "panel", "SEEN", "isLikelyCard", "rebuildOnce", "deepScan", "installOnInstance", "mo", "muts", "hookExisting", "ctor", "origConnected", "iv", "Cls", "_getLovelace", "_scanDdcCards", "_makeYamlBackup", "llConfig", "patch", "when", "backup", "_offerBackupDownload", "_recordRecentKey", "K", "_getRecentKeys", "_collectBackupKeys", "names", "_persistOptionsToYaml", "forceTargetKey", "onlyThisCard", "noDownload", "norm", "myKey", "cardsForStorage", "_fetchBackendKeys", "parseKeys", "urls", "_fetchLayoutByKey", "parseDesign", "tryCall", "method", "params", "tryFetch", "resp", "ct", "j", "enc", "_applyDesignObject", "source", "_o", "_p", "_q", "_r", "_s", "_t", "_u", "_v", "_w", "_x", "_y", "_z", "toPersist", "_updateSwitcherVisibility", "edit", "hui", "_ensureInlineSwitcher", "toolbar", "select", "fill", "current", "serverKeys", "backupKeys", "recentKeys", "toUnique", "server", "backups", "makeGroup", "none", "design", "oldKey", "persistOpts", "e2", "desc", "origSet", "origUpdate", "args"]
}
