{
  "version": 3,
  "sources": ["../node_modules/@interactjs/utils/isWindow.ts", "../node_modules/@interactjs/utils/window.ts", "../node_modules/@interactjs/utils/is.ts", "../node_modules/@interactjs/actions/drag/plugin.ts", "../node_modules/@interactjs/utils/domObjects.ts", "../node_modules/@interactjs/utils/browser.ts", "../node_modules/@interactjs/utils/domUtils.ts", "../node_modules/@interactjs/utils/extend.ts", "../node_modules/@interactjs/utils/rect.ts", "../node_modules/@interactjs/utils/getOriginXY.ts", "../node_modules/@interactjs/utils/normalizeListeners.ts", "../node_modules/@interactjs/utils/hypot.ts", "../node_modules/@interactjs/utils/pointerExtend.ts", "../node_modules/@interactjs/utils/pointerUtils.ts", "../node_modules/@interactjs/core/BaseEvent.ts", "../node_modules/@interactjs/utils/arr.ts", "../node_modules/@interactjs/actions/drop/DropEvent.ts", "../node_modules/@interactjs/actions/drop/plugin.ts", "../node_modules/@interactjs/actions/gesture/plugin.ts", "../node_modules/@interactjs/actions/resize/plugin.ts", "../node_modules/@interactjs/utils/raf.ts", "../node_modules/@interactjs/actions/plugin.ts", "../node_modules/@interactjs/auto-scroll/plugin.ts", "../node_modules/@interactjs/utils/misc.ts", "../node_modules/@interactjs/auto-start/InteractableMethods.ts", "../node_modules/@interactjs/auto-start/base.ts", "../node_modules/@interactjs/auto-start/dragAxis.ts", "../node_modules/@interactjs/auto-start/hold.ts", "../node_modules/@interactjs/auto-start/plugin.ts", "../node_modules/@interactjs/core/interactablePreventDefault.ts", "../node_modules/@interactjs/utils/isNonNativeEvent.ts", "../node_modules/@interactjs/utils/clone.ts", "../node_modules/@interactjs/modifiers/Modification.ts", "../node_modules/@interactjs/modifiers/base.ts", "../node_modules/@interactjs/core/options.ts", "../node_modules/@interactjs/core/InteractEvent.ts", "../node_modules/@interactjs/core/PointerInfo.ts", "../node_modules/@interactjs/core/Interaction.ts", "../node_modules/@interactjs/offset/plugin.ts", "../node_modules/@interactjs/inertia/plugin.ts", "../node_modules/@interactjs/core/Eventable.ts", "../node_modules/@interactjs/core/events.ts", "../node_modules/@interactjs/core/interactionFinder.ts", "../node_modules/@interactjs/core/interactions.ts", "../node_modules/@interactjs/core/Interactable.ts", "../node_modules/@interactjs/core/InteractableSet.ts", "../node_modules/@interactjs/core/scope.ts", "../node_modules/@interactjs/core/InteractStatic.ts", "../node_modules/@interactjs/interact/index.ts", "../node_modules/@interactjs/snappers/edgeTarget.ts", "../node_modules/@interactjs/snappers/elements.ts", "../node_modules/@interactjs/snappers/grid.ts", "../node_modules/@interactjs/snappers/plugin.ts", "../node_modules/@interactjs/modifiers/aspectRatio.ts", "../node_modules/@interactjs/modifiers/noop.ts", "../node_modules/@interactjs/modifiers/restrict/pointer.ts", "../node_modules/@interactjs/modifiers/restrict/edges.ts", "../node_modules/@interactjs/modifiers/restrict/rect.ts", "../node_modules/@interactjs/modifiers/restrict/size.ts", "../node_modules/@interactjs/modifiers/snap/pointer.ts", "../node_modules/@interactjs/modifiers/snap/size.ts", "../node_modules/@interactjs/modifiers/snap/edges.ts", "../node_modules/@interactjs/modifiers/all.ts", "../node_modules/@interactjs/modifiers/plugin.ts", "../node_modules/@interactjs/pointer-events/PointerEvent.ts", "../node_modules/@interactjs/pointer-events/base.ts", "../node_modules/@interactjs/pointer-events/holdRepeat.ts", "../node_modules/@interactjs/pointer-events/interactableTargets.ts", "../node_modules/@interactjs/pointer-events/plugin.ts", "../node_modules/@interactjs/reflow/plugin.ts", "../node_modules/interactjs/index.ts", "../node_modules/@interactjs/interactjs/index.ts", "../src/drag-and-drop-card.js", "../node_modules/js-yaml/dist/js-yaml.mjs"],
  "sourcesContent": ["export default (thing: any) => !!(thing && thing.Window) && thing instanceof thing.Window\n", "import isWindow from './isWindow'\n\nexport let realWindow = undefined as Window\n\nlet win = undefined as Window\nexport { win as window }\n\nexport function init(window: Window & { wrap?: (...args: any[]) => any }) {\n  // get wrapped window if using Shadow DOM polyfill\n\n  realWindow = window\n\n  // create a TextNode\n  const el = window.document.createTextNode('')\n\n  // check if it's wrapped by a polyfill\n  if (el.ownerDocument !== window.document && typeof window.wrap === 'function' && window.wrap(el) === el) {\n    // use wrapped window\n    window = window.wrap(window)\n  }\n\n  win = window\n}\n\nif (typeof window !== 'undefined' && !!window) {\n  init(window)\n}\n\nexport function getWindow(node: any) {\n  if (isWindow(node)) {\n    return node\n  }\n\n  const rootNode = node.ownerDocument || node\n\n  return rootNode.defaultView || win.window\n}\n", "import isWindow from './isWindow'\nimport * as win from './window'\n\nconst window = (thing: any): thing is Window => thing === win.window || isWindow(thing)\n\nconst docFrag = (thing: any): thing is DocumentFragment => object(thing) && thing.nodeType === 11\n\nconst object = (thing: any): thing is { [index: string]: any } => !!thing && typeof thing === 'object'\n\nconst func = (thing: any): thing is (...args: any[]) => any => typeof thing === 'function'\n\nconst number = (thing: any): thing is number => typeof thing === 'number'\n\nconst bool = (thing: any): thing is boolean => typeof thing === 'boolean'\n\nconst string = (thing: any): thing is string => typeof thing === 'string'\n\nconst element = (thing: any): thing is HTMLElement | SVGElement => {\n  if (!thing || typeof thing !== 'object') {\n    return false\n  }\n\n  const _window = win.getWindow(thing) || win.window\n\n  return /object|function/.test(typeof Element)\n    ? thing instanceof Element || thing instanceof _window.Element\n    : thing.nodeType === 1 && typeof thing.nodeName === 'string'\n}\n\nconst plainObject: typeof object = (thing: any): thing is { [index: string]: any } =>\n  object(thing) && !!thing.constructor && /function Object\\b/.test(thing.constructor.toString())\n\nconst array = <T extends unknown>(thing: any): thing is T[] =>\n  object(thing) && typeof thing.length !== 'undefined' && func(thing.splice)\n\nexport default {\n  window,\n  docFrag,\n  object,\n  func,\n  number,\n  bool,\n  string,\n  element,\n  plainObject,\n  array,\n}\n", "import type { Interactable } from '@interactjs/core/Interactable'\nimport type { InteractEvent } from '@interactjs/core/InteractEvent'\nimport type { PerActionDefaults } from '@interactjs/core/options'\nimport type { Scope, Plugin } from '@interactjs/core/scope'\nimport type { ListenersArg, OrBoolean } from '@interactjs/core/types'\nimport is from '@interactjs/utils/is'\n\ndeclare module '@interactjs/core/Interactable' {\n  interface Interactable {\n    draggable(options: Partial<OrBoolean<DraggableOptions>> | boolean): this\n    draggable(): DraggableOptions\n    /**\n     * ```js\n     * interact(element).draggable({\n     *     onstart: function (event) {},\n     *     onmove : function (event) {},\n     *     onend  : function (event) {},\n     *\n     *     // the axis in which the first movement must be\n     *     // for the drag sequence to start\n     *     // 'xy' by default - any direction\n     *     startAxis: 'x' || 'y' || 'xy',\n     *\n     *     // 'xy' by default - don't restrict to one axis (move in any direction)\n     *     // 'x' or 'y' to restrict movement to either axis\n     *     // 'start' to restrict movement to the axis the drag started in\n     *     lockAxis: 'x' || 'y' || 'xy' || 'start',\n     *\n     *     // max number of drags that can happen concurrently\n     *     // with elements of this Interactable. Infinity by default\n     *     max: Infinity,\n     *\n     *     // max number of drags that can target the same element+Interactable\n     *     // 1 by default\n     *     maxPerElement: 2\n     * })\n     *\n     * var isDraggable = interact('element').draggable(); // true\n     * ```\n     *\n     * Get or set whether drag actions can be performed on the target\n     *\n     * @param options - true/false or An object with event\n     * listeners to be fired on drag events (object makes the Interactable\n     * draggable)\n     */\n    draggable(options?: Partial<OrBoolean<DraggableOptions>> | boolean): this | DraggableOptions\n  }\n}\n\ndeclare module '@interactjs/core/options' {\n  interface ActionDefaults {\n    drag: DraggableOptions\n  }\n}\n\ndeclare module '@interactjs/core/types' {\n  interface ActionMap {\n    drag?: typeof drag\n  }\n}\n\nexport type DragEvent = InteractEvent<'drag'>\n\nexport interface DraggableOptions extends PerActionDefaults {\n  startAxis?: 'x' | 'y' | 'xy'\n  lockAxis?: 'x' | 'y' | 'xy' | 'start'\n  oninertiastart?: ListenersArg\n  onstart?: ListenersArg\n  onmove?: ListenersArg\n  onend?: ListenersArg\n}\n\nfunction install(scope: Scope) {\n  const { actions, Interactable, defaults } = scope\n\n  Interactable.prototype.draggable = drag.draggable\n\n  actions.map.drag = drag\n  actions.methodDict.drag = 'draggable'\n\n  defaults.actions.drag = drag.defaults\n}\n\nfunction beforeMove({ interaction }) {\n  if (interaction.prepared.name !== 'drag') return\n\n  const axis = interaction.prepared.axis\n\n  if (axis === 'x') {\n    interaction.coords.cur.page.y = interaction.coords.start.page.y\n    interaction.coords.cur.client.y = interaction.coords.start.client.y\n\n    interaction.coords.velocity.client.y = 0\n    interaction.coords.velocity.page.y = 0\n  } else if (axis === 'y') {\n    interaction.coords.cur.page.x = interaction.coords.start.page.x\n    interaction.coords.cur.client.x = interaction.coords.start.client.x\n\n    interaction.coords.velocity.client.x = 0\n    interaction.coords.velocity.page.x = 0\n  }\n}\n\nfunction move({ iEvent, interaction }) {\n  if (interaction.prepared.name !== 'drag') return\n\n  const axis = interaction.prepared.axis\n\n  if (axis === 'x' || axis === 'y') {\n    const opposite = axis === 'x' ? 'y' : 'x'\n\n    iEvent.page[opposite] = interaction.coords.start.page[opposite]\n    iEvent.client[opposite] = interaction.coords.start.client[opposite]\n    iEvent.delta[opposite] = 0\n  }\n}\n\nconst draggable: Interactable['draggable'] = function draggable(\n  this: Interactable,\n  options?: DraggableOptions | boolean,\n): any {\n  if (is.object(options)) {\n    this.options.drag.enabled = options.enabled !== false\n    this.setPerAction('drag', options)\n    this.setOnEvents('drag', options)\n\n    if (/^(xy|x|y|start)$/.test(options.lockAxis)) {\n      this.options.drag.lockAxis = options.lockAxis\n    }\n    if (/^(xy|x|y)$/.test(options.startAxis)) {\n      this.options.drag.startAxis = options.startAxis\n    }\n\n    return this\n  }\n\n  if (is.bool(options)) {\n    this.options.drag.enabled = options\n\n    return this\n  }\n\n  return this.options.drag as DraggableOptions\n}\n\nconst drag: Plugin = {\n  id: 'actions/drag',\n  install,\n  listeners: {\n    'interactions:before-action-move': beforeMove,\n    'interactions:action-resume': beforeMove,\n\n    // dragmove\n    'interactions:action-move': move,\n    'auto-start:check': (arg) => {\n      const { interaction, interactable, buttons } = arg\n      const dragOptions = interactable.options.drag\n\n      if (\n        !(dragOptions && dragOptions.enabled) ||\n        // check mouseButton setting if the pointer is down\n        (interaction.pointerIsDown &&\n          /mouse|pointer/.test(interaction.pointerType) &&\n          (buttons & interactable.options.drag.mouseButtons) === 0)\n      ) {\n        return undefined\n      }\n\n      arg.action = {\n        name: 'drag',\n        axis: dragOptions.lockAxis === 'start' ? dragOptions.startAxis : dragOptions.lockAxis,\n      }\n\n      return false\n    },\n  },\n  draggable,\n  beforeMove,\n  move,\n  defaults: {\n    startAxis: 'xy',\n    lockAxis: 'xy',\n  } as DraggableOptions,\n\n  getCursor() {\n    return 'move'\n  },\n\n  filterEventType: (type: string) => type.search('drag') === 0,\n}\n\nexport default drag\n", "const domObjects: {\n  init: any\n  document: Document\n  DocumentFragment: typeof DocumentFragment\n  SVGElement: typeof SVGElement\n  SVGSVGElement: typeof SVGSVGElement\n  SVGElementInstance: any\n  Element: typeof Element\n  HTMLElement: typeof HTMLElement\n  Event: typeof Event\n  Touch: typeof Touch\n  PointerEvent: typeof PointerEvent\n} = {\n  init,\n  document: null,\n  DocumentFragment: null,\n  SVGElement: null,\n  SVGSVGElement: null,\n  SVGElementInstance: null,\n  Element: null,\n  HTMLElement: null,\n  Event: null,\n  Touch: null,\n  PointerEvent: null,\n}\n\nfunction blank() {}\n\nexport default domObjects\n\nfunction init(window: Window) {\n  const win = window as any\n\n  domObjects.document = win.document\n  domObjects.DocumentFragment = win.DocumentFragment || blank\n  domObjects.SVGElement = win.SVGElement || blank\n  domObjects.SVGSVGElement = win.SVGSVGElement || blank\n  domObjects.SVGElementInstance = win.SVGElementInstance || blank\n  domObjects.Element = win.Element || blank\n  domObjects.HTMLElement = win.HTMLElement || domObjects.Element\n\n  domObjects.Event = win.Event\n  domObjects.Touch = win.Touch || blank\n  domObjects.PointerEvent = win.PointerEvent || win.MSPointerEvent\n}\n", "import domObjects from './domObjects'\nimport is from './is'\n\nconst browser = {\n  init,\n  supportsTouch: null as boolean,\n  supportsPointerEvent: null as boolean,\n  isIOS7: null as boolean,\n  isIOS: null as boolean,\n  isIe9: null as boolean,\n  isOperaMobile: null as boolean,\n  prefixedMatchesSelector: null as 'matches',\n  pEventTypes: null as {\n    up: string\n    down: string\n    over: string\n    out: string\n    move: string\n    cancel: string\n  },\n  wheelEvent: null as string,\n}\n\nfunction init(window: any) {\n  const Element = domObjects.Element\n  const navigator: Partial<Navigator> = window.navigator || {}\n\n  // Does the browser support touch input?\n  browser.supportsTouch =\n    'ontouchstart' in window ||\n    (is.func(window.DocumentTouch) && domObjects.document instanceof window.DocumentTouch)\n\n  // Does the browser support PointerEvents\n  // https://github.com/taye/interact.js/issues/703#issuecomment-471570492\n  browser.supportsPointerEvent = (navigator as any).pointerEnabled !== false && !!domObjects.PointerEvent\n\n  browser.isIOS = /iP(hone|od|ad)/.test(navigator.platform)\n\n  // scrolling doesn't change the result of getClientRects on iOS 7\n  browser.isIOS7 = /iP(hone|od|ad)/.test(navigator.platform) && /OS 7[^\\d]/.test(navigator.appVersion)\n\n  browser.isIe9 = /MSIE 9/.test(navigator.userAgent)\n\n  // Opera Mobile must be handled differently\n  browser.isOperaMobile =\n    navigator.appName === 'Opera' && browser.supportsTouch && /Presto/.test(navigator.userAgent)\n\n  // prefix matchesSelector\n  browser.prefixedMatchesSelector = (\n    'matches' in Element.prototype\n      ? 'matches'\n      : 'webkitMatchesSelector' in Element.prototype\n        ? 'webkitMatchesSelector'\n        : 'mozMatchesSelector' in Element.prototype\n          ? 'mozMatchesSelector'\n          : 'oMatchesSelector' in Element.prototype\n            ? 'oMatchesSelector'\n            : 'msMatchesSelector'\n  ) as 'matches'\n\n  browser.pEventTypes = browser.supportsPointerEvent\n    ? domObjects.PointerEvent === window.MSPointerEvent\n      ? {\n          up: 'MSPointerUp',\n          down: 'MSPointerDown',\n          over: 'mouseover',\n          out: 'mouseout',\n          move: 'MSPointerMove',\n          cancel: 'MSPointerCancel',\n        }\n      : {\n          up: 'pointerup',\n          down: 'pointerdown',\n          over: 'pointerover',\n          out: 'pointerout',\n          move: 'pointermove',\n          cancel: 'pointercancel',\n        }\n    : null\n\n  // because Webkit and Opera still use 'mousewheel' event type\n  browser.wheelEvent = domObjects.document && 'onmousewheel' in domObjects.document ? 'mousewheel' : 'wheel'\n}\n\nexport default browser\n", "import type { Rect, Target, Element } from '@interactjs/core/types'\n\nimport browser from './browser'\nimport domObjects from './domObjects'\nimport is from './is'\nimport * as win from './window'\n\nexport function nodeContains(parent: Node, child: Node) {\n  if (parent.contains) {\n    return parent.contains(child as Node)\n  }\n\n  while (child) {\n    if (child === parent) {\n      return true\n    }\n\n    child = (child as Node).parentNode\n  }\n\n  return false\n}\n\nexport function closest(element: Node, selector: string) {\n  while (is.element(element)) {\n    if (matchesSelector(element, selector)) {\n      return element\n    }\n\n    element = parentNode(element)\n  }\n\n  return null\n}\n\nexport function parentNode(node: Node | Document) {\n  let parent = node.parentNode\n\n  if (is.docFrag(parent)) {\n    // skip past #shado-root fragments\n    // tslint:disable-next-line\n    while ((parent = (parent as any).host) && is.docFrag(parent)) {\n      continue\n    }\n\n    return parent\n  }\n\n  return parent\n}\n\nexport function matchesSelector(element: Element, selector: string) {\n  // remove /deep/ from selectors if shadowDOM polyfill is used\n  if (win.window !== win.realWindow) {\n    selector = selector.replace(/\\/deep\\//g, ' ')\n  }\n\n  return element[browser.prefixedMatchesSelector](selector)\n}\n\nconst getParent = (el: Node | Document | ShadowRoot) => el.parentNode || (el as ShadowRoot).host\n\n// Test for the element that's \"above\" all other qualifiers\nexport function indexOfDeepestElement(elements: Element[] | NodeListOf<globalThis.Element>) {\n  let deepestNodeParents: Node[] = []\n  let deepestNodeIndex: number\n\n  for (let i = 0; i < elements.length; i++) {\n    const currentNode = elements[i]\n    const deepestNode: Node = elements[deepestNodeIndex]\n\n    // node may appear in elements array multiple times\n    if (!currentNode || i === deepestNodeIndex) {\n      continue\n    }\n\n    if (!deepestNode) {\n      deepestNodeIndex = i\n      continue\n    }\n\n    const currentNodeParent = getParent(currentNode)\n    const deepestNodeParent = getParent(deepestNode)\n\n    // check if the deepest or current are document.documentElement/rootElement\n    // - if the current node is, do nothing and continue\n    if (currentNodeParent === currentNode.ownerDocument) {\n      continue\n    }\n    // - if deepest is, update with the current node and continue to next\n    else if (deepestNodeParent === currentNode.ownerDocument) {\n      deepestNodeIndex = i\n      continue\n    }\n\n    // compare zIndex of siblings\n    if (currentNodeParent === deepestNodeParent) {\n      if (zIndexIsHigherThan(currentNode, deepestNode)) {\n        deepestNodeIndex = i\n      }\n\n      continue\n    }\n\n    // populate the ancestry array for the latest deepest node\n    deepestNodeParents = deepestNodeParents.length ? deepestNodeParents : getNodeParents(deepestNode)\n\n    let ancestryStart: Node\n\n    // if the deepest node is an HTMLElement and the current node is a non root svg element\n    if (\n      deepestNode instanceof domObjects.HTMLElement &&\n      currentNode instanceof domObjects.SVGElement &&\n      !(currentNode instanceof domObjects.SVGSVGElement)\n    ) {\n      // TODO: is this check necessary? Was this for HTML elements embedded in SVG?\n      if (currentNode === deepestNodeParent) {\n        continue\n      }\n\n      ancestryStart = currentNode.ownerSVGElement\n    } else {\n      ancestryStart = currentNode\n    }\n\n    const currentNodeParents = getNodeParents(ancestryStart, deepestNode.ownerDocument)\n    let commonIndex = 0\n\n    // get (position of closest common ancestor) + 1\n    while (\n      currentNodeParents[commonIndex] &&\n      currentNodeParents[commonIndex] === deepestNodeParents[commonIndex]\n    ) {\n      commonIndex++\n    }\n\n    const parents = [\n      currentNodeParents[commonIndex - 1],\n      currentNodeParents[commonIndex],\n      deepestNodeParents[commonIndex],\n    ]\n\n    if (parents[0]) {\n      let child = parents[0].lastChild\n\n      while (child) {\n        if (child === parents[1]) {\n          deepestNodeIndex = i\n          deepestNodeParents = currentNodeParents\n\n          break\n        } else if (child === parents[2]) {\n          break\n        }\n\n        child = child.previousSibling\n      }\n    }\n  }\n\n  return deepestNodeIndex\n}\n\nfunction getNodeParents(node: Node, limit?: Node) {\n  const parents: Node[] = []\n  let parent: Node = node\n  let parentParent: Node\n\n  while ((parentParent = getParent(parent)) && parent !== limit && parentParent !== parent.ownerDocument) {\n    parents.unshift(parent)\n    parent = parentParent\n  }\n\n  return parents\n}\n\nfunction zIndexIsHigherThan(higherNode: Node, lowerNode: Node) {\n  const higherIndex = parseInt(win.getWindow(higherNode).getComputedStyle(higherNode).zIndex, 10) || 0\n  const lowerIndex = parseInt(win.getWindow(lowerNode).getComputedStyle(lowerNode).zIndex, 10) || 0\n\n  return higherIndex >= lowerIndex\n}\n\nexport function matchesUpTo(element: Element, selector: string, limit: Node) {\n  while (is.element(element)) {\n    if (matchesSelector(element, selector)) {\n      return true\n    }\n\n    element = parentNode(element) as Element\n\n    if (element === limit) {\n      return matchesSelector(element, selector)\n    }\n  }\n\n  return false\n}\n\nexport function getActualElement(element: Element) {\n  return (element as any).correspondingUseElement || element\n}\n\nexport function getScrollXY(relevantWindow?: Window) {\n  relevantWindow = relevantWindow || win.window\n  return {\n    x: relevantWindow.scrollX || relevantWindow.document.documentElement.scrollLeft,\n    y: relevantWindow.scrollY || relevantWindow.document.documentElement.scrollTop,\n  }\n}\n\nexport function getElementClientRect(element: Element): Required<Rect> {\n  const clientRect =\n    element instanceof domObjects.SVGElement ? element.getBoundingClientRect() : element.getClientRects()[0]\n\n  return (\n    clientRect && {\n      left: clientRect.left,\n      right: clientRect.right,\n      top: clientRect.top,\n      bottom: clientRect.bottom,\n      width: clientRect.width || clientRect.right - clientRect.left,\n      height: clientRect.height || clientRect.bottom - clientRect.top,\n    }\n  )\n}\n\nexport function getElementRect(element: Element) {\n  const clientRect = getElementClientRect(element)\n\n  if (!browser.isIOS7 && clientRect) {\n    const scroll = getScrollXY(win.getWindow(element))\n\n    clientRect.left += scroll.x\n    clientRect.right += scroll.x\n    clientRect.top += scroll.y\n    clientRect.bottom += scroll.y\n  }\n\n  return clientRect\n}\n\nexport function getPath(node: Node | Document) {\n  const path = []\n\n  while (node) {\n    path.push(node)\n    node = parentNode(node)\n  }\n\n  return path\n}\n\nexport function trySelector(value: Target) {\n  if (!is.string(value)) {\n    return false\n  }\n\n  // an exception will be raised if it is invalid\n  domObjects.document.querySelector(value)\n  return true\n}\n", "export default function extend<T, U extends object>(dest: U & Partial<T>, source: T): T & U {\n  for (const prop in source) {\n    ;(dest as unknown as T)[prop] = source[prop]\n  }\n\n  const ret = dest as T & U\n\n  return ret\n}\n", "import type {\n  HasGetRect,\n  RectResolvable,\n  Rect,\n  Element,\n  Point,\n  FullRect,\n  EdgeOptions,\n} from '@interactjs/core/types'\n\nimport { closest, getElementRect, parentNode } from './domUtils'\nimport extend from './extend'\nimport is from './is'\n\nexport function getStringOptionResult(value: any, target: HasGetRect, element: Node) {\n  if (value === 'parent') {\n    return parentNode(element)\n  }\n\n  if (value === 'self') {\n    return target.getRect(element as Element)\n  }\n\n  return closest(element, value)\n}\n\nexport function resolveRectLike<T extends any[]>(\n  value: RectResolvable<T>,\n  target?: HasGetRect,\n  element?: Node,\n  functionArgs?: T,\n) {\n  let returnValue: any = value\n  if (is.string(returnValue)) {\n    returnValue = getStringOptionResult(returnValue, target, element)\n  } else if (is.func(returnValue)) {\n    returnValue = returnValue(...functionArgs)\n  }\n\n  if (is.element(returnValue)) {\n    returnValue = getElementRect(returnValue)\n  }\n\n  return returnValue as Rect\n}\n\nexport function toFullRect(rect: Rect): FullRect {\n  const { top, left, bottom, right } = rect\n  const width = rect.width ?? rect.right - rect.left\n  const height = rect.height ?? rect.bottom - rect.top\n\n  return { top, left, bottom, right, width, height }\n}\n\nexport function rectToXY(rect: Rect | Point) {\n  return (\n    rect && {\n      x: 'x' in rect ? rect.x : rect.left,\n      y: 'y' in rect ? rect.y : rect.top,\n    }\n  )\n}\n\nexport function xywhToTlbr<T extends Partial<Rect & Point>>(rect: T) {\n  if (rect && !('left' in rect && 'top' in rect)) {\n    rect = extend({}, rect)\n\n    rect.left = rect.x || 0\n    rect.top = rect.y || 0\n    rect.right = rect.right || rect.left + rect.width\n    rect.bottom = rect.bottom || rect.top + rect.height\n  }\n\n  return rect as Rect & T\n}\n\nexport function tlbrToXywh(rect: Rect & Partial<Point>) {\n  if (rect && !('x' in rect && 'y' in rect)) {\n    rect = extend({}, rect)\n\n    rect.x = rect.left || 0\n    rect.y = rect.top || 0\n    rect.width = rect.width || (rect.right || 0) - rect.x\n    rect.height = rect.height || (rect.bottom || 0) - rect.y\n  }\n\n  return rect as FullRect & Point\n}\n\nexport function addEdges(edges: EdgeOptions, rect: Rect, delta: Point) {\n  if (edges.left) {\n    rect.left += delta.x\n  }\n  if (edges.right) {\n    rect.right += delta.x\n  }\n  if (edges.top) {\n    rect.top += delta.y\n  }\n  if (edges.bottom) {\n    rect.bottom += delta.y\n  }\n\n  rect.width = rect.right - rect.left\n  rect.height = rect.bottom - rect.top\n}\n", "import type { PerActionDefaults } from '@interactjs/core/options'\nimport type { ActionName, HasGetRect } from '@interactjs/core/types'\n\nimport { rectToXY, resolveRectLike } from './rect'\n\nexport default function getOriginXY(\n  target: HasGetRect & { options: PerActionDefaults },\n  element: Node,\n  actionName?: ActionName,\n) {\n  const actionOptions = actionName && (target.options as any)[actionName]\n  const actionOrigin = actionOptions && actionOptions.origin\n  const origin = actionOrigin || target.options.origin\n\n  const originRect = resolveRectLike(origin, target, element, [target && element])\n\n  return rectToXY(originRect) || { x: 0, y: 0 }\n}\n", "import type { EventTypes, Listener, ListenersArg } from '@interactjs/core/types'\n\nimport is from './is'\n\nexport interface NormalizedListeners {\n  [type: string]: Listener[]\n}\n\nexport default function normalize(\n  type: EventTypes,\n  listeners?: ListenersArg | ListenersArg[] | null,\n  filter = (_typeOrPrefix: string) => true,\n  result?: NormalizedListeners,\n): NormalizedListeners {\n  result = result || {}\n\n  if (is.string(type) && type.search(' ') !== -1) {\n    type = split(type)\n  }\n\n  if (is.array(type)) {\n    type.forEach((t) => normalize(t, listeners, filter, result))\n    return result\n  }\n\n  // before:  type = [{ drag: () => {} }], listeners = undefined\n  // after:   type = ''                  , listeners = [{ drag: () => {} }]\n  if (is.object(type)) {\n    listeners = type\n    type = ''\n  }\n\n  if (is.func(listeners) && filter(type)) {\n    result[type] = result[type] || []\n    result[type].push(listeners)\n  } else if (is.array(listeners)) {\n    for (const l of listeners) {\n      normalize(type, l, filter, result)\n    }\n  } else if (is.object(listeners)) {\n    for (const prefix in listeners) {\n      const combinedTypes = split(prefix).map((p) => `${type}${p}`)\n\n      normalize(combinedTypes, listeners[prefix], filter, result)\n    }\n  }\n\n  return result as NormalizedListeners\n}\n\nfunction split(type: string) {\n  return type.trim().split(/ +/)\n}\n", "export default (x: number, y: number) => Math.sqrt(x * x + y * y)\n", "const VENDOR_PREFIXES = ['webkit', 'moz']\n\nexport default function pointerExtend<T>(dest: Partial<T & { __set?: Partial<T> }>, source: T) {\n  dest.__set ||= {} as any\n\n  for (const prop in source) {\n    // skip deprecated prefixed properties\n    if (VENDOR_PREFIXES.some((prefix) => prop.indexOf(prefix) === 0)) continue\n\n    if (typeof dest[prop] !== 'function' && prop !== '__set') {\n      Object.defineProperty(dest, prop, {\n        get() {\n          if (prop in dest.__set) return dest.__set[prop]\n\n          return (dest.__set[prop] = source[prop] as any)\n        },\n        set(value: any) {\n          dest.__set[prop] = value\n        },\n        configurable: true,\n      })\n    }\n  }\n  return dest\n}\n", "import type { InteractEvent } from '@interactjs/core/InteractEvent'\nimport type { CoordsSetMember, PointerType, Point, PointerEventType, Element } from '@interactjs/core/types'\n\nimport browser from './browser'\nimport dom from './domObjects'\nimport * as domUtils from './domUtils'\nimport hypot from './hypot'\nimport is from './is'\nimport pointerExtend from './pointerExtend'\n\nexport function copyCoords(dest: CoordsSetMember, src: CoordsSetMember) {\n  dest.page = dest.page || ({} as any)\n  dest.page.x = src.page.x\n  dest.page.y = src.page.y\n\n  dest.client = dest.client || ({} as any)\n  dest.client.x = src.client.x\n  dest.client.y = src.client.y\n\n  dest.timeStamp = src.timeStamp\n}\n\nexport function setCoordDeltas(targetObj: CoordsSetMember, prev: CoordsSetMember, cur: CoordsSetMember) {\n  targetObj.page.x = cur.page.x - prev.page.x\n  targetObj.page.y = cur.page.y - prev.page.y\n  targetObj.client.x = cur.client.x - prev.client.x\n  targetObj.client.y = cur.client.y - prev.client.y\n  targetObj.timeStamp = cur.timeStamp - prev.timeStamp\n}\n\nexport function setCoordVelocity(targetObj: CoordsSetMember, delta: CoordsSetMember) {\n  const dt = Math.max(delta.timeStamp / 1000, 0.001)\n\n  targetObj.page.x = delta.page.x / dt\n  targetObj.page.y = delta.page.y / dt\n  targetObj.client.x = delta.client.x / dt\n  targetObj.client.y = delta.client.y / dt\n  targetObj.timeStamp = dt\n}\n\nexport function setZeroCoords(targetObj: CoordsSetMember) {\n  targetObj.page.x = 0\n  targetObj.page.y = 0\n  targetObj.client.x = 0\n  targetObj.client.y = 0\n}\n\nexport function isNativePointer(pointer: any) {\n  return pointer instanceof dom.Event || pointer instanceof dom.Touch\n}\n\n// Get specified X/Y coords for mouse or event.touches[0]\nexport function getXY(type: string, pointer: PointerType | InteractEvent, xy: Point) {\n  xy = xy || ({} as Point)\n  type = type || 'page'\n\n  xy.x = pointer[(type + 'X') as 'pageX']\n  xy.y = pointer[(type + 'Y') as 'pageY']\n\n  return xy\n}\n\nexport function getPageXY(pointer: PointerType | InteractEvent, page?: Point) {\n  page = page || { x: 0, y: 0 }\n\n  // Opera Mobile handles the viewport and scrolling oddly\n  if (browser.isOperaMobile && isNativePointer(pointer)) {\n    getXY('screen', pointer, page)\n\n    page.x += window.scrollX\n    page.y += window.scrollY\n  } else {\n    getXY('page', pointer, page)\n  }\n\n  return page\n}\n\nexport function getClientXY(pointer: PointerType, client: Point) {\n  client = client || ({} as any)\n\n  if (browser.isOperaMobile && isNativePointer(pointer)) {\n    // Opera Mobile handles the viewport and scrolling oddly\n    getXY('screen', pointer, client)\n  } else {\n    getXY('client', pointer, client)\n  }\n\n  return client\n}\n\nexport function getPointerId(pointer: { pointerId?: number; identifier?: number; type?: string }) {\n  return is.number(pointer.pointerId) ? pointer.pointerId! : pointer.identifier!\n}\n\nexport function setCoords(dest: CoordsSetMember, pointers: any[], timeStamp: number) {\n  const pointer = pointers.length > 1 ? pointerAverage(pointers) : pointers[0]\n\n  getPageXY(pointer, dest.page)\n  getClientXY(pointer, dest.client)\n\n  dest.timeStamp = timeStamp\n}\n\nexport function getTouchPair(event: TouchEvent | PointerType[]) {\n  const touches: PointerType[] = []\n\n  // array of touches is supplied\n  if (is.array(event)) {\n    touches[0] = event[0]\n    touches[1] = event[1]\n  }\n  // an event\n  else {\n    if (event.type === 'touchend') {\n      if (event.touches.length === 1) {\n        touches[0] = event.touches[0]\n        touches[1] = event.changedTouches[0]\n      } else if (event.touches.length === 0) {\n        touches[0] = event.changedTouches[0]\n        touches[1] = event.changedTouches[1]\n      }\n    } else {\n      touches[0] = event.touches[0]\n      touches[1] = event.touches[1]\n    }\n  }\n\n  return touches\n}\n\nexport function pointerAverage(pointers: PointerType[]) {\n  const average = {\n    pageX: 0,\n    pageY: 0,\n    clientX: 0,\n    clientY: 0,\n    screenX: 0,\n    screenY: 0,\n  }\n\n  type CoordKeys = keyof typeof average\n\n  for (const pointer of pointers) {\n    for (const prop in average) {\n      average[prop as CoordKeys] += pointer[prop as CoordKeys]\n    }\n  }\n  for (const prop in average) {\n    average[prop as CoordKeys] /= pointers.length\n  }\n\n  return average\n}\n\nexport function touchBBox(event: PointerType[]) {\n  if (!event.length) {\n    return null\n  }\n\n  const touches = getTouchPair(event)\n  const minX = Math.min(touches[0].pageX, touches[1].pageX)\n  const minY = Math.min(touches[0].pageY, touches[1].pageY)\n  const maxX = Math.max(touches[0].pageX, touches[1].pageX)\n  const maxY = Math.max(touches[0].pageY, touches[1].pageY)\n\n  return {\n    x: minX,\n    y: minY,\n    left: minX,\n    top: minY,\n    right: maxX,\n    bottom: maxY,\n    width: maxX - minX,\n    height: maxY - minY,\n  }\n}\n\nexport function touchDistance(event: PointerType[] | TouchEvent, deltaSource: string) {\n  const sourceX = (deltaSource + 'X') as 'pageX'\n  const sourceY = (deltaSource + 'Y') as 'pageY'\n  const touches = getTouchPair(event)\n\n  const dx = touches[0][sourceX] - touches[1][sourceX]\n  const dy = touches[0][sourceY] - touches[1][sourceY]\n\n  return hypot(dx, dy)\n}\n\nexport function touchAngle(event: PointerType[] | TouchEvent, deltaSource: string) {\n  const sourceX = (deltaSource + 'X') as 'pageX'\n  const sourceY = (deltaSource + 'Y') as 'pageY'\n  const touches = getTouchPair(event)\n  const dx = touches[1][sourceX] - touches[0][sourceX]\n  const dy = touches[1][sourceY] - touches[0][sourceY]\n  const angle = (180 * Math.atan2(dy, dx)) / Math.PI\n\n  return angle\n}\n\nexport function getPointerType(pointer: { pointerType?: string; identifier?: number; type?: string }) {\n  return is.string(pointer.pointerType)\n    ? pointer.pointerType\n    : is.number(pointer.pointerType)\n      ? [undefined, undefined, 'touch', 'pen', 'mouse'][pointer.pointerType]!\n      : // if the PointerEvent API isn't available, then the \"pointer\" must\n        // be either a MouseEvent, TouchEvent, or Touch object\n        /touch/.test(pointer.type || '') || pointer instanceof dom.Touch\n        ? 'touch'\n        : 'mouse'\n}\n\n// [ event.target, event.currentTarget ]\nexport function getEventTargets(event: Event) {\n  const path = is.func(event.composedPath)\n    ? (event.composedPath() as Element[])\n    : (event as unknown as { path: Element[] }).path\n\n  return [\n    domUtils.getActualElement(path ? path[0] : (event.target as Element)),\n    domUtils.getActualElement(event.currentTarget as Element),\n  ]\n}\n\nexport function newCoords(): CoordsSetMember {\n  return {\n    page: { x: 0, y: 0 },\n    client: { x: 0, y: 0 },\n    timeStamp: 0,\n  }\n}\n\nexport function coordsToEvent(coords: MockCoords) {\n  const event = {\n    coords,\n    get page() {\n      return this.coords.page\n    },\n    get client() {\n      return this.coords.client\n    },\n    get timeStamp() {\n      return this.coords.timeStamp\n    },\n    get pageX() {\n      return this.coords.page.x\n    },\n    get pageY() {\n      return this.coords.page.y\n    },\n    get clientX() {\n      return this.coords.client.x\n    },\n    get clientY() {\n      return this.coords.client.y\n    },\n    get pointerId() {\n      return this.coords.pointerId\n    },\n    get target() {\n      return this.coords.target\n    },\n    get type() {\n      return this.coords.type\n    },\n    get pointerType() {\n      return this.coords.pointerType\n    },\n    get buttons() {\n      return this.coords.buttons\n    },\n    preventDefault() {},\n  }\n\n  return event as typeof event & PointerType & PointerEventType\n}\n\nexport interface MockCoords {\n  page: Point\n  client: Point\n  timeStamp?: number\n  pointerId?: any\n  target?: any\n  type?: string\n  pointerType?: string\n  buttons?: number\n}\n\nexport { pointerExtend }\n", "import type { Interactable } from '@interactjs/core/Interactable'\nimport type { Interaction, InteractionProxy } from '@interactjs/core/Interaction'\nimport type { ActionName } from '@interactjs/core/types'\n\nexport class BaseEvent<T extends ActionName | null = never> {\n  declare type: string\n  declare target: EventTarget\n  declare currentTarget: Node\n  declare interactable: Interactable\n  /** @internal */\n  declare _interaction: Interaction<T>\n  declare timeStamp: number\n  immediatePropagationStopped = false\n  propagationStopped = false\n\n  constructor(interaction: Interaction<T>) {\n    this._interaction = interaction\n  }\n\n  preventDefault() {}\n\n  /**\n   * Don't call any other listeners (even on the current target)\n   */\n  stopPropagation() {\n    this.propagationStopped = true\n  }\n\n  /**\n   * Don't call listeners on the remaining targets\n   */\n  stopImmediatePropagation() {\n    this.immediatePropagationStopped = this.propagationStopped = true\n  }\n}\n\n// defined outside of class definition to avoid assignment of undefined during\n// construction\nexport interface BaseEvent<T extends ActionName | null = never> {\n  interaction: InteractionProxy<T>\n}\n\n// getters and setters defined here to support typescript 3.6 and below which\n// don't support getter and setters in .d.ts files\nObject.defineProperty(BaseEvent.prototype, 'interaction', {\n  get(this: BaseEvent) {\n    return this._interaction._proxy\n  },\n  set(this: BaseEvent) {},\n})\n", "type Filter<T> = (element: T, index: number, array: T[]) => boolean\n\nexport const contains = <T>(array: T[], target: T) => array.indexOf(target) !== -1\n\nexport const remove = <T>(array: T[], target: T) => array.splice(array.indexOf(target), 1)\n\nexport const merge = <T, U>(target: Array<T | U>, source: U[]) => {\n  for (const item of source) {\n    target.push(item)\n  }\n\n  return target\n}\n\nexport const from = <T = any>(source: ArrayLike<T>) => merge([] as T[], source as T[])\n\nexport const findIndex = <T>(array: T[], func: Filter<T>) => {\n  for (let i = 0; i < array.length; i++) {\n    if (func(array[i], i, array)) {\n      return i\n    }\n  }\n\n  return -1\n}\n\nexport const find = <T = any>(array: T[], func: Filter<T>): T | undefined => array[findIndex(array, func)]\n", "import { BaseEvent } from '@interactjs/core/BaseEvent'\nimport type { Interactable } from '@interactjs/core/Interactable'\nimport type { InteractEvent } from '@interactjs/core/InteractEvent'\nimport type { Element } from '@interactjs/core/types'\nimport * as arr from '@interactjs/utils/arr'\n\nimport type { DropState } from './plugin'\n\nexport class DropEvent extends BaseEvent<'drag'> {\n  declare target: Element\n  dropzone: Interactable\n  dragEvent: InteractEvent<'drag'>\n  relatedTarget: Element\n  draggable: Interactable\n  propagationStopped = false\n  immediatePropagationStopped = false\n\n  /**\n   * Class of events fired on dropzones during drags with acceptable targets.\n   */\n  constructor(dropState: DropState, dragEvent: InteractEvent<'drag'>, type: string) {\n    super(dragEvent._interaction)\n\n    const { element, dropzone } = type === 'dragleave' ? dropState.prev : dropState.cur\n\n    this.type = type\n    this.target = element\n    this.currentTarget = element\n    this.dropzone = dropzone\n    this.dragEvent = dragEvent\n    this.relatedTarget = dragEvent.target\n    this.draggable = dragEvent.interactable\n    this.timeStamp = dragEvent.timeStamp\n  }\n\n  /**\n   * If this is a `dropactivate` event, the dropzone element will be\n   * deactivated.\n   *\n   * If this is a `dragmove` or `dragenter`, a `dragleave` will be fired on the\n   * dropzone element and more.\n   */\n  reject() {\n    const { dropState } = this._interaction\n\n    if (\n      this.type !== 'dropactivate' &&\n      (!this.dropzone || dropState.cur.dropzone !== this.dropzone || dropState.cur.element !== this.target)\n    ) {\n      return\n    }\n\n    dropState.prev.dropzone = this.dropzone\n    dropState.prev.element = this.target\n\n    dropState.rejected = true\n    dropState.events.enter = null\n\n    this.stopImmediatePropagation()\n\n    if (this.type === 'dropactivate') {\n      const activeDrops = dropState.activeDrops\n      const index = arr.findIndex(\n        activeDrops,\n        ({ dropzone, element }) => dropzone === this.dropzone && element === this.target,\n      )\n\n      dropState.activeDrops.splice(index, 1)\n\n      const deactivateEvent = new DropEvent(dropState, this.dragEvent, 'dropdeactivate')\n\n      deactivateEvent.dropzone = this.dropzone\n      deactivateEvent.target = this.target\n\n      this.dropzone.fire(deactivateEvent)\n    } else {\n      this.dropzone.fire(new DropEvent(dropState, this.dragEvent, 'dragleave'))\n    }\n  }\n\n  preventDefault() {}\n\n  stopPropagation() {\n    this.propagationStopped = true\n  }\n\n  stopImmediatePropagation() {\n    this.immediatePropagationStopped = this.propagationStopped = true\n  }\n}\n", "import type { Interactable } from '@interactjs/core/Interactable'\nimport type { EventPhase, InteractEvent } from '@interactjs/core/InteractEvent'\nimport type { Interaction, DoPhaseArg } from '@interactjs/core/Interaction'\nimport type { PerActionDefaults } from '@interactjs/core/options'\nimport type { Scope, Plugin } from '@interactjs/core/scope'\nimport type { Element, PointerEventType, Rect, ListenersArg } from '@interactjs/core/types'\nimport * as domUtils from '@interactjs/utils/domUtils'\nimport extend from '@interactjs/utils/extend'\nimport getOriginXY from '@interactjs/utils/getOriginXY'\nimport is from '@interactjs/utils/is'\nimport normalizeListeners from '@interactjs/utils/normalizeListeners'\nimport * as pointerUtils from '@interactjs/utils/pointerUtils'\n\n/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport '../drag/plugin'\n\nimport type { DragEvent } from '../drag/plugin'\nimport drag from '../drag/plugin'\n/* eslint-enable import/no-duplicates */\n\nimport { DropEvent } from './DropEvent'\n\nexport type DropFunctionChecker = (\n  dragEvent: any, // related drag operation\n  event: any, // touch or mouse EventEmitter\n  dropped: boolean, // default checker result\n  dropzone: Interactable, // dropzone interactable\n  dropElement: Element, // drop zone element\n  draggable: Interactable, // draggable's Interactable\n  draggableElement: Element, // dragged element\n) => boolean\n\nexport interface DropzoneOptions extends PerActionDefaults {\n  accept?:\n    | string\n    | Element\n    | (({ dropzone, draggableElement }: { dropzone: Interactable; draggableElement: Element }) => boolean)\n  // How the overlap is checked on the drop zone\n  overlap?: 'pointer' | 'center' | number\n  checker?: DropFunctionChecker\n\n  ondropactivate?: ListenersArg\n  ondropdeactivate?: ListenersArg\n  ondragenter?: ListenersArg\n  ondragleave?: ListenersArg\n  ondropmove?: ListenersArg\n  ondrop?: ListenersArg\n}\n\nexport interface DropzoneMethod {\n  (this: Interactable, options: DropzoneOptions | boolean): Interactable\n  (): DropzoneOptions\n}\n\ndeclare module '@interactjs/core/Interactable' {\n  interface Interactable {\n    /**\n     *\n     * ```js\n     * interact('.drop').dropzone({\n     *   accept: '.can-drop' || document.getElementById('single-drop'),\n     *   overlap: 'pointer' || 'center' || zeroToOne\n     * }\n     * ```\n     *\n     * Returns or sets whether draggables can be dropped onto this target to\n     * trigger drop events\n     *\n     * Dropzones can receive the following events:\n     *  - `dropactivate` and `dropdeactivate` when an acceptable drag starts and ends\n     *  - `dragenter` and `dragleave` when a draggable enters and leaves the dropzone\n     *  - `dragmove` when a draggable that has entered the dropzone is moved\n     *  - `drop` when a draggable is dropped into this dropzone\n     *\n     * Use the `accept` option to allow only elements that match the given CSS\n     * selector or element. The value can be:\n     *\n     *  - **an Element** - only that element can be dropped into this dropzone.\n     *  - **a string**, - the element being dragged must match it as a CSS selector.\n     *  - **`null`** - accept options is cleared - it accepts any element.\n     *\n     * Use the `overlap` option to set how drops are checked for. The allowed\n     * values are:\n     *\n     *   - `'pointer'`, the pointer must be over the dropzone (default)\n     *   - `'center'`, the draggable element's center must be over the dropzone\n     *   - a number from 0-1 which is the `(intersection area) / (draggable area)`.\n     *   e.g. `0.5` for drop to happen when half of the area of the draggable is\n     *   over the dropzone\n     *\n     * Use the `checker` option to specify a function to check if a dragged element\n     * is over this Interactable.\n     *\n     * @param options - The new options to be set\n     */\n    dropzone(options: DropzoneOptions | boolean): Interactable\n    /** @returns The current setting */\n    dropzone(): DropzoneOptions\n\n    /**\n     * ```js\n     * interact(target)\n     * .dropChecker(function(dragEvent,         // related dragmove or dragend event\n     *                       event,             // TouchEvent/PointerEvent/MouseEvent\n     *                       dropped,           // bool result of the default checker\n     *                       dropzone,          // dropzone Interactable\n     *                       dropElement,       // dropzone elemnt\n     *                       draggable,         // draggable Interactable\n     *                       draggableElement) {// draggable element\n     *\n     *   return dropped && event.target.hasAttribute('allow-drop')\n     * }\n     * ```\n     */\n    dropCheck(\n      dragEvent: InteractEvent,\n      event: PointerEventType,\n      draggable: Interactable,\n      draggableElement: Element,\n      dropElemen: Element,\n      rect: any,\n    ): boolean\n  }\n}\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction {\n    dropState?: DropState\n  }\n}\n\ndeclare module '@interactjs/core/InteractEvent' {\n  interface InteractEvent {\n    /** @internal */\n    prevDropzone?: Interactable\n    dropzone?: Interactable\n    dragEnter?: Element\n    dragLeave?: Element\n  }\n}\n\ndeclare module '@interactjs/core/options' {\n  interface ActionDefaults {\n    drop: DropzoneOptions\n  }\n}\n\ndeclare module '@interactjs/core/scope' {\n  interface Scope {\n    dynamicDrop?: boolean\n  }\n\n  interface SignalArgs {\n    'actions/drop:start': DropSignalArg\n    'actions/drop:move': DropSignalArg\n    'actions/drop:end': DropSignalArg\n  }\n}\n\ndeclare module '@interactjs/core/types' {\n  interface ActionMap {\n    drop?: typeof drop\n  }\n}\n\ndeclare module '@interactjs/core/InteractStatic' {\n  interface InteractStatic {\n    /**\n     * Returns or sets whether the dimensions of dropzone elements are calculated\n     * on every dragmove or only on dragstart for the default dropChecker\n     *\n     * @param {boolean} [newValue] True to check on each move. False to check only\n     * before start\n     * @return {boolean | interact} The current setting or interact\n     */\n    dynamicDrop: (newValue?: boolean) => boolean | this\n  }\n}\n\ninterface DropSignalArg {\n  interaction: Interaction<'drag'>\n  dragEvent: DragEvent\n}\n\nexport interface ActiveDrop {\n  dropzone: Interactable\n  element: Element\n  rect: Rect\n}\n\nexport interface DropState {\n  cur: {\n    // the dropzone a drag target might be dropped into\n    dropzone: Interactable\n    // the element at the time of checking\n    element: Element\n  }\n  prev: {\n    // the dropzone that was recently dragged away from\n    dropzone: Interactable\n    // the element at the time of checking\n    element: Element\n  }\n  // wheather the potential drop was rejected from a listener\n  rejected: boolean\n  // the drop events related to the current drag event\n  events: FiredDropEvents\n  activeDrops: ActiveDrop[]\n}\n\nfunction install(scope: Scope) {\n  const { actions, interactStatic: interact, Interactable, defaults } = scope\n\n  scope.usePlugin(drag)\n\n  Interactable.prototype.dropzone = function (this: Interactable, options) {\n    return dropzoneMethod(this, options)\n  } as Interactable['dropzone']\n\n  Interactable.prototype.dropCheck = function (\n    this: Interactable,\n    dragEvent,\n    event,\n    draggable,\n    draggableElement,\n    dropElement,\n    rect,\n  ) {\n    return dropCheckMethod(this, dragEvent, event, draggable, draggableElement, dropElement, rect)\n  }\n\n  interact.dynamicDrop = function (newValue?: boolean) {\n    if (is.bool(newValue)) {\n      // if (dragging && scope.dynamicDrop !== newValue && !newValue) {\n      //  calcRects(dropzones)\n      // }\n\n      scope.dynamicDrop = newValue\n\n      return interact\n    }\n    return scope.dynamicDrop!\n  }\n\n  extend(actions.phaselessTypes, {\n    dragenter: true,\n    dragleave: true,\n    dropactivate: true,\n    dropdeactivate: true,\n    dropmove: true,\n    drop: true,\n  })\n  actions.methodDict.drop = 'dropzone'\n\n  scope.dynamicDrop = false\n\n  defaults.actions.drop = drop.defaults\n}\n\nfunction collectDropzones({ interactables }: Scope, draggableElement: Element) {\n  const drops: ActiveDrop[] = []\n\n  // collect all dropzones and their elements which qualify for a drop\n  for (const dropzone of interactables.list) {\n    if (!dropzone.options.drop.enabled) {\n      continue\n    }\n\n    const accept = dropzone.options.drop.accept\n\n    // test the draggable draggableElement against the dropzone's accept setting\n    if (\n      (is.element(accept) && accept !== draggableElement) ||\n      (is.string(accept) && !domUtils.matchesSelector(draggableElement, accept)) ||\n      (is.func(accept) && !accept({ dropzone, draggableElement }))\n    ) {\n      continue\n    }\n\n    for (const dropzoneElement of dropzone.getAllElements()) {\n      if (dropzoneElement !== draggableElement) {\n        drops.push({\n          dropzone,\n          element: dropzoneElement,\n          rect: dropzone.getRect(dropzoneElement),\n        })\n      }\n    }\n  }\n\n  return drops\n}\n\nfunction fireActivationEvents(activeDrops: ActiveDrop[], event: DropEvent) {\n  // loop through all active dropzones and trigger event\n  for (const { dropzone, element } of activeDrops.slice()) {\n    event.dropzone = dropzone\n\n    // set current element as event target\n    event.target = element\n    dropzone.fire(event)\n    event.propagationStopped = event.immediatePropagationStopped = false\n  }\n}\n\n// return a new array of possible drops. getActiveDrops should always be\n// called when a drag has just started or a drag event happens while\n// dynamicDrop is true\nfunction getActiveDrops(scope: Scope, dragElement: Element) {\n  // get dropzones and their elements that could receive the draggable\n  const activeDrops = collectDropzones(scope, dragElement)\n\n  for (const activeDrop of activeDrops) {\n    activeDrop.rect = activeDrop.dropzone.getRect(activeDrop.element)\n  }\n\n  return activeDrops\n}\n\nfunction getDrop(\n  { dropState, interactable: draggable, element: dragElement }: Interaction,\n  dragEvent,\n  pointerEvent,\n) {\n  const validDrops: Element[] = []\n\n  // collect all dropzones and their elements which qualify for a drop\n  for (const { dropzone, element: dropzoneElement, rect } of dropState.activeDrops) {\n    const isValid = dropzone.dropCheck(\n      dragEvent,\n      pointerEvent,\n      draggable!,\n      dragElement!,\n      dropzoneElement,\n      rect,\n    )\n    validDrops.push(isValid ? dropzoneElement : null)\n  }\n\n  // get the most appropriate dropzone based on DOM depth and order\n  const dropIndex = domUtils.indexOfDeepestElement(validDrops)\n\n  return dropState!.activeDrops[dropIndex] || null\n}\n\nfunction getDropEvents(interaction: Interaction, _pointerEvent, dragEvent: DragEvent) {\n  const dropState = interaction.dropState!\n  const dropEvents: Record<string, DropEvent | null> = {\n    enter: null,\n    leave: null,\n    activate: null,\n    deactivate: null,\n    move: null,\n    drop: null,\n  }\n\n  if (dragEvent.type === 'dragstart') {\n    dropEvents.activate = new DropEvent(dropState, dragEvent, 'dropactivate')\n\n    dropEvents.activate.target = null as never\n    dropEvents.activate.dropzone = null as never\n  }\n  if (dragEvent.type === 'dragend') {\n    dropEvents.deactivate = new DropEvent(dropState, dragEvent, 'dropdeactivate')\n\n    dropEvents.deactivate.target = null as never\n    dropEvents.deactivate.dropzone = null as never\n  }\n\n  if (dropState.rejected) {\n    return dropEvents\n  }\n\n  if (dropState.cur.element !== dropState.prev.element) {\n    // if there was a previous dropzone, create a dragleave event\n    if (dropState.prev.dropzone) {\n      dropEvents.leave = new DropEvent(dropState, dragEvent, 'dragleave')\n\n      dragEvent.dragLeave = dropEvents.leave.target = dropState.prev.element\n      dragEvent.prevDropzone = dropEvents.leave.dropzone = dropState.prev.dropzone\n    }\n    // if dropzone is not null, create a dragenter event\n    if (dropState.cur.dropzone) {\n      dropEvents.enter = new DropEvent(dropState, dragEvent, 'dragenter')\n\n      dragEvent.dragEnter = dropState.cur.element\n      dragEvent.dropzone = dropState.cur.dropzone\n    }\n  }\n\n  if (dragEvent.type === 'dragend' && dropState.cur.dropzone) {\n    dropEvents.drop = new DropEvent(dropState, dragEvent, 'drop')\n\n    dragEvent.dropzone = dropState.cur.dropzone\n    dragEvent.relatedTarget = dropState.cur.element\n  }\n  if (dragEvent.type === 'dragmove' && dropState.cur.dropzone) {\n    dropEvents.move = new DropEvent(dropState, dragEvent, 'dropmove')\n\n    dragEvent.dropzone = dropState.cur.dropzone\n  }\n\n  return dropEvents\n}\n\ntype FiredDropEvents = Partial<\n  Record<'leave' | 'enter' | 'move' | 'drop' | 'activate' | 'deactivate', DropEvent>\n>\n\nfunction fireDropEvents(interaction: Interaction, events: FiredDropEvents) {\n  const dropState = interaction.dropState!\n  const { activeDrops, cur, prev } = dropState\n\n  if (events.leave) {\n    prev.dropzone.fire(events.leave)\n  }\n  if (events.enter) {\n    cur.dropzone.fire(events.enter)\n  }\n  if (events.move) {\n    cur.dropzone.fire(events.move)\n  }\n  if (events.drop) {\n    cur.dropzone.fire(events.drop)\n  }\n\n  if (events.deactivate) {\n    fireActivationEvents(activeDrops, events.deactivate)\n  }\n\n  dropState.prev.dropzone = cur.dropzone\n  dropState.prev.element = cur.element\n}\n\nfunction onEventCreated({ interaction, iEvent, event }: DoPhaseArg<'drag', EventPhase>, scope: Scope) {\n  if (iEvent.type !== 'dragmove' && iEvent.type !== 'dragend') {\n    return\n  }\n\n  const dropState = interaction.dropState!\n\n  if (scope.dynamicDrop) {\n    dropState.activeDrops = getActiveDrops(scope, interaction.element!)\n  }\n\n  const dragEvent = iEvent\n  const dropResult = getDrop(interaction, dragEvent, event)\n\n  // update rejected status\n  dropState.rejected =\n    dropState.rejected &&\n    !!dropResult &&\n    dropResult.dropzone === dropState.cur.dropzone &&\n    dropResult.element === dropState.cur.element\n\n  dropState.cur.dropzone = dropResult && dropResult.dropzone\n  dropState.cur.element = dropResult && dropResult.element\n\n  dropState.events = getDropEvents(interaction, event, dragEvent)\n}\n\nfunction dropzoneMethod(interactable: Interactable): DropzoneOptions\nfunction dropzoneMethod(interactable: Interactable, options: DropzoneOptions | boolean): Interactable\nfunction dropzoneMethod(interactable: Interactable, options?: DropzoneOptions | boolean) {\n  if (is.object(options)) {\n    interactable.options.drop.enabled = options.enabled !== false\n\n    if (options.listeners) {\n      const normalized = normalizeListeners(options.listeners)\n      // rename 'drop' to '' as it will be prefixed with 'drop'\n      const corrected = Object.keys(normalized).reduce((acc, type) => {\n        const correctedType = /^(enter|leave)/.test(type)\n          ? `drag${type}`\n          : /^(activate|deactivate|move)/.test(type)\n            ? `drop${type}`\n            : type\n\n        acc[correctedType] = normalized[type]\n\n        return acc\n      }, {})\n\n      const prevListeners = interactable.options.drop.listeners\n      prevListeners && interactable.off(prevListeners)\n\n      interactable.on(corrected)\n      interactable.options.drop.listeners = corrected\n    }\n\n    if (is.func(options.ondrop)) {\n      interactable.on('drop', options.ondrop)\n    }\n    if (is.func(options.ondropactivate)) {\n      interactable.on('dropactivate', options.ondropactivate)\n    }\n    if (is.func(options.ondropdeactivate)) {\n      interactable.on('dropdeactivate', options.ondropdeactivate)\n    }\n    if (is.func(options.ondragenter)) {\n      interactable.on('dragenter', options.ondragenter)\n    }\n    if (is.func(options.ondragleave)) {\n      interactable.on('dragleave', options.ondragleave)\n    }\n    if (is.func(options.ondropmove)) {\n      interactable.on('dropmove', options.ondropmove)\n    }\n\n    if (/^(pointer|center)$/.test(options.overlap as string)) {\n      interactable.options.drop.overlap = options.overlap\n    } else if (is.number(options.overlap)) {\n      interactable.options.drop.overlap = Math.max(Math.min(1, options.overlap), 0)\n    }\n    if ('accept' in options) {\n      interactable.options.drop.accept = options.accept\n    }\n    if ('checker' in options) {\n      interactable.options.drop.checker = options.checker\n    }\n\n    return interactable\n  }\n\n  if (is.bool(options)) {\n    interactable.options.drop.enabled = options\n\n    return interactable\n  }\n\n  return interactable.options.drop\n}\n\nfunction dropCheckMethod(\n  interactable: Interactable,\n  dragEvent: InteractEvent,\n  event: PointerEventType,\n  draggable: Interactable,\n  draggableElement: Element,\n  dropElement: Element,\n  rect: any,\n) {\n  let dropped = false\n\n  // if the dropzone has no rect (eg. display: none)\n  // call the custom dropChecker or just return false\n  if (!(rect = rect || interactable.getRect(dropElement))) {\n    return interactable.options.drop.checker\n      ? interactable.options.drop.checker(\n          dragEvent,\n          event,\n          dropped,\n          interactable,\n          dropElement,\n          draggable,\n          draggableElement,\n        )\n      : false\n  }\n\n  const dropOverlap = interactable.options.drop.overlap\n\n  if (dropOverlap === 'pointer') {\n    const origin = getOriginXY(draggable, draggableElement, 'drag')\n    const page = pointerUtils.getPageXY(dragEvent)\n\n    page.x += origin.x\n    page.y += origin.y\n\n    const horizontal = page.x > rect.left && page.x < rect.right\n    const vertical = page.y > rect.top && page.y < rect.bottom\n\n    dropped = horizontal && vertical\n  }\n\n  const dragRect = draggable.getRect(draggableElement)\n\n  if (dragRect && dropOverlap === 'center') {\n    const cx = dragRect.left + dragRect.width / 2\n    const cy = dragRect.top + dragRect.height / 2\n\n    dropped = cx >= rect.left && cx <= rect.right && cy >= rect.top && cy <= rect.bottom\n  }\n\n  if (dragRect && is.number(dropOverlap)) {\n    const overlapArea =\n      Math.max(0, Math.min(rect.right, dragRect.right) - Math.max(rect.left, dragRect.left)) *\n      Math.max(0, Math.min(rect.bottom, dragRect.bottom) - Math.max(rect.top, dragRect.top))\n\n    const overlapRatio = overlapArea / (dragRect.width * dragRect.height)\n\n    dropped = overlapRatio >= dropOverlap\n  }\n\n  if (interactable.options.drop.checker) {\n    dropped = interactable.options.drop.checker(\n      dragEvent,\n      event,\n      dropped,\n      interactable,\n      dropElement,\n      draggable,\n      draggableElement,\n    )\n  }\n\n  return dropped\n}\n\nconst drop: Plugin = {\n  id: 'actions/drop',\n  install,\n  listeners: {\n    'interactions:before-action-start': ({ interaction }) => {\n      if (interaction.prepared.name !== 'drag') {\n        return\n      }\n\n      interaction.dropState = {\n        cur: {\n          dropzone: null,\n          element: null,\n        },\n        prev: {\n          dropzone: null,\n          element: null,\n        },\n        rejected: null,\n        events: null,\n        activeDrops: [],\n      }\n    },\n\n    'interactions:after-action-start': (\n      { interaction, event, iEvent: dragEvent }: DoPhaseArg<'drag', EventPhase>,\n      scope,\n    ) => {\n      if (interaction.prepared.name !== 'drag') {\n        return\n      }\n\n      const dropState = interaction.dropState!\n\n      // reset active dropzones\n      dropState.activeDrops = []\n      dropState.events = {}\n      dropState.activeDrops = getActiveDrops(scope, interaction.element!)\n      dropState.events = getDropEvents(interaction, event, dragEvent)\n\n      if (dropState.events.activate) {\n        fireActivationEvents(dropState.activeDrops, dropState.events.activate)\n        scope.fire('actions/drop:start', { interaction, dragEvent })\n      }\n    },\n\n    'interactions:action-move': onEventCreated,\n\n    'interactions:after-action-move': (\n      { interaction, iEvent: dragEvent }: DoPhaseArg<'drag', EventPhase>,\n      scope,\n    ) => {\n      if (interaction.prepared.name !== 'drag') {\n        return\n      }\n\n      const dropState = interaction.dropState!\n      fireDropEvents(interaction, dropState.events)\n\n      scope.fire('actions/drop:move', { interaction, dragEvent })\n      dropState.events = {}\n    },\n\n    'interactions:action-end': (arg: DoPhaseArg<'drag', EventPhase>, scope) => {\n      if (arg.interaction.prepared.name !== 'drag') {\n        return\n      }\n\n      const { interaction, iEvent: dragEvent } = arg\n\n      onEventCreated(arg, scope)\n      fireDropEvents(interaction, interaction.dropState!.events)\n      scope.fire('actions/drop:end', { interaction, dragEvent })\n    },\n\n    'interactions:stop': ({ interaction }) => {\n      if (interaction.prepared.name !== 'drag') {\n        return\n      }\n\n      const { dropState } = interaction\n\n      if (dropState) {\n        dropState.activeDrops = null as never\n        dropState.events = null as never\n        dropState.cur.dropzone = null as never\n        dropState.cur.element = null as never\n        dropState.prev.dropzone = null as never\n        dropState.prev.element = null as never\n        dropState.rejected = false\n      }\n    },\n  },\n  getActiveDrops,\n  getDrop,\n  getDropEvents,\n  fireDropEvents,\n\n  filterEventType: (type: string) => type.search('drag') === 0 || type.search('drop') === 0,\n\n  defaults: {\n    enabled: false,\n    accept: null as never,\n    overlap: 'pointer',\n  } as DropzoneOptions,\n}\n\nexport default drop\n", "import type { Interactable } from '@interactjs/core/Interactable'\nimport type { InteractEvent, EventPhase } from '@interactjs/core/InteractEvent'\nimport type { Interaction, DoPhaseArg } from '@interactjs/core/Interaction'\nimport type { PerActionDefaults } from '@interactjs/core/options'\nimport type { Scope, Plugin } from '@interactjs/core/scope'\nimport type { Rect, PointerType, ListenersArg, OrBoolean } from '@interactjs/core/types'\nimport is from '@interactjs/utils/is'\nimport * as pointerUtils from '@interactjs/utils/pointerUtils'\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction {\n    gesture?: {\n      angle: number // angle from first to second touch\n      distance: number\n      scale: number // gesture.distance / gesture.startDistance\n      startAngle: number // angle of line joining two touches\n      startDistance: number // distance between two touches of touchStart\n    }\n  }\n}\n\ndeclare module '@interactjs/core/Interactable' {\n  interface Interactable {\n    gesturable(options: Partial<OrBoolean<GesturableOptions>> | boolean): this\n    gesturable(): GesturableOptions\n    /**\n     * ```js\n     * interact(element).gesturable({\n     *     onstart: function (event) {},\n     *     onmove : function (event) {},\n     *     onend  : function (event) {},\n     *\n     *     // limit multiple gestures.\n     *     // See the explanation in {@link Interactable.draggable} example\n     *     max: Infinity,\n     *     maxPerElement: 1,\n     * })\n     *\n     * var isGestureable = interact(element).gesturable()\n     * ```\n     *\n     * Gets or sets whether multitouch gestures can be performed on the target\n     *\n     * @param options - true/false or An object with event listeners to be fired on gesture events (makes the Interactable gesturable)\n     * @returns A boolean indicating if this can be the target of gesture events, or this Interactable\n     */\n    gesturable(options?: Partial<OrBoolean<GesturableOptions>> | boolean): this | GesturableOptions\n  }\n}\n\ndeclare module '@interactjs/core/options' {\n  interface ActionDefaults {\n    gesture: GesturableOptions\n  }\n}\n\ndeclare module '@interactjs/core/types' {\n  interface ActionMap {\n    gesture?: typeof gesture\n  }\n}\n\nexport interface GesturableOptions extends PerActionDefaults {\n  onstart?: ListenersArg\n  onmove?: ListenersArg\n  onend?: ListenersArg\n}\n\nexport interface GestureEvent extends InteractEvent<'gesture'> {\n  distance: number\n  angle: number\n  da: number // angle change\n  scale: number // ratio of distance start to current event\n  ds: number // scale change\n  box: Rect // enclosing box of all points\n  touches: PointerType[]\n}\n\nexport interface GestureSignalArg extends DoPhaseArg<'gesture', EventPhase> {\n  iEvent: GestureEvent\n  interaction: Interaction<'gesture'>\n}\n\nfunction install(scope: Scope) {\n  const { actions, Interactable, defaults } = scope\n\n  Interactable.prototype.gesturable = function (\n    this: InstanceType<typeof Interactable>,\n    options: GesturableOptions | boolean,\n  ) {\n    if (is.object(options)) {\n      this.options.gesture.enabled = options.enabled !== false\n      this.setPerAction('gesture', options)\n      this.setOnEvents('gesture', options)\n\n      return this\n    }\n\n    if (is.bool(options)) {\n      this.options.gesture.enabled = options\n\n      return this\n    }\n\n    return this.options.gesture as GesturableOptions\n  } as Interactable['gesturable']\n\n  actions.map.gesture = gesture\n  actions.methodDict.gesture = 'gesturable'\n\n  defaults.actions.gesture = gesture.defaults\n}\n\nfunction updateGestureProps({ interaction, iEvent, phase }: GestureSignalArg) {\n  if (interaction.prepared.name !== 'gesture') return\n\n  const pointers = interaction.pointers.map((p) => p.pointer)\n  const starting = phase === 'start'\n  const ending = phase === 'end'\n  const deltaSource = interaction.interactable.options.deltaSource\n\n  iEvent.touches = [pointers[0], pointers[1]]\n\n  if (starting) {\n    iEvent.distance = pointerUtils.touchDistance(pointers, deltaSource)\n    iEvent.box = pointerUtils.touchBBox(pointers)\n    iEvent.scale = 1\n    iEvent.ds = 0\n    iEvent.angle = pointerUtils.touchAngle(pointers, deltaSource)\n    iEvent.da = 0\n\n    interaction.gesture.startDistance = iEvent.distance\n    interaction.gesture.startAngle = iEvent.angle\n  } else if (ending || interaction.pointers.length < 2) {\n    const prevEvent = interaction.prevEvent as GestureEvent\n\n    iEvent.distance = prevEvent.distance\n    iEvent.box = prevEvent.box\n    iEvent.scale = prevEvent.scale\n    iEvent.ds = 0\n    iEvent.angle = prevEvent.angle\n    iEvent.da = 0\n  } else {\n    iEvent.distance = pointerUtils.touchDistance(pointers, deltaSource)\n    iEvent.box = pointerUtils.touchBBox(pointers)\n    iEvent.scale = iEvent.distance / interaction.gesture.startDistance\n    iEvent.angle = pointerUtils.touchAngle(pointers, deltaSource)\n\n    iEvent.ds = iEvent.scale - interaction.gesture.scale\n    iEvent.da = iEvent.angle - interaction.gesture.angle\n  }\n\n  interaction.gesture.distance = iEvent.distance\n  interaction.gesture.angle = iEvent.angle\n\n  if (is.number(iEvent.scale) && iEvent.scale !== Infinity && !isNaN(iEvent.scale)) {\n    interaction.gesture.scale = iEvent.scale\n  }\n}\n\nconst gesture: Plugin = {\n  id: 'actions/gesture',\n  before: ['actions/drag', 'actions/resize'],\n  install,\n  listeners: {\n    'interactions:action-start': updateGestureProps,\n    'interactions:action-move': updateGestureProps,\n    'interactions:action-end': updateGestureProps,\n\n    'interactions:new': ({ interaction }) => {\n      interaction.gesture = {\n        angle: 0,\n        distance: 0,\n        scale: 1,\n        startAngle: 0,\n        startDistance: 0,\n      }\n    },\n\n    'auto-start:check': (arg) => {\n      if (arg.interaction.pointers.length < 2) {\n        return undefined\n      }\n\n      const gestureOptions = arg.interactable.options.gesture\n\n      if (!(gestureOptions && gestureOptions.enabled)) {\n        return undefined\n      }\n\n      arg.action = { name: 'gesture' }\n\n      return false\n    },\n  },\n\n  defaults: {},\n\n  getCursor() {\n    return ''\n  },\n\n  filterEventType: (type: string) => type.search('gesture') === 0,\n}\n\nexport default gesture\n", "import type { Interactable } from '@interactjs/core/Interactable'\nimport type { EventPhase, InteractEvent } from '@interactjs/core/InteractEvent'\nimport type { Interaction } from '@interactjs/core/Interaction'\nimport type { PerActionDefaults } from '@interactjs/core/options'\nimport type { Scope, Plugin } from '@interactjs/core/scope'\nimport type {\n  ActionName,\n  ActionProps,\n  EdgeOptions,\n  FullRect,\n  ListenersArg,\n  OrBoolean,\n  Point,\n  Rect,\n} from '@interactjs/core/types'\nimport * as dom from '@interactjs/utils/domUtils'\nimport extend from '@interactjs/utils/extend'\nimport is from '@interactjs/utils/is'\n\nexport type EdgeName = 'top' | 'left' | 'bottom' | 'right'\n\ndeclare module '@interactjs/core/Interactable' {\n  interface Interactable {\n    resizable(): ResizableOptions\n    resizable(options: Partial<OrBoolean<ResizableOptions>> | boolean): this\n    /**\n     * ```js\n     * interact(element).resizable({\n     *   onstart: function (event) {},\n     *   onmove : function (event) {},\n     *   onend  : function (event) {},\n     *\n     *   edges: {\n     *     top   : true,       // Use pointer coords to check for resize.\n     *     left  : false,      // Disable resizing from left edge.\n     *     bottom: '.resize-s',// Resize if pointer target matches selector\n     *     right : handleEl    // Resize if pointer target is the given Element\n     *   },\n     *\n     *   // Width and height can be adjusted independently. When `true`, width and\n     *   // height are adjusted at a 1:1 ratio.\n     *   square: false,\n     *\n     *   // Width and height can be adjusted independently. When `true`, width and\n     *   // height maintain the aspect ratio they had when resizing started.\n     *   preserveAspectRatio: false,\n     *\n     *   // a value of 'none' will limit the resize rect to a minimum of 0x0\n     *   // 'negate' will allow the rect to have negative width/height\n     *   // 'reposition' will keep the width/height positive by swapping\n     *   // the top and bottom edges and/or swapping the left and right edges\n     *   invert: 'none' || 'negate' || 'reposition'\n     *\n     *   // limit multiple resizes.\n     *   // See the explanation in the {@link Interactable.draggable} example\n     *   max: Infinity,\n     *   maxPerElement: 1,\n     * })\n     *\n     * var isResizeable = interact(element).resizable()\n     * ```\n     *\n     * Gets or sets whether resize actions can be performed on the target\n     *\n     * @param options - true/false or An object with event\n     * listeners to be fired on resize events (object makes the Interactable\n     * resizable)\n     * @returns A boolean indicating if this can be the\n     * target of resize elements, or this Interactable\n     */\n    resizable(options?: Partial<OrBoolean<ResizableOptions>> | boolean): this | ResizableOptions\n  }\n}\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction<T extends ActionName | null = ActionName> {\n    resizeAxes: 'x' | 'y' | 'xy'\n    styleCursor(newValue: boolean): this\n    styleCursor(): boolean\n    resizeStartAspectRatio: number\n  }\n}\n\ndeclare module '@interactjs/core/options' {\n  interface ActionDefaults {\n    resize: ResizableOptions\n  }\n}\n\ndeclare module '@interactjs/core/types' {\n  interface ActionMap {\n    resize?: typeof resize\n  }\n}\n\nexport interface ResizableOptions extends PerActionDefaults {\n  square?: boolean\n  preserveAspectRatio?: boolean\n  edges?: EdgeOptions | null\n  axis?: 'x' | 'y' | 'xy' // deprecated\n  invert?: 'none' | 'negate' | 'reposition'\n  margin?: number\n  squareResize?: boolean\n  oninertiastart?: ListenersArg\n  onstart?: ListenersArg\n  onmove?: ListenersArg\n  onend?: ListenersArg\n}\n\nexport interface ResizeEvent<P extends EventPhase = EventPhase> extends InteractEvent<'resize', P> {\n  deltaRect?: FullRect\n  edges?: ActionProps['edges']\n}\n\nfunction install(scope: Scope) {\n  const {\n    actions,\n    browser,\n    Interactable, // tslint:disable-line no-shadowed-variable\n    defaults,\n  } = scope\n\n  // Less Precision with touch input\n\n  resize.cursors = initCursors(browser)\n  resize.defaultMargin = browser.supportsTouch || browser.supportsPointerEvent ? 20 : 10\n\n  Interactable.prototype.resizable = function (this: Interactable, options: ResizableOptions | boolean) {\n    return resizable(this, options, scope)\n  } as Interactable['resizable']\n\n  actions.map.resize = resize\n  actions.methodDict.resize = 'resizable'\n\n  defaults.actions.resize = resize.defaults\n}\n\nfunction resizeChecker(arg) {\n  const { interaction, interactable, element, rect, buttons } = arg\n\n  if (!rect) {\n    return undefined\n  }\n\n  const page = extend({}, interaction.coords.cur.page)\n  const resizeOptions = interactable.options.resize\n\n  if (\n    !(resizeOptions && resizeOptions.enabled) ||\n    // check mouseButton setting if the pointer is down\n    (interaction.pointerIsDown &&\n      /mouse|pointer/.test(interaction.pointerType) &&\n      (buttons & resizeOptions.mouseButtons) === 0)\n  ) {\n    return undefined\n  }\n\n  // if using resize.edges\n  if (is.object(resizeOptions.edges)) {\n    const resizeEdges = {\n      left: false,\n      right: false,\n      top: false,\n      bottom: false,\n    }\n\n    for (const edge in resizeEdges) {\n      resizeEdges[edge] = checkResizeEdge(\n        edge,\n        resizeOptions.edges[edge],\n        page,\n        interaction._latestPointer.eventTarget,\n        element,\n        rect,\n        resizeOptions.margin || resize.defaultMargin,\n      )\n    }\n\n    resizeEdges.left = resizeEdges.left && !resizeEdges.right\n    resizeEdges.top = resizeEdges.top && !resizeEdges.bottom\n\n    if (resizeEdges.left || resizeEdges.right || resizeEdges.top || resizeEdges.bottom) {\n      arg.action = {\n        name: 'resize',\n        edges: resizeEdges,\n      }\n    }\n  } else {\n    const right = resizeOptions.axis !== 'y' && page.x > rect.right - resize.defaultMargin\n    const bottom = resizeOptions.axis !== 'x' && page.y > rect.bottom - resize.defaultMargin\n\n    if (right || bottom) {\n      arg.action = {\n        name: 'resize',\n        axes: (right ? 'x' : '') + (bottom ? 'y' : ''),\n      }\n    }\n  }\n\n  return arg.action ? false : undefined\n}\n\nfunction resizable(interactable: Interactable, options: OrBoolean<ResizableOptions> | boolean, scope: Scope) {\n  if (is.object(options)) {\n    interactable.options.resize.enabled = options.enabled !== false\n    interactable.setPerAction('resize', options)\n    interactable.setOnEvents('resize', options)\n\n    if (is.string(options.axis) && /^x$|^y$|^xy$/.test(options.axis)) {\n      interactable.options.resize.axis = options.axis\n    } else if (options.axis === null) {\n      interactable.options.resize.axis = scope.defaults.actions.resize.axis\n    }\n\n    if (is.bool(options.preserveAspectRatio)) {\n      interactable.options.resize.preserveAspectRatio = options.preserveAspectRatio\n    } else if (is.bool(options.square)) {\n      interactable.options.resize.square = options.square\n    }\n\n    return interactable\n  }\n  if (is.bool(options)) {\n    interactable.options.resize.enabled = options\n\n    return interactable\n  }\n  return interactable.options.resize\n}\n\nfunction checkResizeEdge(\n  name: string,\n  value: any,\n  page: Point,\n  element: Node,\n  interactableElement: Element,\n  rect: Rect,\n  margin: number,\n) {\n  // false, '', undefined, null\n  if (!value) {\n    return false\n  }\n\n  // true value, use pointer coords and element rect\n  if (value === true) {\n    // if dimensions are negative, \"switch\" edges\n    const width = is.number(rect.width) ? rect.width : rect.right - rect.left\n    const height = is.number(rect.height) ? rect.height : rect.bottom - rect.top\n\n    // don't use margin greater than half the relevent dimension\n    margin = Math.min(margin, Math.abs((name === 'left' || name === 'right' ? width : height) / 2))\n\n    if (width < 0) {\n      if (name === 'left') {\n        name = 'right'\n      } else if (name === 'right') {\n        name = 'left'\n      }\n    }\n    if (height < 0) {\n      if (name === 'top') {\n        name = 'bottom'\n      } else if (name === 'bottom') {\n        name = 'top'\n      }\n    }\n\n    if (name === 'left') {\n      const edge = width >= 0 ? rect.left : rect.right\n      return page.x < edge + margin\n    }\n    if (name === 'top') {\n      const edge = height >= 0 ? rect.top : rect.bottom\n      return page.y < edge + margin\n    }\n\n    if (name === 'right') {\n      return page.x > (width >= 0 ? rect.right : rect.left) - margin\n    }\n    if (name === 'bottom') {\n      return page.y > (height >= 0 ? rect.bottom : rect.top) - margin\n    }\n  }\n\n  // the remaining checks require an element\n  if (!is.element(element)) {\n    return false\n  }\n\n  return is.element(value)\n    ? // the value is an element to use as a resize handle\n      value === element\n    : // otherwise check if element matches value as selector\n      dom.matchesUpTo(element, value, interactableElement)\n}\n\n/* eslint-disable multiline-ternary */\n// eslint-disable-next-line @typescript-eslint/consistent-type-imports\nfunction initCursors(browser: typeof import('@interactjs/utils/browser').default) {\n  return browser.isIe9\n    ? {\n        x: 'e-resize',\n        y: 's-resize',\n        xy: 'se-resize',\n\n        top: 'n-resize',\n        left: 'w-resize',\n        bottom: 's-resize',\n        right: 'e-resize',\n        topleft: 'se-resize',\n        bottomright: 'se-resize',\n        topright: 'ne-resize',\n        bottomleft: 'ne-resize',\n      }\n    : {\n        x: 'ew-resize',\n        y: 'ns-resize',\n        xy: 'nwse-resize',\n\n        top: 'ns-resize',\n        left: 'ew-resize',\n        bottom: 'ns-resize',\n        right: 'ew-resize',\n        topleft: 'nwse-resize',\n        bottomright: 'nwse-resize',\n        topright: 'nesw-resize',\n        bottomleft: 'nesw-resize',\n      }\n}\n/* eslint-enable multiline-ternary */\n\nfunction start({ iEvent, interaction }: { iEvent: InteractEvent<any, any>; interaction: Interaction }) {\n  if (interaction.prepared.name !== 'resize' || !interaction.prepared.edges) {\n    return\n  }\n\n  const resizeEvent = iEvent as ResizeEvent\n  const rect = interaction.rect\n\n  interaction._rects = {\n    start: extend({}, rect),\n    corrected: extend({}, rect),\n    previous: extend({}, rect),\n    delta: {\n      left: 0,\n      right: 0,\n      width: 0,\n      top: 0,\n      bottom: 0,\n      height: 0,\n    },\n  }\n\n  resizeEvent.edges = interaction.prepared.edges\n  resizeEvent.rect = interaction._rects.corrected\n  resizeEvent.deltaRect = interaction._rects.delta\n}\n\nfunction move({ iEvent, interaction }: { iEvent: InteractEvent<any, any>; interaction: Interaction }) {\n  if (interaction.prepared.name !== 'resize' || !interaction.prepared.edges) return\n\n  const resizeEvent = iEvent as ResizeEvent\n  const resizeOptions = interaction.interactable.options.resize\n  const invert = resizeOptions.invert\n  const invertible = invert === 'reposition' || invert === 'negate'\n\n  const current = interaction.rect\n  const { start: startRect, corrected, delta: deltaRect, previous } = interaction._rects\n\n  extend(previous, corrected)\n\n  if (invertible) {\n    // if invertible, copy the current rect\n    extend(corrected, current)\n\n    if (invert === 'reposition') {\n      // swap edge values if necessary to keep width/height positive\n      if (corrected.top > corrected.bottom) {\n        const swap = corrected.top\n\n        corrected.top = corrected.bottom\n        corrected.bottom = swap\n      }\n      if (corrected.left > corrected.right) {\n        const swap = corrected.left\n\n        corrected.left = corrected.right\n        corrected.right = swap\n      }\n    }\n  } else {\n    // if not invertible, restrict to minimum of 0x0 rect\n    corrected.top = Math.min(current.top, startRect.bottom)\n    corrected.bottom = Math.max(current.bottom, startRect.top)\n    corrected.left = Math.min(current.left, startRect.right)\n    corrected.right = Math.max(current.right, startRect.left)\n  }\n\n  corrected.width = corrected.right - corrected.left\n  corrected.height = corrected.bottom - corrected.top\n\n  for (const edge in corrected) {\n    deltaRect[edge] = corrected[edge] - previous[edge]\n  }\n\n  resizeEvent.edges = interaction.prepared.edges\n  resizeEvent.rect = corrected\n  resizeEvent.deltaRect = deltaRect\n}\n\nfunction end({ iEvent, interaction }: { iEvent: InteractEvent<any, any>; interaction: Interaction }) {\n  if (interaction.prepared.name !== 'resize' || !interaction.prepared.edges) return\n\n  const resizeEvent = iEvent as ResizeEvent\n\n  resizeEvent.edges = interaction.prepared.edges\n  resizeEvent.rect = interaction._rects.corrected\n  resizeEvent.deltaRect = interaction._rects.delta\n}\n\nfunction updateEventAxes({\n  iEvent,\n  interaction,\n}: {\n  iEvent: InteractEvent<any, any>\n  interaction: Interaction\n}) {\n  if (interaction.prepared.name !== 'resize' || !interaction.resizeAxes) return\n\n  const options = interaction.interactable.options\n  const resizeEvent = iEvent as ResizeEvent\n\n  if (options.resize.square) {\n    if (interaction.resizeAxes === 'y') {\n      resizeEvent.delta.x = resizeEvent.delta.y\n    } else {\n      resizeEvent.delta.y = resizeEvent.delta.x\n    }\n    resizeEvent.axes = 'xy'\n  } else {\n    resizeEvent.axes = interaction.resizeAxes\n\n    if (interaction.resizeAxes === 'x') {\n      resizeEvent.delta.y = 0\n    } else if (interaction.resizeAxes === 'y') {\n      resizeEvent.delta.x = 0\n    }\n  }\n}\n\nconst resize: Plugin = {\n  id: 'actions/resize',\n  before: ['actions/drag'],\n  install,\n  listeners: {\n    'interactions:new': ({ interaction }) => {\n      interaction.resizeAxes = 'xy'\n    },\n\n    'interactions:action-start': (arg) => {\n      start(arg)\n      updateEventAxes(arg)\n    },\n    'interactions:action-move': (arg) => {\n      move(arg)\n      updateEventAxes(arg)\n    },\n    'interactions:action-end': end,\n    'auto-start:check': resizeChecker,\n  },\n\n  defaults: {\n    square: false,\n    preserveAspectRatio: false,\n    axis: 'xy',\n\n    // use default margin\n    margin: NaN,\n\n    // object with props left, right, top, bottom which are\n    // true/false values to resize when the pointer is over that edge,\n    // CSS selectors to match the handles for each direction\n    // or the Elements for each handle\n    edges: null,\n\n    // a value of 'none' will limit the resize rect to a minimum of 0x0\n    // 'negate' will alow the rect to have negative width/height\n    // 'reposition' will keep the width/height positive by swapping\n    // the top and bottom edges and/or swapping the left and right edges\n    invert: 'none',\n  } as ResizableOptions,\n\n  cursors: null as ReturnType<typeof initCursors>,\n\n  getCursor({ edges, axis, name }: ActionProps) {\n    const cursors = resize.cursors\n    let result: string = null\n\n    if (axis) {\n      result = cursors[name + axis]\n    } else if (edges) {\n      let cursorKey = ''\n\n      for (const edge of ['top', 'bottom', 'left', 'right']) {\n        if (edges[edge]) {\n          cursorKey += edge\n        }\n      }\n\n      result = cursors[cursorKey]\n    }\n\n    return result\n  },\n\n  filterEventType: (type: string) => type.search('resize') === 0,\n\n  defaultMargin: null as number,\n}\n\nexport default resize\n", "let lastTime = 0\nlet request: typeof requestAnimationFrame\nlet cancel: typeof cancelAnimationFrame\n\nfunction init(global: Window | typeof globalThis) {\n  request = global.requestAnimationFrame\n  cancel = global.cancelAnimationFrame\n\n  if (!request) {\n    const vendors = ['ms', 'moz', 'webkit', 'o']\n\n    for (const vendor of vendors) {\n      request = global[`${vendor}RequestAnimationFrame` as 'requestAnimationFrame']\n      cancel =\n        global[`${vendor}CancelAnimationFrame` as 'cancelAnimationFrame'] ||\n        global[`${vendor}CancelRequestAnimationFrame` as 'cancelAnimationFrame']\n    }\n  }\n\n  request = request && request.bind(global)\n  cancel = cancel && cancel.bind(global)\n\n  if (!request) {\n    request = (callback) => {\n      const currTime = Date.now()\n      const timeToCall = Math.max(0, 16 - (currTime - lastTime))\n      const token = global.setTimeout(() => {\n        // eslint-disable-next-line n/no-callback-literal\n        callback(currTime + timeToCall)\n      }, timeToCall)\n\n      lastTime = currTime + timeToCall\n      return token as any\n    }\n\n    cancel = (token) => clearTimeout(token)\n  }\n}\n\nexport default {\n  request: (callback: FrameRequestCallback) => request(callback),\n  cancel: (token: number) => cancel(token),\n  init,\n}\n", "import type { Scope } from '@interactjs/core/scope'\n\n/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport './drag/plugin'\nimport './drop/plugin'\nimport './gesture/plugin'\nimport './resize/plugin'\n\nimport drag from './drag/plugin'\nimport drop from './drop/plugin'\nimport gesture from './gesture/plugin'\nimport resize from './resize/plugin'\n/* eslint-enable import/no-duplicates */\n\nexport default {\n  id: 'actions',\n  install(scope: Scope) {\n    scope.usePlugin(gesture)\n    scope.usePlugin(resize)\n    scope.usePlugin(drag)\n    scope.usePlugin(drop)\n  },\n}\n", "import type { Interactable } from '@interactjs/core/Interactable'\nimport type Interaction from '@interactjs/core/Interaction'\nimport type { Scope, Plugin } from '@interactjs/core/scope'\nimport type { ActionName, PointerType } from '@interactjs/core/types'\nimport * as domUtils from '@interactjs/utils/domUtils'\nimport is from '@interactjs/utils/is'\nimport raf from '@interactjs/utils/raf'\nimport { getStringOptionResult } from '@interactjs/utils/rect'\nimport { getWindow } from '@interactjs/utils/window'\n\ndeclare module '@interactjs/core/scope' {\n  interface Scope {\n    autoScroll: typeof autoScroll\n  }\n}\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction {\n    autoScroll?: typeof autoScroll\n  }\n}\n\ndeclare module '@interactjs/core/options' {\n  interface PerActionDefaults {\n    autoScroll?: AutoScrollOptions\n  }\n}\n\nexport interface AutoScrollOptions {\n  container?: Window | HTMLElement | string\n  margin?: number\n  distance?: number\n  interval?: number\n  speed?: number\n  enabled?: boolean\n}\n\nfunction install(scope: Scope) {\n  const { defaults, actions } = scope\n\n  scope.autoScroll = autoScroll\n  autoScroll.now = () => scope.now()\n\n  actions.phaselessTypes.autoscroll = true\n  defaults.perAction.autoScroll = autoScroll.defaults\n}\n\nconst autoScroll = {\n  defaults: {\n    enabled: false,\n    margin: 60,\n\n    // the item that is scrolled (Window or HTMLElement)\n    container: null as AutoScrollOptions['container'],\n\n    // the scroll speed in pixels per second\n    speed: 300,\n  } as AutoScrollOptions,\n\n  now: Date.now,\n\n  interaction: null as Interaction<ActionName> | null,\n  i: 0, // the handle returned by window.setInterval\n\n  // Direction each pulse is to scroll in\n  x: 0,\n  y: 0,\n\n  isScrolling: false,\n  prevTime: 0,\n  margin: 0,\n  speed: 0,\n\n  start(interaction: Interaction) {\n    autoScroll.isScrolling = true\n    raf.cancel(autoScroll.i)\n\n    interaction.autoScroll = autoScroll\n    autoScroll.interaction = interaction\n    autoScroll.prevTime = autoScroll.now()\n    autoScroll.i = raf.request(autoScroll.scroll)\n  },\n\n  stop() {\n    autoScroll.isScrolling = false\n    if (autoScroll.interaction) {\n      autoScroll.interaction.autoScroll = null\n    }\n    raf.cancel(autoScroll.i)\n  },\n\n  // scroll the window by the values in scroll.x/y\n  scroll() {\n    const { interaction } = autoScroll\n    const { interactable, element } = interaction\n    const actionName = interaction.prepared.name\n    const options = interactable.options[actionName].autoScroll\n    const container = getContainer(options.container, interactable, element)\n    const now = autoScroll.now()\n    // change in time in seconds\n    const dt = (now - autoScroll.prevTime) / 1000\n    // displacement\n    const s = options.speed * dt\n\n    if (s >= 1) {\n      const scrollBy = {\n        x: autoScroll.x * s,\n        y: autoScroll.y * s,\n      }\n\n      if (scrollBy.x || scrollBy.y) {\n        const prevScroll = getScroll(container)\n\n        if (is.window(container)) {\n          container.scrollBy(scrollBy.x, scrollBy.y)\n        } else if (container) {\n          container.scrollLeft += scrollBy.x\n          container.scrollTop += scrollBy.y\n        }\n\n        const curScroll = getScroll(container)\n        const delta = {\n          x: curScroll.x - prevScroll.x,\n          y: curScroll.y - prevScroll.y,\n        }\n\n        if (delta.x || delta.y) {\n          interactable.fire({\n            type: 'autoscroll',\n            target: element,\n            interactable,\n            delta,\n            interaction,\n            container,\n          })\n        }\n      }\n\n      autoScroll.prevTime = now\n    }\n\n    if (autoScroll.isScrolling) {\n      raf.cancel(autoScroll.i)\n      autoScroll.i = raf.request(autoScroll.scroll)\n    }\n  },\n  check(interactable: Interactable, actionName: ActionName) {\n    const options = interactable.options\n\n    return options[actionName].autoScroll?.enabled\n  },\n  onInteractionMove<T extends ActionName>({\n    interaction,\n    pointer,\n  }: {\n    interaction: Interaction<T>\n    pointer: PointerType\n  }) {\n    if (\n      !(interaction.interacting() && autoScroll.check(interaction.interactable, interaction.prepared.name))\n    ) {\n      return\n    }\n\n    if (interaction.simulation) {\n      autoScroll.x = autoScroll.y = 0\n      return\n    }\n\n    let top: boolean\n    let right: boolean\n    let bottom: boolean\n    let left: boolean\n\n    const { interactable, element } = interaction\n    const actionName = interaction.prepared.name\n    const options = interactable.options[actionName].autoScroll\n    const container = getContainer(options.container, interactable, element)\n\n    if (is.window(container)) {\n      left = pointer.clientX < autoScroll.margin\n      top = pointer.clientY < autoScroll.margin\n      right = pointer.clientX > container.innerWidth - autoScroll.margin\n      bottom = pointer.clientY > container.innerHeight - autoScroll.margin\n    } else {\n      const rect = domUtils.getElementClientRect(container)\n\n      left = pointer.clientX < rect.left + autoScroll.margin\n      top = pointer.clientY < rect.top + autoScroll.margin\n      right = pointer.clientX > rect.right - autoScroll.margin\n      bottom = pointer.clientY > rect.bottom - autoScroll.margin\n    }\n\n    autoScroll.x = right ? 1 : left ? -1 : 0\n    autoScroll.y = bottom ? 1 : top ? -1 : 0\n\n    if (!autoScroll.isScrolling) {\n      // set the autoScroll properties to those of the target\n      autoScroll.margin = options.margin\n      autoScroll.speed = options.speed\n\n      autoScroll.start(interaction)\n    }\n  },\n}\n\nexport function getContainer(value: any, interactable: Interactable, element: Element) {\n  return (\n    (is.string(value) ? getStringOptionResult(value, interactable, element) : value) || getWindow(element)\n  )\n}\n\nexport function getScroll(container: any) {\n  if (is.window(container)) {\n    container = window.document.body\n  }\n\n  return { x: container.scrollLeft, y: container.scrollTop }\n}\n\nexport function getScrollSize(container: any) {\n  if (is.window(container)) {\n    container = window.document.body\n  }\n\n  return { x: container.scrollWidth, y: container.scrollHeight }\n}\n\nexport function getScrollSizeDelta<T extends ActionName>(\n  {\n    interaction,\n    element,\n  }: {\n    interaction: Partial<Interaction<T>>\n    element: Element\n  },\n  func: any,\n) {\n  const scrollOptions = interaction && interaction.interactable.options[interaction.prepared.name].autoScroll\n\n  if (!scrollOptions || !scrollOptions.enabled) {\n    func()\n    return { x: 0, y: 0 }\n  }\n\n  const scrollContainer = getContainer(scrollOptions.container, interaction.interactable, element)\n\n  const prevSize = getScroll(scrollContainer)\n  func()\n  const curSize = getScroll(scrollContainer)\n\n  return {\n    x: curSize.x - prevSize.x,\n    y: curSize.y - prevSize.y,\n  }\n}\n\nconst autoScrollPlugin: Plugin = {\n  id: 'auto-scroll',\n  install,\n  listeners: {\n    'interactions:new': ({ interaction }) => {\n      interaction.autoScroll = null\n    },\n\n    'interactions:destroy': ({ interaction }) => {\n      interaction.autoScroll = null\n      autoScroll.stop()\n      if (autoScroll.interaction) {\n        autoScroll.interaction = null\n      }\n    },\n\n    'interactions:stop': autoScroll.stop,\n\n    'interactions:action-move': (arg: any) => autoScroll.onInteractionMove(arg),\n  },\n}\n\nexport default autoScrollPlugin\n", "import type { ActionName, ActionProps } from '@interactjs/core/types'\n\nimport { window } from './window'\n\nexport function warnOnce<T>(this: T, method: (...args: any[]) => any, message: string) {\n  let warned = false\n\n  return function (this: T) {\n    if (!warned) {\n      ;(window as any).console.warn(message)\n      warned = true\n    }\n\n    return method.apply(this, arguments)\n  }\n}\n\nexport function copyAction<T extends ActionName>(dest: ActionProps<any>, src: ActionProps<T>) {\n  dest.name = src.name\n  dest.axis = src.axis\n  dest.edges = src.edges\n\n  return dest\n}\n\nexport const sign = (n: number) => (n >= 0 ? 1 : -1)\n", "import type { Interactable } from '@interactjs/core/Interactable'\nimport type { Interaction } from '@interactjs/core/Interaction'\nimport type { Scope } from '@interactjs/core/scope'\nimport type { ActionProps, PointerType, PointerEventType, Element } from '@interactjs/core/types'\nimport is from '@interactjs/utils/is'\nimport { warnOnce } from '@interactjs/utils/misc'\n\ndeclare module '@interactjs/core/Interactable' {\n  interface Interactable {\n    getAction: (\n      this: Interactable,\n      pointer: PointerType,\n      event: PointerEventType,\n      interaction: Interaction,\n      element: Element,\n    ) => ActionProps | null\n    styleCursor(newValue: boolean): this\n    styleCursor(): boolean\n    /**\n     * Returns or sets whether the the cursor should be changed depending on the\n     * action that would be performed if the mouse were pressed and dragged.\n     *\n     * @param {boolean} [newValue]\n     * @return {boolean | Interactable} The current setting or this Interactable\n     */\n    styleCursor(newValue?: boolean): boolean | this\n    actionChecker(checker: Function): Interactable\n    actionChecker(): Function\n    /**\n     * ```js\n     * interact('.resize-drag')\n     *   .resizable(true)\n     *   .draggable(true)\n     *   .actionChecker(function (pointer, event, action, interactable, element, interaction) {\n     *\n     *     if (interact.matchesSelector(event.target, '.drag-handle')) {\n     *       // force drag with handle target\n     *       action.name = drag\n     *     }\n     *     else {\n     *       // resize from the top and right edges\n     *       action.name  = 'resize'\n     *       action.edges = { top: true, right: true }\n     *     }\n     *\n     *     return action\n     * })\n     * ```\n     *\n     * Returns or sets the function used to check action to be performed on\n     * pointerDown\n     *\n     * @param checker - A function which takes a pointer event,\n     * defaultAction string, interactable, element and interaction as parameters\n     * and returns an object with name property 'drag' 'resize' or 'gesture' and\n     * optionally an `edges` object with boolean 'top', 'left', 'bottom' and right\n     * props.\n     * @returns The checker function or this Interactable\n     */\n    actionChecker(checker?: Function): Interactable | Function\n    /** @returns This interactable */\n    ignoreFrom(newValue: string | Element | null): Interactable\n    /** @returns The current ignoreFrom value */\n    ignoreFrom(): string | Element | null\n    /**\n     * If the target of the `mousedown`, `pointerdown` or `touchstart` event or any\n     * of it's parents match the given CSS selector or Element, no\n     * drag/resize/gesture is started.\n     *\n     * @deprecated\n     * Don't use this method. Instead set the `ignoreFrom` option for each action\n     * or for `pointerEvents`\n     *\n     * ```js\n     * interact(targett)\n     *   .draggable({\n     *     ignoreFrom: 'input, textarea, a[href]'',\n     *   })\n     *   .pointerEvents({\n     *     ignoreFrom: '[no-pointer]',\n     *   })\n     * ```\n     * Interactable\n     */\n    ignoreFrom(\n      /** a CSS selector string, an Element or `null` to not ignore any elements */\n      newValue?: string | Element | null,\n    ): Interactable | string | Element | null\n    allowFrom(): boolean\n    /**\n     *\n     * A drag/resize/gesture is started only If the target of the `mousedown`,\n     * `pointerdown` or `touchstart` event or any of it's parents match the given\n     * CSS selector or Element.\n     *\n     * @deprecated\n     * Don't use this method. Instead set the `allowFrom` option for each action\n     * or for `pointerEvents`\n     *\n     * ```js\n     * interact(targett)\n     *   .resizable({\n     *     allowFrom: '.resize-handle',\n     *   .pointerEvents({\n     *     allowFrom: '.handle',,\n     *   })\n     * ```\n     *\n     * @param {string | Element | null} [newValue]\n     * @return {string | Element | object} The current allowFrom value or this\n     * Interactable\n     */\n    allowFrom(\n      /** A CSS selector string, an Element or `null` to allow from any element */\n      newValue: string | Element | null,\n    ): Interactable\n  }\n}\n\nfunction install(scope: Scope) {\n  const {\n    Interactable, // tslint:disable-line no-shadowed-variable\n  } = scope\n\n  Interactable.prototype.getAction = function getAction(\n    this: Interactable,\n    pointer: PointerType,\n    event: PointerEventType,\n    interaction: Interaction,\n    element: Element,\n  ): ActionProps {\n    const action = defaultActionChecker(this, event, interaction, element, scope)\n\n    if (this.options.actionChecker) {\n      return this.options.actionChecker(pointer, event, action, this, element, interaction)\n    }\n\n    return action\n  }\n\n  Interactable.prototype.ignoreFrom = warnOnce(function (this: Interactable, newValue) {\n    return this._backCompatOption('ignoreFrom', newValue)\n  }, 'Interactable.ignoreFrom() has been deprecated. Use Interactble.draggable({ignoreFrom: newValue}).')\n\n  Interactable.prototype.allowFrom = warnOnce(function (this: Interactable, newValue) {\n    return this._backCompatOption('allowFrom', newValue)\n  }, 'Interactable.allowFrom() has been deprecated. Use Interactble.draggable({allowFrom: newValue}).')\n\n  Interactable.prototype.actionChecker = actionChecker\n\n  Interactable.prototype.styleCursor = styleCursor\n}\n\nfunction defaultActionChecker(\n  interactable: Interactable,\n  event: PointerEventType,\n  interaction: Interaction,\n  element: Element,\n  scope: Scope,\n) {\n  const rect = interactable.getRect(element)\n  const buttons =\n    (event as MouseEvent).buttons ||\n    {\n      0: 1,\n      1: 4,\n      3: 8,\n      4: 16,\n    }[(event as MouseEvent).button as 0 | 1 | 3 | 4]\n  const arg = {\n    action: null,\n    interactable,\n    interaction,\n    element,\n    rect,\n    buttons,\n  }\n\n  scope.fire('auto-start:check', arg)\n\n  return arg.action\n}\n\nfunction styleCursor(this: Interactable, newValue?: boolean) {\n  if (is.bool(newValue)) {\n    this.options.styleCursor = newValue\n\n    return this\n  }\n\n  if (newValue === null) {\n    delete this.options.styleCursor\n\n    return this\n  }\n\n  return this.options.styleCursor\n}\n\nfunction actionChecker(this: Interactable, checker?: any) {\n  if (is.func(checker)) {\n    this.options.actionChecker = checker\n\n    return this\n  }\n\n  if (checker === null) {\n    delete this.options.actionChecker\n\n    return this\n  }\n\n  return this.options.actionChecker\n}\n\nexport default {\n  id: 'auto-start/interactableMethods',\n  install,\n}\n", "import type { Interactable } from '@interactjs/core/Interactable'\nimport type { Interaction } from '@interactjs/core/Interaction'\nimport type { Scope, SignalArgs, Plugin } from '@interactjs/core/scope'\nimport type {\n  CursorChecker,\n  PointerType,\n  PointerEventType,\n  Element,\n  ActionName,\n  ActionProps,\n} from '@interactjs/core/types'\nimport * as domUtils from '@interactjs/utils/domUtils'\nimport extend from '@interactjs/utils/extend'\nimport is from '@interactjs/utils/is'\nimport { copyAction } from '@interactjs/utils/misc'\n\n/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport './InteractableMethods'\nimport InteractableMethods from './InteractableMethods'\n/* eslint-enable import/no-duplicates */\n\ndeclare module '@interactjs/core/InteractStatic' {\n  export interface InteractStatic {\n    /**\n     * Returns or sets the maximum number of concurrent interactions allowed.  By\n     * default only 1 interaction is allowed at a time (for backwards\n     * compatibility). To allow multiple interactions on the same Interactables and\n     * elements, you need to enable it in the draggable, resizable and gesturable\n     * `'max'` and `'maxPerElement'` options.\n     *\n     * @param {number} [newValue] Any number. newValue <= 0 means no interactions.\n     */\n    maxInteractions: (newValue: any) => any\n  }\n}\n\ndeclare module '@interactjs/core/scope' {\n  interface Scope {\n    autoStart: AutoStart\n  }\n\n  interface SignalArgs {\n    'autoStart:before-start': Omit<SignalArgs['interactions:move'], 'interaction'> & {\n      interaction: Interaction<ActionName>\n    }\n    'autoStart:prepared': { interaction: Interaction }\n    'auto-start:check': CheckSignalArg\n  }\n}\n\ndeclare module '@interactjs/core/options' {\n  interface BaseDefaults {\n    actionChecker?: any\n    cursorChecker?: any\n    styleCursor?: any\n  }\n\n  interface PerActionDefaults {\n    manualStart?: boolean\n    max?: number\n    maxPerElement?: number\n    allowFrom?: string | Element\n    ignoreFrom?: string | Element\n    cursorChecker?: CursorChecker\n\n    // only allow left button by default\n    // see https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/buttons#Return_value\n    // TODO: docst\n    mouseButtons?: 0 | 1 | 2 | 4 | 8 | 16\n  }\n}\n\ninterface CheckSignalArg {\n  interactable: Interactable\n  interaction: Interaction\n  element: Element\n  action: ActionProps<ActionName>\n  buttons: number\n}\n\nexport interface AutoStart {\n  // Allow this many interactions to happen simultaneously\n  maxInteractions: number\n  withinInteractionLimit: typeof withinInteractionLimit\n  cursorElement: Element\n}\n\nfunction install(scope: Scope) {\n  const { interactStatic: interact, defaults } = scope\n\n  scope.usePlugin(InteractableMethods)\n\n  defaults.base.actionChecker = null\n  defaults.base.styleCursor = true\n\n  extend(defaults.perAction, {\n    manualStart: false,\n    max: Infinity,\n    maxPerElement: 1,\n    allowFrom: null,\n    ignoreFrom: null,\n\n    // only allow left button by default\n    // see https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/buttons#Return_value\n    mouseButtons: 1,\n  })\n\n  interact.maxInteractions = (newValue: number) => maxInteractions(newValue, scope)\n\n  scope.autoStart = {\n    // Allow this many interactions to happen simultaneously\n    maxInteractions: Infinity,\n    withinInteractionLimit,\n    cursorElement: null,\n  }\n}\n\nfunction prepareOnDown(\n  { interaction, pointer, event, eventTarget }: SignalArgs['interactions:down'],\n  scope: Scope,\n) {\n  if (interaction.interacting()) return\n\n  const actionInfo = getActionInfo(interaction, pointer, event, eventTarget, scope)\n  prepare(interaction, actionInfo, scope)\n}\n\nfunction prepareOnMove(\n  { interaction, pointer, event, eventTarget }: SignalArgs['interactions:move'],\n  scope: Scope,\n) {\n  if (interaction.pointerType !== 'mouse' || interaction.pointerIsDown || interaction.interacting()) return\n\n  const actionInfo = getActionInfo(interaction, pointer, event, eventTarget as Element, scope)\n  prepare(interaction, actionInfo, scope)\n}\n\nfunction startOnMove(arg: SignalArgs['interactions:move'], scope: Scope) {\n  const { interaction } = arg\n\n  if (\n    !interaction.pointerIsDown ||\n    interaction.interacting() ||\n    !interaction.pointerWasMoved ||\n    !interaction.prepared.name\n  ) {\n    return\n  }\n\n  scope.fire('autoStart:before-start', arg)\n\n  const { interactable } = interaction\n  const actionName = (interaction as Interaction<ActionName>).prepared.name\n\n  if (actionName && interactable) {\n    // check manualStart and interaction limit\n    if (\n      interactable.options[actionName].manualStart ||\n      !withinInteractionLimit(interactable, interaction.element, interaction.prepared, scope)\n    ) {\n      interaction.stop()\n    } else {\n      interaction.start(interaction.prepared, interactable, interaction.element)\n      setInteractionCursor(interaction, scope)\n    }\n  }\n}\n\nfunction clearCursorOnStop({ interaction }: { interaction: Interaction }, scope: Scope) {\n  const { interactable } = interaction\n\n  if (interactable && interactable.options.styleCursor) {\n    setCursor(interaction.element, '', scope)\n  }\n}\n\n// Check if the current interactable supports the action.\n// If so, return the validated action. Otherwise, return null\nfunction validateAction<T extends ActionName>(\n  action: ActionProps<T>,\n  interactable: Interactable,\n  element: Element,\n  eventTarget: Node,\n  scope: Scope,\n) {\n  if (\n    interactable.testIgnoreAllow(interactable.options[action.name], element, eventTarget) &&\n    interactable.options[action.name].enabled &&\n    withinInteractionLimit(interactable, element, action, scope)\n  ) {\n    return action\n  }\n\n  return null\n}\n\nfunction validateMatches(\n  interaction: Interaction,\n  pointer: PointerType,\n  event: PointerEventType,\n  matches: Interactable[],\n  matchElements: Element[],\n  eventTarget: Node,\n  scope: Scope,\n) {\n  for (let i = 0, len = matches.length; i < len; i++) {\n    const match = matches[i]\n    const matchElement = matchElements[i]\n    const matchAction = match.getAction(pointer, event, interaction, matchElement)\n\n    if (!matchAction) {\n      continue\n    }\n\n    const action = validateAction<ActionName>(matchAction, match, matchElement, eventTarget, scope)\n\n    if (action) {\n      return {\n        action,\n        interactable: match,\n        element: matchElement,\n      }\n    }\n  }\n\n  return { action: null, interactable: null, element: null }\n}\n\nfunction getActionInfo(\n  interaction: Interaction,\n  pointer: PointerType,\n  event: PointerEventType,\n  eventTarget: Node,\n  scope: Scope,\n) {\n  let matches: Interactable[] = []\n  let matchElements: Element[] = []\n\n  let element = eventTarget as Element\n\n  function pushMatches(interactable: Interactable) {\n    matches.push(interactable)\n    matchElements.push(element)\n  }\n\n  while (is.element(element)) {\n    matches = []\n    matchElements = []\n\n    scope.interactables.forEachMatch(element, pushMatches)\n\n    const actionInfo = validateMatches(\n      interaction,\n      pointer,\n      event,\n      matches,\n      matchElements,\n      eventTarget,\n      scope,\n    )\n\n    if (actionInfo.action && !actionInfo.interactable.options[actionInfo.action.name].manualStart) {\n      return actionInfo\n    }\n\n    element = domUtils.parentNode(element) as Element\n  }\n\n  return { action: null, interactable: null, element: null }\n}\n\nfunction prepare(\n  interaction: Interaction,\n  {\n    action,\n    interactable,\n    element,\n  }: {\n    action: ActionProps<any>\n    interactable: Interactable\n    element: Element\n  },\n  scope: Scope,\n) {\n  action = action || { name: null }\n\n  interaction.interactable = interactable\n  interaction.element = element\n  copyAction(interaction.prepared, action)\n\n  interaction.rect = interactable && action.name ? interactable.getRect(element) : null\n\n  setInteractionCursor(interaction, scope)\n\n  scope.fire('autoStart:prepared', { interaction })\n}\n\nfunction withinInteractionLimit<T extends ActionName>(\n  interactable: Interactable,\n  element: Element,\n  action: ActionProps<T>,\n  scope: Scope,\n) {\n  const options = interactable.options\n  const maxActions = options[action.name].max\n  const maxPerElement = options[action.name].maxPerElement\n  const autoStartMax = scope.autoStart.maxInteractions\n  let activeInteractions = 0\n  let interactableCount = 0\n  let elementCount = 0\n\n  // no actions if any of these values == 0\n  if (!(maxActions && maxPerElement && autoStartMax)) {\n    return false\n  }\n\n  for (const interaction of scope.interactions.list) {\n    const otherAction = interaction.prepared.name\n\n    if (!interaction.interacting()) {\n      continue\n    }\n\n    activeInteractions++\n\n    if (activeInteractions >= autoStartMax) {\n      return false\n    }\n\n    if (interaction.interactable !== interactable) {\n      continue\n    }\n\n    interactableCount += otherAction === action.name ? 1 : 0\n\n    if (interactableCount >= maxActions) {\n      return false\n    }\n\n    if (interaction.element === element) {\n      elementCount++\n\n      if (otherAction === action.name && elementCount >= maxPerElement) {\n        return false\n      }\n    }\n  }\n\n  return autoStartMax > 0\n}\n\nfunction maxInteractions(newValue: any, scope: Scope) {\n  if (is.number(newValue)) {\n    scope.autoStart.maxInteractions = newValue\n\n    return this\n  }\n\n  return scope.autoStart.maxInteractions\n}\n\nfunction setCursor(element: Element, cursor: string, scope: Scope) {\n  const { cursorElement: prevCursorElement } = scope.autoStart\n\n  if (prevCursorElement && prevCursorElement !== element) {\n    prevCursorElement.style.cursor = ''\n  }\n\n  element.ownerDocument.documentElement.style.cursor = cursor\n  element.style.cursor = cursor\n  scope.autoStart.cursorElement = cursor ? element : null\n}\n\nfunction setInteractionCursor<T extends ActionName>(interaction: Interaction<T>, scope: Scope) {\n  const { interactable, element, prepared } = interaction\n\n  if (!(interaction.pointerType === 'mouse' && interactable && interactable.options.styleCursor)) {\n    // clear previous target element cursor\n    if (scope.autoStart.cursorElement) {\n      setCursor(scope.autoStart.cursorElement, '', scope)\n    }\n\n    return\n  }\n\n  let cursor = ''\n\n  if (prepared.name) {\n    const cursorChecker = interactable.options[prepared.name].cursorChecker\n\n    if (is.func(cursorChecker)) {\n      cursor = cursorChecker(prepared, interactable, element, interaction._interacting)\n    } else {\n      cursor = scope.actions.map[prepared.name].getCursor(prepared)\n    }\n  }\n\n  setCursor(interaction.element, cursor || '', scope)\n}\n\nconst autoStart: Plugin = {\n  id: 'auto-start/base',\n  before: ['actions'],\n  install,\n  listeners: {\n    'interactions:down': prepareOnDown,\n    'interactions:move': (arg, scope) => {\n      prepareOnMove(arg, scope)\n      startOnMove(arg, scope)\n    },\n    'interactions:stop': clearCursorOnStop,\n  },\n  maxInteractions,\n  withinInteractionLimit,\n  validateAction,\n}\n\nexport default autoStart\n", "import type { Interactable } from '@interactjs/core/Interactable'\nimport type Interaction from '@interactjs/core/Interaction'\nimport type { SignalArgs, Scope } from '@interactjs/core/scope'\nimport type { ActionName, Element } from '@interactjs/core/types'\nimport { parentNode } from '@interactjs/utils/domUtils'\nimport is from '@interactjs/utils/is'\n\nimport autoStart from './base'\n\nfunction beforeStart({ interaction, eventTarget, dx, dy }: SignalArgs['interactions:move'], scope: Scope) {\n  if (interaction.prepared.name !== 'drag') return\n\n  // check if a drag is in the correct axis\n  const absX = Math.abs(dx)\n  const absY = Math.abs(dy)\n  const targetOptions = interaction.interactable.options.drag\n  const startAxis = targetOptions.startAxis\n  const currentAxis = absX > absY ? 'x' : absX < absY ? 'y' : 'xy'\n\n  interaction.prepared.axis =\n    targetOptions.lockAxis === 'start'\n      ? (currentAxis[0] as 'x' | 'y') // always lock to one axis even if currentAxis === 'xy'\n      : targetOptions.lockAxis\n\n  // if the movement isn't in the startAxis of the interactable\n  if (currentAxis !== 'xy' && startAxis !== 'xy' && startAxis !== currentAxis) {\n    // cancel the prepared action\n    ;(interaction as Interaction<ActionName>).prepared.name = null\n\n    // then try to get a drag from another ineractable\n    let element = eventTarget as Element\n\n    const getDraggable = function (interactable: Interactable): Interactable | void {\n      if (interactable === interaction.interactable) return\n\n      const options = interaction.interactable.options.drag\n\n      if (!options.manualStart && interactable.testIgnoreAllow(options, element, eventTarget)) {\n        const action = interactable.getAction(\n          interaction.downPointer,\n          interaction.downEvent,\n          interaction,\n          element,\n        )\n\n        if (\n          action &&\n          action.name === 'drag' &&\n          checkStartAxis(currentAxis, interactable) &&\n          autoStart.validateAction(action, interactable, element, eventTarget, scope)\n        ) {\n          return interactable\n        }\n      }\n    }\n\n    // check all interactables\n    while (is.element(element)) {\n      const interactable = scope.interactables.forEachMatch(element, getDraggable)\n\n      if (interactable) {\n        ;(interaction as Interaction<ActionName>).prepared.name = 'drag'\n        interaction.interactable = interactable\n        interaction.element = element\n        break\n      }\n\n      element = parentNode(element) as Element\n    }\n  }\n}\n\nfunction checkStartAxis(startAxis: string, interactable: Interactable) {\n  if (!interactable) {\n    return false\n  }\n\n  const thisAxis = interactable.options.drag.startAxis\n\n  return startAxis === 'xy' || thisAxis === 'xy' || thisAxis === startAxis\n}\n\nexport default {\n  id: 'auto-start/dragAxis',\n  listeners: { 'autoStart:before-start': beforeStart },\n}\n", "import type Interaction from '@interactjs/core/Interaction'\nimport type { Scope, Plugin } from '@interactjs/core/scope'\n\n/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport './base'\nimport basePlugin from './base'\n/* eslint-enable */\n\ndeclare module '@interactjs/core/options' {\n  interface PerActionDefaults {\n    hold?: number\n    delay?: number\n  }\n}\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction {\n    autoStartHoldTimer?: any\n  }\n}\n\nfunction install(scope: Scope) {\n  const { defaults } = scope\n\n  scope.usePlugin(basePlugin)\n\n  defaults.perAction.hold = 0\n  defaults.perAction.delay = 0\n}\n\nfunction getHoldDuration(interaction: Interaction) {\n  const actionName = interaction.prepared && interaction.prepared.name\n\n  if (!actionName) {\n    return null\n  }\n\n  const options = interaction.interactable.options\n\n  return options[actionName].hold || options[actionName].delay\n}\n\nconst hold: Plugin = {\n  id: 'auto-start/hold',\n  install,\n  listeners: {\n    'interactions:new': ({ interaction }) => {\n      interaction.autoStartHoldTimer = null\n    },\n\n    'autoStart:prepared': ({ interaction }) => {\n      const hold = getHoldDuration(interaction)\n\n      if (hold > 0) {\n        interaction.autoStartHoldTimer = setTimeout(() => {\n          interaction.start(interaction.prepared, interaction.interactable, interaction.element)\n        }, hold)\n      }\n    },\n\n    'interactions:move': ({ interaction, duplicate }) => {\n      if (interaction.autoStartHoldTimer && interaction.pointerWasMoved && !duplicate) {\n        clearTimeout(interaction.autoStartHoldTimer)\n        interaction.autoStartHoldTimer = null\n      }\n    },\n\n    // prevent regular down->move autoStart\n    'autoStart:before-start': ({ interaction }) => {\n      const holdDuration = getHoldDuration(interaction)\n\n      if (holdDuration > 0) {\n        interaction.prepared.name = null\n      }\n    },\n  },\n  getHoldDuration,\n}\nexport default hold\n", "import type { Scope } from '@interactjs/core/scope'\n\n/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport './base'\nimport './dragAxis'\nimport './hold'\n\nimport autoStart from './base'\nimport dragAxis from './dragAxis'\nimport hold from './hold'\n/* eslint-enable import/no-duplicates */\n\nexport default {\n  id: 'auto-start',\n  install(scope: Scope) {\n    scope.usePlugin(autoStart)\n    scope.usePlugin(hold)\n    scope.usePlugin(dragAxis)\n  },\n}\n", "import { matchesSelector, nodeContains } from '@interactjs/utils/domUtils'\nimport is from '@interactjs/utils/is'\nimport { getWindow } from '@interactjs/utils/window'\n\nimport type { Interactable } from '@interactjs/core/Interactable'\nimport type Interaction from '@interactjs/core/Interaction'\nimport type { Scope } from '@interactjs/core/scope'\nimport type { PointerEventType } from '@interactjs/core/types'\n\ntype PreventDefaultValue = 'always' | 'never' | 'auto'\n\ndeclare module '@interactjs/core/Interactable' {\n  interface Interactable {\n    preventDefault(newValue: PreventDefaultValue): this\n    preventDefault(): PreventDefaultValue\n    /**\n     * Returns or sets whether to prevent the browser's default behaviour in\n     * response to pointer events. Can be set to:\n     *  - `'always'` to always prevent\n     *  - `'never'` to never prevent\n     *  - `'auto'` to let interact.js try to determine what would be best\n     *\n     * @param newValue - `'always'`, `'never'` or `'auto'`\n     * @returns The current setting or this Interactable\n     */\n    preventDefault(newValue?: PreventDefaultValue): PreventDefaultValue | this\n    checkAndPreventDefault(event: Event): void\n  }\n}\n\nconst preventDefault = function preventDefault(this: Interactable, newValue?: PreventDefaultValue) {\n  if (/^(always|never|auto)$/.test(newValue)) {\n    this.options.preventDefault = newValue\n    return this\n  }\n\n  if (is.bool(newValue)) {\n    this.options.preventDefault = newValue ? 'always' : 'never'\n    return this\n  }\n\n  return this.options.preventDefault\n} as Interactable['preventDefault']\n\nfunction checkAndPreventDefault(interactable: Interactable, scope: Scope, event: Event) {\n  const setting = interactable.options.preventDefault\n\n  if (setting === 'never') return\n\n  if (setting === 'always') {\n    event.preventDefault()\n    return\n  }\n\n  // setting === 'auto'\n\n  // if the browser supports passive event listeners and isn't running on iOS,\n  // don't preventDefault of touch{start,move} events. CSS touch-action and\n  // user-select should be used instead of calling event.preventDefault().\n  if (scope.events.supportsPassive && /^touch(start|move)$/.test(event.type)) {\n    const doc = getWindow(event.target).document\n    const docOptions = scope.getDocOptions(doc)\n\n    if (!(docOptions && docOptions.events) || docOptions.events.passive !== false) {\n      return\n    }\n  }\n\n  // don't preventDefault of pointerdown events\n  if (/^(mouse|pointer|touch)*(down|start)/i.test(event.type)) {\n    return\n  }\n\n  // don't preventDefault on editable elements\n  if (\n    is.element(event.target) &&\n    matchesSelector(event.target, 'input,select,textarea,[contenteditable=true],[contenteditable=true] *')\n  ) {\n    return\n  }\n\n  event.preventDefault()\n}\n\nfunction onInteractionEvent({ interaction, event }: { interaction: Interaction; event: PointerEventType }) {\n  if (interaction.interactable) {\n    interaction.interactable.checkAndPreventDefault(event as Event)\n  }\n}\n\nexport function install(scope: Scope) {\n  const { Interactable } = scope\n\n  Interactable.prototype.preventDefault = preventDefault\n\n  Interactable.prototype.checkAndPreventDefault = function (event) {\n    return checkAndPreventDefault(this, scope, event)\n  }\n\n  // prevent native HTML5 drag on interact.js target elements\n  scope.interactions.docEvents.push({\n    type: 'dragstart',\n    listener(event) {\n      for (const interaction of scope.interactions.list) {\n        if (\n          interaction.element &&\n          (interaction.element === event.target || nodeContains(interaction.element, event.target))\n        ) {\n          interaction.interactable.checkAndPreventDefault(event)\n          return\n        }\n      }\n    },\n  })\n}\n\nexport default {\n  id: 'core/interactablePreventDefault',\n  install,\n  listeners: ['down', 'move', 'up', 'cancel'].reduce((acc, eventType) => {\n    acc[`interactions:${eventType}`] = onInteractionEvent\n    return acc\n  }, {} as any),\n}\n", "import type { Actions } from '@interactjs/core/types'\n\nexport default function isNonNativeEvent(type: string, actions: Actions) {\n  if (actions.phaselessTypes[type]) {\n    return true\n  }\n\n  for (const name in actions.map) {\n    if (type.indexOf(name) === 0 && type.substr(name.length) in actions.phases) {\n      return true\n    }\n  }\n\n  return false\n}\n", "import * as arr from './arr'\nimport is from './is'\n\n// tslint:disable-next-line ban-types\nexport default function clone<T extends Object>(source: T): Partial<T> {\n  const dest = {} as Partial<T>\n\n  for (const prop in source) {\n    const value = source[prop]\n\n    if (is.plainObject(value)) {\n      dest[prop] = clone(value) as any\n    } else if (is.array(value)) {\n      dest[prop] = arr.from(value) as typeof value\n    } else {\n      dest[prop] = value\n    }\n  }\n\n  return dest\n}\n", "import type { EventPhase } from '@interactjs/core/InteractEvent'\nimport type { Interaction, DoAnyPhaseArg } from '@interactjs/core/Interaction'\nimport type { EdgeOptions, FullRect, Point, Rect } from '@interactjs/core/types'\nimport clone from '@interactjs/utils/clone'\nimport extend from '@interactjs/utils/extend'\nimport * as rectUtils from '@interactjs/utils/rect'\n\nimport type { Modifier, ModifierArg, ModifierState } from './types'\n\nexport interface ModificationResult {\n  delta: Point\n  rectDelta: Rect\n  coords: Point\n  rect: FullRect\n  eventProps: any[]\n  changed: boolean\n}\n\ninterface MethodArg {\n  phase: EventPhase\n  pageCoords: Point\n  rect: FullRect\n  coords: Point\n  preEnd?: boolean\n  skipModifiers?: number\n}\n\nexport class Modification {\n  states: ModifierState[] = []\n  startOffset: Rect = { left: 0, right: 0, top: 0, bottom: 0 }\n  startDelta!: Point\n  result!: ModificationResult\n  endResult!: Point\n  startEdges!: EdgeOptions\n  edges: EdgeOptions\n  readonly interaction: Readonly<Interaction>\n\n  constructor(interaction: Interaction) {\n    this.interaction = interaction\n    this.result = createResult()\n    this.edges = {\n      left: false,\n      right: false,\n      top: false,\n      bottom: false,\n    }\n  }\n\n  start({ phase }: { phase: EventPhase }, pageCoords: Point) {\n    const { interaction } = this\n    const modifierList = getModifierList(interaction)\n    this.prepareStates(modifierList)\n\n    this.startEdges = extend({}, interaction.edges)\n    this.edges = extend({}, this.startEdges)\n    this.startOffset = getRectOffset(interaction.rect, pageCoords)\n    this.startDelta = { x: 0, y: 0 }\n\n    const arg = this.fillArg({\n      phase,\n      pageCoords,\n      preEnd: false,\n    })\n\n    this.result = createResult()\n    this.startAll(arg)\n\n    const result = (this.result = this.setAll(arg))\n\n    return result\n  }\n\n  fillArg(arg: Partial<ModifierArg>) {\n    const { interaction } = this\n\n    arg.interaction = interaction\n    arg.interactable = interaction.interactable\n    arg.element = interaction.element\n    arg.rect ||= interaction.rect\n    arg.edges ||= this.startEdges\n    arg.startOffset = this.startOffset\n\n    return arg as ModifierArg\n  }\n\n  startAll(arg: MethodArg & Partial<ModifierArg>) {\n    for (const state of this.states) {\n      if (state.methods.start) {\n        arg.state = state\n        state.methods.start(arg as ModifierArg)\n      }\n    }\n  }\n\n  setAll(arg: MethodArg & Partial<ModifierArg>): ModificationResult {\n    const { phase, preEnd, skipModifiers, rect: unmodifiedRect, edges: unmodifiedEdges } = arg\n\n    arg.coords = extend({}, arg.pageCoords)\n    arg.rect = extend({}, unmodifiedRect)\n    arg.edges = extend({}, unmodifiedEdges)\n\n    const states = skipModifiers ? this.states.slice(skipModifiers) : this.states\n\n    const newResult = createResult(arg.coords, arg.rect)\n\n    for (const state of states) {\n      const { options } = state\n      const lastModifierCoords = extend({}, arg.coords)\n      let returnValue = null\n\n      if (state.methods?.set && this.shouldDo(options, preEnd, phase)) {\n        arg.state = state\n        returnValue = state.methods.set(arg as ModifierArg<never>)\n\n        rectUtils.addEdges(arg.edges, arg.rect, {\n          x: arg.coords.x - lastModifierCoords.x,\n          y: arg.coords.y - lastModifierCoords.y,\n        })\n      }\n\n      newResult.eventProps.push(returnValue)\n    }\n\n    extend(this.edges, arg.edges)\n\n    newResult.delta.x = arg.coords.x - arg.pageCoords.x\n    newResult.delta.y = arg.coords.y - arg.pageCoords.y\n\n    newResult.rectDelta.left = arg.rect.left - unmodifiedRect.left\n    newResult.rectDelta.right = arg.rect.right - unmodifiedRect.right\n    newResult.rectDelta.top = arg.rect.top - unmodifiedRect.top\n    newResult.rectDelta.bottom = arg.rect.bottom - unmodifiedRect.bottom\n\n    const prevCoords = this.result.coords\n    const prevRect = this.result.rect\n\n    if (prevCoords && prevRect) {\n      const rectChanged =\n        newResult.rect.left !== prevRect.left ||\n        newResult.rect.right !== prevRect.right ||\n        newResult.rect.top !== prevRect.top ||\n        newResult.rect.bottom !== prevRect.bottom\n\n      newResult.changed =\n        rectChanged || prevCoords.x !== newResult.coords.x || prevCoords.y !== newResult.coords.y\n    }\n\n    return newResult\n  }\n\n  applyToInteraction(arg: { phase: EventPhase; rect?: Rect }) {\n    const { interaction } = this\n    const { phase } = arg\n    const curCoords = interaction.coords.cur\n    const startCoords = interaction.coords.start\n    const { result, startDelta } = this\n    const curDelta = result.delta\n\n    if (phase === 'start') {\n      extend(this.startDelta, result.delta)\n    }\n\n    for (const [coordsSet, delta] of [\n      [startCoords, startDelta],\n      [curCoords, curDelta],\n    ] as const) {\n      coordsSet.page.x += delta.x\n      coordsSet.page.y += delta.y\n      coordsSet.client.x += delta.x\n      coordsSet.client.y += delta.y\n    }\n\n    const { rectDelta } = this.result\n    const rect = arg.rect || interaction.rect\n\n    rect.left += rectDelta.left\n    rect.right += rectDelta.right\n    rect.top += rectDelta.top\n    rect.bottom += rectDelta.bottom\n\n    rect.width = rect.right - rect.left\n    rect.height = rect.bottom - rect.top\n  }\n\n  setAndApply(\n    arg: Partial<DoAnyPhaseArg> & {\n      phase: EventPhase\n      preEnd?: boolean\n      skipModifiers?: number\n      modifiedCoords?: Point\n    },\n  ): void | false {\n    const { interaction } = this\n    const { phase, preEnd, skipModifiers } = arg\n\n    const result = this.setAll(\n      this.fillArg({\n        preEnd,\n        phase,\n        pageCoords: arg.modifiedCoords || interaction.coords.cur.page,\n      }),\n    )\n\n    this.result = result\n\n    // don't fire an action move if a modifier would keep the event in the same\n    // cordinates as before\n    if (\n      !result.changed &&\n      (!skipModifiers || skipModifiers < this.states.length) &&\n      interaction.interacting()\n    ) {\n      return false\n    }\n\n    if (arg.modifiedCoords) {\n      const { page } = interaction.coords.cur\n      const adjustment = {\n        x: arg.modifiedCoords.x - page.x,\n        y: arg.modifiedCoords.y - page.y,\n      }\n\n      result.coords.x += adjustment.x\n      result.coords.y += adjustment.y\n      result.delta.x += adjustment.x\n      result.delta.y += adjustment.y\n    }\n\n    this.applyToInteraction(arg)\n  }\n\n  beforeEnd(arg: Omit<DoAnyPhaseArg, 'iEvent'> & { state?: ModifierState }): void | false {\n    const { interaction, event } = arg\n    const states = this.states\n\n    if (!states || !states.length) {\n      return\n    }\n\n    let doPreend = false\n\n    for (const state of states) {\n      arg.state = state\n      const { options, methods } = state\n\n      const endPosition = methods.beforeEnd && methods.beforeEnd(arg as unknown as ModifierArg)\n\n      if (endPosition) {\n        this.endResult = endPosition\n        return false\n      }\n\n      doPreend = doPreend || (!doPreend && this.shouldDo(options, true, arg.phase, true))\n    }\n\n    if (doPreend) {\n      // trigger a final modified move before ending\n      interaction.move({ event, preEnd: true })\n    }\n  }\n\n  stop(arg: { interaction: Interaction }) {\n    const { interaction } = arg\n\n    if (!this.states || !this.states.length) {\n      return\n    }\n\n    const modifierArg: Partial<ModifierArg> = extend(\n      {\n        states: this.states,\n        interactable: interaction.interactable,\n        element: interaction.element,\n        rect: null,\n      },\n      arg,\n    )\n\n    this.fillArg(modifierArg)\n\n    for (const state of this.states) {\n      modifierArg.state = state\n\n      if (state.methods.stop) {\n        state.methods.stop(modifierArg as ModifierArg)\n      }\n    }\n\n    this.states = null\n    this.endResult = null\n  }\n\n  prepareStates(modifierList: Modifier[]) {\n    this.states = []\n\n    for (let index = 0; index < modifierList.length; index++) {\n      const { options, methods, name } = modifierList[index]\n\n      this.states.push({\n        options,\n        methods,\n        index,\n        name,\n      })\n    }\n\n    return this.states\n  }\n\n  restoreInteractionCoords({ interaction: { coords, rect, modification } }: { interaction: Interaction }) {\n    if (!modification.result) return\n\n    const { startDelta } = modification\n    const { delta: curDelta, rectDelta } = modification.result\n\n    const coordsAndDeltas = [\n      [coords.start, startDelta],\n      [coords.cur, curDelta],\n    ]\n\n    for (const [coordsSet, delta] of coordsAndDeltas as any) {\n      coordsSet.page.x -= delta.x\n      coordsSet.page.y -= delta.y\n      coordsSet.client.x -= delta.x\n      coordsSet.client.y -= delta.y\n    }\n\n    rect.left -= rectDelta.left\n    rect.right -= rectDelta.right\n    rect.top -= rectDelta.top\n    rect.bottom -= rectDelta.bottom\n  }\n\n  shouldDo(options, preEnd?: boolean, phase?: string, requireEndOnly?: boolean) {\n    if (\n      // ignore disabled modifiers\n      !options ||\n      options.enabled === false ||\n      // check if we require endOnly option to fire move before end\n      (requireEndOnly && !options.endOnly) ||\n      // don't apply endOnly modifiers when not ending\n      (options.endOnly && !preEnd) ||\n      // check if modifier should run be applied on start\n      (phase === 'start' && !options.setStart)\n    ) {\n      return false\n    }\n\n    return true\n  }\n\n  copyFrom(other: Modification) {\n    this.startOffset = other.startOffset\n    this.startDelta = other.startDelta\n    this.startEdges = other.startEdges\n    this.edges = other.edges\n    this.states = other.states.map((s) => clone(s) as ModifierState)\n    this.result = createResult(extend({}, other.result.coords), extend({}, other.result.rect))\n  }\n\n  destroy() {\n    for (const prop in this) {\n      this[prop] = null\n    }\n  }\n}\n\nfunction createResult(coords?: Point, rect?: FullRect): ModificationResult {\n  return {\n    rect,\n    coords,\n    delta: { x: 0, y: 0 },\n    rectDelta: {\n      left: 0,\n      right: 0,\n      top: 0,\n      bottom: 0,\n    },\n    eventProps: [],\n    changed: true,\n  }\n}\n\nfunction getModifierList(interaction) {\n  const actionOptions = interaction.interactable.options[interaction.prepared.name]\n  const actionModifiers = actionOptions.modifiers\n\n  if (actionModifiers && actionModifiers.length) {\n    return actionModifiers\n  }\n\n  return ['snap', 'snapSize', 'snapEdges', 'restrict', 'restrictEdges', 'restrictSize']\n    .map((type) => {\n      const options = actionOptions[type]\n\n      return (\n        options &&\n        options.enabled && {\n          options,\n          methods: options._methods,\n        }\n      )\n    })\n    .filter((m) => !!m)\n}\n\nexport function getRectOffset(rect, coords) {\n  return rect\n    ? {\n        left: coords.x - rect.left,\n        top: coords.y - rect.top,\n        right: rect.right - coords.x,\n        bottom: rect.bottom - coords.y,\n      }\n    : {\n        left: 0,\n        top: 0,\n        right: 0,\n        bottom: 0,\n      }\n}\n", "import type { InteractEvent } from '@interactjs/core/InteractEvent'\nimport type Interaction from '@interactjs/core/Interaction'\nimport type { Plugin } from '@interactjs/core/scope'\n\nimport { Modification } from './Modification'\nimport type { Modifier, ModifierModule, ModifierState } from './types'\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction {\n    modification?: Modification\n  }\n}\n\ndeclare module '@interactjs/core/InteractEvent' {\n  interface InteractEvent {\n    modifiers?: Array<{\n      name: string\n      [key: string]: any\n    }>\n  }\n}\n\ndeclare module '@interactjs/core/options' {\n  interface PerActionDefaults {\n    modifiers?: Modifier[]\n  }\n}\n\nexport function makeModifier<\n  Defaults extends { enabled?: boolean },\n  State extends ModifierState,\n  Name extends string,\n  Result,\n>(module: ModifierModule<Defaults, State, Result>, name?: Name) {\n  const { defaults } = module\n  const methods = {\n    start: module.start,\n    set: module.set,\n    beforeEnd: module.beforeEnd,\n    stop: module.stop,\n  }\n\n  const modifier = (_options?: Partial<Defaults>) => {\n    const options = (_options || {}) as Defaults\n\n    options.enabled = options.enabled !== false\n\n    // add missing defaults to options\n    for (const prop in defaults) {\n      if (!(prop in options)) {\n        ;(options as any)[prop] = defaults[prop]\n      }\n    }\n\n    const m: Modifier<Defaults, State, Name, Result> = {\n      options,\n      methods,\n      name,\n      enable: () => {\n        options.enabled = true\n        return m\n      },\n      disable: () => {\n        options.enabled = false\n        return m\n      },\n    }\n\n    return m\n  }\n\n  if (name && typeof name === 'string') {\n    // for backwrads compatibility\n    modifier._defaults = defaults\n    modifier._methods = methods\n  }\n\n  return modifier\n}\n\nexport function addEventModifiers({\n  iEvent,\n  interaction,\n}: {\n  iEvent: InteractEvent<any>\n  interaction: Interaction<any>\n}) {\n  const result = interaction.modification!.result\n\n  if (result) {\n    iEvent.modifiers = result.eventProps\n  }\n}\n\nconst modifiersBase: Plugin = {\n  id: 'modifiers/base',\n  before: ['actions'],\n  install: (scope) => {\n    scope.defaults.perAction.modifiers = []\n  },\n  listeners: {\n    'interactions:new': ({ interaction }) => {\n      interaction.modification = new Modification(interaction)\n    },\n\n    'interactions:before-action-start': (arg) => {\n      const { interaction } = arg\n      const modification = arg.interaction.modification!\n\n      modification.start(arg, interaction.coords.start.page)\n      interaction.edges = modification.edges\n      modification.applyToInteraction(arg)\n    },\n\n    'interactions:before-action-move': (arg) => {\n      const { interaction } = arg\n      const { modification } = interaction\n      const ret = modification.setAndApply(arg)\n      interaction.edges = modification.edges\n\n      return ret\n    },\n\n    'interactions:before-action-end': (arg) => {\n      const { interaction } = arg\n      const { modification } = interaction\n      const ret = modification.beforeEnd(arg)\n      interaction.edges = modification.startEdges\n\n      return ret\n    },\n\n    'interactions:action-start': addEventModifiers,\n    'interactions:action-move': addEventModifiers,\n    'interactions:action-end': addEventModifiers,\n\n    'interactions:after-action-start': (arg) => arg.interaction.modification.restoreInteractionCoords(arg),\n    'interactions:after-action-move': (arg) => arg.interaction.modification.restoreInteractionCoords(arg),\n\n    'interactions:stop': (arg) => arg.interaction.modification.stop(arg),\n  },\n}\n\nexport default modifiersBase\n", "import type { Point, Listeners, OrBoolean, Element, Rect } from '@interactjs/core/types'\n\nexport interface Defaults {\n  base: BaseDefaults\n  perAction: PerActionDefaults\n  actions: ActionDefaults\n}\n\n// eslint-disable-next-line @typescript-eslint/no-empty-interface\nexport interface ActionDefaults {}\n\nexport interface BaseDefaults {\n  preventDefault?: 'always' | 'never' | 'auto'\n  deltaSource?: 'page' | 'client'\n  context?: Node\n  getRect?: (element: Element) => Rect\n}\n\nexport interface PerActionDefaults {\n  enabled?: boolean\n  origin?: Point | string | Element\n  listeners?: Listeners\n  allowFrom?: string | Element\n  ignoreFrom?: string | Element\n}\n\nexport type Options = Partial<BaseDefaults> &\n  Partial<PerActionDefaults> & {\n    [P in keyof ActionDefaults]?: Partial<ActionDefaults[P]>\n  }\n\nexport interface OptionsArg extends BaseDefaults, OrBoolean<Partial<ActionDefaults>> {}\n\nexport const defaults: Defaults = {\n  base: {\n    preventDefault: 'auto',\n    deltaSource: 'page',\n  },\n\n  perAction: {\n    enabled: false,\n    origin: { x: 0, y: 0 },\n  },\n\n  actions: {} as ActionDefaults,\n}\n", "import extend from '@interactjs/utils/extend'\nimport getOriginXY from '@interactjs/utils/getOriginXY'\nimport hypot from '@interactjs/utils/hypot'\n\nimport type { Point, FullRect, PointerEventType, Element, ActionName } from '@interactjs/core/types'\n\nimport { BaseEvent } from './BaseEvent'\nimport type { Interaction } from './Interaction'\nimport { defaults } from './options'\n\nexport type EventPhase = keyof PhaseMap\n\nexport interface PhaseMap {\n  start: true\n  move: true\n  end: true\n}\n\n// defined outside of class definition to avoid assignment of undefined during\n// construction\nexport interface InteractEvent {\n  pageX: number\n  pageY: number\n\n  clientX: number\n  clientY: number\n\n  dx: number\n  dy: number\n\n  velocityX: number\n  velocityY: number\n}\n\nexport class InteractEvent<\n  T extends ActionName = never,\n  P extends EventPhase = EventPhase,\n> extends BaseEvent<T> {\n  declare target: Element\n  declare currentTarget: Element\n  relatedTarget: Element | null = null\n  screenX?: number\n  screenY?: number\n  button: number\n  buttons: number\n  ctrlKey: boolean\n  shiftKey: boolean\n  altKey: boolean\n  metaKey: boolean\n  page: Point\n  client: Point\n  delta: Point\n  rect: FullRect\n  x0: number\n  y0: number\n  t0: number\n  dt: number\n  duration: number\n  clientX0: number\n  clientY0: number\n  velocity: Point\n  speed: number\n  swipe: ReturnType<InteractEvent<T>['getSwipe']>\n  // resize\n  axes?: 'x' | 'y' | 'xy'\n  /** @internal */\n  preEnd?: boolean\n\n  constructor(\n    interaction: Interaction<T>,\n    event: PointerEventType,\n    actionName: T,\n    phase: P,\n    element: Element,\n    preEnd?: boolean,\n    type?: string,\n  ) {\n    super(interaction)\n\n    element = element || interaction.element\n\n    const target = interaction.interactable\n    const deltaSource = (((target && target.options) || defaults) as any).deltaSource as 'page' | 'client'\n    const origin = getOriginXY(target, element, actionName)\n    const starting = phase === 'start'\n    const ending = phase === 'end'\n    const prevEvent = starting ? this : interaction.prevEvent\n    const coords = starting\n      ? interaction.coords.start\n      : ending\n        ? { page: prevEvent.page, client: prevEvent.client, timeStamp: interaction.coords.cur.timeStamp }\n        : interaction.coords.cur\n\n    this.page = extend({}, coords.page)\n    this.client = extend({}, coords.client)\n    this.rect = extend({}, interaction.rect)\n    this.timeStamp = coords.timeStamp\n\n    if (!ending) {\n      this.page.x -= origin.x\n      this.page.y -= origin.y\n\n      this.client.x -= origin.x\n      this.client.y -= origin.y\n    }\n\n    this.ctrlKey = event.ctrlKey\n    this.altKey = event.altKey\n    this.shiftKey = event.shiftKey\n    this.metaKey = event.metaKey\n    this.button = (event as MouseEvent).button\n    this.buttons = (event as MouseEvent).buttons\n    this.target = element\n    this.currentTarget = element\n    this.preEnd = preEnd\n    this.type = type || actionName + (phase || '')\n    this.interactable = target\n\n    this.t0 = starting ? interaction.pointers[interaction.pointers.length - 1].downTime : prevEvent.t0\n\n    this.x0 = interaction.coords.start.page.x - origin.x\n    this.y0 = interaction.coords.start.page.y - origin.y\n    this.clientX0 = interaction.coords.start.client.x - origin.x\n    this.clientY0 = interaction.coords.start.client.y - origin.y\n\n    if (starting || ending) {\n      this.delta = { x: 0, y: 0 }\n    } else {\n      this.delta = {\n        x: this[deltaSource].x - prevEvent[deltaSource].x,\n        y: this[deltaSource].y - prevEvent[deltaSource].y,\n      }\n    }\n\n    this.dt = interaction.coords.delta.timeStamp\n    this.duration = this.timeStamp - this.t0\n\n    // velocity and speed in pixels per second\n    this.velocity = extend({}, interaction.coords.velocity[deltaSource])\n    this.speed = hypot(this.velocity.x, this.velocity.y)\n\n    this.swipe = ending || phase === 'inertiastart' ? this.getSwipe() : null\n  }\n\n  getSwipe() {\n    const interaction = this._interaction\n\n    if (interaction.prevEvent.speed < 600 || this.timeStamp - interaction.prevEvent.timeStamp > 150) {\n      return null\n    }\n\n    let angle = (180 * Math.atan2(interaction.prevEvent.velocityY, interaction.prevEvent.velocityX)) / Math.PI\n    const overlap = 22.5\n\n    if (angle < 0) {\n      angle += 360\n    }\n\n    const left = 135 - overlap <= angle && angle < 225 + overlap\n    const up = 225 - overlap <= angle && angle < 315 + overlap\n\n    const right = !left && (315 - overlap <= angle || angle < 45 + overlap)\n    const down = !up && 45 - overlap <= angle && angle < 135 + overlap\n\n    return {\n      up,\n      down,\n      left,\n      right,\n      angle,\n      speed: interaction.prevEvent.speed,\n      velocity: {\n        x: interaction.prevEvent.velocityX,\n        y: interaction.prevEvent.velocityY,\n      },\n    }\n  }\n\n  preventDefault() {}\n\n  /**\n   * Don't call listeners on the remaining targets\n   */\n  stopImmediatePropagation() {\n    this.immediatePropagationStopped = this.propagationStopped = true\n  }\n\n  /**\n   * Don't call any other listeners (even on the current target)\n   */\n  stopPropagation() {\n    this.propagationStopped = true\n  }\n}\n\n// getters and setters defined here to support typescript 3.6 and below which\n// don't support getter and setters in .d.ts files\nObject.defineProperties(InteractEvent.prototype, {\n  pageX: {\n    get() {\n      return this.page.x\n    },\n    set(value) {\n      this.page.x = value\n    },\n  },\n  pageY: {\n    get() {\n      return this.page.y\n    },\n    set(value) {\n      this.page.y = value\n    },\n  },\n\n  clientX: {\n    get() {\n      return this.client.x\n    },\n    set(value) {\n      this.client.x = value\n    },\n  },\n  clientY: {\n    get() {\n      return this.client.y\n    },\n    set(value) {\n      this.client.y = value\n    },\n  },\n\n  dx: {\n    get() {\n      return this.delta.x\n    },\n    set(value) {\n      this.delta.x = value\n    },\n  },\n  dy: {\n    get() {\n      return this.delta.y\n    },\n    set(value) {\n      this.delta.y = value\n    },\n  },\n\n  velocityX: {\n    get() {\n      return this.velocity.x\n    },\n    set(value) {\n      this.velocity.x = value\n    },\n  },\n  velocityY: {\n    get() {\n      return this.velocity.y\n    },\n    set(value) {\n      this.velocity.y = value\n    },\n  },\n})\n", "import type { PointerEventType, PointerType } from '@interactjs/core/types'\n\nexport class PointerInfo {\n  id: number\n  pointer: PointerType\n  event: PointerEventType\n  downTime: number\n  downTarget: Node\n\n  constructor(id: number, pointer: PointerType, event: PointerEventType, downTime: number, downTarget: Node) {\n    this.id = id\n    this.pointer = pointer\n    this.event = event\n    this.downTime = downTime\n    this.downTarget = downTarget\n  }\n}\n", "import * as arr from '@interactjs/utils/arr'\nimport extend from '@interactjs/utils/extend'\nimport hypot from '@interactjs/utils/hypot'\nimport { warnOnce, copyAction } from '@interactjs/utils/misc'\nimport * as pointerUtils from '@interactjs/utils/pointerUtils'\nimport * as rectUtils from '@interactjs/utils/rect'\n\nimport type {\n  Element,\n  EdgeOptions,\n  PointerEventType,\n  PointerType,\n  FullRect,\n  CoordsSet,\n  ActionName,\n  ActionProps,\n} from '@interactjs/core/types'\n\nimport type { Interactable } from './Interactable'\nimport type { EventPhase } from './InteractEvent'\nimport { InteractEvent } from './InteractEvent'\nimport type { ActionDefaults } from './options'\nimport { PointerInfo } from './PointerInfo'\nimport type { Scope } from './scope'\n\nexport enum _ProxyValues {\n  interactable = '',\n  element = '',\n  prepared = '',\n  pointerIsDown = '',\n  pointerWasMoved = '',\n  _proxy = '',\n}\n\nexport enum _ProxyMethods {\n  start = '',\n  move = '',\n  end = '',\n  stop = '',\n  interacting = '',\n}\n\nexport type PointerArgProps<T extends {} = {}> = {\n  pointer: PointerType\n  event: PointerEventType\n  eventTarget: Node\n  pointerIndex: number\n  pointerInfo: PointerInfo\n  interaction: Interaction<never>\n} & T\n\nexport interface DoPhaseArg<T extends ActionName, P extends EventPhase> {\n  event: PointerEventType\n  phase: EventPhase\n  interaction: Interaction<T>\n  iEvent: InteractEvent<T, P>\n  preEnd?: boolean\n  type?: string\n}\n\nexport type DoAnyPhaseArg = DoPhaseArg<ActionName, EventPhase>\n\ndeclare module '@interactjs/core/scope' {\n  interface SignalArgs {\n    'interactions:new': { interaction: Interaction<ActionName> }\n    'interactions:down': PointerArgProps<{\n      type: 'down'\n    }>\n    'interactions:move': PointerArgProps<{\n      type: 'move'\n      dx: number\n      dy: number\n      duplicate: boolean\n    }>\n    'interactions:up': PointerArgProps<{\n      type: 'up'\n      curEventTarget: EventTarget\n    }>\n    'interactions:cancel': SignalArgs['interactions:up'] & {\n      type: 'cancel'\n      curEventTarget: EventTarget\n    }\n    'interactions:update-pointer': PointerArgProps<{\n      down: boolean\n    }>\n    'interactions:remove-pointer': PointerArgProps\n    'interactions:blur': { interaction: Interaction<never>; event: Event; type: 'blur' }\n    'interactions:before-action-start': Omit<DoAnyPhaseArg, 'iEvent'>\n    'interactions:action-start': DoAnyPhaseArg\n    'interactions:after-action-start': DoAnyPhaseArg\n    'interactions:before-action-move': Omit<DoAnyPhaseArg, 'iEvent'>\n    'interactions:action-move': DoAnyPhaseArg\n    'interactions:after-action-move': DoAnyPhaseArg\n    'interactions:before-action-end': Omit<DoAnyPhaseArg, 'iEvent'>\n    'interactions:action-end': DoAnyPhaseArg\n    'interactions:after-action-end': DoAnyPhaseArg\n    'interactions:stop': { interaction: Interaction }\n  }\n}\n\nexport type InteractionProxy<T extends ActionName | null = never> = Pick<\n  Interaction<T>,\n  Exclude<keyof typeof _ProxyValues | keyof typeof _ProxyMethods, '_proxy'>\n>\n\nlet idCounter = 0\n\nexport class Interaction<T extends ActionName | null = ActionName> {\n  /** current interactable being interacted with */\n  interactable: Interactable | null = null\n\n  /** the target element of the interactable */\n  element: Element | null = null\n  rect: FullRect | null = null\n  /** @internal */\n  _rects?: {\n    start: FullRect\n    corrected: FullRect\n    previous: FullRect\n    delta: FullRect\n  }\n  /** @internal */\n  edges: EdgeOptions | null = null\n\n  /** @internal */\n  _scopeFire: Scope['fire']\n\n  // action that's ready to be fired on next move event\n  prepared: ActionProps<T> = {\n    name: null,\n    axis: null,\n    edges: null,\n  }\n\n  pointerType: string\n\n  /** @internal keep track of added pointers */\n  pointers: PointerInfo[] = []\n\n  /** @internal pointerdown/mousedown/touchstart event */\n  downEvent: PointerEventType | null = null\n\n  /** @internal */ downPointer: PointerType = {} as PointerType\n\n  /** @internal */\n  _latestPointer: {\n    pointer: PointerType\n    event: PointerEventType\n    eventTarget: Node\n  } = {\n    pointer: null,\n    event: null,\n    eventTarget: null,\n  }\n\n  /** @internal */ prevEvent: InteractEvent<T, EventPhase> = null\n\n  pointerIsDown = false\n  pointerWasMoved = false\n  /** @internal */ _interacting = false\n  /** @internal */ _ending = false\n  /** @internal */ _stopped = true\n  /** @internal */ _proxy: InteractionProxy<T>\n\n  /** @internal */ simulation = null\n\n  /** @internal */ get pointerMoveTolerance() {\n    return 1\n  }\n\n  doMove = warnOnce(function (this: Interaction, signalArg: any) {\n    this.move(signalArg)\n  }, 'The interaction.doMove() method has been renamed to interaction.move()')\n\n  coords: CoordsSet = {\n    // Starting InteractEvent pointer coordinates\n    start: pointerUtils.newCoords(),\n    // Previous native pointer move event coordinates\n    prev: pointerUtils.newCoords(),\n    // current native pointer move event coordinates\n    cur: pointerUtils.newCoords(),\n    // Change in coordinates and time of the pointer\n    delta: pointerUtils.newCoords(),\n    // pointer velocity\n    velocity: pointerUtils.newCoords(),\n  }\n\n  /** @internal */ readonly _id: number = idCounter++\n\n  constructor({ pointerType, scopeFire }: { pointerType?: string; scopeFire: Scope['fire'] }) {\n    this._scopeFire = scopeFire\n    this.pointerType = pointerType\n\n    const that = this\n\n    this._proxy = {} as InteractionProxy<T>\n\n    for (const key in _ProxyValues) {\n      Object.defineProperty(this._proxy, key, {\n        get() {\n          return that[key]\n        },\n      })\n    }\n\n    for (const key in _ProxyMethods) {\n      Object.defineProperty(this._proxy, key, {\n        value: (...args: any[]) => that[key](...args),\n      })\n    }\n\n    this._scopeFire('interactions:new', { interaction: this })\n  }\n\n  pointerDown(pointer: PointerType, event: PointerEventType, eventTarget: Node) {\n    const pointerIndex = this.updatePointer(pointer, event, eventTarget, true)\n    const pointerInfo = this.pointers[pointerIndex]\n\n    this._scopeFire('interactions:down', {\n      pointer,\n      event,\n      eventTarget,\n      pointerIndex,\n      pointerInfo,\n      type: 'down',\n      interaction: this as unknown as Interaction<never>,\n    })\n  }\n\n  /**\n   * ```js\n   * interact(target)\n   *   .draggable({\n   *     // disable the default drag start by down->move\n   *     manualStart: true\n   *   })\n   *   // start dragging after the user holds the pointer down\n   *   .on('hold', function (event) {\n   *     var interaction = event.interaction\n   *\n   *     if (!interaction.interacting()) {\n   *       interaction.start({ name: 'drag' },\n   *                         event.interactable,\n   *                         event.currentTarget)\n   *     }\n   * })\n   * ```\n   *\n   * Start an action with the given Interactable and Element as tartgets. The\n   * action must be enabled for the target Interactable and an appropriate\n   * number of pointers must be held down - 1 for drag/resize, 2 for gesture.\n   *\n   * Use it with `interactable.<action>able({ manualStart: false })` to always\n   * [start actions manually](https://github.com/taye/interact.js/issues/114)\n   *\n   * @param action - The action to be performed - drag, resize, etc.\n   * @param target - The Interactable to target\n   * @param element - The DOM Element to target\n   * @returns Whether the interaction was successfully started\n   */\n  start<A extends ActionName>(action: ActionProps<A>, interactable: Interactable, element: Element): boolean {\n    if (\n      this.interacting() ||\n      !this.pointerIsDown ||\n      this.pointers.length < (action.name === 'gesture' ? 2 : 1) ||\n      !interactable.options[action.name as keyof ActionDefaults].enabled\n    ) {\n      return false\n    }\n\n    copyAction(this.prepared, action)\n\n    this.interactable = interactable\n    this.element = element\n    this.rect = interactable.getRect(element)\n    this.edges = this.prepared.edges\n      ? extend({}, this.prepared.edges)\n      : { left: true, right: true, top: true, bottom: true }\n    this._stopped = false\n    this._interacting =\n      this._doPhase({\n        interaction: this,\n        event: this.downEvent,\n        phase: 'start',\n      }) && !this._stopped\n\n    return this._interacting\n  }\n\n  pointerMove(pointer: PointerType, event: PointerEventType, eventTarget: Node) {\n    if (!this.simulation && !(this.modification && this.modification.endResult)) {\n      this.updatePointer(pointer, event, eventTarget, false)\n    }\n\n    const duplicateMove =\n      this.coords.cur.page.x === this.coords.prev.page.x &&\n      this.coords.cur.page.y === this.coords.prev.page.y &&\n      this.coords.cur.client.x === this.coords.prev.client.x &&\n      this.coords.cur.client.y === this.coords.prev.client.y\n\n    let dx: number\n    let dy: number\n\n    // register movement greater than pointerMoveTolerance\n    if (this.pointerIsDown && !this.pointerWasMoved) {\n      dx = this.coords.cur.client.x - this.coords.start.client.x\n      dy = this.coords.cur.client.y - this.coords.start.client.y\n\n      this.pointerWasMoved = hypot(dx, dy) > this.pointerMoveTolerance\n    }\n\n    const pointerIndex = this.getPointerIndex(pointer)\n    const signalArg = {\n      pointer,\n      pointerIndex,\n      pointerInfo: this.pointers[pointerIndex],\n      event,\n      type: 'move' as const,\n      eventTarget,\n      dx,\n      dy,\n      duplicate: duplicateMove,\n      interaction: this as unknown as Interaction<never>,\n    }\n\n    if (!duplicateMove) {\n      // set pointer coordinate, time changes and velocity\n      pointerUtils.setCoordVelocity(this.coords.velocity, this.coords.delta)\n    }\n\n    this._scopeFire('interactions:move', signalArg)\n\n    if (!duplicateMove && !this.simulation) {\n      // if interacting, fire an 'action-move' signal etc\n      if (this.interacting()) {\n        signalArg.type = null\n        this.move(signalArg)\n      }\n\n      if (this.pointerWasMoved) {\n        pointerUtils.copyCoords(this.coords.prev, this.coords.cur)\n      }\n    }\n  }\n\n  /**\n   * ```js\n   * interact(target)\n   *   .draggable(true)\n   *   .on('dragmove', function (event) {\n   *     if (someCondition) {\n   *       // change the snap settings\n   *       event.interactable.draggable({ snap: { targets: [] }})\n   *       // fire another move event with re-calculated snap\n   *       event.interaction.move()\n   *     }\n   *   })\n   * ```\n   *\n   * Force a move of the current action at the same coordinates. Useful if\n   * snap/restrict has been changed and you want a movement with the new\n   * settings.\n   */\n  move(signalArg?: any) {\n    if (!signalArg || !signalArg.event) {\n      pointerUtils.setZeroCoords(this.coords.delta)\n    }\n\n    signalArg = extend(\n      {\n        pointer: this._latestPointer.pointer,\n        event: this._latestPointer.event,\n        eventTarget: this._latestPointer.eventTarget,\n        interaction: this,\n      },\n      signalArg || {},\n    )\n\n    signalArg.phase = 'move'\n\n    this._doPhase(signalArg)\n  }\n\n  /**\n   * @internal\n   * End interact move events and stop auto-scroll unless simulation is running\n   */\n  pointerUp(pointer: PointerType, event: PointerEventType, eventTarget: Node, curEventTarget: EventTarget) {\n    let pointerIndex = this.getPointerIndex(pointer)\n\n    if (pointerIndex === -1) {\n      pointerIndex = this.updatePointer(pointer, event, eventTarget, false)\n    }\n\n    const type = /cancel$/i.test(event.type) ? 'cancel' : 'up'\n\n    this._scopeFire(`interactions:${type}` as 'interactions:up' | 'interactions:cancel', {\n      pointer,\n      pointerIndex,\n      pointerInfo: this.pointers[pointerIndex],\n      event,\n      eventTarget,\n      type: type as any,\n      curEventTarget,\n      interaction: this as unknown as Interaction<never>,\n    })\n\n    if (!this.simulation) {\n      this.end(event)\n    }\n\n    this.removePointer(pointer, event)\n  }\n\n  /** @internal */\n  documentBlur(event: Event) {\n    this.end(event as any)\n    this._scopeFire('interactions:blur', {\n      event,\n      type: 'blur',\n      interaction: this as unknown as Interaction<never>,\n    })\n  }\n\n  /**\n   * ```js\n   * interact(target)\n   *   .draggable(true)\n   *   .on('move', function (event) {\n   *     if (event.pageX > 1000) {\n   *       // end the current action\n   *       event.interaction.end()\n   *       // stop all further listeners from being called\n   *       event.stopImmediatePropagation()\n   *     }\n   *   })\n   * ```\n   */\n  end(event?: PointerEventType) {\n    this._ending = true\n    event = event || this._latestPointer.event\n    let endPhaseResult: boolean\n\n    if (this.interacting()) {\n      endPhaseResult = this._doPhase({\n        event,\n        interaction: this,\n        phase: 'end',\n      })\n    }\n\n    this._ending = false\n\n    if (endPhaseResult === true) {\n      this.stop()\n    }\n  }\n\n  currentAction() {\n    return this._interacting ? this.prepared.name : null\n  }\n\n  interacting() {\n    return this._interacting\n  }\n\n  stop() {\n    this._scopeFire('interactions:stop', { interaction: this })\n\n    this.interactable = this.element = null\n\n    this._interacting = false\n    this._stopped = true\n    this.prepared.name = this.prevEvent = null\n  }\n\n  /** @internal */\n  getPointerIndex(pointer: any) {\n    const pointerId = pointerUtils.getPointerId(pointer)\n\n    // mouse and pen interactions may have only one pointer\n    return this.pointerType === 'mouse' || this.pointerType === 'pen'\n      ? this.pointers.length - 1\n      : arr.findIndex(this.pointers, (curPointer) => curPointer.id === pointerId)\n  }\n\n  /** @internal */\n  getPointerInfo(pointer: any) {\n    return this.pointers[this.getPointerIndex(pointer)]\n  }\n\n  /** @internal */\n  updatePointer(pointer: PointerType, event: PointerEventType, eventTarget: Node, down?: boolean) {\n    const id = pointerUtils.getPointerId(pointer)\n    let pointerIndex = this.getPointerIndex(pointer)\n    let pointerInfo = this.pointers[pointerIndex]\n\n    down = down === false ? false : down || /(down|start)$/i.test(event.type)\n\n    if (!pointerInfo) {\n      pointerInfo = new PointerInfo(id, pointer, event, null, null)\n\n      pointerIndex = this.pointers.length\n      this.pointers.push(pointerInfo)\n    } else {\n      pointerInfo.pointer = pointer\n    }\n\n    pointerUtils.setCoords(\n      this.coords.cur,\n      this.pointers.map((p) => p.pointer),\n      this._now(),\n    )\n    pointerUtils.setCoordDeltas(this.coords.delta, this.coords.prev, this.coords.cur)\n\n    if (down) {\n      this.pointerIsDown = true\n\n      pointerInfo.downTime = this.coords.cur.timeStamp\n      pointerInfo.downTarget = eventTarget\n      pointerUtils.pointerExtend(this.downPointer, pointer)\n\n      if (!this.interacting()) {\n        pointerUtils.copyCoords(this.coords.start, this.coords.cur)\n        pointerUtils.copyCoords(this.coords.prev, this.coords.cur)\n\n        this.downEvent = event\n        this.pointerWasMoved = false\n      }\n    }\n\n    this._updateLatestPointer(pointer, event, eventTarget)\n\n    this._scopeFire('interactions:update-pointer', {\n      pointer,\n      event,\n      eventTarget,\n      down,\n      pointerInfo,\n      pointerIndex,\n      interaction: this as unknown as Interaction<never>,\n    })\n\n    return pointerIndex\n  }\n\n  /** @internal */\n  removePointer(pointer: PointerType, event: PointerEventType) {\n    const pointerIndex = this.getPointerIndex(pointer)\n\n    if (pointerIndex === -1) return\n\n    const pointerInfo = this.pointers[pointerIndex]\n\n    this._scopeFire('interactions:remove-pointer', {\n      pointer,\n      event,\n      eventTarget: null,\n      pointerIndex,\n      pointerInfo,\n      interaction: this as unknown as Interaction<never>,\n    })\n\n    this.pointers.splice(pointerIndex, 1)\n    this.pointerIsDown = false\n  }\n\n  /** @internal */\n  _updateLatestPointer(pointer: PointerType, event: PointerEventType, eventTarget: Node) {\n    this._latestPointer.pointer = pointer\n    this._latestPointer.event = event\n    this._latestPointer.eventTarget = eventTarget\n  }\n\n  destroy() {\n    this._latestPointer.pointer = null\n    this._latestPointer.event = null\n    this._latestPointer.eventTarget = null\n  }\n\n  /** @internal */\n  _createPreparedEvent<P extends EventPhase>(\n    event: PointerEventType,\n    phase: P,\n    preEnd?: boolean,\n    type?: string,\n  ) {\n    return new InteractEvent<T, P>(this, event, this.prepared.name, phase, this.element, preEnd, type)\n  }\n\n  /** @internal */\n  _fireEvent<P extends EventPhase>(iEvent: InteractEvent<T, P>) {\n    this.interactable?.fire(iEvent)\n\n    if (!this.prevEvent || iEvent.timeStamp >= this.prevEvent.timeStamp) {\n      this.prevEvent = iEvent\n    }\n  }\n\n  /** @internal */\n  _doPhase<P extends EventPhase>(\n    signalArg: Omit<DoPhaseArg<T, P>, 'iEvent'> & { iEvent?: InteractEvent<T, P> },\n  ) {\n    const { event, phase, preEnd, type } = signalArg\n    const { rect } = this\n\n    if (rect && phase === 'move') {\n      // update the rect changes due to pointer move\n      rectUtils.addEdges(this.edges, rect, this.coords.delta[this.interactable.options.deltaSource])\n\n      rect.width = rect.right - rect.left\n      rect.height = rect.bottom - rect.top\n    }\n\n    const beforeResult = this._scopeFire(`interactions:before-action-${phase}` as any, signalArg)\n\n    if (beforeResult === false) {\n      return false\n    }\n\n    const iEvent = (signalArg.iEvent = this._createPreparedEvent(event, phase, preEnd, type))\n\n    this._scopeFire(`interactions:action-${phase}` as any, signalArg)\n\n    if (phase === 'start') {\n      this.prevEvent = iEvent\n    }\n\n    this._fireEvent(iEvent)\n\n    this._scopeFire(`interactions:after-action-${phase}` as any, signalArg)\n\n    return true\n  }\n\n  /** @internal */\n  _now() {\n    return Date.now()\n  }\n}\n\nexport default Interaction\nexport { PointerInfo }\n", "import type Interaction from '@interactjs/core/Interaction'\nimport { _ProxyMethods } from '@interactjs/core/Interaction'\nimport type { Plugin } from '@interactjs/core/scope'\nimport type { Point } from '@interactjs/core/types'\nimport * as rectUtils from '@interactjs/utils/rect'\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction {\n    offsetBy?: typeof offsetBy\n    offset: {\n      total: Point\n      pending: Point\n    }\n  }\n\n  enum _ProxyMethods {\n    offsetBy = '',\n  }\n}\n\n;(_ProxyMethods as any).offsetBy = ''\n\nexport function addTotal(interaction: Interaction) {\n  if (!interaction.pointerIsDown) {\n    return\n  }\n\n  addToCoords(interaction.coords.cur, interaction.offset.total)\n\n  interaction.offset.pending.x = 0\n  interaction.offset.pending.y = 0\n}\n\nfunction beforeAction({ interaction }: { interaction: Interaction }) {\n  applyPending(interaction)\n}\n\nfunction beforeEnd({ interaction }: { interaction: Interaction }): boolean | void {\n  const hadPending = applyPending(interaction)\n\n  if (!hadPending) return\n\n  interaction.move({ offset: true })\n  interaction.end()\n\n  return false\n}\n\nfunction end({ interaction }: { interaction: Interaction }) {\n  interaction.offset.total.x = 0\n  interaction.offset.total.y = 0\n  interaction.offset.pending.x = 0\n  interaction.offset.pending.y = 0\n}\n\nexport function applyPending(interaction: Interaction) {\n  if (!hasPending(interaction)) {\n    return false\n  }\n\n  const { pending } = interaction.offset\n\n  addToCoords(interaction.coords.cur, pending)\n  addToCoords(interaction.coords.delta, pending)\n  rectUtils.addEdges(interaction.edges, interaction.rect, pending)\n\n  pending.x = 0\n  pending.y = 0\n\n  return true\n}\n\nfunction offsetBy(this: Interaction, { x, y }: Point) {\n  this.offset.pending.x += x\n  this.offset.pending.y += y\n\n  this.offset.total.x += x\n  this.offset.total.y += y\n}\n\nfunction addToCoords({ page, client }, { x, y }: Point) {\n  page.x += x\n  page.y += y\n  client.x += x\n  client.y += y\n}\n\nfunction hasPending(interaction: Interaction) {\n  return !!(interaction.offset.pending.x || interaction.offset.pending.y)\n}\n\nconst offset: Plugin = {\n  id: 'offset',\n  before: ['modifiers', 'pointer-events', 'actions', 'inertia'],\n  install(scope) {\n    scope.Interaction.prototype.offsetBy = offsetBy\n  },\n  listeners: {\n    'interactions:new': ({ interaction }) => {\n      interaction.offset = {\n        total: { x: 0, y: 0 },\n        pending: { x: 0, y: 0 },\n      }\n    },\n    'interactions:update-pointer': ({ interaction }) => addTotal(interaction),\n    'interactions:before-action-start': beforeAction,\n    'interactions:before-action-move': beforeAction,\n    'interactions:before-action-end': beforeEnd,\n    'interactions:stop': end,\n  },\n}\n\nexport default offset\n", "import type { Interaction, DoPhaseArg } from '@interactjs/core/Interaction'\nimport type { Scope, SignalArgs, Plugin } from '@interactjs/core/scope'\nimport type { ActionName, Point, PointerEventType } from '@interactjs/core/types'\n/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport '@interactjs/modifiers/base'\nimport '@interactjs/offset/plugin'\nimport * as modifiers from '@interactjs/modifiers/base'\nimport { Modification } from '@interactjs/modifiers/Modification'\nimport type { ModifierArg } from '@interactjs/modifiers/types'\nimport offset from '@interactjs/offset/plugin'\n/* eslint-enable import/no-duplicates */\nimport * as dom from '@interactjs/utils/domUtils'\nimport hypot from '@interactjs/utils/hypot'\nimport is from '@interactjs/utils/is'\nimport { copyCoords } from '@interactjs/utils/pointerUtils'\nimport raf from '@interactjs/utils/raf'\n\ndeclare module '@interactjs/core/InteractEvent' {\n  interface PhaseMap {\n    resume?: true\n    inertiastart?: true\n  }\n}\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction {\n    inertia?: InertiaState\n  }\n}\n\ndeclare module '@interactjs/core/options' {\n  interface PerActionDefaults {\n    inertia?: {\n      enabled?: boolean\n      resistance?: number // the lambda in exponential decay\n      minSpeed?: number // target speed must be above this for inertia to start\n      endSpeed?: number // the speed at which inertia is slow enough to stop\n      allowResume?: true // allow resuming an action in inertia phase\n      smoothEndDuration?: number // animate to snap/restrict endOnly if there's no inertia\n    }\n  }\n}\n\ndeclare module '@interactjs/core/scope' {\n  interface SignalArgs {\n    'interactions:before-action-inertiastart': Omit<DoPhaseArg<ActionName, 'inertiastart'>, 'iEvent'>\n    'interactions:action-inertiastart': DoPhaseArg<ActionName, 'inertiastart'>\n    'interactions:after-action-inertiastart': DoPhaseArg<ActionName, 'inertiastart'>\n    'interactions:before-action-resume': Omit<DoPhaseArg<ActionName, 'resume'>, 'iEvent'>\n    'interactions:action-resume': DoPhaseArg<ActionName, 'resume'>\n    'interactions:after-action-resume': DoPhaseArg<ActionName, 'resume'>\n  }\n}\n\nfunction install(scope: Scope) {\n  const { defaults } = scope\n\n  scope.usePlugin(offset)\n  scope.usePlugin(modifiers.default)\n  scope.actions.phases.inertiastart = true\n  scope.actions.phases.resume = true\n\n  defaults.perAction.inertia = {\n    enabled: false,\n    resistance: 10, // the lambda in exponential decay\n    minSpeed: 100, // target speed must be above this for inertia to start\n    endSpeed: 10, // the speed at which inertia is slow enough to stop\n    allowResume: true, // allow resuming an action in inertia phase\n    smoothEndDuration: 300, // animate to snap/restrict endOnly if there's no inertia\n  }\n}\n\nexport class InertiaState {\n  active = false\n  isModified = false\n  smoothEnd = false\n  allowResume = false\n\n  modification!: Modification\n  modifierCount = 0\n  modifierArg!: ModifierArg\n\n  startCoords!: Point\n  t0 = 0\n  v0 = 0\n\n  te = 0\n  targetOffset!: Point\n  modifiedOffset!: Point\n  currentOffset!: Point\n\n  lambda_v0? = 0 // eslint-disable-line camelcase\n  one_ve_v0? = 0 // eslint-disable-line camelcase\n  timeout!: number\n  readonly interaction: Interaction\n\n  constructor(interaction: Interaction) {\n    this.interaction = interaction\n  }\n\n  start(event: PointerEventType) {\n    const { interaction } = this\n    const options = getOptions(interaction)\n\n    if (!options || !options.enabled) {\n      return false\n    }\n\n    const { client: velocityClient } = interaction.coords.velocity\n    const pointerSpeed = hypot(velocityClient.x, velocityClient.y)\n    const modification = this.modification || (this.modification = new Modification(interaction))\n\n    modification.copyFrom(interaction.modification)\n\n    this.t0 = interaction._now()\n    this.allowResume = options.allowResume\n    this.v0 = pointerSpeed\n    this.currentOffset = { x: 0, y: 0 }\n    this.startCoords = interaction.coords.cur.page\n\n    this.modifierArg = modification.fillArg({\n      pageCoords: this.startCoords,\n      preEnd: true,\n      phase: 'inertiastart',\n    })\n\n    const thrown =\n      this.t0 - interaction.coords.cur.timeStamp < 50 &&\n      pointerSpeed > options.minSpeed &&\n      pointerSpeed > options.endSpeed\n\n    if (thrown) {\n      this.startInertia()\n    } else {\n      modification.result = modification.setAll(this.modifierArg)\n\n      if (!modification.result.changed) {\n        return false\n      }\n\n      this.startSmoothEnd()\n    }\n\n    // force modification change\n    interaction.modification.result.rect = null\n\n    // bring inertiastart event to the target coords\n    interaction.offsetBy(this.targetOffset)\n    interaction._doPhase({\n      interaction,\n      event,\n      phase: 'inertiastart',\n    })\n    interaction.offsetBy({ x: -this.targetOffset.x, y: -this.targetOffset.y })\n    // force modification change\n    interaction.modification.result.rect = null\n\n    this.active = true\n    interaction.simulation = this\n\n    return true\n  }\n\n  startInertia() {\n    const startVelocity = this.interaction.coords.velocity.client\n    const options = getOptions(this.interaction)\n    const lambda = options.resistance\n    const inertiaDur = -Math.log(options.endSpeed / this.v0) / lambda\n\n    this.targetOffset = {\n      x: (startVelocity.x - inertiaDur) / lambda,\n      y: (startVelocity.y - inertiaDur) / lambda,\n    }\n\n    this.te = inertiaDur\n    this.lambda_v0 = lambda / this.v0\n    this.one_ve_v0 = 1 - options.endSpeed / this.v0\n\n    const { modification, modifierArg } = this\n\n    modifierArg.pageCoords = {\n      x: this.startCoords.x + this.targetOffset.x,\n      y: this.startCoords.y + this.targetOffset.y,\n    }\n\n    modification.result = modification.setAll(modifierArg)\n\n    if (modification.result.changed) {\n      this.isModified = true\n      this.modifiedOffset = {\n        x: this.targetOffset.x + modification.result.delta.x,\n        y: this.targetOffset.y + modification.result.delta.y,\n      }\n    }\n\n    this.onNextFrame(() => this.inertiaTick())\n  }\n\n  startSmoothEnd() {\n    this.smoothEnd = true\n    this.isModified = true\n    this.targetOffset = {\n      x: this.modification.result.delta.x,\n      y: this.modification.result.delta.y,\n    }\n\n    this.onNextFrame(() => this.smoothEndTick())\n  }\n\n  onNextFrame(tickFn: () => void) {\n    this.timeout = raf.request(() => {\n      if (this.active) {\n        tickFn()\n      }\n    })\n  }\n\n  inertiaTick() {\n    const { interaction } = this\n    const options = getOptions(interaction)\n    const lambda = options.resistance\n    const t = (interaction._now() - this.t0) / 1000\n\n    if (t < this.te) {\n      const progress = 1 - (Math.exp(-lambda * t) - this.lambda_v0) / this.one_ve_v0\n      let newOffset: Point\n\n      if (this.isModified) {\n        newOffset = getQuadraticCurvePoint(\n          0,\n          0,\n          this.targetOffset.x,\n          this.targetOffset.y,\n          this.modifiedOffset.x,\n          this.modifiedOffset.y,\n          progress,\n        )\n      } else {\n        newOffset = {\n          x: this.targetOffset.x * progress,\n          y: this.targetOffset.y * progress,\n        }\n      }\n\n      const delta = { x: newOffset.x - this.currentOffset.x, y: newOffset.y - this.currentOffset.y }\n\n      this.currentOffset.x += delta.x\n      this.currentOffset.y += delta.y\n\n      interaction.offsetBy(delta)\n      interaction.move()\n\n      this.onNextFrame(() => this.inertiaTick())\n    } else {\n      interaction.offsetBy({\n        x: this.modifiedOffset.x - this.currentOffset.x,\n        y: this.modifiedOffset.y - this.currentOffset.y,\n      })\n\n      this.end()\n    }\n  }\n\n  smoothEndTick() {\n    const { interaction } = this\n    const t = interaction._now() - this.t0\n    const { smoothEndDuration: duration } = getOptions(interaction)\n\n    if (t < duration) {\n      const newOffset = {\n        x: easeOutQuad(t, 0, this.targetOffset.x, duration),\n        y: easeOutQuad(t, 0, this.targetOffset.y, duration),\n      }\n      const delta = {\n        x: newOffset.x - this.currentOffset.x,\n        y: newOffset.y - this.currentOffset.y,\n      }\n\n      this.currentOffset.x += delta.x\n      this.currentOffset.y += delta.y\n\n      interaction.offsetBy(delta)\n      interaction.move({ skipModifiers: this.modifierCount })\n\n      this.onNextFrame(() => this.smoothEndTick())\n    } else {\n      interaction.offsetBy({\n        x: this.targetOffset.x - this.currentOffset.x,\n        y: this.targetOffset.y - this.currentOffset.y,\n      })\n\n      this.end()\n    }\n  }\n\n  resume({ pointer, event, eventTarget }: SignalArgs['interactions:down']) {\n    const { interaction } = this\n\n    // undo inertia changes to interaction coords\n    interaction.offsetBy({\n      x: -this.currentOffset.x,\n      y: -this.currentOffset.y,\n    })\n\n    // update pointer at pointer down position\n    interaction.updatePointer(pointer, event, eventTarget, true)\n\n    // fire resume signals and event\n    interaction._doPhase({\n      interaction,\n      event,\n      phase: 'resume',\n    })\n    copyCoords(interaction.coords.prev, interaction.coords.cur)\n\n    this.stop()\n  }\n\n  end() {\n    this.interaction.move()\n    this.interaction.end()\n    this.stop()\n  }\n\n  stop() {\n    this.active = this.smoothEnd = false\n    this.interaction.simulation = null\n    raf.cancel(this.timeout)\n  }\n}\n\nfunction start({ interaction, event }: DoPhaseArg<ActionName, 'end'>) {\n  if (!interaction._interacting || interaction.simulation) {\n    return null\n  }\n\n  const started = interaction.inertia.start(event)\n\n  // prevent action end if inertia or smoothEnd\n  return started ? false : null\n}\n\n// Check if the down event hits the current inertia target\n// control should be return to the user\nfunction resume(arg: SignalArgs['interactions:down']) {\n  const { interaction, eventTarget } = arg\n  const state = interaction.inertia\n\n  if (!state.active) return\n\n  let element = eventTarget as Node\n\n  // climb up the DOM tree from the event target\n  while (is.element(element)) {\n    // if interaction element is the current inertia target element\n    if (element === interaction.element) {\n      state.resume(arg)\n      break\n    }\n\n    element = dom.parentNode(element)\n  }\n}\n\nfunction stop({ interaction }: { interaction: Interaction }) {\n  const state = interaction.inertia\n\n  if (state.active) {\n    state.stop()\n  }\n}\n\nfunction getOptions({ interactable, prepared }: Interaction) {\n  return interactable && interactable.options && prepared.name && interactable.options[prepared.name].inertia\n}\n\nconst inertia: Plugin = {\n  id: 'inertia',\n  before: ['modifiers', 'actions'],\n  install,\n  listeners: {\n    'interactions:new': ({ interaction }) => {\n      interaction.inertia = new InertiaState(interaction)\n    },\n\n    'interactions:before-action-end': start,\n    'interactions:down': resume,\n    'interactions:stop': stop,\n\n    'interactions:before-action-resume': (arg) => {\n      const { modification } = arg.interaction\n\n      modification.stop(arg)\n      modification.start(arg, arg.interaction.coords.cur.page)\n      modification.applyToInteraction(arg)\n    },\n\n    'interactions:before-action-inertiastart': (arg) => arg.interaction.modification.setAndApply(arg),\n    'interactions:action-resume': modifiers.addEventModifiers,\n    'interactions:action-inertiastart': modifiers.addEventModifiers,\n    'interactions:after-action-inertiastart': (arg) =>\n      arg.interaction.modification.restoreInteractionCoords(arg),\n    'interactions:after-action-resume': (arg) => arg.interaction.modification.restoreInteractionCoords(arg),\n  },\n}\n\n// http://stackoverflow.com/a/5634528/2280888\nfunction _getQBezierValue(t: number, p1: number, p2: number, p3: number) {\n  const iT = 1 - t\n  return iT * iT * p1 + 2 * iT * t * p2 + t * t * p3\n}\n\nfunction getQuadraticCurvePoint(\n  startX: number,\n  startY: number,\n  cpX: number,\n  cpY: number,\n  endX: number,\n  endY: number,\n  position: number,\n) {\n  return {\n    x: _getQBezierValue(position, startX, cpX, endX),\n    y: _getQBezierValue(position, startY, cpY, endY),\n  }\n}\n\n// http://gizma.com/easing/\nfunction easeOutQuad(t: number, b: number, c: number, d: number) {\n  t /= d\n  return -c * t * (t - 2) + b\n}\n\nexport default inertia\n", "import * as arr from '@interactjs/utils/arr'\nimport extend from '@interactjs/utils/extend'\nimport type { NormalizedListeners } from '@interactjs/utils/normalizeListeners'\nimport normalize from '@interactjs/utils/normalizeListeners'\n\nimport type { Listener, ListenersArg, Rect } from '@interactjs/core/types'\n\nfunction fireUntilImmediateStopped(event: any, listeners: Listener[]) {\n  for (const listener of listeners) {\n    if (event.immediatePropagationStopped) {\n      break\n    }\n\n    listener(event)\n  }\n}\n\nexport class Eventable {\n  options: any\n  types: NormalizedListeners = {}\n  propagationStopped = false\n  immediatePropagationStopped = false\n  global: any\n\n  constructor(options?: { [index: string]: any }) {\n    this.options = extend({}, options || {})\n  }\n\n  fire<T extends { type: string; propagationStopped?: boolean }>(event: T) {\n    let listeners: Listener[]\n    const global = this.global\n\n    // Interactable#on() listeners\n    // tslint:disable no-conditional-assignment\n    if ((listeners = this.types[event.type])) {\n      fireUntilImmediateStopped(event, listeners)\n    }\n\n    // interact.on() listeners\n    if (!event.propagationStopped && global && (listeners = global[event.type])) {\n      fireUntilImmediateStopped(event, listeners)\n    }\n  }\n\n  on(type: string, listener: ListenersArg) {\n    const listeners = normalize(type, listener)\n\n    for (type in listeners) {\n      this.types[type] = arr.merge(this.types[type] || [], listeners[type])\n    }\n  }\n\n  off(type: string, listener: ListenersArg) {\n    const listeners = normalize(type, listener)\n\n    for (type in listeners) {\n      const eventList = this.types[type]\n\n      if (!eventList || !eventList.length) {\n        continue\n      }\n\n      for (const subListener of listeners[type]) {\n        const index = eventList.indexOf(subListener)\n\n        if (index !== -1) {\n          eventList.splice(index, 1)\n        }\n      }\n    }\n  }\n\n  getRect(_element: Element): Rect {\n    return null\n  }\n}\n", "import * as arr from '@interactjs/utils/arr'\nimport * as domUtils from '@interactjs/utils/domUtils'\nimport is from '@interactjs/utils/is'\nimport pExtend from '@interactjs/utils/pointerExtend'\nimport * as pointerUtils from '@interactjs/utils/pointerUtils'\n\nimport type { Scope } from '@interactjs/core/scope'\nimport type { Element } from '@interactjs/core/types'\n\nimport type { NativeEventTarget } from './NativeTypes'\n\ndeclare module '@interactjs/core/scope' {\n  interface Scope {\n    events: ReturnType<typeof install>\n  }\n}\n\ninterface EventOptions {\n  capture: boolean\n  passive: boolean\n}\n\ntype PartialEventTarget = Partial<NativeEventTarget>\n\ntype ListenerEntry = { func: (event: Event | FakeEvent) => any; options: EventOptions }\n\nfunction install(scope: Scope) {\n  const targets: Array<{\n    eventTarget: PartialEventTarget\n    events: { [type: string]: ListenerEntry[] }\n  }> = []\n\n  const delegatedEvents: {\n    [type: string]: Array<{\n      selector: string\n      context: Node\n      listeners: ListenerEntry[]\n    }>\n  } = {}\n  const documents: Document[] = []\n\n  const eventsMethods = {\n    add,\n    remove,\n\n    addDelegate,\n    removeDelegate,\n\n    delegateListener,\n    delegateUseCapture,\n    delegatedEvents,\n    documents,\n\n    targets,\n\n    supportsOptions: false,\n    supportsPassive: false,\n  }\n\n  // check if browser supports passive events and options arg\n  scope.document?.createElement('div').addEventListener('test', null, {\n    get capture() {\n      return (eventsMethods.supportsOptions = true)\n    },\n    get passive() {\n      return (eventsMethods.supportsPassive = true)\n    },\n  })\n\n  scope.events = eventsMethods\n\n  function add(\n    eventTarget: PartialEventTarget,\n    type: string,\n    listener: ListenerEntry['func'],\n    optionalArg?: boolean | EventOptions,\n  ) {\n    if (!eventTarget.addEventListener) return\n\n    const options = getOptions(optionalArg)\n    let target = arr.find(targets, (t) => t.eventTarget === eventTarget)\n\n    if (!target) {\n      target = {\n        eventTarget,\n        events: {},\n      }\n\n      targets.push(target)\n    }\n\n    if (!target.events[type]) {\n      target.events[type] = []\n    }\n\n    if (!arr.find(target.events[type], (l) => l.func === listener && optionsMatch(l.options, options))) {\n      eventTarget.addEventListener(\n        type,\n        listener as any,\n        eventsMethods.supportsOptions ? options : options.capture,\n      )\n      target.events[type].push({ func: listener, options })\n    }\n  }\n\n  function remove(\n    eventTarget: PartialEventTarget,\n    type: string,\n    listener?: 'all' | ListenerEntry['func'],\n    optionalArg?: boolean | EventOptions,\n  ) {\n    if (!eventTarget.addEventListener || !eventTarget.removeEventListener) return\n\n    const targetIndex = arr.findIndex(targets, (t) => t.eventTarget === eventTarget)\n    const target = targets[targetIndex]\n\n    if (!target || !target.events) {\n      return\n    }\n\n    if (type === 'all') {\n      for (type in target.events) {\n        if (target.events.hasOwnProperty(type)) {\n          remove(eventTarget, type, 'all')\n        }\n      }\n      return\n    }\n\n    let typeIsEmpty = false\n    const typeListeners = target.events[type]\n\n    if (typeListeners) {\n      if (listener === 'all') {\n        for (let i = typeListeners.length - 1; i >= 0; i--) {\n          const entry = typeListeners[i]\n          remove(eventTarget, type, entry.func, entry.options)\n        }\n        return\n      } else {\n        const options = getOptions(optionalArg)\n\n        for (let i = 0; i < typeListeners.length; i++) {\n          const entry = typeListeners[i]\n          if (entry.func === listener && optionsMatch(entry.options, options)) {\n            eventTarget.removeEventListener(\n              type,\n              listener as any,\n              eventsMethods.supportsOptions ? options : options.capture,\n            )\n            typeListeners.splice(i, 1)\n\n            if (typeListeners.length === 0) {\n              delete target.events[type]\n              typeIsEmpty = true\n            }\n\n            break\n          }\n        }\n      }\n    }\n\n    if (typeIsEmpty && !Object.keys(target.events).length) {\n      targets.splice(targetIndex, 1)\n    }\n  }\n\n  function addDelegate(\n    selector: string,\n    context: Node,\n    type: string,\n    listener: ListenerEntry['func'],\n    optionalArg?: any,\n  ) {\n    const options = getOptions(optionalArg)\n    if (!delegatedEvents[type]) {\n      delegatedEvents[type] = []\n\n      // add delegate listener functions\n      for (const doc of documents) {\n        add(doc, type, delegateListener)\n        add(doc, type, delegateUseCapture, true)\n      }\n    }\n\n    const delegates = delegatedEvents[type]\n    let delegate = arr.find(delegates, (d) => d.selector === selector && d.context === context)\n\n    if (!delegate) {\n      delegate = { selector, context, listeners: [] }\n      delegates.push(delegate)\n    }\n\n    delegate.listeners.push({ func: listener, options })\n  }\n\n  function removeDelegate(\n    selector: string,\n    context: Document | Element,\n    type: string,\n    listener?: ListenerEntry['func'],\n    optionalArg?: any,\n  ) {\n    const options = getOptions(optionalArg)\n    const delegates = delegatedEvents[type]\n    let matchFound = false\n    let index: number\n\n    if (!delegates) return\n\n    // count from last index of delegated to 0\n    for (index = delegates.length - 1; index >= 0; index--) {\n      const cur = delegates[index]\n      // look for matching selector and context Node\n      if (cur.selector === selector && cur.context === context) {\n        const { listeners } = cur\n\n        // each item of the listeners array is an array: [function, capture, passive]\n        for (let i = listeners.length - 1; i >= 0; i--) {\n          const entry = listeners[i]\n\n          // check if the listener functions and capture and passive flags match\n          if (entry.func === listener && optionsMatch(entry.options, options)) {\n            // remove the listener from the array of listeners\n            listeners.splice(i, 1)\n\n            // if all listeners for this target have been removed\n            // remove the target from the delegates array\n            if (!listeners.length) {\n              delegates.splice(index, 1)\n\n              // remove delegate function from context\n              remove(context, type, delegateListener)\n              remove(context, type, delegateUseCapture, true)\n            }\n\n            // only remove one listener\n            matchFound = true\n            break\n          }\n        }\n\n        if (matchFound) {\n          break\n        }\n      }\n    }\n  }\n\n  // bound to the interactable context when a DOM event\n  // listener is added to a selector interactable\n  function delegateListener(event: Event | FakeEvent, optionalArg?: any) {\n    const options = getOptions(optionalArg)\n    const fakeEvent = new FakeEvent(event as Event)\n    const delegates = delegatedEvents[event.type]\n    const [eventTarget] = pointerUtils.getEventTargets(event as Event)\n    let element: Node = eventTarget\n\n    // climb up document tree looking for selector matches\n    while (is.element(element)) {\n      for (let i = 0; i < delegates.length; i++) {\n        const cur = delegates[i]\n        const { selector, context } = cur\n\n        if (\n          domUtils.matchesSelector(element, selector) &&\n          domUtils.nodeContains(context, eventTarget) &&\n          domUtils.nodeContains(context, element)\n        ) {\n          const { listeners } = cur\n\n          fakeEvent.currentTarget = element\n\n          for (const entry of listeners) {\n            if (optionsMatch(entry.options, options)) {\n              entry.func(fakeEvent)\n            }\n          }\n        }\n      }\n\n      element = domUtils.parentNode(element)\n    }\n  }\n\n  function delegateUseCapture(this: Element, event: Event | FakeEvent) {\n    return delegateListener.call(this, event, true)\n  }\n\n  // for type inferrence\n  return eventsMethods\n}\n\nclass FakeEvent implements Partial<Event> {\n  currentTarget: Node\n  originalEvent: Event\n  type: string\n\n  constructor(originalEvent: Event) {\n    this.originalEvent = originalEvent\n    // duplicate the event so that currentTarget can be changed\n    pExtend(this, originalEvent)\n  }\n\n  preventOriginalDefault() {\n    this.originalEvent.preventDefault()\n  }\n\n  stopPropagation() {\n    this.originalEvent.stopPropagation()\n  }\n\n  stopImmediatePropagation() {\n    this.originalEvent.stopImmediatePropagation()\n  }\n}\n\nfunction getOptions(param: { [index: string]: any } | boolean): { capture: boolean; passive: boolean } {\n  if (!is.object(param)) {\n    return { capture: !!param, passive: false }\n  }\n\n  return {\n    capture: !!param.capture,\n    passive: !!param.passive,\n  }\n}\n\nfunction optionsMatch(a: Partial<EventOptions> | boolean, b: Partial<EventOptions>) {\n  if (a === b) return true\n\n  if (typeof a === 'boolean') return !!b.capture === a && !!b.passive === false\n\n  return !!a.capture === !!b.capture && !!a.passive === !!b.passive\n}\n\nexport default {\n  id: 'events',\n  install,\n}\n", "import * as dom from '@interactjs/utils/domUtils'\n\nimport type Interaction from '@interactjs/core/Interaction'\nimport type { Scope } from '@interactjs/core/scope'\nimport type { PointerType } from '@interactjs/core/types'\n\nexport interface SearchDetails {\n  pointer: PointerType\n  pointerId: number\n  pointerType: string\n  eventType: string\n  eventTarget: EventTarget\n  curEventTarget: EventTarget\n  scope: Scope\n}\n\nconst finder = {\n  methodOrder: ['simulationResume', 'mouseOrPen', 'hasPointer', 'idle'] as const,\n\n  search(details: SearchDetails) {\n    for (const method of finder.methodOrder) {\n      const interaction = finder[method](details)\n\n      if (interaction) {\n        return interaction\n      }\n    }\n\n    return null\n  },\n\n  // try to resume simulation with a new pointer\n  simulationResume({ pointerType, eventType, eventTarget, scope }: SearchDetails) {\n    if (!/down|start/i.test(eventType)) {\n      return null\n    }\n\n    for (const interaction of scope.interactions.list) {\n      let element = eventTarget as Node\n\n      if (\n        interaction.simulation &&\n        interaction.simulation.allowResume &&\n        interaction.pointerType === pointerType\n      ) {\n        while (element) {\n          // if the element is the interaction element\n          if (element === interaction.element) {\n            return interaction\n          }\n          element = dom.parentNode(element)\n        }\n      }\n    }\n\n    return null\n  },\n\n  // if it's a mouse or pen interaction\n  mouseOrPen({ pointerId, pointerType, eventType, scope }: SearchDetails) {\n    if (pointerType !== 'mouse' && pointerType !== 'pen') {\n      return null\n    }\n\n    let firstNonActive\n\n    for (const interaction of scope.interactions.list) {\n      if (interaction.pointerType === pointerType) {\n        // if it's a down event, skip interactions with running simulations\n        if (interaction.simulation && !hasPointerId(interaction, pointerId)) {\n          continue\n        }\n\n        // if the interaction is active, return it immediately\n        if (interaction.interacting()) {\n          return interaction\n        }\n        // otherwise save it and look for another active interaction\n        else if (!firstNonActive) {\n          firstNonActive = interaction\n        }\n      }\n    }\n\n    // if no active mouse interaction was found use the first inactive mouse\n    // interaction\n    if (firstNonActive) {\n      return firstNonActive\n    }\n\n    // find any mouse or pen interaction.\n    // ignore the interaction if the eventType is a *down, and a simulation\n    // is active\n    for (const interaction of scope.interactions.list) {\n      if (interaction.pointerType === pointerType && !(/down/i.test(eventType) && interaction.simulation)) {\n        return interaction\n      }\n    }\n\n    return null\n  },\n\n  // get interaction that has this pointer\n  hasPointer({ pointerId, scope }: SearchDetails) {\n    for (const interaction of scope.interactions.list) {\n      if (hasPointerId(interaction, pointerId)) {\n        return interaction\n      }\n    }\n\n    return null\n  },\n\n  // get first idle interaction with a matching pointerType\n  idle({ pointerType, scope }: SearchDetails) {\n    for (const interaction of scope.interactions.list) {\n      // if there's already a pointer held down\n      if (interaction.pointers.length === 1) {\n        const target = interaction.interactable\n        // don't add this pointer if there is a target interactable and it\n        // isn't gesturable\n        if (target && !(target.options.gesture && target.options.gesture.enabled)) {\n          continue\n        }\n      }\n      // maximum of 2 pointers per interaction\n      else if (interaction.pointers.length >= 2) {\n        continue\n      }\n\n      if (!interaction.interacting() && pointerType === interaction.pointerType) {\n        return interaction\n      }\n    }\n\n    return null\n  },\n}\n\nfunction hasPointerId(interaction: Interaction, pointerId: number) {\n  return interaction.pointers.some(({ id }) => id === pointerId)\n}\n\nexport default finder\n", "import browser from '@interactjs/utils/browser'\nimport domObjects from '@interactjs/utils/domObjects'\nimport { nodeContains } from '@interactjs/utils/domUtils'\nimport * as pointerUtils from '@interactjs/utils/pointerUtils'\n\nimport type { Scope, SignalArgs, Plugin } from '@interactjs/core/scope'\nimport type { ActionName, Listener } from '@interactjs/core/types'\n\n/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport './interactablePreventDefault'\nimport interactablePreventDefault from './interactablePreventDefault'\nimport InteractionBase from './Interaction'\n/* eslint-enable import/no-duplicates */\nimport type { SearchDetails } from './interactionFinder'\nimport finder from './interactionFinder'\n\ndeclare module '@interactjs/core/scope' {\n  interface Scope {\n    Interaction: typeof InteractionBase\n    interactions: {\n      new: <T extends ActionName>(options: any) => InteractionBase<T>\n      list: Array<InteractionBase<ActionName>>\n      listeners: { [type: string]: Listener }\n      docEvents: Array<{ type: string; listener: Listener }>\n      pointerMoveTolerance: number\n    }\n    prevTouchTime: number\n  }\n\n  interface SignalArgs {\n    'interactions:find': {\n      interaction: InteractionBase\n      searchDetails: SearchDetails\n    }\n  }\n}\n\nconst methodNames = [\n  'pointerDown',\n  'pointerMove',\n  'pointerUp',\n  'updatePointer',\n  'removePointer',\n  'windowBlur',\n]\n\nfunction install(scope: Scope) {\n  const listeners = {} as any\n\n  for (const method of methodNames) {\n    listeners[method] = doOnInteractions(method, scope)\n  }\n\n  const pEventTypes = browser.pEventTypes\n  let docEvents: typeof scope.interactions.docEvents\n\n  if (domObjects.PointerEvent) {\n    docEvents = [\n      { type: pEventTypes.down, listener: releasePointersOnRemovedEls },\n      { type: pEventTypes.down, listener: listeners.pointerDown },\n      { type: pEventTypes.move, listener: listeners.pointerMove },\n      { type: pEventTypes.up, listener: listeners.pointerUp },\n      { type: pEventTypes.cancel, listener: listeners.pointerUp },\n    ]\n  } else {\n    docEvents = [\n      { type: 'mousedown', listener: listeners.pointerDown },\n      { type: 'mousemove', listener: listeners.pointerMove },\n      { type: 'mouseup', listener: listeners.pointerUp },\n\n      { type: 'touchstart', listener: releasePointersOnRemovedEls },\n      { type: 'touchstart', listener: listeners.pointerDown },\n      { type: 'touchmove', listener: listeners.pointerMove },\n      { type: 'touchend', listener: listeners.pointerUp },\n      { type: 'touchcancel', listener: listeners.pointerUp },\n    ]\n  }\n\n  docEvents.push({\n    type: 'blur',\n    listener(event) {\n      for (const interaction of scope.interactions.list) {\n        interaction.documentBlur(event)\n      }\n    },\n  })\n\n  // for ignoring browser's simulated mouse events\n  scope.prevTouchTime = 0\n\n  scope.Interaction = class<T extends ActionName> extends InteractionBase<T> {\n    get pointerMoveTolerance() {\n      return scope.interactions.pointerMoveTolerance\n    }\n\n    set pointerMoveTolerance(value) {\n      scope.interactions.pointerMoveTolerance = value\n    }\n\n    _now() {\n      return scope.now()\n    }\n  }\n\n  scope.interactions = {\n    // all active and idle interactions\n    list: [],\n    new<T extends ActionName>(options: { pointerType?: string; scopeFire?: Scope['fire'] }) {\n      options.scopeFire = (name, arg) => scope.fire(name, arg)\n\n      const interaction = new scope.Interaction<T>(options as Required<typeof options>)\n\n      scope.interactions.list.push(interaction)\n      return interaction\n    },\n    listeners,\n    docEvents,\n    pointerMoveTolerance: 1,\n  }\n\n  function releasePointersOnRemovedEls() {\n    // for all inactive touch interactions with pointers down\n    for (const interaction of scope.interactions.list) {\n      if (!interaction.pointerIsDown || interaction.pointerType !== 'touch' || interaction._interacting) {\n        continue\n      }\n\n      // if a pointer is down on an element that is no longer in the DOM tree\n      for (const pointer of interaction.pointers) {\n        if (!scope.documents.some(({ doc }) => nodeContains(doc, pointer.downTarget))) {\n          // remove the pointer from the interaction\n          interaction.removePointer(pointer.pointer, pointer.event)\n        }\n      }\n    }\n  }\n\n  scope.usePlugin(interactablePreventDefault)\n}\n\nfunction doOnInteractions(method: string, scope: Scope) {\n  return function (event: Event) {\n    const interactions = scope.interactions.list\n\n    const pointerType = pointerUtils.getPointerType(event)\n    const [eventTarget, curEventTarget] = pointerUtils.getEventTargets(event)\n    const matches: any[] = [] // [ [pointer, interaction], ...]\n\n    if (/^touch/.test(event.type)) {\n      scope.prevTouchTime = scope.now()\n\n      // @ts-expect-error\n      for (const changedTouch of event.changedTouches) {\n        const pointer = changedTouch\n        const pointerId = pointerUtils.getPointerId(pointer)\n        const searchDetails: SearchDetails = {\n          pointer,\n          pointerId,\n          pointerType,\n          eventType: event.type,\n          eventTarget,\n          curEventTarget,\n          scope,\n        }\n        const interaction = getInteraction(searchDetails)\n\n        matches.push([\n          searchDetails.pointer,\n          searchDetails.eventTarget,\n          searchDetails.curEventTarget,\n          interaction,\n        ])\n      }\n    } else {\n      let invalidPointer = false\n\n      if (!browser.supportsPointerEvent && /mouse/.test(event.type)) {\n        // ignore mouse events while touch interactions are active\n        for (let i = 0; i < interactions.length && !invalidPointer; i++) {\n          invalidPointer = interactions[i].pointerType !== 'mouse' && interactions[i].pointerIsDown\n        }\n\n        // try to ignore mouse events that are simulated by the browser\n        // after a touch event\n        invalidPointer =\n          invalidPointer ||\n          scope.now() - scope.prevTouchTime < 500 ||\n          // on iOS and Firefox Mobile, MouseEvent.timeStamp is zero if simulated\n          event.timeStamp === 0\n      }\n\n      if (!invalidPointer) {\n        const searchDetails = {\n          pointer: event as PointerEvent,\n          pointerId: pointerUtils.getPointerId(event as PointerEvent),\n          pointerType,\n          eventType: event.type,\n          curEventTarget,\n          eventTarget,\n          scope,\n        }\n\n        const interaction = getInteraction(searchDetails)\n\n        matches.push([\n          searchDetails.pointer,\n          searchDetails.eventTarget,\n          searchDetails.curEventTarget,\n          interaction,\n        ])\n      }\n    }\n\n    // eslint-disable-next-line no-shadow\n    for (const [pointer, eventTarget, curEventTarget, interaction] of matches) {\n      interaction[method](pointer, event, eventTarget, curEventTarget)\n    }\n  }\n}\n\nfunction getInteraction(searchDetails: SearchDetails) {\n  const { pointerType, scope } = searchDetails\n\n  const foundInteraction = finder.search(searchDetails)\n  const signalArg = { interaction: foundInteraction, searchDetails }\n\n  scope.fire('interactions:find', signalArg)\n\n  return signalArg.interaction || scope.interactions.new({ pointerType })\n}\n\nfunction onDocSignal<T extends 'scope:add-document' | 'scope:remove-document'>(\n  { doc, scope, options }: SignalArgs[T],\n  eventMethodName: 'add' | 'remove',\n) {\n  const {\n    interactions: { docEvents },\n    events,\n  } = scope\n  const eventMethod = events[eventMethodName]\n\n  if (scope.browser.isIOS && !options.events) {\n    options.events = { passive: false }\n  }\n\n  // delegate event listener\n  for (const eventType in events.delegatedEvents) {\n    eventMethod(doc, eventType, events.delegateListener)\n    eventMethod(doc, eventType, events.delegateUseCapture, true)\n  }\n\n  const eventOptions = options && options.events\n\n  for (const { type, listener } of docEvents) {\n    eventMethod(doc, type, listener, eventOptions)\n  }\n}\n\nconst interactions: Plugin = {\n  id: 'core/interactions',\n  install,\n  listeners: {\n    'scope:add-document': (arg) => onDocSignal(arg, 'add'),\n    'scope:remove-document': (arg) => onDocSignal(arg, 'remove'),\n    'interactable:unset': ({ interactable }, scope) => {\n      // Stop and destroy related interactions when an Interactable is unset\n      for (let i = scope.interactions.list.length - 1; i >= 0; i--) {\n        const interaction = scope.interactions.list[i]\n\n        if (interaction.interactable !== interactable) {\n          continue\n        }\n\n        interaction.stop()\n        scope.fire('interactions:destroy', { interaction })\n        interaction.destroy()\n\n        if (scope.interactions.list.length > 2) {\n          scope.interactions.list.splice(i, 1)\n        }\n      }\n    },\n  },\n  onDocSignal,\n  doOnInteractions,\n  methodNames,\n}\n\nexport default interactions\n", "/* eslint-disable no-dupe-class-members */\nimport * as arr from '@interactjs/utils/arr'\nimport browser from '@interactjs/utils/browser'\nimport clone from '@interactjs/utils/clone'\nimport { getElementRect, matchesUpTo, nodeContains, trySelector } from '@interactjs/utils/domUtils'\nimport extend from '@interactjs/utils/extend'\nimport is from '@interactjs/utils/is'\nimport isNonNativeEvent from '@interactjs/utils/isNonNativeEvent'\nimport normalizeListeners from '@interactjs/utils/normalizeListeners'\nimport { getWindow } from '@interactjs/utils/window'\n\nimport type { Scope } from '@interactjs/core/scope'\nimport type {\n  ActionMap,\n  ActionMethod,\n  ActionName,\n  Actions,\n  Context,\n  Element,\n  EventTypes,\n  Listeners,\n  ListenersArg,\n  OrBoolean,\n  Target,\n} from '@interactjs/core/types'\n\nimport { Eventable } from './Eventable'\nimport type { ActionDefaults, Defaults, OptionsArg, PerActionDefaults, Options } from './options'\n\ntype IgnoreValue = string | Element | boolean\ntype DeltaSource = 'page' | 'client'\n\nconst enum OnOffMethod {\n  On,\n  Off,\n}\n\n/**\n * ```ts\n * const interactable = interact('.cards')\n *   .draggable({\n *     listeners: { move: event => console.log(event.type, event.pageX, event.pageY) }\n *   })\n *   .resizable({\n *     listeners: { move: event => console.log(event.rect) },\n *     modifiers: [interact.modifiers.restrictEdges({ outer: 'parent' })]\n *   })\n * ```\n */\nexport class Interactable implements Partial<Eventable> {\n  /** @internal */ get _defaults(): Defaults {\n    return {\n      base: {},\n      perAction: {},\n      actions: {} as ActionDefaults,\n    }\n  }\n\n  readonly target: Target\n  /** @internal */ readonly options!: Required<Options>\n  /** @internal */ readonly _actions: Actions\n  /** @internal */ readonly events = new Eventable()\n  /** @internal */ readonly _context: Context\n  /** @internal */ readonly _win: Window\n  /** @internal */ readonly _doc: Document\n  /** @internal */ readonly _scopeEvents: Scope['events']\n\n  constructor(\n    target: Target,\n    options: any,\n    defaultContext: Document | Element,\n    scopeEvents: Scope['events'],\n  ) {\n    this._actions = options.actions\n    this.target = target\n    this._context = options.context || defaultContext\n    this._win = getWindow(trySelector(target) ? this._context : target)\n    this._doc = this._win.document\n    this._scopeEvents = scopeEvents\n\n    this.set(options)\n  }\n\n  setOnEvents(actionName: ActionName, phases: NonNullable<any>) {\n    if (is.func(phases.onstart)) {\n      this.on(`${actionName}start`, phases.onstart)\n    }\n    if (is.func(phases.onmove)) {\n      this.on(`${actionName}move`, phases.onmove)\n    }\n    if (is.func(phases.onend)) {\n      this.on(`${actionName}end`, phases.onend)\n    }\n    if (is.func(phases.oninertiastart)) {\n      this.on(`${actionName}inertiastart`, phases.oninertiastart)\n    }\n\n    return this\n  }\n\n  updatePerActionListeners(actionName: ActionName, prev: Listeners | undefined, cur: Listeners | undefined) {\n    const actionFilter = (this._actions.map[actionName] as { filterEventType?: (type: string) => boolean })\n      ?.filterEventType\n    const filter = (type: string) =>\n      (actionFilter == null || actionFilter(type)) && isNonNativeEvent(type, this._actions)\n\n    if (is.array(prev) || is.object(prev)) {\n      this._onOff(OnOffMethod.Off, actionName, prev, undefined, filter)\n    }\n\n    if (is.array(cur) || is.object(cur)) {\n      this._onOff(OnOffMethod.On, actionName, cur, undefined, filter)\n    }\n  }\n\n  setPerAction(actionName: ActionName, options: OrBoolean<Options>) {\n    const defaults = this._defaults\n\n    // for all the default per-action options\n    for (const optionName_ in options) {\n      const optionName = optionName_ as keyof PerActionDefaults\n      const actionOptions = this.options[actionName]\n      const optionValue: any = options[optionName]\n\n      // remove old event listeners and add new ones\n      if (optionName === 'listeners') {\n        this.updatePerActionListeners(actionName, actionOptions.listeners, optionValue as Listeners)\n      }\n\n      // if the option value is an array\n      if (is.array(optionValue)) {\n        ;(actionOptions[optionName] as any) = arr.from(optionValue)\n      }\n      // if the option value is an object\n      else if (is.plainObject(optionValue)) {\n        // copy the object\n        ;(actionOptions[optionName] as any) = extend(\n          actionOptions[optionName] || ({} as any),\n          clone(optionValue),\n        )\n\n        // set anabled field to true if it exists in the defaults\n        if (\n          is.object(defaults.perAction[optionName]) &&\n          'enabled' in (defaults.perAction[optionName] as any)\n        ) {\n          ;(actionOptions[optionName] as any).enabled = optionValue.enabled !== false\n        }\n      }\n      // if the option value is a boolean and the default is an object\n      else if (is.bool(optionValue) && is.object(defaults.perAction[optionName])) {\n        ;(actionOptions[optionName] as any).enabled = optionValue\n      }\n      // if it's anything else, do a plain assignment\n      else {\n        ;(actionOptions[optionName] as any) = optionValue\n      }\n    }\n  }\n\n  /**\n   * The default function to get an Interactables bounding rect. Can be\n   * overridden using {@link Interactable.rectChecker}.\n   *\n   * @param {Element} [element] The element to measure.\n   * @return {Rect} The object's bounding rectangle.\n   */\n  getRect(element: Element) {\n    element = element || (is.element(this.target) ? this.target : null)\n\n    if (is.string(this.target)) {\n      element = element || this._context.querySelector(this.target)\n    }\n\n    return getElementRect(element)\n  }\n\n  /**\n   * Returns or sets the function used to calculate the interactable's\n   * element's rectangle\n   *\n   * @param {function} [checker] A function which returns this Interactable's\n   * bounding rectangle. See {@link Interactable.getRect}\n   * @return {function | object} The checker function or this Interactable\n   */\n  rectChecker(): (element: Element) => any | null\n  rectChecker(checker: (element: Element) => any): this\n  rectChecker(checker?: (element: Element) => any) {\n    if (is.func(checker)) {\n      this.getRect = (element) => {\n        const rect = extend({}, checker.apply(this, element))\n\n        if (!(('width' in rect) as unknown)) {\n          rect.width = rect.right - rect.left\n          rect.height = rect.bottom - rect.top\n        }\n\n        return rect\n      }\n\n      return this\n    }\n\n    if (checker === null) {\n      delete (this as Partial<typeof this>).getRect\n\n      return this\n    }\n\n    return this.getRect\n  }\n\n  /** @internal */\n  _backCompatOption(optionName: keyof Options, newValue: any) {\n    if (trySelector(newValue) || is.object(newValue)) {\n      ;(this.options[optionName] as any) = newValue\n\n      for (const action in this._actions.map) {\n        ;(this.options[action as keyof ActionMap] as any)[optionName] = newValue\n      }\n\n      return this\n    }\n\n    return this.options[optionName]\n  }\n\n  /**\n   * Gets or sets the origin of the Interactable's element.  The x and y\n   * of the origin will be subtracted from action event coordinates.\n   *\n   * @param {Element | object | string} [origin] An HTML or SVG Element whose\n   * rect will be used, an object eg. { x: 0, y: 0 } or string 'parent', 'self'\n   * or any CSS selector\n   *\n   * @return {object} The current origin or this Interactable\n   */\n  origin(newValue: any) {\n    return this._backCompatOption('origin', newValue)\n  }\n\n  /**\n   * Returns or sets the mouse coordinate types used to calculate the\n   * movement of the pointer.\n   *\n   * @param {string} [newValue] Use 'client' if you will be scrolling while\n   * interacting; Use 'page' if you want autoScroll to work\n   * @return {string | object} The current deltaSource or this Interactable\n   */\n  deltaSource(): DeltaSource\n  deltaSource(newValue: DeltaSource): this\n  deltaSource(newValue?: DeltaSource) {\n    if (newValue === 'page' || newValue === 'client') {\n      this.options.deltaSource = newValue\n\n      return this\n    }\n\n    return this.options.deltaSource\n  }\n\n  /** @internal */\n  getAllElements(): Element[] {\n    const { target } = this\n\n    if (is.string(target)) {\n      return Array.from(this._context.querySelectorAll(target))\n    }\n\n    if (is.func(target) && (target as any).getAllElements) {\n      return (target as any).getAllElements()\n    }\n\n    return is.element(target) ? [target] : []\n  }\n\n  /**\n   * Gets the selector context Node of the Interactable. The default is\n   * `window.document`.\n   *\n   * @return {Node} The context Node of this Interactable\n   */\n  context() {\n    return this._context\n  }\n\n  inContext(element: Document | Node) {\n    return this._context === element.ownerDocument || nodeContains(this._context, element)\n  }\n\n  /** @internal */\n  testIgnoreAllow(\n    this: Interactable,\n    options: { ignoreFrom?: IgnoreValue; allowFrom?: IgnoreValue },\n    targetNode: Node,\n    eventTarget: Node,\n  ) {\n    return (\n      !this.testIgnore(options.ignoreFrom, targetNode, eventTarget) &&\n      this.testAllow(options.allowFrom, targetNode, eventTarget)\n    )\n  }\n\n  /** @internal */\n  testAllow(this: Interactable, allowFrom: IgnoreValue | undefined, targetNode: Node, element: Node) {\n    if (!allowFrom) {\n      return true\n    }\n\n    if (!is.element(element)) {\n      return false\n    }\n\n    if (is.string(allowFrom)) {\n      return matchesUpTo(element, allowFrom, targetNode)\n    } else if (is.element(allowFrom)) {\n      return nodeContains(allowFrom, element)\n    }\n\n    return false\n  }\n\n  /** @internal */\n  testIgnore(this: Interactable, ignoreFrom: IgnoreValue | undefined, targetNode: Node, element: Node) {\n    if (!ignoreFrom || !is.element(element)) {\n      return false\n    }\n\n    if (is.string(ignoreFrom)) {\n      return matchesUpTo(element, ignoreFrom, targetNode)\n    } else if (is.element(ignoreFrom)) {\n      return nodeContains(ignoreFrom, element)\n    }\n\n    return false\n  }\n\n  /**\n   * Calls listeners for the given InteractEvent type bound globally\n   * and directly to this Interactable\n   *\n   * @param {InteractEvent} iEvent The InteractEvent object to be fired on this\n   * Interactable\n   * @return {Interactable} this Interactable\n   */\n  fire<E extends { type: string }>(iEvent: E) {\n    this.events.fire(iEvent)\n\n    return this\n  }\n\n  /** @internal */\n  _onOff(\n    method: OnOffMethod,\n    typeArg: EventTypes,\n    listenerArg?: ListenersArg | null,\n    options?: any,\n    filter?: (type: string) => boolean,\n  ) {\n    if (is.object(typeArg) && !is.array(typeArg)) {\n      options = listenerArg\n      listenerArg = null\n    }\n\n    const listeners = normalizeListeners(typeArg, listenerArg, filter)\n\n    for (let type in listeners) {\n      if (type === 'wheel') {\n        type = browser.wheelEvent\n      }\n\n      for (const listener of listeners[type]) {\n        // if it is an action event type\n        if (isNonNativeEvent(type, this._actions)) {\n          this.events[method === OnOffMethod.On ? 'on' : 'off'](type, listener)\n        }\n        // delegated event\n        else if (is.string(this.target)) {\n          this._scopeEvents[method === OnOffMethod.On ? 'addDelegate' : 'removeDelegate'](\n            this.target,\n            this._context,\n            type,\n            listener,\n            options,\n          )\n        }\n        // remove listener from this Interactable's element\n        else {\n          this._scopeEvents[method === OnOffMethod.On ? 'add' : 'remove'](\n            this.target,\n            type,\n            listener,\n            options,\n          )\n        }\n      }\n    }\n\n    return this\n  }\n\n  /**\n   * Binds a listener for an InteractEvent, pointerEvent or DOM event.\n   *\n   * @param {string | array | object} types The types of events to listen\n   * for\n   * @param {function | array | object} [listener] The event listener function(s)\n   * @param {object | boolean} [options] options object or useCapture flag for\n   * addEventListener\n   * @return {Interactable} This Interactable\n   */\n  on(types: EventTypes, listener?: ListenersArg, options?: any) {\n    return this._onOff(OnOffMethod.On, types, listener, options)\n  }\n\n  /**\n   * Removes an InteractEvent, pointerEvent or DOM event listener.\n   *\n   * @param {string | array | object} types The types of events that were\n   * listened for\n   * @param {function | array | object} [listener] The event listener function(s)\n   * @param {object | boolean} [options] options object or useCapture flag for\n   * removeEventListener\n   * @return {Interactable} This Interactable\n   */\n  off(types: string | string[] | EventTypes, listener?: ListenersArg, options?: any) {\n    return this._onOff(OnOffMethod.Off, types, listener, options)\n  }\n\n  /**\n   * Reset the options of this Interactable\n   *\n   * @param {object} options The new settings to apply\n   * @return {object} This Interactable\n   */\n  set(options: OptionsArg) {\n    const defaults = this._defaults\n\n    if (!is.object(options)) {\n      options = {}\n    }\n\n    ;(this.options as Required<Options>) = clone(defaults.base) as Required<Options>\n\n    for (const actionName_ in this._actions.methodDict) {\n      const actionName = actionName_ as ActionName\n      const methodName = this._actions.methodDict[actionName]\n\n      this.options[actionName] = {}\n      this.setPerAction(actionName, extend(extend({}, defaults.perAction), defaults.actions[actionName]))\n      ;(this[methodName] as ActionMethod<unknown>)(options[actionName])\n    }\n\n    for (const setting in options) {\n      if (setting === 'getRect') {\n        this.rectChecker(options.getRect)\n        continue\n      }\n\n      if (is.func((this as any)[setting])) {\n        ;(this as any)[setting](options[setting as keyof typeof options])\n      }\n    }\n\n    return this\n  }\n\n  /**\n   * Remove this interactable from the list of interactables and remove it's\n   * action capabilities and event listeners\n   */\n  unset() {\n    if (is.string(this.target)) {\n      // remove delegated events\n      for (const type in this._scopeEvents.delegatedEvents) {\n        const delegated = this._scopeEvents.delegatedEvents[type]\n\n        for (let i = delegated.length - 1; i >= 0; i--) {\n          const { selector, context, listeners } = delegated[i]\n\n          if (selector === this.target && context === this._context) {\n            delegated.splice(i, 1)\n          }\n\n          for (let l = listeners.length - 1; l >= 0; l--) {\n            this._scopeEvents.removeDelegate(\n              this.target,\n              this._context,\n              type,\n              listeners[l][0],\n              listeners[l][1],\n            )\n          }\n        }\n      }\n    } else {\n      this._scopeEvents.remove(this.target, 'all')\n    }\n  }\n}\n", "import * as arr from '@interactjs/utils/arr'\nimport * as domUtils from '@interactjs/utils/domUtils'\nimport extend from '@interactjs/utils/extend'\nimport is from '@interactjs/utils/is'\n\nimport type { Interactable } from '@interactjs/core/Interactable'\nimport type { OptionsArg, Options } from '@interactjs/core/options'\nimport type { Scope } from '@interactjs/core/scope'\nimport type { Target } from '@interactjs/core/types'\n\ndeclare module '@interactjs/core/scope' {\n  interface SignalArgs {\n    'interactable:new': {\n      interactable: Interactable\n      target: Target\n      options: OptionsArg\n      win: Window\n    }\n  }\n}\n\nexport class InteractableSet {\n  // all set interactables\n  list: Interactable[] = []\n\n  selectorMap: {\n    [selector: string]: Interactable[]\n  } = {}\n\n  scope: Scope\n\n  constructor(scope: Scope) {\n    this.scope = scope\n    scope.addListeners({\n      'interactable:unset': ({ interactable }) => {\n        const { target } = interactable\n        const interactablesOnTarget: Interactable[] = is.string(target)\n          ? this.selectorMap[target]\n          : (target as any)[this.scope.id]\n\n        const targetIndex = arr.findIndex(interactablesOnTarget, (i) => i === interactable)\n        interactablesOnTarget.splice(targetIndex, 1)\n      },\n    })\n  }\n\n  new(target: Target, options?: any): Interactable {\n    options = extend(options || {}, {\n      actions: this.scope.actions,\n    })\n    const interactable = new this.scope.Interactable(target, options, this.scope.document, this.scope.events)\n\n    this.scope.addDocument(interactable._doc)\n    this.list.push(interactable)\n\n    if (is.string(target)) {\n      if (!this.selectorMap[target]) {\n        this.selectorMap[target] = []\n      }\n      this.selectorMap[target].push(interactable)\n    } else {\n      if (!(interactable.target as any)[this.scope.id]) {\n        Object.defineProperty(target, this.scope.id, {\n          value: [],\n          configurable: true,\n        })\n      }\n\n      ;(target as any)[this.scope.id].push(interactable)\n    }\n\n    this.scope.fire('interactable:new', {\n      target,\n      options,\n      interactable,\n      win: this.scope._win,\n    })\n\n    return interactable\n  }\n\n  getExisting(target: Target, options?: Options) {\n    const context = (options && options.context) || this.scope.document\n    const isSelector = is.string(target)\n    const interactablesOnTarget: Interactable[] = isSelector\n      ? this.selectorMap[target as string]\n      : (target as any)[this.scope.id]\n\n    if (!interactablesOnTarget) return undefined\n\n    return arr.find(\n      interactablesOnTarget,\n      (interactable) =>\n        interactable._context === context && (isSelector || interactable.inContext(target as any)),\n    )\n  }\n\n  forEachMatch<T>(node: Node, callback: (interactable: Interactable) => T): T | void {\n    for (const interactable of this.list) {\n      let ret: T\n\n      if (\n        (is.string(interactable.target)\n          ? // target is a selector and the element matches\n            is.element(node) && domUtils.matchesSelector(node, interactable.target)\n          : // target is the element\n            node === interactable.target) &&\n        // the element is in context\n        interactable.inContext(node)\n      ) {\n        ret = callback(interactable)\n      }\n\n      if (ret !== undefined) {\n        return ret\n      }\n    }\n  }\n}\n", "import browser from '@interactjs/utils/browser'\nimport clone from '@interactjs/utils/clone'\nimport domObjects from '@interactjs/utils/domObjects'\nimport extend from '@interactjs/utils/extend'\nimport is from '@interactjs/utils/is'\nimport raf from '@interactjs/utils/raf'\nimport * as win from '@interactjs/utils/window'\n\nimport type Interaction from '@interactjs/core/Interaction'\n\nimport { Eventable } from './Eventable'\n/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport './events'\nimport './interactions'\nimport events from './events'\nimport { Interactable as InteractableBase } from './Interactable'\nimport { InteractableSet } from './InteractableSet'\nimport { InteractEvent } from './InteractEvent'\nimport interactions from './interactions'\n/* eslint-enable import/no-duplicates */\nimport { createInteractStatic } from './InteractStatic'\nimport type { OptionsArg } from './options'\nimport { defaults } from './options'\nimport type { Actions } from './types'\n\nexport interface SignalArgs {\n  'scope:add-document': DocSignalArg\n  'scope:remove-document': DocSignalArg\n  'interactable:unset': { interactable: InteractableBase }\n  'interactable:set': { interactable: InteractableBase; options: OptionsArg }\n  'interactions:destroy': { interaction: Interaction }\n}\n\nexport type ListenerName = keyof SignalArgs\n\nexport type ListenerMap = {\n  [P in ListenerName]?: (arg: SignalArgs[P], scope: Scope, signalName: P) => void | boolean\n}\n\ninterface DocSignalArg {\n  doc: Document\n  window: Window\n  scope: Scope\n  options: Record<string, any>\n}\n\nexport interface Plugin {\n  [key: string]: any\n  id?: string\n  listeners?: ListenerMap\n  before?: string[]\n  install?(scope: Scope, options?: any): void\n}\n\n/** @internal */\nexport class Scope {\n  id = `__interact_scope_${Math.floor(Math.random() * 100)}`\n  isInitialized = false\n  listenerMaps: Array<{\n    map: ListenerMap\n    id?: string\n  }> = []\n\n  browser = browser\n  defaults = clone(defaults) as typeof defaults\n  Eventable = Eventable\n  actions: Actions = {\n    map: {},\n    phases: {\n      start: true,\n      move: true,\n      end: true,\n    },\n    methodDict: {} as any,\n    phaselessTypes: {},\n  }\n\n  interactStatic = createInteractStatic(this)\n  InteractEvent = InteractEvent\n  Interactable: typeof InteractableBase\n  interactables = new InteractableSet(this)\n\n  // main window\n  _win!: Window\n\n  // main document\n  document!: Document\n\n  // main window\n  window!: Window\n\n  // all documents being listened to\n  documents: Array<{ doc: Document; options: any }> = []\n\n  _plugins: {\n    list: Plugin[]\n    map: { [id: string]: Plugin }\n  } = {\n    list: [],\n    map: {},\n  }\n\n  constructor() {\n    const scope = this\n\n    this.Interactable = class extends InteractableBase {\n      get _defaults() {\n        return scope.defaults\n      }\n\n      set<T extends InteractableBase>(this: T, options: OptionsArg) {\n        super.set(options)\n\n        scope.fire('interactable:set', {\n          options,\n          interactable: this,\n        })\n\n        return this\n      }\n\n      unset(this: InteractableBase) {\n        super.unset()\n\n        const index = scope.interactables.list.indexOf(this)\n        if (index < 0) return\n\n        scope.interactables.list.splice(index, 1)\n        scope.fire('interactable:unset', { interactable: this })\n      }\n    }\n  }\n\n  addListeners(map: ListenerMap, id?: string) {\n    this.listenerMaps.push({ id, map })\n  }\n\n  fire<T extends ListenerName>(name: T, arg: SignalArgs[T]): void | false {\n    for (const {\n      map: { [name]: listener },\n    } of this.listenerMaps) {\n      if (!!listener && listener(arg as any, this, name as never) === false) {\n        return false\n      }\n    }\n  }\n\n  onWindowUnload = (event: BeforeUnloadEvent) => this.removeDocument(event.target as Document)\n\n  init(window: Window | typeof globalThis) {\n    return this.isInitialized ? this : initScope(this, window)\n  }\n\n  pluginIsInstalled(plugin: Plugin) {\n    const { id } = plugin\n    return id ? !!this._plugins.map[id] : this._plugins.list.indexOf(plugin) !== -1\n  }\n\n  usePlugin(plugin: Plugin, options?: { [key: string]: any }) {\n    if (!this.isInitialized) {\n      return this\n    }\n\n    if (this.pluginIsInstalled(plugin)) {\n      return this\n    }\n\n    if (plugin.id) {\n      this._plugins.map[plugin.id] = plugin\n    }\n    this._plugins.list.push(plugin)\n\n    if (plugin.install) {\n      plugin.install(this, options)\n    }\n\n    if (plugin.listeners && plugin.before) {\n      let index = 0\n      const len = this.listenerMaps.length\n      const before = plugin.before.reduce((acc, id) => {\n        acc[id] = true\n        acc[pluginIdRoot(id)] = true\n        return acc\n      }, {})\n\n      for (; index < len; index++) {\n        const otherId = this.listenerMaps[index].id\n\n        if (otherId && (before[otherId] || before[pluginIdRoot(otherId)])) {\n          break\n        }\n      }\n\n      this.listenerMaps.splice(index, 0, { id: plugin.id, map: plugin.listeners })\n    } else if (plugin.listeners) {\n      this.listenerMaps.push({ id: plugin.id, map: plugin.listeners })\n    }\n\n    return this\n  }\n\n  addDocument(doc: Document, options?: any): void | false {\n    // do nothing if document is already known\n    if (this.getDocIndex(doc) !== -1) {\n      return false\n    }\n\n    const window = win.getWindow(doc)\n\n    options = options ? extend({}, options) : {}\n\n    this.documents.push({ doc, options })\n    this.events.documents.push(doc)\n\n    // don't add an unload event for the main document\n    // so that the page may be cached in browser history\n    if (doc !== this.document) {\n      this.events.add(window, 'unload', this.onWindowUnload)\n    }\n\n    this.fire('scope:add-document', { doc, window, scope: this, options })\n  }\n\n  removeDocument(doc: Document) {\n    const index = this.getDocIndex(doc)\n\n    const window = win.getWindow(doc)\n    const options = this.documents[index].options\n\n    this.events.remove(window, 'unload', this.onWindowUnload)\n\n    this.documents.splice(index, 1)\n    this.events.documents.splice(index, 1)\n\n    this.fire('scope:remove-document', { doc, window, scope: this, options })\n  }\n\n  getDocIndex(doc: Document) {\n    for (let i = 0; i < this.documents.length; i++) {\n      if (this.documents[i].doc === doc) {\n        return i\n      }\n    }\n\n    return -1\n  }\n\n  getDocOptions(doc: Document) {\n    const docIndex = this.getDocIndex(doc)\n\n    return docIndex === -1 ? null : this.documents[docIndex].options\n  }\n\n  now() {\n    return (((this.window as any).Date as typeof Date) || Date).now()\n  }\n}\n\n// Keep Scope class internal, but expose minimal interface to avoid broken types when Scope is stripped out\nexport interface Scope {\n  fire<T extends ListenerName>(name: T, arg: SignalArgs[T]): void | false\n}\n\n/** @internal */\nexport function initScope(scope: Scope, window: Window | typeof globalThis) {\n  scope.isInitialized = true\n\n  if (is.window(window)) {\n    win.init(window)\n  }\n\n  domObjects.init(window)\n  browser.init(window)\n  raf.init(window)\n\n  // @ts-expect-error\n  scope.window = window\n  scope.document = window.document\n\n  scope.usePlugin(interactions)\n  scope.usePlugin(events)\n\n  return scope\n}\n\nfunction pluginIdRoot(id: string) {\n  return id && id.replace(/\\/.*$/, '')\n}\n", "import browser from '@interactjs/utils/browser'\nimport * as domUtils from '@interactjs/utils/domUtils'\nimport is from '@interactjs/utils/is'\nimport isNonNativeEvent from '@interactjs/utils/isNonNativeEvent'\nimport { warnOnce } from '@interactjs/utils/misc'\nimport * as pointerUtils from '@interactjs/utils/pointerUtils'\n\nimport type { Scope, Plugin } from '@interactjs/core/scope'\nimport type { Context, EventTypes, Listener, ListenersArg, Target } from '@interactjs/core/types'\n\nimport type { Interactable } from './Interactable'\nimport type { Options } from './options'\n\n/**\n * ```js\n * interact('#draggable').draggable(true)\n *\n * var rectables = interact('rect')\n * rectables\n *   .gesturable(true)\n *   .on('gesturemove', function (event) {\n *       // ...\n *   })\n * ```\n *\n * The methods of this variable can be used to set elements as interactables\n * and also to change various default settings.\n *\n * Calling it as a function and passing an element or a valid CSS selector\n * string returns an Interactable object which has various methods to configure\n * it.\n *\n * @param {Element | string} target The HTML or SVG Element to interact with\n * or CSS selector\n * @return {Interactable}\n */\nexport interface InteractStatic {\n  (target: Target, options?: Options): Interactable\n  getPointerAverage: typeof pointerUtils.pointerAverage\n  getTouchBBox: typeof pointerUtils.touchBBox\n  getTouchDistance: typeof pointerUtils.touchDistance\n  getTouchAngle: typeof pointerUtils.touchAngle\n  getElementRect: typeof domUtils.getElementRect\n  getElementClientRect: typeof domUtils.getElementClientRect\n  matchesSelector: typeof domUtils.matchesSelector\n  closest: typeof domUtils.closest\n  /** @internal */ globalEvents: any\n  version: string\n  /** @internal */ scope: Scope\n  /**\n   * Use a plugin\n   */\n  use(\n    plugin: Plugin,\n    options?: {\n      [key: string]: any\n    },\n  ): any\n  /**\n   * Check if an element or selector has been set with the `interact(target)`\n   * function\n   *\n   * @return {boolean} Indicates if the element or CSS selector was previously\n   * passed to interact\n   */\n  isSet(\n    /* The Element or string being searched for */\n    target: Target,\n    options?: any,\n  ): boolean\n  on(type: string | EventTypes, listener: ListenersArg, options?: object): any\n  off(type: EventTypes, listener: any, options?: object): any\n  debug(): any\n  /**\n   * Whether or not the browser supports touch input\n   */\n  supportsTouch(): boolean\n  /**\n   * Whether or not the browser supports PointerEvents\n   */\n  supportsPointerEvent(): boolean\n  /**\n   * Cancels all interactions (end events are not fired)\n   */\n  stop(): InteractStatic\n  /**\n   * Returns or sets the distance the pointer must be moved before an action\n   * sequence occurs. This also affects tolerance for tap events.\n   */\n  pointerMoveTolerance(\n    /** The movement from the start position must be greater than this value */\n    newValue?: number,\n  ): InteractStatic | number\n  addDocument(doc: Document, options?: object): void\n  removeDocument(doc: Document): void\n}\n\nexport function createInteractStatic(scope: Scope): InteractStatic {\n  const interact = ((target: Target, options: Options) => {\n    let interactable = scope.interactables.getExisting(target, options)\n\n    if (!interactable) {\n      interactable = scope.interactables.new(target, options)\n      interactable.events.global = interact.globalEvents\n    }\n\n    return interactable\n  }) as InteractStatic\n\n  // expose the functions used to calculate multi-touch properties\n  interact.getPointerAverage = pointerUtils.pointerAverage\n  interact.getTouchBBox = pointerUtils.touchBBox\n  interact.getTouchDistance = pointerUtils.touchDistance\n  interact.getTouchAngle = pointerUtils.touchAngle\n\n  interact.getElementRect = domUtils.getElementRect\n  interact.getElementClientRect = domUtils.getElementClientRect\n  interact.matchesSelector = domUtils.matchesSelector\n  interact.closest = domUtils.closest\n\n  interact.globalEvents = {} as any\n\n  // eslint-disable-next-line no-undef\n  interact.version = process.env.npm_package_version\n  interact.scope = scope\n  interact.use = function (plugin, options) {\n    this.scope.usePlugin(plugin, options)\n\n    return this\n  }\n\n  interact.isSet = function (target: Target, options?: { context?: Context }): boolean {\n    return !!this.scope.interactables.get(target, options && options.context)\n  }\n\n  interact.on = warnOnce(function on(type: string | EventTypes, listener: ListenersArg, options?: object) {\n    if (is.string(type) && type.search(' ') !== -1) {\n      type = type.trim().split(/ +/)\n    }\n\n    if (is.array(type)) {\n      for (const eventType of type as any[]) {\n        this.on(eventType, listener, options)\n      }\n\n      return this\n    }\n\n    if (is.object(type)) {\n      for (const prop in type) {\n        this.on(prop, (type as any)[prop], listener)\n      }\n\n      return this\n    }\n\n    // if it is an InteractEvent type, add listener to globalEvents\n    if (isNonNativeEvent(type, this.scope.actions)) {\n      // if this type of event was never bound\n      if (!this.globalEvents[type]) {\n        this.globalEvents[type] = [listener]\n      } else {\n        this.globalEvents[type].push(listener)\n      }\n    }\n    // If non InteractEvent type, addEventListener to document\n    else {\n      this.scope.events.add(this.scope.document, type, listener as Listener, { options })\n    }\n\n    return this\n  }, 'The interact.on() method is being deprecated')\n\n  interact.off = warnOnce(function off(type: EventTypes, listener: any, options?: object) {\n    if (is.string(type) && type.search(' ') !== -1) {\n      type = type.trim().split(/ +/)\n    }\n\n    if (is.array(type)) {\n      for (const eventType of type) {\n        this.off(eventType, listener, options)\n      }\n\n      return this\n    }\n\n    if (is.object(type)) {\n      for (const prop in type) {\n        this.off(prop, type[prop], listener)\n      }\n\n      return this\n    }\n\n    if (isNonNativeEvent(type, this.scope.actions)) {\n      let index: number\n\n      if (type in this.globalEvents && (index = this.globalEvents[type].indexOf(listener)) !== -1) {\n        this.globalEvents[type].splice(index, 1)\n      }\n    } else {\n      this.scope.events.remove(this.scope.document, type, listener, options)\n    }\n\n    return this\n  }, 'The interact.off() method is being deprecated')\n\n  interact.debug = function () {\n    return this.scope\n  }\n\n  interact.supportsTouch = function () {\n    return browser.supportsTouch\n  }\n\n  interact.supportsPointerEvent = function () {\n    return browser.supportsPointerEvent\n  }\n\n  interact.stop = function () {\n    for (const interaction of this.scope.interactions.list) {\n      interaction.stop()\n    }\n\n    return this\n  }\n\n  interact.pointerMoveTolerance = function (newValue?: number) {\n    if (is.number(newValue)) {\n      this.scope.interactions.pointerMoveTolerance = newValue\n\n      return this\n    }\n\n    return this.scope.interactions.pointerMoveTolerance\n  }\n\n  interact.addDocument = function (doc: Document, options?: object) {\n    this.scope.addDocument(doc, options)\n  }\n\n  interact.removeDocument = function (doc: Document) {\n    this.scope.removeDocument(doc)\n  }\n\n  return interact\n}\n", "import { Scope } from '@interactjs/core/scope'\n\nconst scope = new Scope()\n\nconst interact = scope.interactStatic\n\nexport default interact\n\nconst _global = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : this\nscope.init(_global)\n", "export default () => {}\n", "export default () => {}\n", "import type { Rect, Point } from '@interactjs/core/types'\nimport type { SnapFunction, SnapTarget } from '@interactjs/modifiers/snap/pointer'\n\nexport interface GridOptionsBase {\n  range?: number\n  limits?: Rect\n  offset?: Point\n}\nexport interface GridOptionsXY extends GridOptionsBase {\n  x: number\n  y: number\n}\nexport interface GridOptionsTopLeft extends GridOptionsBase {\n  top?: number\n  left?: number\n}\nexport interface GridOptionsBottomRight extends GridOptionsBase {\n  bottom?: number\n  right?: number\n}\nexport interface GridOptionsWidthHeight extends GridOptionsBase {\n  width?: number\n  height?: number\n}\n\nexport type GridOptions = GridOptionsXY | GridOptionsTopLeft | GridOptionsBottomRight | GridOptionsWidthHeight\n\nexport default (grid: GridOptions) => {\n  const coordFields = (\n    [\n      ['x', 'y'],\n      ['left', 'top'],\n      ['right', 'bottom'],\n      ['width', 'height'],\n    ] as const\n  ).filter(([xField, yField]) => xField in grid || yField in grid)\n\n  const gridFunc: SnapFunction & {\n    grid: typeof grid\n    coordFields: typeof coordFields\n  } = (x, y) => {\n    const {\n      range,\n      limits = {\n        left: -Infinity,\n        right: Infinity,\n        top: -Infinity,\n        bottom: Infinity,\n      },\n      offset = { x: 0, y: 0 },\n    } = grid\n\n    const result: SnapTarget & {\n      grid: typeof grid\n    } = { range, grid, x: null as number, y: null as number }\n\n    for (const [xField, yField] of coordFields) {\n      const gridx = Math.round((x - offset.x) / (grid as any)[xField])\n      const gridy = Math.round((y - offset.y) / (grid as any)[yField])\n\n      result[xField] = Math.max(limits.left, Math.min(limits.right, gridx * (grid as any)[xField] + offset.x))\n      result[yField] = Math.max(limits.top, Math.min(limits.bottom, gridy * (grid as any)[yField] + offset.y))\n    }\n\n    return result\n  }\n\n  gridFunc.grid = grid\n  gridFunc.coordFields = coordFields\n\n  return gridFunc\n}\n", "import type { Plugin } from '@interactjs/core/scope'\nimport extend from '@interactjs/utils/extend'\n\nimport * as allSnappers from './all'\n\ndeclare module '@interactjs/core/InteractStatic' {\n  export interface InteractStatic {\n    snappers: typeof allSnappers\n    createSnapGrid: typeof allSnappers.grid\n  }\n}\n\nconst snappersPlugin: Plugin = {\n  id: 'snappers',\n  install(scope) {\n    const { interactStatic: interact } = scope\n\n    interact.snappers = extend(interact.snappers || {}, allSnappers)\n    interact.createSnapGrid = interact.snappers.grid\n  },\n}\n\nexport default snappersPlugin\n", "/**\n * @module modifiers/aspectRatio\n *\n * @description\n * This modifier forces elements to be resized with a specified dx/dy ratio.\n *\n * ```js\n * interact(target).resizable({\n *   modifiers: [\n *     interact.modifiers.snapSize({\n *       targets: [ interact.snappers.grid({ x: 20, y: 20 }) ],\n *     }),\n *     interact.aspectRatio({ ratio: 'preserve' }),\n *   ],\n * });\n * ```\n */\n\nimport type { Point, Rect, EdgeOptions } from '@interactjs/core/types'\nimport extend from '@interactjs/utils/extend'\nimport { addEdges } from '@interactjs/utils/rect'\n\nimport { makeModifier } from './base'\nimport { Modification } from './Modification'\nimport type { Modifier, ModifierModule, ModifierState } from './types'\n\nexport interface AspectRatioOptions {\n  ratio?: number | 'preserve'\n  equalDelta?: boolean\n  modifiers?: Modifier[]\n  enabled?: boolean\n}\n\nexport type AspectRatioState = ModifierState<\n  AspectRatioOptions,\n  {\n    startCoords: Point\n    startRect: Rect\n    linkedEdges: EdgeOptions\n    ratio: number\n    equalDelta: boolean\n    xIsPrimaryAxis: boolean\n    edgeSign: {\n      x: number\n      y: number\n    }\n    subModification: Modification\n  }\n>\n\nconst aspectRatio: ModifierModule<AspectRatioOptions, AspectRatioState> = {\n  start(arg) {\n    const { state, rect, edges, pageCoords: coords } = arg\n    let { ratio, enabled } = state.options\n    const { equalDelta, modifiers } = state.options\n\n    if (ratio === 'preserve') {\n      ratio = rect.width / rect.height\n    }\n\n    state.startCoords = extend({}, coords)\n    state.startRect = extend({}, rect)\n    state.ratio = ratio\n    state.equalDelta = equalDelta\n\n    const linkedEdges = (state.linkedEdges = {\n      top: edges.top || (edges.left && !edges.bottom),\n      left: edges.left || (edges.top && !edges.right),\n      bottom: edges.bottom || (edges.right && !edges.top),\n      right: edges.right || (edges.bottom && !edges.left),\n    })\n\n    state.xIsPrimaryAxis = !!(edges.left || edges.right)\n\n    if (state.equalDelta) {\n      const sign = (linkedEdges.left ? 1 : -1) * (linkedEdges.top ? 1 : -1)\n      state.edgeSign = {\n        x: sign,\n        y: sign,\n      }\n    } else {\n      state.edgeSign = {\n        x: linkedEdges.left ? -1 : 1,\n        y: linkedEdges.top ? -1 : 1,\n      }\n    }\n\n    if (enabled !== false) {\n      extend(edges, linkedEdges)\n    }\n\n    if (!modifiers?.length) return\n\n    const subModification = new Modification(arg.interaction)\n\n    subModification.copyFrom(arg.interaction.modification)\n    subModification.prepareStates(modifiers)\n\n    state.subModification = subModification\n    subModification.startAll({ ...arg })\n  },\n\n  set(arg) {\n    const { state, rect, coords } = arg\n    const { linkedEdges } = state\n    const initialCoords = extend({}, coords)\n    const aspectMethod = state.equalDelta ? setEqualDelta : setRatio\n\n    extend(arg.edges, linkedEdges)\n    aspectMethod(state, state.xIsPrimaryAxis, coords, rect)\n\n    if (!state.subModification) {\n      return null\n    }\n\n    const correctedRect = extend({}, rect)\n\n    addEdges(linkedEdges, correctedRect, {\n      x: coords.x - initialCoords.x,\n      y: coords.y - initialCoords.y,\n    })\n\n    const result = state.subModification.setAll({\n      ...arg,\n      rect: correctedRect,\n      edges: linkedEdges,\n      pageCoords: coords,\n      prevCoords: coords,\n      prevRect: correctedRect,\n    })\n\n    const { delta } = result\n\n    if (result.changed) {\n      const xIsCriticalAxis = Math.abs(delta.x) > Math.abs(delta.y)\n\n      // do aspect modification again with critical edge axis as primary\n      aspectMethod(state, xIsCriticalAxis, result.coords, result.rect)\n      extend(coords, result.coords)\n    }\n\n    return result.eventProps\n  },\n\n  defaults: {\n    ratio: 'preserve',\n    equalDelta: false,\n    modifiers: [],\n    enabled: false,\n  },\n}\n\nfunction setEqualDelta({ startCoords, edgeSign }: AspectRatioState, xIsPrimaryAxis: boolean, coords: Point) {\n  if (xIsPrimaryAxis) {\n    coords.y = startCoords.y + (coords.x - startCoords.x) * edgeSign.y\n  } else {\n    coords.x = startCoords.x + (coords.y - startCoords.y) * edgeSign.x\n  }\n}\n\nfunction setRatio(\n  { startRect, startCoords, ratio, edgeSign }: AspectRatioState,\n  xIsPrimaryAxis: boolean,\n  coords: Point,\n  rect: Rect,\n) {\n  if (xIsPrimaryAxis) {\n    const newHeight = rect.width / ratio\n\n    coords.y = startCoords.y + (newHeight - startRect.height) * edgeSign.y\n  } else {\n    const newWidth = rect.height * ratio\n\n    coords.x = startCoords.x + (newWidth - startRect.width) * edgeSign.x\n  }\n}\n\nexport default makeModifier(aspectRatio, 'aspectRatio')\nexport { aspectRatio }\n", "import type { ModifierFunction } from './types'\n\nconst noop = (() => {}) as unknown as ModifierFunction<any, any, 'noop'>\n\nnoop._defaults = {}\n\nexport default noop\n", "import type Interaction from '@interactjs/core/Interaction'\nimport type { RectResolvable, Rect, Point } from '@interactjs/core/types'\nimport extend from '@interactjs/utils/extend'\nimport is from '@interactjs/utils/is'\nimport * as rectUtils from '@interactjs/utils/rect'\n\nimport { makeModifier } from '../base'\nimport type { ModifierArg, ModifierModule, ModifierState } from '../types'\n\nexport interface RestrictOptions {\n  // where to drag over\n  restriction: RectResolvable<[number, number, Interaction]>\n  // what part of self is allowed to drag over\n  elementRect: Rect\n  offset: Rect\n  // restrict just before the end drag\n  endOnly: boolean\n  enabled?: boolean\n}\n\nexport type RestrictState = ModifierState<\n  RestrictOptions,\n  {\n    offset: Rect\n  }\n>\n\nfunction start({ rect, startOffset, state, interaction, pageCoords }: ModifierArg<RestrictState>) {\n  const { options } = state\n  const { elementRect } = options\n  const offset: Rect = extend(\n    {\n      left: 0,\n      top: 0,\n      right: 0,\n      bottom: 0,\n    },\n    options.offset || {},\n  )\n\n  if (rect && elementRect) {\n    const restriction = getRestrictionRect(options.restriction, interaction, pageCoords)\n\n    if (restriction) {\n      const widthDiff = restriction.right - restriction.left - rect.width\n      const heightDiff = restriction.bottom - restriction.top - rect.height\n\n      if (widthDiff < 0) {\n        offset.left += widthDiff\n        offset.right += widthDiff\n      }\n      if (heightDiff < 0) {\n        offset.top += heightDiff\n        offset.bottom += heightDiff\n      }\n    }\n\n    offset.left += startOffset.left - rect.width * elementRect.left\n    offset.top += startOffset.top - rect.height * elementRect.top\n\n    offset.right += startOffset.right - rect.width * (1 - elementRect.right)\n    offset.bottom += startOffset.bottom - rect.height * (1 - elementRect.bottom)\n  }\n\n  state.offset = offset\n}\n\nfunction set({ coords, interaction, state }: ModifierArg<RestrictState>) {\n  const { options, offset } = state\n\n  const restriction = getRestrictionRect(options.restriction, interaction, coords)\n\n  if (!restriction) return\n\n  const rect = rectUtils.xywhToTlbr(restriction)\n\n  coords.x = Math.max(Math.min(rect.right - offset.right, coords.x), rect.left + offset.left)\n  coords.y = Math.max(Math.min(rect.bottom - offset.bottom, coords.y), rect.top + offset.top)\n}\n\nexport function getRestrictionRect(\n  value: RectResolvable<[number, number, Interaction]>,\n  interaction: Interaction,\n  coords?: Point,\n) {\n  if (is.func(value)) {\n    return rectUtils.resolveRectLike(value, interaction.interactable, interaction.element, [\n      coords.x,\n      coords.y,\n      interaction,\n    ])\n  } else {\n    return rectUtils.resolveRectLike(value, interaction.interactable, interaction.element)\n  }\n}\n\nconst defaults: RestrictOptions = {\n  restriction: null,\n  elementRect: null,\n  offset: null,\n  endOnly: false,\n  enabled: false,\n}\n\nconst restrict: ModifierModule<RestrictOptions, RestrictState> = {\n  start,\n  set,\n  defaults,\n}\n\nexport default makeModifier(restrict, 'restrict')\nexport { restrict }\n", "// This modifier adds the options.resize.restrictEdges setting which sets min and\n// max for the top, left, bottom and right edges of the target being resized.\n//\n// interact(target).resize({\n//   edges: { top: true, left: true },\n//   restrictEdges: {\n//     inner: { top: 200, left: 200, right: 400, bottom: 400 },\n//     outer: { top:   0, left:   0, right: 600, bottom: 600 },\n//   },\n// })\n\nimport type { Point, Rect } from '@interactjs/core/types'\nimport extend from '@interactjs/utils/extend'\nimport * as rectUtils from '@interactjs/utils/rect'\n\nimport { makeModifier } from '../base'\nimport type { ModifierArg, ModifierState } from '../types'\n\nimport type { RestrictOptions } from './pointer'\nimport { getRestrictionRect } from './pointer'\n\nexport interface RestrictEdgesOptions {\n  inner: RestrictOptions['restriction']\n  outer: RestrictOptions['restriction']\n  offset?: RestrictOptions['offset']\n  endOnly: boolean\n  enabled?: boolean\n}\n\nexport type RestrictEdgesState = ModifierState<\n  RestrictEdgesOptions,\n  {\n    inner: Rect\n    outer: Rect\n    offset: RestrictEdgesOptions['offset']\n  }\n>\n\nconst noInner = { top: +Infinity, left: +Infinity, bottom: -Infinity, right: -Infinity }\nconst noOuter = { top: -Infinity, left: -Infinity, bottom: +Infinity, right: +Infinity }\n\nfunction start({ interaction, startOffset, state }: ModifierArg<RestrictEdgesState>) {\n  const { options } = state\n  let offset: Point\n\n  if (options) {\n    const offsetRect = getRestrictionRect(options.offset, interaction, interaction.coords.start.page)\n\n    offset = rectUtils.rectToXY(offsetRect)\n  }\n\n  offset = offset || { x: 0, y: 0 }\n\n  state.offset = {\n    top: offset.y + startOffset.top,\n    left: offset.x + startOffset.left,\n    bottom: offset.y - startOffset.bottom,\n    right: offset.x - startOffset.right,\n  }\n}\n\nfunction set({ coords, edges, interaction, state }: ModifierArg<RestrictEdgesState>) {\n  const { offset, options } = state\n\n  if (!edges) {\n    return\n  }\n\n  const page = extend({}, coords)\n  const inner = getRestrictionRect(options.inner, interaction, page) || ({} as Rect)\n  const outer = getRestrictionRect(options.outer, interaction, page) || ({} as Rect)\n\n  fixRect(inner, noInner)\n  fixRect(outer, noOuter)\n\n  if (edges.top) {\n    coords.y = Math.min(Math.max(outer.top + offset.top, page.y), inner.top + offset.top)\n  } else if (edges.bottom) {\n    coords.y = Math.max(Math.min(outer.bottom + offset.bottom, page.y), inner.bottom + offset.bottom)\n  }\n  if (edges.left) {\n    coords.x = Math.min(Math.max(outer.left + offset.left, page.x), inner.left + offset.left)\n  } else if (edges.right) {\n    coords.x = Math.max(Math.min(outer.right + offset.right, page.x), inner.right + offset.right)\n  }\n}\n\nfunction fixRect(rect: Rect, defaults: Rect) {\n  for (const edge of ['top', 'left', 'bottom', 'right']) {\n    if (!(edge in rect)) {\n      rect[edge] = defaults[edge]\n    }\n  }\n\n  return rect\n}\n\nconst defaults: RestrictEdgesOptions = {\n  inner: null,\n  outer: null,\n  offset: null,\n  endOnly: false,\n  enabled: false,\n}\n\nconst restrictEdges = {\n  noInner,\n  noOuter,\n  start,\n  set,\n  defaults,\n}\n\nexport default makeModifier(restrictEdges, 'restrictEdges')\nexport { restrictEdges }\n", "import extend from '@interactjs/utils/extend'\n\nimport { makeModifier } from '../base'\n\nimport { restrict } from './pointer'\n\nconst defaults = extend(\n  {\n    get elementRect() {\n      return { top: 0, left: 0, bottom: 1, right: 1 }\n    },\n    set elementRect(_) {},\n  },\n  restrict.defaults,\n)\n\nconst restrictRect = {\n  start: restrict.start,\n  set: restrict.set,\n  defaults,\n}\n\nexport default makeModifier(restrictRect, 'restrictRect')\nexport { restrictRect }\n", "import type { Point, Rect, Size } from '@interactjs/core/types'\nimport extend from '@interactjs/utils/extend'\nimport * as rectUtils from '@interactjs/utils/rect'\n\nimport { makeModifier } from '../base'\nimport type { ModifierArg, ModifierState } from '../types'\n\nimport type { RestrictEdgesState } from './edges'\nimport { restrictEdges } from './edges'\nimport type { RestrictOptions } from './pointer'\nimport { getRestrictionRect } from './pointer'\n\nconst noMin = { width: -Infinity, height: -Infinity }\nconst noMax = { width: +Infinity, height: +Infinity }\n\nexport interface RestrictSizeOptions {\n  min?: Size | Point | RestrictOptions['restriction']\n  max?: Size | Point | RestrictOptions['restriction']\n  endOnly: boolean\n  enabled?: boolean\n}\n\nfunction start(arg: ModifierArg<RestrictEdgesState>) {\n  return restrictEdges.start(arg)\n}\n\nexport type RestrictSizeState = RestrictEdgesState &\n  ModifierState<\n    RestrictSizeOptions & { inner: Rect; outer: Rect },\n    {\n      min: Rect\n      max: Rect\n    }\n  >\n\nfunction set(arg: ModifierArg<RestrictSizeState>) {\n  const { interaction, state, rect, edges } = arg\n  const { options } = state\n\n  if (!edges) {\n    return\n  }\n\n  const minSize =\n    rectUtils.tlbrToXywh(getRestrictionRect(options.min as any, interaction, arg.coords)) || noMin\n  const maxSize =\n    rectUtils.tlbrToXywh(getRestrictionRect(options.max as any, interaction, arg.coords)) || noMax\n\n  state.options = {\n    endOnly: options.endOnly,\n    inner: extend({}, restrictEdges.noInner),\n    outer: extend({}, restrictEdges.noOuter),\n  }\n\n  if (edges.top) {\n    state.options.inner.top = rect.bottom - minSize.height\n    state.options.outer.top = rect.bottom - maxSize.height\n  } else if (edges.bottom) {\n    state.options.inner.bottom = rect.top + minSize.height\n    state.options.outer.bottom = rect.top + maxSize.height\n  }\n  if (edges.left) {\n    state.options.inner.left = rect.right - minSize.width\n    state.options.outer.left = rect.right - maxSize.width\n  } else if (edges.right) {\n    state.options.inner.right = rect.left + minSize.width\n    state.options.outer.right = rect.left + maxSize.width\n  }\n\n  restrictEdges.set(arg)\n\n  state.options = options\n}\n\nconst defaults: RestrictSizeOptions = {\n  min: null,\n  max: null,\n  endOnly: false,\n  enabled: false,\n}\n\nconst restrictSize = {\n  start,\n  set,\n  defaults,\n}\n\nexport default makeModifier(restrictSize, 'restrictSize')\nexport { restrictSize }\n", "import type { Interaction, InteractionProxy } from '@interactjs/core/Interaction'\nimport type { ActionName, Point, RectResolvable, Element } from '@interactjs/core/types'\nimport extend from '@interactjs/utils/extend'\nimport getOriginXY from '@interactjs/utils/getOriginXY'\nimport hypot from '@interactjs/utils/hypot'\nimport is from '@interactjs/utils/is'\nimport { resolveRectLike, rectToXY } from '@interactjs/utils/rect'\n\nimport { makeModifier } from '../base'\nimport type { ModifierArg, ModifierState } from '../types'\n\nexport interface Offset {\n  x: number\n  y: number\n  index: number\n  relativePoint?: Point | null\n}\n\nexport interface SnapPosition {\n  x?: number\n  y?: number\n  range?: number\n  offset?: Offset\n  [index: string]: any\n}\n\nexport type SnapFunction = (\n  x: number,\n  y: number,\n  interaction: InteractionProxy<ActionName>,\n  offset: Offset,\n  index: number,\n) => SnapPosition\nexport type SnapTarget = SnapPosition | SnapFunction\nexport interface SnapOptions {\n  targets?: SnapTarget[]\n  // target range\n  range?: number\n  // self points for snapping. [0,0] = top left, [1,1] = bottom right\n  relativePoints?: Point[]\n  // startCoords = offset snapping from drag start page position\n  offset?: Point | RectResolvable<[Interaction]> | 'startCoords'\n  offsetWithOrigin?: boolean\n  origin?: RectResolvable<[Element]> | Point\n  endOnly?: boolean\n  enabled?: boolean\n}\n\nexport type SnapState = ModifierState<\n  SnapOptions,\n  {\n    offsets?: Offset[]\n    closest?: any\n    targetFields?: string[][]\n  }\n>\n\nfunction start(arg: ModifierArg<SnapState>) {\n  const { interaction, interactable, element, rect, state, startOffset } = arg\n  const { options } = state\n  const origin = options.offsetWithOrigin ? getOrigin(arg) : { x: 0, y: 0 }\n\n  let snapOffset: Point\n\n  if (options.offset === 'startCoords') {\n    snapOffset = {\n      x: interaction.coords.start.page.x,\n      y: interaction.coords.start.page.y,\n    }\n  } else {\n    const offsetRect = resolveRectLike(options.offset as any, interactable, element, [interaction])\n\n    snapOffset = rectToXY(offsetRect) || { x: 0, y: 0 }\n    snapOffset.x += origin.x\n    snapOffset.y += origin.y\n  }\n\n  const { relativePoints } = options\n\n  state.offsets =\n    rect && relativePoints && relativePoints.length\n      ? relativePoints.map((relativePoint, index) => ({\n          index,\n          relativePoint,\n          x: startOffset.left - rect.width * relativePoint.x + snapOffset.x,\n          y: startOffset.top - rect.height * relativePoint.y + snapOffset.y,\n        }))\n      : [\n          {\n            index: 0,\n            relativePoint: null,\n            x: snapOffset.x,\n            y: snapOffset.y,\n          },\n        ]\n}\n\nfunction set(arg: ModifierArg<SnapState>) {\n  const { interaction, coords, state } = arg\n  const { options, offsets } = state\n\n  const origin = getOriginXY(interaction.interactable!, interaction.element!, interaction.prepared.name)\n  const page = extend({}, coords)\n  const targets: SnapPosition[] = []\n\n  if (!options.offsetWithOrigin) {\n    page.x -= origin.x\n    page.y -= origin.y\n  }\n\n  for (const offset of offsets!) {\n    const relativeX = page.x - offset.x\n    const relativeY = page.y - offset.y\n\n    for (let index = 0, len = options.targets!.length; index < len; index++) {\n      const snapTarget = options.targets![index]\n      let target: SnapPosition\n\n      if (is.func(snapTarget)) {\n        target = snapTarget(relativeX, relativeY, interaction._proxy, offset, index)\n      } else {\n        target = snapTarget\n      }\n\n      if (!target) {\n        continue\n      }\n\n      targets.push({\n        x: (is.number(target.x) ? target.x : relativeX) + offset.x,\n        y: (is.number(target.y) ? target.y : relativeY) + offset.y,\n\n        range: is.number(target.range) ? target.range : options.range,\n        source: snapTarget,\n        index,\n        offset,\n      })\n    }\n  }\n\n  const closest = {\n    target: null,\n    inRange: false,\n    distance: 0,\n    range: 0,\n    delta: { x: 0, y: 0 },\n  }\n\n  for (const target of targets) {\n    const range = target.range\n    const dx = target.x - page.x\n    const dy = target.y - page.y\n    const distance = hypot(dx, dy)\n    let inRange = distance <= range\n\n    // Infinite targets count as being out of range\n    // compared to non infinite ones that are in range\n    if (range === Infinity && closest.inRange && closest.range !== Infinity) {\n      inRange = false\n    }\n\n    if (\n      !closest.target ||\n      (inRange\n        ? // is the closest target in range?\n          closest.inRange && range !== Infinity\n          ? // the pointer is relatively deeper in this target\n            distance / range < closest.distance / closest.range\n          : // this target has Infinite range and the closest doesn't\n            (range === Infinity && closest.range !== Infinity) ||\n            // OR this target is closer that the previous closest\n            distance < closest.distance\n        : // The other is not in range and the pointer is closer to this target\n          !closest.inRange && distance < closest.distance)\n    ) {\n      closest.target = target\n      closest.distance = distance\n      closest.range = range\n      closest.inRange = inRange\n      closest.delta.x = dx\n      closest.delta.y = dy\n    }\n  }\n\n  if (closest.inRange) {\n    coords.x = closest.target.x\n    coords.y = closest.target.y\n  }\n\n  state.closest = closest\n  return closest\n}\n\nfunction getOrigin(arg: Partial<ModifierArg<SnapState>>) {\n  const { element } = arg.interaction\n  const optionsOrigin = rectToXY(resolveRectLike(arg.state.options.origin as any, null, null, [element]))\n  const origin = optionsOrigin || getOriginXY(arg.interactable, element, arg.interaction.prepared.name)\n\n  return origin\n}\n\nconst defaults: SnapOptions = {\n  range: Infinity,\n  targets: null,\n  offset: null,\n  offsetWithOrigin: true,\n  origin: null,\n  relativePoints: null,\n  endOnly: false,\n  enabled: false,\n}\nconst snap = {\n  start,\n  set,\n  defaults,\n}\n\nexport default makeModifier(snap, 'snap')\nexport { snap }\n", "// This modifier allows snapping of the size of targets during resize\n// interactions.\n\nimport extend from '@interactjs/utils/extend'\nimport is from '@interactjs/utils/is'\n\nimport { makeModifier } from '../base'\nimport type { ModifierArg } from '../types'\n\nimport type { SnapOptions, SnapState } from './pointer'\nimport { snap } from './pointer'\n\nexport type SnapSizeOptions = Pick<SnapOptions, 'targets' | 'offset' | 'endOnly' | 'range' | 'enabled'>\n\nfunction start(arg: ModifierArg<SnapState>) {\n  const { state, edges } = arg\n  const { options } = state\n\n  if (!edges) {\n    return null\n  }\n\n  arg.state = {\n    options: {\n      targets: null,\n      relativePoints: [\n        {\n          x: edges.left ? 0 : 1,\n          y: edges.top ? 0 : 1,\n        },\n      ],\n      offset: options.offset || 'self',\n      origin: { x: 0, y: 0 },\n      range: options.range,\n    },\n  }\n\n  state.targetFields = state.targetFields || [\n    ['width', 'height'],\n    ['x', 'y'],\n  ]\n\n  snap.start(arg)\n  state.offsets = arg.state.offsets\n\n  arg.state = state\n}\n\nfunction set(arg) {\n  const { interaction, state, coords } = arg\n  const { options, offsets } = state\n  const relative = {\n    x: coords.x - offsets[0].x,\n    y: coords.y - offsets[0].y,\n  }\n\n  state.options = extend({}, options)\n  state.options.targets = []\n\n  for (const snapTarget of options.targets || []) {\n    let target\n\n    if (is.func(snapTarget)) {\n      target = snapTarget(relative.x, relative.y, interaction)\n    } else {\n      target = snapTarget\n    }\n\n    if (!target) {\n      continue\n    }\n\n    for (const [xField, yField] of state.targetFields) {\n      if (xField in target || yField in target) {\n        target.x = target[xField]\n        target.y = target[yField]\n\n        break\n      }\n    }\n\n    state.options.targets.push(target)\n  }\n\n  const returnValue = snap.set(arg)\n\n  state.options = options\n\n  return returnValue\n}\n\nconst defaults: SnapSizeOptions = {\n  range: Infinity,\n  targets: null,\n  offset: null,\n  endOnly: false,\n  enabled: false,\n}\n\nconst snapSize = {\n  start,\n  set,\n  defaults,\n}\n\nexport default makeModifier(snapSize, 'snapSize')\nexport { snapSize }\n", "/**\n * @module modifiers/snapEdges\n *\n * @description\n * This modifier allows snapping of the edges of targets during resize\n * interactions.\n *\n * ```js\n * interact(target).resizable({\n *   snapEdges: {\n *     targets: [interact.snappers.grid({ x: 100, y: 50 })],\n *   },\n * })\n *\n * interact(target).resizable({\n *   snapEdges: {\n *     targets: [\n *       interact.snappers.grid({\n *        top: 50,\n *        left: 50,\n *        bottom: 100,\n *        right: 100,\n *       }),\n *     ],\n *   },\n * })\n * ```\n */\n\nimport clone from '@interactjs/utils/clone'\nimport extend from '@interactjs/utils/extend'\n\nimport { makeModifier } from '../base'\nimport type { ModifierArg, ModifierModule } from '../types'\n\nimport type { SnapOptions, SnapState } from './pointer'\nimport { snapSize } from './size'\n\nexport type SnapEdgesOptions = Pick<SnapOptions, 'targets' | 'range' | 'offset' | 'endOnly' | 'enabled'>\n\nfunction start(arg: ModifierArg<SnapState>) {\n  const { edges } = arg\n\n  if (!edges) {\n    return null\n  }\n\n  arg.state.targetFields = arg.state.targetFields || [\n    [edges.left ? 'left' : 'right', edges.top ? 'top' : 'bottom'],\n  ]\n\n  return snapSize.start(arg)\n}\n\nconst snapEdges: ModifierModule<SnapEdgesOptions, SnapState, ReturnType<typeof snapSize.set>> = {\n  start,\n  set: snapSize.set,\n  defaults: extend(clone(snapSize.defaults), {\n    targets: undefined,\n    range: undefined,\n    offset: { x: 0, y: 0 },\n  } as const),\n}\n\nexport default makeModifier(snapEdges, 'snapEdges')\nexport { snapEdges }\n", "/* eslint-disable n/no-extraneous-import, import/no-unresolved */\nimport aspectRatio from './aspectRatio'\nimport avoid from './avoid/avoid'\nimport restrictEdges from './restrict/edges'\nimport restrict from './restrict/pointer'\nimport restrictRect from './restrict/rect'\nimport restrictSize from './restrict/size'\nimport rubberband from './rubberband/rubberband'\nimport snapEdges from './snap/edges'\nimport snap from './snap/pointer'\nimport snapSize from './snap/size'\nimport spring from './spring/spring'\nimport transform from './transform/transform'\n\nexport default {\n  aspectRatio,\n  restrictEdges,\n  restrict,\n  restrictRect,\n  restrictSize,\n  snapEdges,\n  snap,\n  snapSize,\n\n  spring,\n  avoid,\n  transform,\n  rubberband,\n}\n", "import type { Plugin } from '@interactjs/core/scope'\nimport snappers from '@interactjs/snappers/plugin'\n\n/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport './all'\nimport './base'\n\nimport all from './all'\nimport base from './base'\n/* eslint-enable import/no-duplicates */\n\ndeclare module '@interactjs/core/InteractStatic' {\n  export interface InteractStatic {\n    modifiers: typeof all\n  }\n}\n\nconst modifiers: Plugin = {\n  id: 'modifiers',\n  install(scope) {\n    const { interactStatic: interact } = scope\n\n    scope.usePlugin(base)\n    scope.usePlugin(snappers)\n\n    interact.modifiers = all\n\n    // for backwrads compatibility\n    for (const type in all) {\n      const { _defaults, _methods } = all[type as keyof typeof all]\n\n      ;(_defaults as any)._methods = _methods\n      ;(scope.defaults.perAction as any)[type] = _defaults\n    }\n  },\n}\n\nexport default modifiers\n", "import { BaseEvent } from '@interactjs/core/BaseEvent'\nimport type Interaction from '@interactjs/core/Interaction'\nimport type { PointerEventType, PointerType, Point } from '@interactjs/core/types'\nimport * as pointerUtils from '@interactjs/utils/pointerUtils'\n\nexport class PointerEvent<T extends string = any> extends BaseEvent<never> {\n  declare type: T\n  declare originalEvent: PointerEventType\n  declare pointerId: number\n  declare pointerType: string\n  declare double: boolean\n  declare pageX: number\n  declare pageY: number\n  declare clientX: number\n  declare clientY: number\n  declare dt: number\n  declare eventable: any;\n  [key: string]: any\n\n  constructor(\n    type: T,\n    pointer: PointerType | PointerEvent<any>,\n    event: PointerEventType,\n    eventTarget: Node,\n    interaction: Interaction<never>,\n    timeStamp: number,\n  ) {\n    super(interaction)\n    pointerUtils.pointerExtend(this, event)\n\n    if (event !== pointer) {\n      pointerUtils.pointerExtend(this, pointer)\n    }\n\n    this.timeStamp = timeStamp\n    this.originalEvent = event\n    this.type = type\n    this.pointerId = pointerUtils.getPointerId(pointer)\n    this.pointerType = pointerUtils.getPointerType(pointer)\n    this.target = eventTarget\n    this.currentTarget = null\n\n    if (type === 'tap') {\n      const pointerIndex = interaction.getPointerIndex(pointer)\n      this.dt = this.timeStamp - interaction.pointers[pointerIndex].downTime\n\n      const interval = this.timeStamp - interaction.tapTime\n\n      this.double =\n        !!interaction.prevTap &&\n        interaction.prevTap.type !== 'doubletap' &&\n        interaction.prevTap.target === this.target &&\n        interval < 500\n    } else if (type === 'doubletap') {\n      this.dt = (pointer as PointerEvent<'tap'>).timeStamp - interaction.tapTime\n      this.double = true\n    }\n  }\n\n  _subtractOrigin({ x: originX, y: originY }: Point) {\n    this.pageX -= originX\n    this.pageY -= originY\n    this.clientX -= originX\n    this.clientY -= originY\n\n    return this\n  }\n\n  _addOrigin({ x: originX, y: originY }: Point) {\n    this.pageX += originX\n    this.pageY += originY\n    this.clientX += originX\n    this.clientY += originY\n\n    return this\n  }\n\n  /**\n   * Prevent the default behaviour of the original Event\n   */\n  preventDefault() {\n    this.originalEvent.preventDefault()\n  }\n}\n", "import type { Eventable } from '@interactjs/core/Eventable'\nimport type { Interaction } from '@interactjs/core/Interaction'\nimport type { PerActionDefaults } from '@interactjs/core/options'\nimport type { Scope, SignalArgs, Plugin } from '@interactjs/core/scope'\nimport type { Point, PointerType, PointerEventType, Element } from '@interactjs/core/types'\nimport * as domUtils from '@interactjs/utils/domUtils'\nimport extend from '@interactjs/utils/extend'\nimport getOriginXY from '@interactjs/utils/getOriginXY'\n\nimport { PointerEvent } from './PointerEvent'\n\nexport type EventTargetList = Array<{\n  node: Node\n  eventable: Eventable\n  props: { [key: string]: any }\n}>\n\nexport interface PointerEventOptions extends PerActionDefaults {\n  enabled?: undefined // not used\n  holdDuration?: number\n  ignoreFrom?: any\n  allowFrom?: any\n  origin?: Point | string | Element\n}\n\ndeclare module '@interactjs/core/scope' {\n  interface Scope {\n    pointerEvents: typeof pointerEvents\n  }\n}\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction {\n    prevTap?: PointerEvent<string>\n    tapTime?: number\n  }\n}\n\ndeclare module '@interactjs/core/PointerInfo' {\n  interface PointerInfo {\n    hold?: {\n      duration: number\n      timeout: any\n    }\n  }\n}\n\ndeclare module '@interactjs/core/options' {\n  interface ActionDefaults {\n    pointerEvents: Options\n  }\n}\n\ndeclare module '@interactjs/core/scope' {\n  interface SignalArgs {\n    'pointerEvents:new': { pointerEvent: PointerEvent<any> }\n    'pointerEvents:fired': {\n      interaction: Interaction<null>\n      pointer: PointerType | PointerEvent<any>\n      event: PointerEventType | PointerEvent<any>\n      eventTarget: Node\n      pointerEvent: PointerEvent<any>\n      targets?: EventTargetList\n      type: string\n    }\n    'pointerEvents:collect-targets': {\n      interaction: Interaction<any>\n      pointer: PointerType | PointerEvent<any>\n      event: PointerEventType | PointerEvent<any>\n      eventTarget: Node\n      targets?: EventTargetList\n      type: string\n      path: Node[]\n      node: null\n    }\n  }\n}\n\nconst defaults: PointerEventOptions = {\n  holdDuration: 600,\n  ignoreFrom: null,\n  allowFrom: null,\n  origin: { x: 0, y: 0 },\n}\n\nconst pointerEvents: Plugin = {\n  id: 'pointer-events/base',\n  before: ['inertia', 'modifiers', 'auto-start', 'actions'],\n  install,\n  listeners: {\n    'interactions:new': addInteractionProps,\n    'interactions:update-pointer': addHoldInfo,\n    'interactions:move': moveAndClearHold,\n    'interactions:down': (arg, scope) => {\n      downAndStartHold(arg, scope)\n      fire(arg, scope)\n    },\n    'interactions:up': (arg, scope) => {\n      clearHold(arg)\n      fire(arg, scope)\n      tapAfterUp(arg, scope)\n    },\n    'interactions:cancel': (arg, scope) => {\n      clearHold(arg)\n      fire(arg, scope)\n    },\n  },\n  PointerEvent,\n  fire,\n  collectEventTargets,\n  defaults,\n  types: {\n    down: true,\n    move: true,\n    up: true,\n    cancel: true,\n    tap: true,\n    doubletap: true,\n    hold: true,\n  } as { [type: string]: true },\n}\n\nfunction fire<T extends string>(\n  arg: {\n    pointer: PointerType | PointerEvent<any>\n    event: PointerEventType | PointerEvent<any>\n    eventTarget: Node\n    interaction: Interaction<never>\n    type: T\n    targets?: EventTargetList\n  },\n  scope: Scope,\n) {\n  const { interaction, pointer, event, eventTarget, type, targets = collectEventTargets(arg, scope) } = arg\n\n  const pointerEvent = new PointerEvent(type, pointer, event, eventTarget, interaction, scope.now())\n\n  scope.fire('pointerEvents:new', { pointerEvent })\n\n  const signalArg = {\n    interaction,\n    pointer,\n    event,\n    eventTarget,\n    targets,\n    type,\n    pointerEvent,\n  }\n\n  for (let i = 0; i < targets.length; i++) {\n    const target = targets[i]\n\n    for (const prop in target.props || {}) {\n      ;(pointerEvent as any)[prop] = target.props[prop]\n    }\n\n    const origin = getOriginXY(target.eventable, target.node)\n\n    pointerEvent._subtractOrigin(origin)\n    pointerEvent.eventable = target.eventable\n    pointerEvent.currentTarget = target.node\n\n    target.eventable.fire(pointerEvent)\n\n    pointerEvent._addOrigin(origin)\n\n    if (\n      pointerEvent.immediatePropagationStopped ||\n      (pointerEvent.propagationStopped &&\n        i + 1 < targets.length &&\n        targets[i + 1].node !== pointerEvent.currentTarget)\n    ) {\n      break\n    }\n  }\n\n  scope.fire('pointerEvents:fired', signalArg)\n\n  if (type === 'tap') {\n    // if pointerEvent should make a double tap, create and fire a doubletap\n    // PointerEvent and use that as the prevTap\n    const prevTap = pointerEvent.double\n      ? fire(\n          {\n            interaction,\n            pointer,\n            event,\n            eventTarget,\n            type: 'doubletap',\n          },\n          scope,\n        )\n      : pointerEvent\n\n    interaction.prevTap = prevTap\n    interaction.tapTime = prevTap.timeStamp\n  }\n\n  return pointerEvent\n}\n\nfunction collectEventTargets<T extends string>(\n  {\n    interaction,\n    pointer,\n    event,\n    eventTarget,\n    type,\n  }: {\n    interaction: Interaction<any>\n    pointer: PointerType | PointerEvent<any>\n    event: PointerEventType | PointerEvent<any>\n    eventTarget: Node\n    type: T\n  },\n  scope: Scope,\n) {\n  const pointerIndex = interaction.getPointerIndex(pointer)\n  const pointerInfo = interaction.pointers[pointerIndex]\n\n  // do not fire a tap event if the pointer was moved before being lifted\n  if (\n    type === 'tap' &&\n    (interaction.pointerWasMoved ||\n      // or if the pointerup target is different to the pointerdown target\n      !(pointerInfo && pointerInfo.downTarget === eventTarget))\n  ) {\n    return []\n  }\n\n  const path = domUtils.getPath(eventTarget as Element | Document)\n  const signalArg = {\n    interaction,\n    pointer,\n    event,\n    eventTarget,\n    type,\n    path,\n    targets: [] as EventTargetList,\n    node: null,\n  }\n\n  for (const node of path) {\n    signalArg.node = node\n\n    scope.fire('pointerEvents:collect-targets', signalArg)\n  }\n\n  if (type === 'hold') {\n    signalArg.targets = signalArg.targets.filter(\n      (target) =>\n        target.eventable.options.holdDuration === interaction.pointers[pointerIndex]?.hold?.duration,\n    )\n  }\n\n  return signalArg.targets\n}\n\nfunction addInteractionProps({ interaction }) {\n  interaction.prevTap = null // the most recent tap event on this interaction\n  interaction.tapTime = 0 // time of the most recent tap event\n}\n\nfunction addHoldInfo({ down, pointerInfo }: SignalArgs['interactions:update-pointer']) {\n  if (!down && pointerInfo.hold) {\n    return\n  }\n\n  pointerInfo.hold = { duration: Infinity, timeout: null }\n}\n\nfunction clearHold({ interaction, pointerIndex }) {\n  const hold = interaction.pointers[pointerIndex].hold\n\n  if (hold && hold.timeout) {\n    clearTimeout(hold.timeout)\n    hold.timeout = null\n  }\n}\n\nfunction moveAndClearHold(arg: SignalArgs['interactions:move'], scope: Scope) {\n  const { interaction, pointer, event, eventTarget, duplicate } = arg\n\n  if (!duplicate && (!interaction.pointerIsDown || interaction.pointerWasMoved)) {\n    if (interaction.pointerIsDown) {\n      clearHold(arg)\n    }\n\n    fire(\n      {\n        interaction,\n        pointer,\n        event,\n        eventTarget: eventTarget as Element,\n        type: 'move',\n      },\n      scope,\n    )\n  }\n}\n\nfunction downAndStartHold(\n  { interaction, pointer, event, eventTarget, pointerIndex }: SignalArgs['interactions:down'],\n  scope: Scope,\n) {\n  const timer = interaction.pointers[pointerIndex].hold!\n  const path = domUtils.getPath(eventTarget as Element | Document)\n  const signalArg = {\n    interaction,\n    pointer,\n    event,\n    eventTarget,\n    type: 'hold',\n    targets: [] as EventTargetList,\n    path,\n    node: null,\n  }\n\n  for (const node of path) {\n    signalArg.node = node\n\n    scope.fire('pointerEvents:collect-targets', signalArg)\n  }\n\n  if (!signalArg.targets.length) return\n\n  let minDuration = Infinity\n\n  for (const target of signalArg.targets) {\n    const holdDuration = target.eventable.options.holdDuration\n\n    if (holdDuration < minDuration) {\n      minDuration = holdDuration\n    }\n  }\n\n  timer.duration = minDuration\n  timer.timeout = setTimeout(() => {\n    fire(\n      {\n        interaction,\n        eventTarget,\n        pointer,\n        event,\n        type: 'hold',\n      },\n      scope,\n    )\n  }, minDuration)\n}\n\nfunction tapAfterUp(\n  { interaction, pointer, event, eventTarget }: SignalArgs['interactions:up'],\n  scope: Scope,\n) {\n  if (!interaction.pointerWasMoved) {\n    fire({ interaction, eventTarget, pointer, event, type: 'tap' }, scope)\n  }\n}\n\nfunction install(scope: Scope) {\n  scope.pointerEvents = pointerEvents\n  scope.defaults.actions.pointerEvents = pointerEvents.defaults\n  extend(scope.actions.phaselessTypes, pointerEvents.types)\n}\n\nexport default pointerEvents\n", "import type Interaction from '@interactjs/core/Interaction'\nimport type { ListenerMap, Scope, SignalArgs, Plugin } from '@interactjs/core/scope'\n\n/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport './base'\nimport basePlugin from './base'\n/* eslint-enable import/no-duplicates */\nimport { type PointerEvent } from './PointerEvent'\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction {\n    holdIntervalHandle?: any\n  }\n}\n\ndeclare module '@interactjs/pointer-events/PointerEvent' {\n  interface PointerEvent<T extends string = any> {\n    count?: number\n  }\n}\n\ndeclare module '@interactjs/pointer-events/base' {\n  interface PointerEventOptions {\n    holdRepeatInterval?: number\n  }\n}\n\nfunction install(scope: Scope) {\n  scope.usePlugin(basePlugin)\n\n  const { pointerEvents } = scope\n\n  // don't repeat by default\n  pointerEvents.defaults.holdRepeatInterval = 0\n  pointerEvents.types.holdrepeat = scope.actions.phaselessTypes.holdrepeat = true\n}\n\nfunction onNew({ pointerEvent }: { pointerEvent: PointerEvent<any> }) {\n  if (pointerEvent.type !== 'hold') return\n\n  pointerEvent.count = (pointerEvent.count || 0) + 1\n}\n\nfunction onFired(\n  { interaction, pointerEvent, eventTarget, targets }: SignalArgs['pointerEvents:fired'],\n  scope: Scope,\n) {\n  if (pointerEvent.type !== 'hold' || !targets.length) return\n\n  // get the repeat interval from the first eventable\n  const interval = targets[0].eventable.options.holdRepeatInterval\n\n  // don't repeat if the interval is 0 or less\n  if (interval <= 0) return\n\n  // set a timeout to fire the holdrepeat event\n  interaction.holdIntervalHandle = setTimeout(() => {\n    scope.pointerEvents.fire(\n      {\n        interaction,\n        eventTarget,\n        type: 'hold',\n        pointer: pointerEvent,\n        event: pointerEvent,\n      },\n      scope,\n    )\n  }, interval)\n}\n\nfunction endHoldRepeat({ interaction }: { interaction: Interaction }) {\n  // set the interaction's holdStopTime property\n  // to stop further holdRepeat events\n  if (interaction.holdIntervalHandle) {\n    clearInterval(interaction.holdIntervalHandle)\n    interaction.holdIntervalHandle = null\n  }\n}\n\nconst holdRepeat: Plugin = {\n  id: 'pointer-events/holdRepeat',\n  install,\n  listeners: ['move', 'up', 'cancel', 'endall'].reduce(\n    (acc, enderTypes) => {\n      ;(acc as any)[`pointerEvents:${enderTypes}`] = endHoldRepeat\n      return acc\n    },\n    {\n      'pointerEvents:new': onNew,\n      'pointerEvents:fired': onFired,\n    } as ListenerMap,\n  ),\n}\n\nexport default holdRepeat\n", "import type { Interactable } from '@interactjs/core/Interactable'\nimport type { Scope, Plugin } from '@interactjs/core/scope'\nimport type { Element } from '@interactjs/core/types'\nimport extend from '@interactjs/utils/extend'\n\nimport type { PointerEventOptions } from '@interactjs/pointer-events/base'\n\ndeclare module '@interactjs/core/Interactable' {\n  interface Interactable {\n    pointerEvents(options: Partial<PointerEventOptions>): this\n    /** @internal */\n    __backCompatOption: (optionName: string, newValue: any) => any\n  }\n}\n\nfunction install(scope: Scope) {\n  const { Interactable } = scope\n\n  Interactable.prototype.pointerEvents = function (\n    this: Interactable,\n    options: Partial<PointerEventOptions>,\n  ) {\n    extend(this.events.options, options)\n\n    return this\n  }\n\n  const __backCompatOption = Interactable.prototype._backCompatOption\n\n  Interactable.prototype._backCompatOption = function (optionName, newValue) {\n    const ret = __backCompatOption.call(this, optionName, newValue)\n\n    if (ret === this) {\n      this.events.options[optionName] = newValue\n    }\n\n    return ret\n  }\n}\n\nconst plugin: Plugin = {\n  id: 'pointer-events/interactableTargets',\n  install,\n  listeners: {\n    'pointerEvents:collect-targets': ({ targets, node, type, eventTarget }, scope) => {\n      scope.interactables.forEachMatch(node, (interactable: Interactable) => {\n        const eventable = interactable.events\n        const options = eventable.options\n\n        if (\n          eventable.types[type] &&\n          eventable.types[type].length &&\n          interactable.testIgnoreAllow(options, node, eventTarget)\n        ) {\n          targets.push({\n            node,\n            eventable,\n            props: { interactable },\n          })\n        }\n      })\n    },\n\n    'interactable:new': ({ interactable }) => {\n      interactable.events.getRect = function (element: Element) {\n        return interactable.getRect(element)\n      }\n    },\n\n    'interactable:set': ({ interactable, options }, scope) => {\n      extend(interactable.events.options, scope.pointerEvents.defaults)\n      extend(interactable.events.options, options.pointerEvents || {})\n    },\n  },\n}\n\nexport default plugin\n", "import type { Plugin } from '@interactjs/core/scope'\n\n/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport './base'\nimport './holdRepeat'\nimport './interactableTargets'\n\nimport * as pointerEvents from './base'\nimport holdRepeat from './holdRepeat'\nimport interactableTargets from './interactableTargets'\n/* eslint-enable import/no-duplicates */\n\nconst plugin: Plugin = {\n  id: 'pointer-events',\n  install(scope) {\n    scope.usePlugin(pointerEvents)\n    scope.usePlugin(holdRepeat)\n    scope.usePlugin(interactableTargets)\n  },\n}\n\nexport default plugin\n", "import type { Interactable } from '@interactjs/core/Interactable'\nimport type { DoAnyPhaseArg, Interaction } from '@interactjs/core/Interaction'\nimport type { Scope, Plugin } from '@interactjs/core/scope'\nimport type { ActionName, ActionProps, Element } from '@interactjs/core/types'\nimport * as arr from '@interactjs/utils/arr'\nimport { copyAction } from '@interactjs/utils/misc'\nimport * as pointerUtils from '@interactjs/utils/pointerUtils'\nimport { tlbrToXywh } from '@interactjs/utils/rect'\n\ndeclare module '@interactjs/core/scope' {\n  interface SignalArgs {\n    'interactions:before-action-reflow': Omit<DoAnyPhaseArg, 'iEvent'>\n    'interactions:action-reflow': DoAnyPhaseArg\n    'interactions:after-action-reflow': DoAnyPhaseArg\n  }\n}\n\ndeclare module '@interactjs/core/Interactable' {\n  interface Interactable {\n    /**\n     * ```js\n     * const interactable = interact(target)\n     * const drag = { name: drag, axis: 'x' }\n     * const resize = { name: resize, edges: { left: true, bottom: true }\n     *\n     * interactable.reflow(drag)\n     * interactable.reflow(resize)\n     * ```\n     *\n     * Start an action sequence to re-apply modifiers, check drops, etc.\n     *\n     * @param { Object } action The action to begin\n     * @param { string } action.name The name of the action\n     * @returns { Promise } A promise that resolves to the `Interactable` when actions on all targets have ended\n     */\n    reflow<T extends ActionName>(action: ActionProps<T>): ReturnType<typeof doReflow>\n  }\n}\n\ndeclare module '@interactjs/core/Interaction' {\n  interface Interaction {\n    _reflowPromise: Promise<void>\n    _reflowResolve: (...args: unknown[]) => void\n  }\n}\n\ndeclare module '@interactjs/core/InteractEvent' {\n  interface PhaseMap {\n    reflow?: true\n  }\n}\n\nfunction install(scope: Scope) {\n  const { Interactable } = scope\n\n  scope.actions.phases.reflow = true\n\n  Interactable.prototype.reflow = function (action: ActionProps) {\n    return doReflow(this, action, scope)\n  }\n}\n\nfunction doReflow<T extends ActionName>(\n  interactable: Interactable,\n  action: ActionProps<T>,\n  scope: Scope,\n): Promise<Interactable> {\n  const elements = interactable.getAllElements()\n\n  // tslint:disable-next-line variable-name\n  const Promise = (scope.window as any).Promise\n  const promises: Array<Promise<null>> | null = Promise ? [] : null\n\n  for (const element of elements) {\n    const rect = interactable.getRect(element as HTMLElement | SVGElement)\n\n    if (!rect) {\n      break\n    }\n\n    const runningInteraction = arr.find(scope.interactions.list, (interaction: Interaction) => {\n      return (\n        interaction.interacting() &&\n        interaction.interactable === interactable &&\n        interaction.element === element &&\n        interaction.prepared.name === action.name\n      )\n    })\n    let reflowPromise: Promise<null>\n\n    if (runningInteraction) {\n      runningInteraction.move()\n\n      if (promises) {\n        reflowPromise =\n          runningInteraction._reflowPromise ||\n          new Promise((resolve: any) => {\n            runningInteraction._reflowResolve = resolve\n          })\n      }\n    } else {\n      const xywh = tlbrToXywh(rect)\n      const coords = {\n        page: { x: xywh.x, y: xywh.y },\n        client: { x: xywh.x, y: xywh.y },\n        timeStamp: scope.now(),\n      }\n\n      const event = pointerUtils.coordsToEvent(coords)\n      reflowPromise = startReflow<T>(scope, interactable, element, action, event)\n    }\n\n    if (promises) {\n      promises.push(reflowPromise)\n    }\n  }\n\n  return promises && Promise.all(promises).then(() => interactable)\n}\n\nfunction startReflow<T extends ActionName>(\n  scope: Scope,\n  interactable: Interactable,\n  element: Element,\n  action: ActionProps<T>,\n  event: any,\n) {\n  const interaction = scope.interactions.new({ pointerType: 'reflow' })\n  const signalArg = {\n    interaction,\n    event,\n    pointer: event,\n    eventTarget: element,\n    phase: 'reflow',\n  } as const\n\n  interaction.interactable = interactable\n  interaction.element = element\n  interaction.prevEvent = event\n  interaction.updatePointer(event, event, element, true)\n  pointerUtils.setZeroCoords(interaction.coords.delta)\n\n  copyAction(interaction.prepared, action)\n  interaction._doPhase(signalArg)\n\n  const { Promise } = scope.window as unknown as { Promise: PromiseConstructor }\n  const reflowPromise = Promise\n    ? new Promise<undefined>((resolve) => {\n        interaction._reflowResolve = resolve\n      })\n    : undefined\n\n  interaction._reflowPromise = reflowPromise\n  interaction.start(action, interactable, element)\n\n  if (interaction._interacting) {\n    interaction.move(signalArg)\n    interaction.end(event)\n  } else {\n    interaction.stop()\n    interaction._reflowResolve()\n  }\n\n  interaction.removePointer(event, event)\n\n  return reflowPromise\n}\n\nconst reflow: Plugin = {\n  id: 'reflow',\n  install,\n  listeners: {\n    // remove completed reflow interactions\n    'interactions:stop': ({ interaction }, scope) => {\n      if (interaction.pointerType === 'reflow') {\n        if (interaction._reflowResolve) {\n          interaction._reflowResolve()\n        }\n\n        arr.remove(scope.interactions.list, interaction)\n      }\n    },\n  },\n}\n\nexport default reflow\n", "// eslint-disable-next-line import/no-extraneous-dependencies\nimport interact from '@interactjs/interactjs'\n\nexport default interact\n\nif (typeof module === 'object' && !!module) {\n  try {\n    module.exports = interact\n  } catch {}\n}\n\n;(interact as any).default = interact\n", "/* eslint-disable import/no-duplicates -- for typescript module augmentations */\nimport '@interactjs/actions/plugin'\nimport '@interactjs/auto-scroll/plugin'\nimport '@interactjs/auto-start/plugin'\nimport '@interactjs/core/interactablePreventDefault'\nimport '@interactjs/dev-tools/plugin'\nimport '@interactjs/inertia/plugin'\nimport '@interactjs/interact'\nimport '@interactjs/modifiers/plugin'\nimport '@interactjs/offset/plugin'\nimport '@interactjs/pointer-events/plugin'\nimport '@interactjs/reflow/plugin'\n\nimport actions from '@interactjs/actions/plugin'\nimport autoScroll from '@interactjs/auto-scroll/plugin'\nimport autoStart from '@interactjs/auto-start/plugin'\nimport interactablePreventDefault from '@interactjs/core/interactablePreventDefault'\nimport devTools from '@interactjs/dev-tools/plugin'\nimport inertia from '@interactjs/inertia/plugin'\nimport interact from '@interactjs/interact'\nimport modifiers from '@interactjs/modifiers/plugin'\nimport offset from '@interactjs/offset/plugin'\nimport pointerEvents from '@interactjs/pointer-events/plugin'\nimport reflow from '@interactjs/reflow/plugin'\n/* eslint-enable import/no-duplicates */\n\ninteract.use(interactablePreventDefault)\n\ninteract.use(offset)\n\n// pointerEvents\ninteract.use(pointerEvents)\n\n// inertia\ninteract.use(inertia)\n\n// snap, resize, etc.\ninteract.use(modifiers)\n\n// autoStart, hold\ninteract.use(autoStart)\n\n// drag and drop, resize, gesture\ninteract.use(actions)\n\n// autoScroll\ninteract.use(autoScroll)\n\n// reflow\ninteract.use(reflow)\n\n// eslint-disable-next-line no-undef\nif (process.env.NODE_ENV !== 'production') {\n  interact.use(devTools)\n}\n\nexport default interact\n;(interact as any).default = interact\n", "/*!\n * Drag & Drop Card (Proprietary)\n * Copyright (c) 2025 <SMARTI AS>\n * Use is governed by EULA.md. Third-party notices: THIRD_PARTY_NOTICES.md\n */\n\n\n// \u2014 bundle-time imports so we don't rely on CDNs in HACS installs \u2014\nimport interact from 'interactjs';\nimport jsyaml from 'js-yaml';\n\n// expose for your existing code that checks window.interact/jsyaml\nif (!window.interact) window.interact = interact;\nif (!window.jsyaml) window.jsyaml = jsyaml;\n\n// pretty console banner + version\nconst VERSION = __VERSION__;\nconsole.info(\n  `%c drag-and-drop-card %c v${VERSION} `,\n  'color:#fff;background:#03a9f4;font-weight:700;padding:2px 6px;border-radius:3px 0 0 3px',\n  'color:#03303a;background:#bdeaff;padding:2px 6px;border-radius:0 3px 3px 0'\n);\n\n// drag-and-drop-card.js\n/* eslint-disable no-console */\nconst LOG = (m, ...a) => console.debug(`[drag-and-drop-card] ${m}`, ...a);\nconsole.info('%c drag-and-drop-card loaded', 'color:#03a9f4;font-weight:700;');\n\nconst raf = () => new Promise((r) => requestAnimationFrame(() => r()));\nconst idle = () => new Promise((r) => (window.requestIdleCallback ? requestIdleCallback(() => r()) : setTimeout(r, 0)));\n\nclass DragAndDropCard extends HTMLElement {\n  _updateTabsA11y_() {\n  const bar = this.tabsBar; if (!bar) return;\n  bar.setAttribute('role', 'tablist');\n  const btns = bar.querySelectorAll('.ddc-tab');\n  btns.forEach((btn, idx) => {\n    const selected = btn.classList.contains('active');\n    btn.setAttribute('role', 'tab');\n    btn.setAttribute('aria-selected', String(selected));\n    btn.setAttribute('tabindex', selected ? '0' : '-1');\n    btn.dataset.index = String(idx);\n  });\n  if (!this.__tabsKeyHandler) {\n    this.__tabsKeyHandler = (e) => {\n      const valid = ['ArrowLeft','ArrowRight','Home','End'];\n      if (!valid.includes(e.key)) return;\n      const list = Array.from(bar.querySelectorAll('.ddc-tab'));\n      if (!list.length) return;\n      e.preventDefault();\n      const focusedIndex = list.findIndex(b => b === document.activeElement);\n      const activeIndex = list.findIndex(b => b.classList.contains('active'));\n      let idx = focusedIndex >= 0 ? focusedIndex : (activeIndex >= 0 ? activeIndex : 0);\n      if (e.key === 'ArrowRight') idx = Math.min(list.length - 1, idx + 1);\n      if (e.key === 'ArrowLeft')  idx = Math.max(0, idx - 1);\n      if (e.key === 'Home')       idx = 0;\n      if (e.key === 'End')        idx = list.length - 1;\n      const target = list[idx];\n      if (target) { try { target.focus({preventScroll:false}); } catch {}; target.click(); }\n    };\n    bar.addEventListener('keydown', this.__tabsKeyHandler);\n  }\n  if (!this.__tabsScrollHandler) {\n    this.__tabsScrollHandler = () => this._updateTabOverflowShadows_?.();\n    bar.addEventListener('scroll', this.__tabsScrollHandler, { passive: true });\n  }\n  this._updateTabOverflowShadows_?.();\n}\n\n\n// ---------------- Dashboard URL helpers ----------------\n_getCurrentDashboardUrlPath_() {\n  // e.g. \"/\", \"/lovelace/0\", \"/myboard/0\", \"/lovelace-myboard/0\"\n  const path = (window.location.pathname || \"/\").replace(/^\\/+/, \"\");\n  const first = path.split(\"/\")[0] || \"lovelace\";\n\n  // Primary dashboard uses \"/lovelace\"\n  if (first === \"lovelace\") return null;\n\n  // Additional dashboards: first segment is the url_path (works for \"/myboard\" and \"/lovelace-myboard\")\n  return first;\n}\n\n// ---------------- Storage-mode persistence (Visual Editor path) ----------------\n\n// Ensure this card has a persistent id in its config (stored in Lovelace)\nasync _ensureCardIdSeededInStorage_() {\n  if (this.config?.id) return this.config.id;\n\n  const id = (crypto?.randomUUID ? crypto.randomUUID() : (\"ddc_\" + Math.random().toString(36).slice(2)));\n  this.config = { ...this.config, id }; // in-memory immediately\n\n  try {\n    const url_path = this._getCurrentDashboardUrlPath_();\n    const ll = await this.hass.callWS(url_path ? { type: \"lovelace/config\", url_path } : { type: \"lovelace/config\" });\n\n    const hit = this._findThisCardPathRecursive_(ll, (c) =>\n      c?.type === \"custom:drag-and-drop-card\" && (!c.id || c.id === id)\n    );\n    if (!hit) return id;\n\n    const { viewIndex, cardIndex, parentPath } = hit;\n    const view = ll.views[viewIndex];\n    const curr = this._getCardByPath_(view, parentPath, cardIndex);\n    const updated = { ...curr, id };\n    this._setCardByPath_(view, parentPath, cardIndex, updated);\n\n    // SAVE with url_path when present\n    await this.hass.callWS(\n      url_path\n        ? { type: \"lovelace/config/save\", url_path, config: ll }\n        : { type: \"lovelace/config/save\", config: ll }\n    );\n  } catch (_) {\n    // YAML dashboards or permission issues: ignore; we still keep the in-memory id\n  }\n  return id;\n}\n\n// Persist this._config back into the stored card (Storage dashboards)\nasync _persistThisCardConfigToStorage_() {\n  await this._ensureCardIdSeededInStorage_();\n\n  // Build what we want to merge (like Visual Editor does at top-level)\n  const partial = {\n    type: \"custom:drag-and-drop-card\",\n    id: this.config?.id,\n    ...this._config,\n  };\n\n  const url_path = this._getCurrentDashboardUrlPath_();\n\n  // LOAD\n  const ll = await this.hass.callWS(url_path ? { type: \"lovelace/config\", url_path } : { type: \"lovelace/config\" });\n\n  // FIND our card by type + id (supports nesting)\n  const hit = this._findThisCardPathRecursive_(ll, (c) =>\n    c?.type === \"custom:drag-and-drop-card\" && c?.id === this.config?.id\n  );\n  if (!hit) throw new Error(\"Card not found in Lovelace config\");\n\n  const { viewIndex, cardIndex, parentPath } = hit;\n  const view = ll.views[viewIndex];\n\n  // MERGE + WRITE\n  const currentCard = this._getCardByPath_(view, parentPath, cardIndex);\n  const merged = { ...currentCard, ...partial };\n  this._setCardByPath_(view, parentPath, cardIndex, merged);\n\n  // SAVE (respect url_path)\n  await this.hass.callWS(\n    url_path\n      ? { type: \"lovelace/config/save\", url_path, config: ll }\n      : { type: \"lovelace/config/save\", config: ll }\n  );\n\n  // Apply locally\n  this.config = merged;\n  this.requestUpdate?.();\n}\n\n// ---- Tree helpers (unchanged) ----\n_findThisCardPathRecursive_(llConfig, predicate) {\n  const views = llConfig?.views || [];\n  for (let vi = 0; vi < views.length; vi++) {\n    const hit = this._findInCardTree_(views[vi], predicate);\n    if (hit) return { viewIndex: vi, ...hit };\n  }\n  return null;\n}\n\n_findInCardTree_(node, predicate, parentPath = []) {\n  const cards = node?.cards || [];\n  for (let ci = 0; ci < cards.length; ci++) {\n    const c = cards[ci];\n    if (predicate(c)) return { cardIndex: ci, parentPath };\n    if (c?.cards?.length) {\n      const sub = this._findInCardTree_(c, predicate, parentPath.concat(ci));\n      if (sub) return sub;\n    }\n  }\n  return null;\n}\n\n_getCardByPath_(view, parentPath, cardIndex) {\n  let container = view;\n  for (const idx of (parentPath || [])) container = container.cards[idx];\n  return container.cards[cardIndex];\n}\n\n_setCardByPath_(view, parentPath, cardIndex, value) {\n  let container = view;\n  for (const idx of (parentPath || [])) container = container.cards[idx];\n  container.cards[cardIndex] = value;\n}\n\n\n  /* -------------------- HA chrome (header/sidebar) visibility -------------------- */\n/* -------------------- HA chrome (header/sidebar) visibility -------------------- */\n_setHeaderVisible_(show = true) {\n  try {\n    // 1) Hide the header containers across HA variants\n    const headers = this._deepQueryAll?.(\n      'app-header, ha-top-app-bar, ha-top-app-bar-fixed, mwc-top-app-bar-fixed, ha-header-bar, app-toolbar, ha-toolbar'\n    ) || [];\n    headers.forEach(el => {\n      if (!el) return;\n      if (el.dataset.ddcPrevDisplayHeader === undefined) {\n        el.dataset.ddcPrevDisplayHeader = el.style.display || '';\n        el.dataset.ddcPrevMinH = el.style.minHeight || '';\n        el.dataset.ddcPrevH = el.style.height || '';\n        el.dataset.ddcPrevVis = el.style.visibility || '';\n      }\n      if (show) {\n        el.style.display = el.dataset.ddcPrevDisplayHeader || '';\n        el.style.minHeight = el.dataset.ddcPrevMinH || '';\n        el.style.height = el.dataset.ddcPrevH || '';\n        el.style.visibility = el.dataset.ddcPrevVis || '';\n        el.removeAttribute('hidden');\n      } else {\n        el.style.display = 'none';\n        el.style.minHeight = '0';\n        el.style.height = '0';\n        el.style.visibility = 'hidden';\n        el.setAttribute('hidden', '');\n      }\n    });\n\n    // 2) Explicitly hide the action items (Search / Assist / Edit menu)\n    //    Belt & suspenders: catch both slot-based and direct buttons/menus.\n    const actionNodes = this._deepQueryAll?.(\n      '[slot=\"actionItems\"], ha-icon-button, ha-button-menu, assist-button, search-input, ha-quick-bar, ha-mwc-menu'\n    ) || [];\n    actionNodes.forEach(el => {\n      if (!el) return;\n      if (el.dataset.ddcPrevDisplayAction === undefined) {\n        el.dataset.ddcPrevDisplayAction = el.style.display || '';\n        el.dataset.ddcPrevVisAction = el.style.visibility || '';\n      }\n      if (show) {\n        el.style.display = el.dataset.ddcPrevDisplayAction || '';\n        el.style.visibility = el.dataset.ddcPrevVisAction || '';\n      } else {\n        el.style.display = 'none';\n        el.style.visibility = 'hidden';\n      }\n    });\n\n    // 3) Adjust CSS variables so layout doesn't reserve header space\n    //    Include an extra var some themes use, and collapse content padding.\n    const containers = [\n      // common layout hosts that own the header height vars/padding\n      ...(this._deepQueryAll?.('ha-app-layout') || []),\n      ...(this._deepQueryAll?.('home-assistant-main') || []),\n      document.documentElement,\n      document.body\n    ].filter(Boolean);\n\n    containers.forEach(host => {\n      if (!host) return;\n      if (host.dataset.ddcPrevHdrVars === undefined) {\n        host.dataset.ddcPrevHdrVars = JSON.stringify({\n          mdc: host.style.getPropertyValue('--mdc-top-app-bar-height') || '',\n          app: host.style.getPropertyValue('--app-header-height') || '',\n          hdr: host.style.getPropertyValue('--header-height') || '',\n          hah: host.style.getPropertyValue('--ha-header-height') || '',\n          pad: (host.style && (host.style.paddingTop || '')) || ''\n        });\n      }\n      if (show) {\n        try {\n          const prev = JSON.parse(host.dataset.ddcPrevHdrVars || '{}');\n          host.style.setProperty('--mdc-top-app-bar-height', prev.mdc || '');\n          host.style.setProperty('--app-header-height', prev.app || '');\n          host.style.setProperty('--header-height', prev.hdr || '');\n          host.style.setProperty('--ha-header-height', prev.hah || '');\n          if (prev.pad !== undefined) host.style.paddingTop = prev.pad || '';\n        } catch {}\n      } else {\n        host.style.setProperty('--mdc-top-app-bar-height', '0px');\n        host.style.setProperty('--app-header-height', '0px');\n        host.style.setProperty('--header-height', '0px');\n        host.style.setProperty('--ha-header-height', '0px');\n        // collapse any padding that might be applied because of header height\n        try { host.style.paddingTop = '0px'; } catch {}\n      }\n    });\n\n    // 4) Some builds keep content under a #contentContainer; collapse its padding too\n    const contentContainers = this._deepQueryAll?.('#contentContainer') || [];\n    contentContainers.forEach(cc => {\n      if (!cc) return;\n      if (cc.dataset.ddcPrevContentPadTop === undefined) {\n        cc.dataset.ddcPrevContentPadTop = (cc.style && (cc.style.paddingTop || '')) || '';\n      }\n      cc.style.paddingTop = show ? (cc.dataset.ddcPrevContentPadTop || '') : '0px';\n    });\n\n  } catch {}\n}\n\n_setSidebarVisible_(show=true) {\n  try {\n    const sidebars = this._deepQueryAll?.('ha-sidebar') || [];\n    sidebars.forEach(el => {\n      if (!el) return;\n      if (el.dataset.ddcPrevDisplaySidebar === undefined) {\n        el.dataset.ddcPrevDisplaySidebar = el.style.display || '';\n      }\n      el.style.display = show ? el.dataset.ddcPrevDisplaySidebar || '' : 'none';\n    });\n    const drawers = this._deepQueryAll?.('ha-drawer') || [];\n    drawers.forEach(el => {\n      if (!el) return;\n      if (el.dataset.ddcPrevDrawerWidth === undefined) {\n        el.dataset.ddcPrevDrawerWidth = el.style.getPropertyValue('--mdc-drawer-width') || '';\n      }\n      if (show) {\n        el.style.setProperty('--mdc-drawer-width', el.dataset.ddcPrevDrawerWidth || '');\n      } else {\n        el.style.setProperty('--mdc-drawer-width', '0px');\n      }\n      try { if (!show && typeof el.close === 'function') el.close(); } catch {}\n    });\n  } catch {}\n}\n\n_applyHaChromeVisibility_() {\n  try {\n    const showAll = !!this.editMode || this._isInHaEditorPreview?.();\n    // header\n    if (showAll || !this.hideHaHeader) this._setHeaderVisible_(true);\n    else this._setHeaderVisible_(false);\n    // sidebar\n    if (showAll || !this.hideHaSidebar) this._setSidebarVisible_(true);\n    else this._setSidebarVisible_(false);\n\n  } catch {}\n}\n\n\n\n\n_applyBackgroundImageFromConfig() {\n  const cfg = this._config || {};\n  const bg = cfg.background_image || cfg.bg_image || null;\n  const cont = this.cardContainer;\n  if (!cont) return;\n\n  if (bg && bg.src) {\n    const url = String(bg.src).trim();\n    const repeat = (bg.repeat === true || bg.repeat === 'repeat') ? 'repeat' : 'no-repeat';\n    const opacity = Math.max(0, Math.min(1, Number(bg.opacity ?? 1)));\n    const size = bg.size || 'cover';\n    const position = bg.position || 'center center';\n    const attachment = bg.attachment || 'scroll';\n    const filter = bg.filter || 'none';\n\n    cont.style.setProperty('--ddc-bg-image', url ? `url(\"${url.replace(/\"/g, '\\\"')}\")` : 'none');\n    cont.style.setProperty('--ddc-bg-repeat', repeat);\n    cont.style.setProperty('--ddc-bg-opacity', String(opacity));\n    cont.style.setProperty('--ddc-bg-size', size);\n    cont.style.setProperty('--ddc-bg-position', position);\n    cont.style.setProperty('--ddc-bg-attachment', attachment);\n    cont.style.setProperty('--ddc-bg-filter', filter);\n    cont.classList.add('has-bg-image');\n  } else {\n    cont.style.removeProperty('--ddc-bg-image');\n    cont.style.removeProperty('--ddc-bg-repeat');\n    cont.style.removeProperty('--ddc-bg-opacity');\n    cont.style.removeProperty('--ddc-bg-size');\n    cont.style.removeProperty('--ddc-bg-position');\n    cont.style.removeProperty('--ddc-bg-attachment');\n    cont.style.removeProperty('--ddc-bg-filter');\n    cont.classList.remove('has-bg-image');\n  }\n}\n\n/**\n * Evaluate an array of visibility conditions against the current hass state.\n * Returns true if the card should be shown. Conditions follow the same\n * structure as Home Assistant\u2019s per\u2011card visibility settings. Only a subset\n * of condition types are supported: state, numeric_state, screen and user.\n * Unknown condition types are treated as passing.\n *\n * @param {Array} visList Array of condition objects\n * @returns {boolean} true if all conditions evaluate to true, otherwise false\n */\n_evaluateVisibility_(visList) {\n  try {\n    const hass = this.hass || this._hass;\n    // If no conditions defined, always visible\n    if (!Array.isArray(visList) || visList.length === 0) return true;\n    /**\n     * Recursively evaluate a single condition or a group of conditions.  The\n     * visibility editor supports nested groups (and/or) as well as leaf\n     * conditions such as state, numeric_state, screen and user.  Unknown\n     * condition types default to passing.\n     *\n     * @param {Object} cond A visibility condition or group\n     * @returns {boolean} true if the condition/group passes\n     */\n    const evalCond = (cond) => {\n      if (!cond || typeof cond !== 'object') return true;\n      const type = cond.condition || cond.type || 'state';\n      // Group: AND / OR\n      if (type === 'and' || type === 'or') {\n        const children = Array.isArray(cond.conditions) ? cond.conditions : [];\n        // Empty group passes by default\n        if (children.length === 0) return true;\n        if (type === 'and') {\n          return children.every((child) => evalCond(child));\n        }\n        // type === 'or'\n        return children.some((child) => evalCond(child));\n      }\n      if (type === 'state') {\n        const entity = cond.entity;\n        if (!entity) return true;\n        const stateObj = hass?.states?.[entity];\n        if (!stateObj) return false;\n        const st = String(stateObj.state ?? '');\n        if (cond.state !== undefined) {\n          const target = Array.isArray(cond.state) ? cond.state : [cond.state];\n          return target.some((v) => String(v) === st);\n        }\n        if (cond.state_not !== undefined) {\n          const target = Array.isArray(cond.state_not) ? cond.state_not : [cond.state_not];\n          return !target.some((v) => String(v) === st);\n        }\n        // No state specified -> pass\n        return true;\n      }\n      if (type === 'numeric_state') {\n        const entity = cond.entity;\n        if (!entity) return true;\n        const stateObj = hass?.states?.[entity];\n        if (!stateObj) return false;\n        const val = parseFloat(stateObj.state);\n        if (isNaN(val)) return false;\n        if (cond.above !== undefined && !(val > Number(cond.above))) return false;\n        if (cond.below !== undefined && !(val < Number(cond.below))) return false;\n        return true;\n      }\n      if (type === 'screen') {\n        const mq = cond.media_query || cond.query;\n        if (!mq || typeof mq !== 'string') return true;\n        try { return window.matchMedia(mq).matches; } catch { return true; }\n      }\n      if (type === 'user') {\n        const users = Array.isArray(cond.users) ? cond.users : (cond.user ? [cond.user] : []);\n        if (!users.length) return true;\n        // In Home Assistant, hass.user?.id contains the current user ID\n        const uid = hass?.user?.id || hass?.user?.id || null;\n        if (!uid) return true;\n        return users.includes(uid);\n      }\n      // Unknown types pass\n      return true;\n    };\n    // Top-level list uses implicit AND semantics (all must pass)\n    return visList.every((c) => evalCond(c));\n  } catch (e) {\n    console.warn('[ddc:visibility] evaluate error', e);\n    return true;\n  }\n}\n\n/**\n * Apply visibility conditions to all card wrappers. When not in edit mode,\n * wrappers with conditions that evaluate to false are hidden by setting\n * display: none; otherwise they are shown. Cards are always visible in\n * edit mode. Call this after setting hass or updating card configs.\n */\n_applyVisibility_() {\n  try {\n    const wraps = this.cardContainer?.children || [];\n    // Determine the currently active tab; normalize to an integer\n    const currentTabId = this._normalizeTabId(this.activeTab);\n    for (const wrap of wraps) {\n      if (!wrap || !wrap.firstElementChild) continue;\n      // Only apply visibility rules to wrappers belonging to the active tab.\n      // Leave wrappers on other tabs untouched so that _applyActiveTab can\n      // control their display property.\n      const tabId = this._normalizeTabId(wrap.dataset.tabId);\n      if (tabId !== currentTabId) {\n        continue;\n      }\n      const cfg = this._extractCardConfig(wrap.firstElementChild) || {};\n      const visList = cfg.visibility;\n      const shouldShow = this.editMode ? true : this._evaluateVisibility_(visList);\n      wrap.style.display = shouldShow ? '' : 'none';\n    }\n  } catch (e) {\n    console.warn('[ddc:visibility] apply error', e);\n  }\n}\n\n\n  async _onKeyDown_(e) {\n  if (!this.editMode) return;\n  if (this._isTypingTarget_(e.target)) return;\n\n  const gs = Number(this.gridSize || 10);\n  const step = e.altKey ? 1 : (e.shiftKey ? gs * 5 : gs);\n\n  let dx = 0, dy = 0;\n  switch (e.key) {\n    case 'ArrowLeft':  dx = -step; break;\n    case 'ArrowRight': dx =  step; break;\n    case 'ArrowUp':    dy = -step; break;\n    case 'ArrowDown':  dy =  step; break;\n  }\n  if (dx || dy) {\n    e.preventDefault();\n    this._moveSelectionBy_(dx, dy, { liveSnap: !e.altKey });\n    return;\n  }\n\n  if (e.key === 'Delete' || e.key === 'Backspace') {\n    const sel = this._selection && this._selection.size ? Array.from(this._selection) : [];\n    if (!sel.length) return;\n    e.preventDefault();\n    sel.forEach(el => el.remove());\n    this._clearSelection?.();\n    this._resizeContainer?.();\n    this._queueSave?.('delete-key');\n    this._ensurePlaceholderIfEmpty?.();\n    return;\n  }\n\n  if ((e.ctrlKey || e.metaKey) && (e.key === 'd' || e.key === 'D')) {\n    e.preventDefault();\n    await this._duplicateSelection_();\n    return;\n  }\n\n  if ((e.ctrlKey || e.metaKey) && e.key === ']') {\n    e.preventDefault();\n    (this._selection && this._selection.forEach?.(w => this._adjustZ?.(w, +1)));\n    this._queueSave?.('z-up');\n    return;\n  }\n  if ((e.ctrlKey || e.metaKey) && e.key === '[') {\n    e.preventDefault();\n    (this._selection && this._selection.forEach?.(w => this._adjustZ?.(w, -1)));\n    this._queueSave?.('z-down');\n    return;\n  }\n}\n\n\n  async _duplicateSelection_() {\n  if (!this._selection || !this._selection.size) return;\n  const sel = Array.from(this._selection);\n  for (const t of sel) {\n    try {\n      const cfg = this._extractCardConfig?.(t.firstElementChild) || {};\n      const dup = await this._createCard?.(cfg);\n      const w2  = this._makeWrapper?.(dup);\n      if (!dup || !w2) continue;\n\n      w2.style.width  = t.style.width;\n      w2.style.height = t.style.height;\n\n      const step = Number(this.gridSize || 10);\n      const x = (parseFloat(t.getAttribute('data-x')) || 0) + step;\n      const y = (parseFloat(t.getAttribute('data-y')) || 0) + step;\n\n      this._setCardPosition?.(w2, x, y);\n      w2.style.zIndex = String((this._highestZ?.() || 0) + 1);\n        // Preserve the tab assignment from the original wrapper. Without this,\n        // duplicates incorrectly end up in the currently active tab instead of\n        // inheriting the source tab. See: https://github.com/owner/repo/issues/XYZ\n        try {\n          const tid = t.dataset?.tabId;\n          if (tid) w2.dataset.tabId = tid;\n        } catch {}\n\n      this.cardContainer?.appendChild(w2);\n        // When duplicating we need to wire up a tab selector for the new\n        // wrapper so that the user can reassign it later. Passing the\n        // inherited tab ensures the selector defaults correctly.\n        try { this._addTabSelectorToChip?.(w2, w2.dataset.tabId); } catch {}\n      try { this._rebuildOnce?.(w2.firstElementChild); } catch {}\n      try { this._initCardInteract?.(w2); } catch {}\n    } catch {}\n  }\n  try { this._resizeContainer?.(); } catch {}\n  try { this._queueSave?.('duplicate'); } catch {}\n}\n\n\n  _moveSelectionBy_(dx, dy, { liveSnap = true } = {}) {\n  if (!this._selection || !this._selection.size) return;\n  const sel = Array.from(this._selection);\n\n  const gs = Number(this.gridSize || 10);\n  const fixed = this._isContainerFixed?.();\n  const box = this._getContainerSize?.() || { w: Infinity, h: Infinity };\n\n  const proposed = sel.map(el => {\n    const rawX = parseFloat(el.getAttribute('data-x-raw')) || parseFloat(el.getAttribute('data-x')) || 0;\n    const rawY = parseFloat(el.getAttribute('data-y-raw')) || parseFloat(el.getAttribute('data-y')) || 0;\n    const w = parseFloat(el.style.width)  || el.getBoundingClientRect().width;\n    const h = parseFloat(el.style.height) || el.getBoundingClientRect().height;\n\n    let nx = rawX + dx;\n    let ny = rawY + dy;\n\n    if (fixed) {\n      nx = Math.max(0, Math.min(nx, Math.max(0, box.w - w)));\n      ny = Math.max(0, Math.min(ny, Math.max(0, box.h - h)));\n    }\n\n    const sx = liveSnap ? Math.round(nx / gs) * gs : nx;\n    const sy = liveSnap ? Math.round(ny / gs) * gs : ny;\n\n    return { el, rawX: nx, rawY: ny, snapX: sx, snapY: sy, w, h };\n  });\n\n  if (this.disableOverlap && typeof this._pushCardsOutOfTheWay === 'function') {\n    try { this._pushCardsOutOfTheWay(proposed, dx, dy, liveSnap, gs); } catch {}\n  }\n\n  for (const p of proposed) {\n    p.el.setAttribute('data-x-raw', String(p.rawX));\n    p.el.setAttribute('data-y-raw', String(p.rawY));\n    try { this._setCardPosition?.(p.el, p.snapX, p.snapY); } catch {}\n  }\n  try { this._resizeContainer?.(); } catch {}\n  try { this._queueSave?.('nudge'); } catch {}\n}\n\n  /**\n   * Synchronise the width of the tabs bar with the visible width of the card\n   * container. When the auto-scaling logic shrinks the canvas, the tabs\n   * should shrink too rather than spanning the entire host width. This\n   * helper queries the scale wrapper (if present) or falls back to the\n   * container itself to derive the actual visual width and applies it\n   * directly to the tabs bar. For vertical (left) tabs we reset any\n   * widths to allow the rail to size naturally.\n   */\n  _syncTabsWidth_() {\n    try {\n      const bar = this.tabsBar;\n      if (!bar) return;\n      // For left-side tabs the width should not be clamped; reset and bail.\n      if (this.tabsPosition === 'left') {\n        bar.style.width = '';\n        bar.style.maxWidth = '';\n        return;\n      }\n      // Determine the element representing the visible card canvas. We use\n      // the bounding box of the card container itself rather than the\n      // outer scaling wrapper. The container has the transform applied to\n      // it, so getBoundingClientRect() returns the actual visible width.\n      const ref = this.cardContainer || this.__scaleOuter;\n      if (!ref) return;\n      let width = 0;\n      try {\n        const rect = ref.getBoundingClientRect();\n        width = rect && rect.width ? rect.width : 0;\n      } catch {}\n      // Fallback: if the container hasn't been laid out yet, try the scale\n      // wrapper. This can happen very early in the lifecycle.\n      if (width <= 0 && this.__scaleOuter && this.__scaleOuter !== ref) {\n        try {\n          const rect2 = this.__scaleOuter.getBoundingClientRect();\n          width = rect2 && rect2.width ? rect2.width : 0;\n        } catch {}\n      }\n      if (width > 0) {\n        bar.style.width = `${width}px`;\n        bar.style.maxWidth = `${width}px`;\n      }\n    } catch {}\n  }\n\n\n  _isTypingTarget_(t) {\n  if (!t || t === window || t === document) return false;\n  const editable = t.closest?.('input, textarea, [contenteditable=\"true\"], ha-textfield, mwc-textfield');\n  if (!editable) return false;\n  const tag = editable.tagName?.toLowerCase?.() || '';\n  return tag === 'input' || tag === 'textarea' || editable.hasAttribute?.('contenteditable');\n}\n\n\n  // --- Live reflow + scale while dragging (dynamic mode) ---\n  _scheduleReflowAndScale() {\n    if (this.__reflowRAF) return;\n    this.__reflowRAF = requestAnimationFrame(() => {\n      this.__reflowRAF = null;\n      try {\n        const mode = (this.containerSizeMode || this.container_size_mode || 'dynamic').toLowerCase();\n        if (mode === 'dynamic') {\n          this._resizeContainer?.(); // recompute content extents so d.h grows live\n        }\n      } catch {}\n      try { this._applyAutoScale?.(); } catch {}\n    });\n  }\n\n  __ddcBindPointerListeners() {\n    if (this.__ddcPtrBound) return;\n    this.__ddcPtrBound = true;\n    // Use bound methods to allow removeEventListener later if needed\n    this.__onDDCPointerDown = (ev) => {\n      try {\n        // Only react to primary button/touch\n        if (ev.button !== undefined && ev.button !== 0) return;\n        const path = ev.composedPath?.() || [];\n        let hit = null;\n        for (const n of path) {\n          if (n && n.classList && n.classList.contains('card-wrapper')) { hit = n; break; }\n        }\n        if (!hit) return;\n        this.__ddcDragging = true;\n        if (this.__scaleOuter) {\n          this.__prevOverflow = this.__scaleOuter.style.overflow;\n          this.__scaleOuter.style.overflow = 'visible'; // avoid \"ceiling\" clipping\n        }\n        this._scheduleReflowAndScale?.();\n      } catch {}\n    };\n    this.__onDDCPointerMove = (ev) => {\n      try {\n        if (!this.__ddcDragging) return;\n        this._scheduleReflowAndScale?.();\n      } catch {}\n    };\n    this.__onDDCPointerUp = (ev) => {\n      try {\n        if (!this.__ddcDragging) return;\n        this.__ddcDragging = false;\n        if (this.__scaleOuter) this.__scaleOuter.style.overflow = this.__prevOverflow || '';\n        // Final settle\n        try { this._applyAutoScale?.(); } catch {}\n      } catch {}\n    };\n    // Attach listeners\n    try { this.addEventListener('pointerdown', this.__onDDCPointerDown, { passive: true }); } catch {}\n    try { this.addEventListener('pointermove', this.__onDDCPointerMove, { passive: true }); } catch {}\n    try { window.addEventListener('pointerup', this.__onDDCPointerUp, { passive: true }); } catch {}\n    try { window.addEventListener('pointercancel', this.__onDDCPointerUp, { passive: true }); } catch {}\n  }\n\n\n_ensureScaleWrapper() {\n  const c = this.cardContainer;\n  if (!c) return;\n  if (this.__scaleOuter && this.__scaleOuter.contains(c)) return;\n\n  // Create a layout box that will reflect the *visual* size\n  const outer = document.createElement('div');\n  outer.className = 'ddc-scale-outer';\n  Object.assign(outer.style, {\n    position: 'relative',\n    width: '100%',\n    overflow: 'hidden'\n  });\n\n  // Insert wrapper around the current container\n  if (c.parentNode) {\n    c.parentNode.insertBefore(outer, c);\n    outer.appendChild(c);\n  }\n\n  // Make the inner container absolutely positioned and transformable\n  Object.assign(c.style, {\n    position: 'absolute',\n    top: '0',\n    left: '0',\n    transformOrigin: 'top left'\n  });\n\n  this.__scaleOuter = outer;\n}\n\n\n  __booting = false;  \n\n  constructor() {\n    super();\n    if (!this.shadowRoot) this.attachShadow({ mode: 'open' });\n    this.__rebuiltCards = new WeakSet();\n  }\n\n  \n  // --- DDC patch: deep card_mod detection + one-time rebuild helper ---\n  _hasCardModDeep(cfg) {\n    try {\n      if (!cfg || typeof cfg !== 'object') return false;\n      if (cfg.card_mod || cfg.type === 'custom:mod-card') return true;\n      if (cfg.card) return this._hasCardModDeep(cfg.card);\n      if (Array.isArray(cfg.cards)) {\n        for (const c of cfg.cards) { if (this._hasCardModDeep(c)) return true; }\n      }\n      return false;\n    } catch { return false; }\n  }\n  _rebuildOnce(el) {\n    try {\n      if (!el) return;\n      if (!this.__rebuiltCards) this.__rebuiltCards = new WeakSet();\n      if (this.__rebuiltCards.has(el)) return;\n      this.__rebuiltCards.add(el);\n      // Fire rebuild from the child card so Lovelace/card-mod re-attaches without recreating DDC itself\n      el.dispatchEvent(new Event('ll-rebuild', { bubbles: true, composed: true }));\n    } catch {}\n  }\n\n\n  // Deep query across shadow roots\n  _deepQueryAll(selector, root = document) {\n    const results = [];\n    const visit = (node) => {\n      if (!node) return;\n      if (node.querySelectorAll) {\n        try {\n          node.querySelectorAll(selector).forEach(el => results.push(el));\n        } catch {}\n      }\n      // Recurse into shadow roots\n      const treeWalker = document.createTreeWalker(node, NodeFilter.SHOW_ELEMENT, null);\n      let el = node;\n      while (el) {\n        const sr = el.shadowRoot;\n        if (sr) visit(sr);\n        el = treeWalker.nextNode();\n      }\n    };\n    visit(root);\n    return results;\n  }\n\n\n  // Keep visible editors (HA sidebar or in-card modal) in sync with current storage_key\n  _syncEditorsStorageKey() {\n    try {\n      const val = this.storageKey || '';\n      // Update any open editor input fields for this card\n      // We look for our known editor markup within the DOM and set the storage key input.\n      const nodes = this._deepQueryAll('#storage_key');\n      nodes.forEach((inp) => {\n        try {\n          if (inp && inp.tagName === 'INPUT') {\n            if (inp.value !== val) {\n              inp.value = val;\n              // Fire input event so editor UIs update their internal state\n              inp.dispatchEvent(new Event('input', { bubbles: true }));\n              inp.dispatchEvent(new Event('change', { bubbles: true }));\n            }\n          }\n        } catch {}\n      });\n    } catch {}\n  }\n\n  // Inside class DragAndDropCard extends ...\n  static _genKey() {\n    const id =\n      globalThis.crypto?.randomUUID?.() ||\n      `${Date.now().toString(36)}_${Math.random().toString(36).slice(2, 8)}`;\n    return `layout_${id}`;\n  }\n\n  static getStubConfig(/* hass, entities, entitiesFallback */) {\n    return {\n      type: 'custom:drag-and-drop-card',\n      // \u2190 generated immediately when the card is added\n      storage_key: this._genKey(),\n\n      // (optional) sensible defaults you already use:\n      grid: 10,\n      drag_live_snap: false,\n      auto_save: true,\n      auto_save_debounce: 800,\n      container_size_mode: 'dynamic',\n\n\n      // your baked-in hero image, if you want it visible by default\n      hero_image:\n        \"https://i.postimg.cc/CxsWQgwp/Chat-GPT-Image-Sep-5-2025-09-26-16-AM.png\",\n    };\n  }\n\n  /* ------------------------- Mini config editor (HA) ------------------------- */\n// Replace your existing static getConfigElement() with the version below.\n// It uses HA-native inputs (ha-textfield, ha-select, ha-formfield + ha-checkbox)\n// for consistent styling, clearer alignment, helper text, and a subtle animation\n// for the Apply button when there are unapplied changes.\n\nstatic getConfigElement() {\n  const el = document.createElement('div');\n  el.innerHTML = `\n    <style>\n      :host, .ddc-editor { font-family: var(--paper-font-body1_-_font-family, Roboto, system-ui, sans-serif); color: var(--primary-text-color); }\n\n      .ddc-editor { display: grid; grid-template-columns: 220px 1fr; gap: 10px 16px; align-items: center; box-sizing: border-box; padding: 8px 4px; }\n      .section { grid-column: 1 / -1; margin: 10px 0 2px; font-weight: 600; opacity: 0.9; }\n      .row-spacer { grid-column: 1 / -1; height: 2px; background: var(--divider-color); opacity: .2; border-radius: 2px; }\n\n      .label { align-self: flex-start; padding-top: 6px; font-weight: 600; opacity: .9; }\n      .helper { grid-column: 2 / 3; font-size: .85rem; opacity: .7; margin-top: -6px; }\n\n      .inline { display: inline-flex; align-items: center; gap: 8px; }\n      .two-col { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 8px; }\n\n      .actions { grid-column: 1 / -1; display: flex; gap: 8px; justify-content: flex-end; margin-top: 8px; }\n      .actions ha-button[disabled] { opacity: .6; }\n\n      /* Subtle pulse for enabled Apply button */\n      @keyframes ddcPulse {\n        0%, 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(0,0,0,0); }\n        50% { transform: scale(1.035); box-shadow: 0 0 12px 2px rgba(255,255,255,.22); }\n      }\n      #applyBtn:not([disabled]) { animation: ddcPulse 1.8s ease-in-out infinite; }\n\n      /* Make HA inputs fill width nicely */\n      ha-textfield, ha-select { width: 100%; }\n\n      /* Checkbox rows: keep left column reserved so alignment stays consistent */\n      .left-empty { visibility: hidden; }\n\n</style>\n\n     <div class=\"ddc-editor\">\n      <div class=\"section\">Layout & Behavior</div>\n\n      <div class=\"label\">Storage key</div>\n      <ha-textfield id=\"storage_key\" label=\"Storage key\" placeholder=\"my_unique_layout_key\"></ha-textfield>\n      <div class=\"helper\">Unique key for saving layout positions. Auto-generated if empty.</div>\n\n      <div class=\"label\">Grid size</div>\n      <ha-textfield id=\"grid\" label=\"Grid (px)\" type=\"number\" min=\"4\" max=\"32\" step=\"1\" value=\"10\"></ha-textfield>\n      <div class=\"helper\">Pixel size of each grid cell. Affects snap and default card size.</div>\n\n      <div class=\"label\">Snap while dragging</div>\n      <ha-formfield label=\"Snap to grid during drag (live)\">\n        <ha-checkbox id=\"liveSnap\"></ha-checkbox>\n      </ha-formfield>\n      <div class=\"helper\">If on, elements snap to grid while dragging. If off, snap occurs on drop.</div>\n\n      <div class=\"label\">Auto-save</div>\n      <div class=\"two-col\">\n        <ha-formfield label=\"Auto-save changes\">\n          <ha-checkbox id=\"autoSave\"></ha-checkbox>\n        </ha-formfield>\n        <ha-textfield id=\"autoSaveDebounce\" label=\"Debounce (ms)\" type=\"number\" min=\"0\" step=\"50\" value=\"800\"></ha-textfield>\n      </div>\n      <div class=\"helper\">When enabled, layout changes are saved automatically after a short delay.</div>\n\n      <div class=\"row-spacer\"></div>\n      <div class=\"section\">Appearance</div>\n\n      <div class=\"label\">Container background</div>\n      <ha-textfield id=\"containerBg\" label=\"CSS color/gradient\" placeholder=\"transparent, #232f3e, linear-gradient(...)\" helper=\"\"></ha-textfield>\n      <div class=\"helper\">Examples: <code>transparent</code>, <code>#232f3e</code>, <code>linear-gradient(...)</code>.</div>\n\n      <div class=\"label\">Card background</div>\n      <ha-textfield id=\"cardBg\" label=\"CSS color/gradient\" placeholder=\"var(--ha-card-background) or #ffffffcc\"></ha-textfield>\n      <div class=\"helper\">Background for each card in the layout; can use theme vars.</div>\n\n      <div class=\"label\">Debug logs</div>\n      <ha-formfield label=\"Enable console debug\">\n        <ha-checkbox id=\"debug\"></ha-checkbox>\n      </ha-formfield>\n\n      <div class=\"label\">Disable overlap</div>\n      <ha-formfield label=\"Prevent cards from overlapping\">\n        <ha-checkbox id=\"noOverlap\"></ha-checkbox>\n      </ha-formfield>\n\n      <div class=\"label\">Auto-resize cards</div>\n      <ha-formfield label=\"Scale layout to fit parent (view mode)\">\n        <ha-checkbox id=\"autoResize\"></ha-checkbox>\n      </ha-formfield>\n\n      <div class=\"label\">Animate cards</div>\n      <ha-formfield label=\"Animate cards on tab switch\">\n        <ha-checkbox id=\"animateCards\"></ha-checkbox>\n      </ha-formfield>\n      <div class=\"helper\">If enabled, cards will fly in when switching tabs or on refresh.</div>\n\n\n      <div class=\"row-spacer\"></div>\n      <div class=\"section\">Container Size</div>\n\n      <div class=\"label\">Mode</div>\n      <ha-select id=\"sizeMode\" label=\"Container size mode\">\n        <mwc-list-item value=\"dynamic\">Dynamic (auto)</mwc-list-item>\n        <mwc-list-item value=\"fixed_custom\">Fixed (custom)</mwc-list-item>\n        <mwc-list-item value=\"preset\">Preset</mwc-list-item>\n      </ha-select>\n\n      <div class=\"label\">Fixed size</div>\n      <div class=\"inline\" id=\"sizeCustom\" style=\"display:none\">\n        <ha-textfield id=\"sizeW\" type=\"number\" label=\"W\" min=\"100\" step=\"10\"></ha-textfield>\n        <ha-textfield id=\"sizeH\" type=\"number\" label=\"H\" min=\"100\" step=\"10\"></ha-textfield>\n      </div>\n\n      <div class=\"label\">Preset</div>\n      <div class=\"inline\" id=\"sizePresetWrap\" style=\"display:none\">\n        <ha-select id=\"sizePreset\" label=\"Preset\"></ha-select>\n        <ha-select id=\"sizeOrientation\" label=\"Orientation\">\n          <mwc-list-item value=\"auto\">Auto</mwc-list-item>\n          <mwc-list-item value=\"landscape\">Landscape</mwc-list-item>\n          <mwc-list-item value=\"portrait\">Portrait</mwc-list-item>\n        </ha-select>\n      </div>\n\n      <div class=\"actions\">\n        <ha-button id=\"revertBtn\">Revert</ha-button>\n        <ha-button id=\"applyBtn\" raised disabled>Apply</ha-button>\n      </div>\n    </div>\n  `;\n\n  // ---- Utility helpers ----\n  const updateButtons = () => {\n    const dirty = isDirty();\n    applyBtn.disabled = !dirty;\n  };\n\n  const fire = () => {\n    const newConfig = el.getConfig();\n    el.dispatchEvent(new CustomEvent('config-changed', { detail: { config: newConfig } }));\n    // Re-check button states after applying\n    updateButtons();\n  };\n\n  const toggleSizeControls = () => {\n    const mode = el.querySelector('#sizeMode').value;\n    el.querySelector('#sizeCustom').style.display = mode === 'fixed_custom' ? 'inline-flex' : 'none';\n    el.querySelector('#sizePresetWrap').style.display = mode === 'preset' ? 'inline-flex' : 'none';\n  };\n\n  // Keep reference to controls\n  const applyBtn  = el.querySelector('#applyBtn');\n  const revertBtn = el.querySelector('#revertBtn');\n\n  // Make menus stable in HA dialog without blocking clicks\n  ['#sizeMode','#sizePreset','#sizeOrientation'].forEach((sel) => {\n    const s = el.querySelector(sel);\n    if (!s) return;\n    try { s.fixedMenuPosition = true; } catch {}\n    s.addEventListener('closed', (e) => e.stopPropagation());\n  });\n\n  // --- Public API: set incoming values (preserve unknown keys)\n  el.setConfig = (config = {}) => {\n    el._config = { type: config.type || 'custom:drag-and-drop-card', ...config };\n\n    // Auto-generate storage key once if not present\n    if (!el._config.storage_key) {\n      el._config.storage_key = `layout_${(crypto?.randomUUID?.() || Date.now().toString(36))}`;\n      el.__autokeyPending = true;\n    }\n\n    // Populate inputs\n    el.querySelector('#storage_key').value = el._config.storage_key || '';\n    el.querySelector('#grid').value = el._config.grid ?? 10;\n    el.querySelector('#liveSnap').checked = !!el._config.drag_live_snap;\n    el.querySelector('#autoSave').checked = el._config.auto_save !== false;\n    el.querySelector('#autoSaveDebounce').value = el._config.auto_save_debounce ?? 800;\n    el.querySelector('#containerBg').value = el._config.container_background ?? 'transparent';\n    el.querySelector('#cardBg').value = el._config.card_background ?? 'var(--ha-card-background, var(--card-background-color))';\n    el.querySelector('#debug').checked = !!el._config.debug;\n    el.querySelector('#noOverlap').checked = !!el._config.disable_overlap;\n    el.querySelector('#autoResize').checked = !!el._config.auto_resize_cards;\n\n    // Set the animate cards checkbox based on the incoming config. This\n    // defaults to false when not specified. When true, cards will animate\n    // into view on tab changes or refresh.\n    el.querySelector('#animateCards').checked = !!el._config.animate_cards;\n\n\n    el.querySelector('#sizeMode').value = el._config.container_size_mode || 'dynamic';\n    el.querySelector('#sizeW').value = el._config.container_fixed_width ?? '';\n    el.querySelector('#sizeH').value = el._config.container_fixed_height ?? '';\n    el.querySelector('#sizeOrientation').value = el._config.container_preset_orientation || 'auto';\n\n    // Build size preset list once (grouped)\n    const presetSelect = el.querySelector('#sizePreset');\n    if (!presetSelect.__filled) {\n      const groups = (this._sizePresets?.() || []).reduce((acc, p) => {\n        (acc[p.group || 'other'] ||= []).push(p); return acc;\n      }, {});\n      presetSelect.innerHTML = '';\n      for (const [group, items] of Object.entries(groups)) {\n        const optgroup = document.createElement('optgroup');\n        optgroup.label = group.replace(/(^.|-.?)/g, s => s.toUpperCase());\n        items.forEach(preset => {\n          const item = document.createElement('mwc-list-item');\n          item.value = preset.key;\n          item.textContent = `${preset.label} (${preset.w}\u00D7${preset.h})`;\n          optgroup.appendChild(item);\n        });\n        // Note: <optgroup> isn't supported inside mwc-menu; append flat items with prefix\n        // so we create visual grouping by inserting disabled headers\n        const header = document.createElement('mwc-list-item');\n        header.setAttribute('disabled', '');\n        header.textContent = `\u2014 ${optgroup.label} \u2014`;\n        presetSelect.appendChild(header);\n        Array.from(optgroup.children).forEach(child => presetSelect.appendChild(child));\n      }\n      presetSelect.__filled = true;\n    }\n    if (el._config.container_preset) presetSelect.value = el._config.container_preset;\n\n    toggleSizeControls();\n    updateButtons();\n\n    // If we just generated a key, immediately persist it so the dashboard saves it\n    if (el.__autokeyPending) {\n      el.__autokeyPending = false;\n      fire();\n    }\n  };\n\n  // --- Public API: collect values into config\n  el.getConfig = () => {\n    const base = { ...(el._config || {}) };\n    base.storage_key = el.querySelector('#storage_key').value || '';\n    base.grid = Number(el.querySelector('#grid').value || 10);\n    base.drag_live_snap = !!el.querySelector('#liveSnap').checked;\n    base.auto_save = !!el.querySelector('#autoSave').checked;\n    base.auto_save_debounce = Number(el.querySelector('#autoSaveDebounce').value || 800);\n    base.container_background = el.querySelector('#containerBg').value || 'transparent';\n    base.card_background = el.querySelector('#cardBg').value || 'var(--ha-card-background, var(--card-background-color))';\n    base.debug = !!el.querySelector('#debug').checked;\n    base.disable_overlap = !!el.querySelector('#noOverlap').checked;\n    base.auto_resize_cards = !!el.querySelector('#autoResize').checked;\n\n    // Reflect the animate cards setting back into the configuration. When\n    // true, cards will perform a fly\u2011in animation on tab switch. This key\n    // persists in YAML so toggling the option will survive reloads.\n    base.animate_cards = !!el.querySelector('#animateCards').checked;\n\n\n    base.container_size_mode = el.querySelector('#sizeMode').value;\n    base.container_fixed_width  = Number(el.querySelector('#sizeW').value || 0) || undefined;\n    base.container_fixed_height = Number(el.querySelector('#sizeH').value || 0) || undefined;\n    base.container_preset = el.querySelector('#sizePreset').value || undefined;\n    base.container_preset_orientation = el.querySelector('#sizeOrientation').value || 'auto';\n\n    return base;\n  };\n\n  // Change detection (don\u2019t fire immediately on each keystroke)\n  const isDirty = () => {\n    const current = el.getConfig();\n    const baseline = el._config || {};\n    try {\n      return JSON.stringify(current) !== JSON.stringify(baseline);\n    } catch { return true; }\n  };\n\n  const on = (sel, ev = 'input') => el.querySelector(sel)?.addEventListener(ev, () => {\n    if (sel === '#sizeMode') toggleSizeControls();\n    updateButtons();\n  });\n\n  // Listeners\n  on('#storage_key'); on('#grid');\n  on('#liveSnap', 'change'); on('#autoSave', 'change'); on('#autoSaveDebounce');\n  on('#containerBg'); on('#cardBg');\n  on('#debug', 'change'); on('#noOverlap', 'change');\n  on('#autoResize', 'change');\n  on('#animateCards', 'change');\n  on('#sizeMode', 'change'); on('#sizeW'); on('#sizeH');\n  on('#sizePreset', 'selected'); on('#sizeOrientation', 'selected');\n\n  applyBtn?.addEventListener('click', () => {\n    fire();\n  });\n  revertBtn?.addEventListener('click', () => el.setConfig(el._config));\n\n  return el;\n}\n\n\n\n\n  \n    /* ---------------------------- Size helpers ---------------------------- */\n  // ---- size presets (CSS pixels) ----\nstatic _sizePresets() {\n  return [\n    // Phones\n    { key:'iphone-14-pro',      label:'iPhone 14 Pro',        w:393,  h:852,  group:'phone' },\n    { key:'iphone-14-pro-max',  label:'iPhone 14 Pro Max',    w:430,  h:932,  group:'phone' },\n    { key:'iphone-se-2',        label:'iPhone SE (2/3rd gen)',w:375,  h:667,  group:'phone' },\n    { key:'pixel-7',            label:'Pixel 7',              w:412,  h:915,  group:'phone' },\n    { key:'galaxy-s8',          label:'Galaxy S8',            w:360,  h:740,  group:'phone' },\n    { key:'galaxy-s20-ultra',   label:'Galaxy S20 Ultra',     w:412,  h:915,  group:'phone' },\n\n    // Tablets\n    { key:'ipad-9-7',           label:'iPad 9.7\"',            w:768,  h:1024, group:'tablet' },\n    { key:'ipad-11-pro',        label:'iPad Pro 11\"',         w:834,  h:1194, group:'tablet' },\n    { key:'ipad-12-9-pro',      label:'iPad Pro 12.9\"',       w:1024, h:1366, group:'tablet' },\n    { key:'surface-go-3',       label:'Surface Go 3',         w:800,  h:1280, group:'tablet' },\n\n    // Desktop / Displays\n    { key:'hd',                 label:'HD',                   w:1366, h:768,  group:'desktop' },\n    { key:'wxga-plus',          label:'WXGA+',                w:1440, h:900,  group:'desktop' },\n    { key:'fhd',                label:'Full HD',              w:1920, h:1080, group:'desktop' },\n    { key:'qhd',                label:'2K / QHD',             w:2560, h:1440, group:'desktop' },\n    { key:'uhd-4k',             label:'4K UHD',               w:3840, h:2160, group:'desktop' },\n  ];\n}\n\n_isContainerFixed() { return this.containerSizeMode !== 'dynamic'; }\n\n_resolveFixedSize() {\n  if (this.containerSizeMode === 'fixed_custom') {\n    const w = Math.max(100, Number(this.containerFixedWidth || 0));\n    const h = Math.max(100, Number(this.containerFixedHeight || 0));\n    return { w, h };\n  }\n  if (this.containerSizeMode === 'preset') {\n    const p = DragAndDropCard._sizePresets().find(x => x.key === this.containerPreset) ||\n              DragAndDropCard._sizePresets().find(x => x.key === 'fhd');\n    if (!p) return { w: 1920, h: 1080 };\n    let w = p.w, h = p.h;\n    if (this.containerPresetOrient === 'portrait' && w > h) [w,h] = [h,w];\n    if (this.containerPresetOrient === 'landscape' && h > w) [w,h] = [h,w];\n    return { w, h };\n  }\n  return null;\n}\n\n_applyContainerSizingFromConfig(initial=false) {\n  // set container size according to mode\n  const c = this.cardContainer; if (!c) return;\n\n  if (this._isContainerFixed()) {\n    const { w, h } = this._resolveFixedSize();\n    c.style.width  = `${w}px`;\n    c.style.height = `${h}px`;\n    // ensure overflow hidden (hard lock)\n    c.style.overflow = 'hidden';\n    if (!initial) this._dbgPush?.('size', 'Applied fixed size', { w, h, mode: this.containerSizeMode, preset:this.containerPreset, orient:this.containerPresetOrient });\n    // pull any existing cards back inside\n    this._clampAllCardsInside();\n  } else {\n    // dynamic \u2014 let _resizeContainer compute; clear inline to allow growth/shrink\n    c.style.overflow = 'hidden';\n    // keep width/height managed by _resizeContainer\n    if (!initial) this._dbgPush?.('size', 'Applied dynamic size');\n    this._resizeContainer();\n  }\n}\n\n_getContainerSize() {\n  const c = this.cardContainer; if (!c) return { w:0, h:0 };\n  const w = parseFloat(getComputedStyle(c).width) || c.getBoundingClientRect().width;\n  const h = parseFloat(getComputedStyle(c).height) || c.getBoundingClientRect().height;\n  return { w, h };\n}\n\n_clampAllCardsInside() {\n  if (!this._isContainerFixed()) return;\n  const { w: cw, h: ch } = this._getContainerSize();\n  const wraps = this.cardContainer.querySelectorAll('.card-wrapper');\n  wraps.forEach(w => {\n    const x = parseFloat(w.getAttribute('data-x')) || 0;\n    const y = parseFloat(w.getAttribute('data-y')) || 0;\n    const ww = parseFloat(w.style.width)  || w.getBoundingClientRect().width;\n    const hh = parseFloat(w.style.height) || w.getBoundingClientRect().height;\n\n    const nx = Math.max(0, Math.min(x, Math.max(0, cw - ww)));\n    const ny = Math.max(0, Math.min(y, Math.max(0, ch - hh)));\n    let nw = Math.min(ww, cw);\n    let nh = Math.min(hh, ch);\n\n    // if width/height exceed box, shrink then re-clamp pos\n    if (nw !== ww || nh !== hh) {\n      w.style.width  = `${nw}px`;\n      w.style.height = `${nh}px`;\n    }\n    const nx2 = Math.max(0, Math.min(nx, Math.max(0, cw - nw)));\n    const ny2 = Math.max(0, Math.min(ny, Math.max(0, ch - nh)));\n    this._setCardPosition(w, nx2, ny2);\n  });\n}\n\n_applyGridVars() {\n  const sz = `${this.gridSize || 10}px`;\n  // host (inherits down)\n  this.style.setProperty('--ddc-grid-size', sz);\n  // container (extra robust)\n  this.cardContainer?.style.setProperty('--ddc-grid-size', sz);\n}\n\n  /* ---------------------------- debug helpers ---------------------------- */\n  _dbgInit() {\n    if (this.__dbgReady) return;\n    this.__dbgReady = true;\n    this._dbgBuffer = [];\n    this._dbgMax = 400;\n    try { window.DDC = this; } catch {}\n  }\n  _dbgPush(kind, msg, extra = null) {\n    const line = { t: new Date().toISOString(), kind, msg, extra };\n    this._dbgBuffer.push(line);\n    if (this._dbgBuffer.length > this._dbgMax) this._dbgBuffer.shift();\n    if (this.debug) console.debug(`%c[ddc:${kind}]%c ${msg}`, 'color:#03a9f4', 'color:unset', extra ?? '');\n  }\n  _dbgDump() { return [...this._dbgBuffer]; }\n  _safe(s) { return String(s).replace(/[&<>\"']/g, (c)=>({'&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;',\"'\":'&#39;'}[c])); }\n\n  /* --------------------------- Card lifecycle --------------------------- */\n  setConfig(config = {}) {\n    // Track old key so we only rebuild when storage_key actually changes\n    // Auto\u2011assign a storage key if none provided\n    // Keep previous to detect real key changes\n    const prevKey = this.storageKey;\n    // Use existing instance key if present\n\n    this.config = { ...config };\n    if (!this.config.storage_key || this.config.storage_key === \"\") {\n      this.config.storage_key = this.constructor._genKey();\n    }\n    this.storageKey = this.config.storage_key;\n\n    // STABLE storage_key: reuse instance key if none provided\n    if (!config.storage_key) {\n      if (this.storageKey) {\n        config = { ...config, storage_key: this.storageKey };\n      } else {\n        this.storageKey = `layout_${(crypto?.randomUUID?.() || Date.now().toString(36))}`;\n        config = { ...config, storage_key: this.storageKey };\n      }\n    }\n\n    // Store & reflect\n    this._config = config;\n    this.storageKey = config.storage_key;\n    this._syncEditorsStorageKey();\n\n\n    // Store incoming config and update properties\n    this.storageKey = config.storage_key || undefined;\n    this._syncEditorsStorageKey();\n    this.gridSize                 = Number(config.grid ?? 10);\n    this.dragLiveSnap             = !!config.drag_live_snap;\n    this.autoSave                 = config.auto_save !== false;\n    this.autoSaveDebounce         = Number(config.auto_save_debounce ?? 800);\n    this.containerBackground      = config.container_background ?? 'transparent';\n    this.cardBackground           = config.card_background ?? 'var(--ha-card-background, var(--card-background-color))';\n\n    this.hideHaHeader            = !!(config.hide_HA_Header ?? config.hide_ha_header ?? false);\n    this.hideHaSidebar           = !!(config.hide_HA_Sidebar ?? config.hide_ha_sidebar ?? false);\n        this.debug                    = !!config.debug;\n    this.editMode                 = false;\n    this._backendOK               = false;\n    this.disableOverlap           = !!config.disable_overlap;\n    this.containerSizeMode        = config.container_size_mode || 'dynamic';\n    this.autoResizeCards         = !!config.auto_resize_cards;\n\n    // Whether to play a fly\u2011in animation when switching tabs or refreshing\n    // Defaults to false when not specified.  When true, the card wrappers\n    // animate into view the moment a tab becomes active or on initial load.\n    this.animateCards             = !!config.animate_cards;\n\n    if (this.autoResizeCards) this._startScaleWatch?.(); else this._stopScaleWatch?.();\n    this._applyAutoScale?.();\n    this.containerFixedWidth      = Number(config.container_fixed_width ?? 0) || null;\n    this.containerFixedHeight     = Number(config.container_fixed_height ?? 0) || null;\n    this.containerPreset          = config.container_preset || 'fullhd';\n    this.containerPresetOrient    = config.container_preset_orientation || 'auto';\n    this.heroImage = config?.hero_image || \"https://i.postimg.cc/CxsWQgwp/Chat-GPT-Image-Sep-5-2025-09-26-16-AM.png\";\n    // Tabs options\n    this.tabs               = Array.isArray(config.tabs) ? config.tabs : [];\n    this.tabsPosition       = (config.tabs_position === 'left') ? 'left' : 'top';\n    this.defaultTab         = config.default_tab || (this.tabs[0]?.id ?? 'default');\n    this.hideTabsWhenSingle = (config.hide_tabs_when_single !== false);\n    this.activeTab          = this.defaultTab;\n    try { const lastT = localStorage.getItem(`ddc_lasttab_${this.storageKey}`);\n      if (lastT && this.tabs.some(t=>t.id===lastT)) this.activeTab = lastT; } catch {}\n    if (this.rootEl) this.rootEl.classList.toggle('ddc-tabs-left-layout', this.tabsPosition === 'left');\n\n\n\n    if (this.cardContainer) this._applyContainerSizingFromConfig(false);\n\n    const keyChanged = prevKey !== this.storageKey;\n\n      // IMPORTANT: do NOT autosave a layout snapshot while the key is changing/booting\n    if (this.editMode && !this.__booting && !keyChanged) {\n      try { if (!this._isInHaEditorPreview()) this._queueSave('config-change'); } catch {}\n    }\n    // Grid-related\n    this._applyGridVars();\n\n    \n    try { this._applyBackgroundImageFromConfig?.(); } catch {}\n\n    try { this._applyHaChromeVisibility_?.(); } catch {}\n// Overlay fix for UI based cards\n    this._ensureOverlayZFix();\n\n    // selection state\n    this._selection = new Set();\n    this.__groupDrag = null;\n\n    // caches for speed\n    this.__editorCache = new Map(); // type -> element\n    this.__stubCache = new Map();\n\n    this._dbgInit();\n    this._dbgPush('init', 'Card configured', {\n      storageKey_raw: config.storage_key,\n      storageKey_slug: this.storageKey,\n      autoSave: this.autoSave,\n      grid: this.gridSize\n    });\n\n    this.style.setProperty('--ddc-bg', this.containerBackground);\n    this.style.setProperty('--ddc-card-bg', this.cardBackground);\n\n    // preload libs\n    if (!window.jsyaml) {\n      const s = document.createElement('script');\n      s.src = 'https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js';\n      document.head.appendChild(s);\n    }\n    if (!window.interact) {\n      const s = document.createElement('script');\n      s.src = 'https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js';\n      s.onload = () => this._initInteract();\n      document.head.appendChild(s);\n    }\n    // preload helpers early to avoid lag on first pick\n    this._helpersPromise = (typeof window.loadCardHelpers === 'function')\n      ? window.loadCardHelpers().catch(()=>null)\n      : Promise.resolve(null);\n\n    if (!this._built) {\n      this._built = true;\n      this.shadowRoot.innerHTML = `\n        <style>\n          .ddc-root{\n            position:relative;\n            /* JS will keep this in sync with your \u201CGrid (px)\u201D */\n            --ddc-grid-size: 10px;\n            /* Good contrast on light/dark themes */\n            --ddc-grid-color: color-mix(in srgb, var(--primary-text-color) 22%, transparent);\n          }\n          .toolbar{display:flex;gap:8px;margin:6px 0;align-items:center;flex-wrap:wrap}\n          .btn{\n            background:var(--primary-color);color:#fff;border:none;padding:8px 12px;border-radius:10px;\n            cursor:pointer;font:inherit;box-shadow:0 2px 6px rgba(0,0,0,.12)\n          }\n          .btn.secondary{background:var(--secondary-background-color);color:var(--primary-text-color);border:1px solid var(--divider-color)}\n          .btn.ghost{background:transparent;color:var(--primary-text-color);border:1px dashed var(--divider-color)}\n          .store-badge {\n            margin-left: auto;\n            border: 1px solid var(--divider-color);\n            border-radius: 999px;\n            padding: 4px 10px;\n            font-size: .85rem;\n            background: rgba(255,193,7,.15);\n            display: none; /* hidden by default, shown only in edit mode */\n          }\n\n          .card-container{\n            position: relative;\n            transform-origin: top left;\n            padding: 10px;\n            border: 1px solid var(--divider-color);\n            background: var(--ddc-bg, transparent);\n            width: auto; height: auto; border-radius: 12px; overflow: hidden;\n            isolation: isolate; z-index: 0; -webkit-touch-callout: none;\n            user-select: none;\n          }\n          /* make the grid only on the background, aligned to the same origin as cards */\n          .card-container::before{\n            content:'';\n            position:absolute; inset:0;                 /* same origin as absolutely positioned children */\n            background-image:\n              linear-gradient(var(--ddc-grid-color, rgba(120,120,120,.25)) 1px, transparent 1px),\n              linear-gradient(90deg, var(--ddc-grid-color, rgba(120,120,120,.25)) 1px, transparent 1px);\n            background-size: var(--ddc-grid-size) var(--ddc-grid-size);\n            background-origin: content-box;              /* align pattern to the content/padding edge */\n            background-clip: content-box;\n            pointer-events:none;\n            opacity:0;\n            transition: opacity .15s;\n            z-index:1;\n          }\n          .card-container.grid-on::before{\n            opacity:.28;\n          }\n          /* background image layer (always behind grid and cards) */\n          .card-container::after{\n            content:'';\n            position:absolute; inset:0;\n            pointer-events:none;\n            z-index:0;\n            opacity: var(--ddc-bg-opacity, 1);\n            background-image: var(--ddc-bg-image, none);\n            background-repeat: var(--ddc-bg-repeat, no-repeat);\n            background-size: var(--ddc-bg-size, cover);\n            background-position: var(--ddc-bg-position, center center);\n            background-attachment: var(--ddc-bg-attachment, scroll);\n            filter: var(--ddc-bg-filter, none);\n          }\n    \n\n          .card-wrapper{\n            position:absolute;\n            left: 0;                     /* <<< important: unify origin with the grid */\n            top:  0;                     /* <<< important: unify origin with the grid */\n            box-sizing: border-box;      /* include the 2px border in the set width/height */\n            border:2px solid transparent;\n            background:var(--ddc-card-bg, var(--card-background-color));\n            cursor:grab;\n            /* ensure buttons and resize handles remain visible on very small cards */\n            overflow:auto;\n            border-radius:14px;\n            box-shadow:var(--ha-card-box-shadow,0 2px 12px rgba(0,0,0,.18));\n            will-change:transform,width,height,box-shadow; touch-action:auto;\n            z-index:2;\n          }\n          .card-wrapper.dragging{\n            cursor:grabbing;\n            touch-action: none;\n            }\n          .card-wrapper.editing.selected{\n            border-color:var(--primary-color,#03a9f4);\n            box-shadow:0 0 0 2px var(--primary-color,#03a9f4)!important;\n          }\n\n          /* ---- empty-state of the card---- */\n          .btn.cta-empty{\n            position:relative;\n            padding:12px 16px;\n            font-weight:600;\n            border-radius:14px;\n            display:inline-flex !important;\n            align-items:center;\n            gap:8px;\n            box-shadow:0 6px 18px rgba(3,169,244,.25);\n          }\n          .btn.cta-empty::after{\n            content:\"\";\n            position:absolute; inset:-4px;\n            border-radius:16px;\n            border:2px solid rgba(3,169,244,.35);\n            animation: ddc-cta-pulse 1.8s ease-out infinite;\n            pointer-events:none;\n          }\n          @keyframes ddc-cta-pulse{\n            0%   { opacity:.85; transform:scale(.98); }\n            70%  { opacity:0;   transform:scale(1.12); }\n            100% { opacity:0;   transform:scale(1.18); }\n          }    \n            \n          /* pleasant buttons: info (light blue) & warning (orange) */\n          .btn.info{\n            background: var(--ddc-info,#4db6ff);\n            color:#0b2537;\n            border:1px solid color-mix(in srgb, var(--ddc-info,#4db6ff) 55%, #000 15%);\n          }\n          .btn.info:hover{ filter: brightness(1.06); transform: translateY(-1px); box-shadow:0 4px 14px rgba(0,0,0,.18) }\n          .btn.info:active{ transform: translateY(0) }\n\n          .btn.warning{\n            background: var(--ddc-warning,#ff9800);\n            color:#210b00;\n            border:1px solid color-mix(in srgb, var(--ddc-warning,#ff9800) 55%, #000 15%);\n          }\n          .btn.warning:hover{ filter: brightness(1.07); transform: translateY(-1px); box-shadow:0 4px 14px rgba(0,0,0,.18) }\n          .btn.warning:active{ transform: translateY(0) }\n\n          /* small quality-of-life for all .btn */\n          .btn{\n            display:inline-flex; align-items:center; gap:8px;\n            border-radius:12px; transition: transform .08s ease, box-shadow .12s ease, filter .12s ease;\n          }\n          .btn ha-icon{ --mdc-icon-size:18px; width:18px; height:18px }\n\n          /* ---- chip ---- */\n        .chip{\n            position:absolute;\n            /* Position the chip horizontally centered above the resize handle */\n            bottom:48px;\n            left:50%;\n            transform:translateX(-50%);\n            display:flex;\n            gap:6px;\n            flex-wrap:wrap;\n            opacity:0;\n            transition:opacity .15s;\n            z-index:30;\n            pointer-events: none;\n          }\n          .card-wrapper.editing .chip{\n            opacity:1;\n            pointer-events: auto;\n          }\n          .card-wrapper.editing .chip{\n            opacity:1;\n            pointer-events: auto;\n          }\n          /* Action buttons on cards: icons only, colour-coded and consistent sizing */\n          .chip .mini{\n            display:flex;\n            align-items:center;\n            justify-content:center;\n            width:32px;\n            height:32px;\n            /* Use a subtle gradient for a more interesting look */\n            background:linear-gradient(135deg, rgba(24,25,27,.7) 0%, rgba(40,41,43,.9) 100%);\n            color:#fff;\n            border:1px solid rgba(255,255,255,.18);\n            border-radius:8px;\n            cursor:pointer;\n            box-shadow:0 2px 4px rgba(0,0,0,.25);\n            /* removed blur for clarity */\n            transition:background .15s, transform .1s, box-shadow .15s;\n          }\n          .chip .mini span{\n            display:none;\n          }\n          .chip .mini:hover{\n            transform:translateY(-1px);\n            background:linear-gradient(135deg, rgba(24,25,27,.85) 0%, rgba(40,41,43,1) 100%);\n            box-shadow:0 3px 8px rgba(0,0,0,.4);\n          }\n          .chip .mini ha-icon{\n            --mdc-icon-size:20px;\n            width:20px;\n            height:20px;\n          }\n          .chip .mini.danger{\n            background:linear-gradient(135deg, rgba(236,72,72,.9) 0%, rgba(255,105,97,1) 100%);\n            border-color:rgba(255,255,255,.22);\n          }\n          .chip .mini.danger:hover{\n            background:linear-gradient(135deg, rgba(236,72,72,1) 0%, rgba(255,105,97,1) 100%);\n          }\n          /* pill modifier is no longer used, but keep rule for compatibility */\n          .chip .mini.pill{\n            /* no extra padding needed when using icon-only buttons */\n            padding:0;\n          }\n\n          /* Edit highlight */\n          .card-wrapper.editing{ \n            border-color:var(--primary-color,#03a9f4);\n            touch-action: none;\n          }\n          .card-wrapper.editing::after{\n            content:\"\";position:absolute;inset:0;border:1px dashed var(--primary-color,#03a9f4);\n            border-radius:12px;pointer-events:none;opacity:.35;z-index:5;box-sizing:border-box\n          }\n\n          .shield{position:absolute;inset:0;z-index:10;background:transparent;pointer-events:none}\n          .card-wrapper.editing .shield,\n          .card-wrapper.dragging .shield{pointer-events:auto;cursor:grab}\n\n          .resize-handle{\n            display:none;                 /* shown in edit mode via your existing rule */\n            position:absolute;\n            bottom:0;\n            right:0;\n            width:40px;\n            height:40px;\n            background:var(--primary-color);\n            color:#fff;\n            border-top-left-radius:40px;\n            border-bottom-left-radius:0;\n            border-top-right-radius:0;\n            border-bottom-right-radius:0;\n            cursor:se-resize;\n            z-index:999;                  /* above the card content */\n            box-shadow:0 3px 8px rgba(0,0,0,.28);\n            display:flex;\n            align-items:center;\n            justify-content:center;\n            transition:background .15s, transform .1s, box-shadow .15s;\n          }\n          .resize-handle:hover{\n            transform:scale(1.05);\n            box-shadow:0 6px 16px rgba(0,0,0,.35);\n            filter:brightness(1.05);\n          }\n          .card-wrapper.editing .resize-handle{display:flex}\n          .resize-handle ha-icon{\n            --mdc-icon-size:20px;\n            width:20px;\n            height:20px;\n            pointer-events:none;\n          }\n\n          /* Delete handle: a quarter\u2011circle wedge in the top-left corner */\n          .delete-handle{\n            display:none;                 /* shown only in edit mode */\n            position:absolute;\n            top:0;\n            left:0;\n            width:40px;\n            height:40px;\n            background:linear-gradient(135deg, rgba(236,72,72,.9) 0%, rgba(255,105,97,1) 100%);\n            color:#fff;\n            border-bottom-right-radius:40px;\n            z-index:999;\n            box-shadow:0 3px 8px rgba(0,0,0,.28);\n            cursor:pointer;\n            align-items:center;\n            justify-content:center;\n            transition:background .15s, transform .1s, box-shadow .15s;\n          }\n          .delete-handle:hover{\n            transform:scale(1.05);\n            box-shadow:0 6px 16px rgba(0,0,0,.35);\n            filter:brightness(1.05);\n          }\n          .card-wrapper.editing .delete-handle{display:flex}\n          .delete-handle ha-icon{\n            --mdc-icon-size:20px;\n            width:20px;\n            height:20px;\n            pointer-events:none;\n          }\n\n          /* modal */\n          .modal{position:fixed;inset:0;background:rgba(0,0,0,.45);display:flex;align-items:center;justify-content:center;z-index:9000}\n          .dialog{\n            width:min(1220px,96%);max-height:min(90vh, 900px);display:flex;flex-direction:column;\n            background:var(--card-background-color);border-radius:20px;padding:0;border:1px solid var(--divider-color);overflow:visible\n          }\n          .dlg-head{\n            display:flex;align-items:center;gap:12px;padding:12px 16px;border-bottom:1px solid var(--divider-color);\n            background:\n              radial-gradient(1200px 120px at 20% -40px, rgba(3,169,244,.21), transparent 60%),\n              radial-gradient(900px 110px at 80% -40px, rgba(0,150,136,.18), transparent 60%);\n          }\n          .dlg-head h3{margin:0;font-size:1.1rem;letter-spacing:.2px}\n          .dlg-foot{display:flex;gap:10px;justify-content:flex-end;padding:12px;border-top:1px solid var(--divider-color);background:var(--primary-background-color)}\n          .btn:disabled{opacity:.6;cursor:not-allowed}\n\n          /* picker layout */\n          .layout{display:grid;height:min(84vh,820px);grid-template-columns:260px 1fr}\n          #leftPane{\n            border-right:1px solid var(--divider-color);\n            overflow:auto;\n            background:var(--primary-background-color);\n            /*\n             * Remove contain:content so that fixed-position menus from\n             * custom card editors can correctly position themselves\n             * relative to the viewport. CSS containment can interfere\n             * with anchoring of overlays.\n             */\n            contain:none;\n          }\n          /*\n           * Allow content like dropdown menus from custom card editors to\n           * overflow the right pane without being clipped. Using overflow\n           * visible instead of hidden prevents menus from being positioned\n           * far away or requiring excessive scrolling when they open.\n           */\n          #rightPane{\n            /* Allow the right-hand editor pane to scroll vertically when\n             * content from custom card editors exceeds the available space.\n             * We hide horizontal overflow to avoid layout shifts. */\n            overflow-y:auto;\n            overflow-x:hidden;\n            background:var(--primary-background-color);\n          }\n          .rightGrid{\n            display:grid;grid-template-columns:540px 1fr;grid-template-rows:auto auto 1fr;gap:12px;padding:12px;height:100%;box-sizing:border-box;position:relative;\n          }\n          .sec{\n            border:1px solid var(--divider-color);\n            border-radius:12px;\n            background:var(--card-background-color);\n            overflow:visible;\n            position:relative;\n            /* Remove content containment on sections to prevent the\n             * creation of an artificial containing block which can\n             * disrupt dropdown positioning. */\n            contain:none;\n          }\n          .sec .hd{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid var(--divider-color);font-weight:600;position: relative;z-index: 10}\n          .sec .bd{padding:12px;overflow:visible}       \n          .tabs{display:flex;gap:6px;margin-left:auto}\n          .tab{\n            font-size:.85rem;padding:6px 10px;border-radius:10px;border:1px solid var(--divider-color);\n            background:var(--primary-background-color);color:var(--primary-text-color);cursor:pointer\n          }\n          .tab.active{background:var(--primary-color);color:#fff;border-color:var(--primary-color)}\n          .cm-editor{height: 100%}\n          /* --- FIX: YAML/Visual editor: ensure the entire content is visible --- */\n          /*\n           * The YAML editor previously had a fixed height which caused the\n           * bottom of longer configurations to be clipped. Removing the fixed\n           * height allows the section to flex based on available space within\n           * the grid row. A min-height of zero lets it collapse when there\n           * isn't much content, while overflow:auto enables scrolling when\n           * content exceeds the visible area.\n           */\n          #yamlSec {\n            min-height: 0;\n            height: auto !important;\n            overflow: auto;\n          }\n          #yamlSec .bd {\n            /* allow the YAML editor to use the full available space instead of a fixed max height */\n            overflow: auto;\n            max-height: none;\n            /* Fill the available grid row height (1fr) so that scrolling\n             * happens inside this section rather than expanding the editor\n             * beyond the modal boundary. A min-height of zero ensures the\n             * section can shrink when little content is present. */\n            height: 100%;\n            min-height: 0;\n          }\n          /* --- make Visual editor area scrollable, like YAML --- */\n          #optionsSec {\n            min-height: 0;\n            overflow: auto;\n          }\n          #optionsSec .bd {\n            position: relative;\n            overflow: auto;\n            height: auto;\n            max-height: none;\n            min-height: 0;\n          }\n          #editorHost {\n            display: block;\n            min-height: 0;\n          }\n\n          #quickFillSec { \n            display: flex; \n            flex-direction: column; \n            min-height: 0; \n          }\n          #quickFillSec .bd { \n            overflow: auto;          /* scroll inside the card */\n            max-height: 320px;       /* keep it contained; tweak as you wish */\n          }\n\n          /* ha-code-editor / CodeMirror height: allow growth but set a sensible minimum\n           * so that very short snippets don't collapse. Using min-height\n           * instead of a fixed height allows the editor to expand when the\n           * parent container grows. The !important flag ensures that the\n           * component\u2019s inline styles from HA won\u2019t override this sizing.\n           */\n          ha-code-editor {\n            display: block;\n            min-height: 260px;\n            height: auto !important;\n          }\n          .CodeMirror {\n            min-height: 260px;\n            height: auto !important;\n          }\n\n          /* host that wraps the editor should also allow scroll if content grows */\n          #yamlHost { \n            overflow: visible; \n            height: auto;\n          }\n\n          /* CodeMirror */\n          .CodeMirror{\n            height:260px;border:1px solid var(--divider-color);border-radius:12px;\n            background:var(--primary-background-color);color:var(--primary-text-color);\n            z-index:6;\n          }\n\n          /* YAML editor safety / visibility */\n          #yamlSec{ z-index:5; }\n          #yamlHost, #yamlHost * { touch-action: auto; }\n          ha-code-editor, ha-code-editor * { touch-action: auto; }\n          ha-code-editor{ display:block; height:260px; z-index:6; }\n\n          /* loading spinners */\n          .spin-center{\n            position:absolute;inset:0;display:flex;align-items:center;justify-content:center;pointer-events: none; /* let clicks pass through to tabs and controls */\n          }\n\n\n          /* marquee selection rectangle */\n          .marquee{\n            position:absolute; border:1px dashed var(--primary-color);\n            background: color-mix(in srgb, var(--primary-color) 10%, transparent);\n            pointer-events:none; z-index:50;\n          }\n\n          /* placeholder tile */\n          .ddc-placeholder-inner{\n            position: relative;\n            display:flex; align-items:center; justify-content:center;\n            width:100%; height:100%;\n            border-radius:16px;\n            overflow: hidden;\n            /* cool gradient derived from HA primary color */\n            background:\n              radial-gradient(120% 120% at 100% 0%,\n                color-mix(in srgb, var(--primary-color) 18%, #000 0%) 0%,\n                transparent 60%),\n              linear-gradient(135deg,\n                color-mix(in srgb, var(--primary-color) 70%, #000 0%) 0%,\n                color-mix(in srgb, var(--primary-color) 35%, #000 0%) 100%);\n          }\n\n          /* subtle shine */\n          .ddc-placeholder-inner::after{\n            content:\"\";\n            position:absolute; inset:0;\n            background: radial-gradient(120% 90% at 0% 100%, rgba(255,255,255,.15), transparent 60%);\n            pointer-events:none;\n          }\n\n          /* center stack */\n          .ddc-hero{\n            position:absolute; inset:0;\n            display:flex; flex-direction:column; align-items:center; justify-content:center;\n            gap:16px; text-align:center; padding:24px;\n            color:rgba(255,255,255,.98);\n            text-shadow:0 1px 2px rgba(0,0,0,.35);\n            user-select:none; pointer-events:none; /* click goes to shield below */\n          }\n\n          .ddc-hero img{\n            width:128px; height:128px; object-fit:contain; opacity:.95; filter: drop-shadow(0 4px 14px rgba(0,0,0,.25));\n          }\n\n          .ddc-hero .ddc-title{\n            font-weight:800; font-size:1.25rem; letter-spacing:.2px;\n          }\n\n          .ddc-hero .ddc-sub{\n            font-weight:600; opacity:.95;\n          }\n\n          /* --- hold-to-edit ring (cursor progress) --- */\n          .ddc-press-ring{\n            position:fixed; z-index:100000; width:44px; height:44px; pointer-events:none;\n            margin-left:-22px; margin-top:-22px;\n            filter: drop-shadow(0 2px 6px rgba(0,0,0,.35));\n          }\n          .ddc-press-ring svg{width:44px;height:44px}\n          .ddc-press-ring .pr-bg{stroke: rgba(255,255,255,.45); stroke-width:4; fill:none}\n          .ddc-press-ring .pr-fg{stroke: var(--primary-color); stroke-width:4; fill:none; stroke-linecap:round}\n          .ddc-press-ring .pr-dot{fill: var(--primary-color); opacity:.95}\n\n          /* --- edit-mode ripple transition --- */\n          .ddc-ripple-veil{\n            position:absolute; inset:0; pointer-events:none; z-index:80; overflow:hidden;\n            mix-blend-mode: screen;\n          }\n          .ddc-ripple-veil::before{\n            content:\"\"; position:absolute; left: var(--rip-x, 50%); top: var(--rip-y, 50%);\n            width:0px; height:0px; transform: translate(-50%,-50%);\n            border-radius:50%;\n            background:\n              radial-gradient(closest-side, rgba(3,169,244,.55), rgba(3,169,244,.25) 45%, rgba(0,0,0,0) 65%),\n              radial-gradient(closest-side, rgba(0,150,136,.35), rgba(0,150,136,.15) 50%, rgba(0,0,0,0) 70%);\n            filter: blur(12px);\n            animation: ddc-ripple-grow 900ms ease-out forwards;\n          }\n          .ddc-ripple-veil::after{\n            content:\"\"; position:absolute; inset:-20%;\n            background:\n              repeating-linear-gradient(115deg, rgba(3,169,244,.09) 0 12px, rgba(0,0,0,0) 12px 24px);\n            opacity:0;\n            animation: ddc-ripple-scan 900ms ease-out forwards;\n          }\n          @keyframes ddc-ripple-grow{\n            0%   { width:0; height:0; opacity:.9 }\n            60%  { width:150vmax; height:150vmax; opacity:.9 }\n            100% { width:170vmax; height:170vmax; opacity:0 }\n          }\n          @keyframes ddc-ripple-scan{\n            0%   { transform:scale(.96) rotate(0deg); opacity:0 }\n            40%  { opacity:.7 }\n            100% { transform:scale(1.06) rotate(2deg); opacity:0 }\n          }\n\n                /* --- Tabs bar (DDC) --- */\n          /* --- WILD DDC Tabs (drop in and replace your block) --- */\n\n          /* --- DDC Tabs \u2014 Chrome-style, no backdrop, mobile-friendly --- */\n\n          /* --- DDC Tabs \u2014 Chrome-style, fills width, steady hover (no bounce), stronger active shadow --- */\n\n          /* Tabs bar (transparent, no backdrop) */\n /* --- DDC Tabs \u2014 Chrome-style, centered content, smooth tab-change, faint inactive outline --- */\n\n        /* Tabs bar (transparent, no backdrop; fills width) */\n        .ddc-tabs{\n          position: relative;\n          display: flex; flex-wrap: wrap;\n          align-items: flex-end; /* Chrome-like baseline */\n          gap: 6px;\n          padding: 6px 10px;\n          width: 100%;\n          overflow-x: hidden;\n          overflow-y: hidden;\n          -webkit-overflow-scrolling: touch;\n          scroll-snap-type: x proximity;\n          background: transparent;\n          border-bottom: 1px solid var(--divider-color, rgba(0,0,0,.12));\n          scrollbar-width: thin;\n          scrollbar-color: color-mix(in oklab, var(--primary-text-color) 35%, transparent) transparent;\n        }\n        .ddc-tabs::-webkit-scrollbar { height: 8px; }\n        .ddc-tabs::-webkit-scrollbar-thumb {\n          background: color-mix(in oklab, var(--primary-text-color) 35%, transparent);\n          border-radius: 9999px;\n        }\n        .ddc-tabs::-webkit-scrollbar-track { background: transparent; }\n\n        /* Tab: fills available width, centered icon+text, no hover bounce */\n        .ddc-tab{\n          -webkit-tap-highlight-color: transparent;\n          position: relative;\n          z-index: 0;\n          display: inline-flex;\n          align-items: center;\n          justify-content: center;             /* 1) center content */\n          text-align: center;                  /* 1) center label text */\n          gap: 8px;\n          padding: 8px 12px;\n          font: 500 13px/1.2 system-ui, -apple-system, Segoe UI, Roboto, \"Helvetica Neue\", Arial, \"Noto Sans\";\n          letter-spacing: .2px;\n          color: color-mix(in oklab, var(--primary-text-color) 75%, #000 0%);\n          cursor: pointer;\n\n          /* fill width but remain scrollable when crowded */\n          flex: 1 1 clamp(120px, 18%, 280px);\n          min-width: clamp(120px, 18%, 280px);\n          max-width: 100%;\n          scroll-snap-align: start;\n\n          margin: 0;                           /* no overlap for steady layout */\n          border: 0;\n          background: transparent;\n\n          /* 2&3) keep motion minimal; animate only color/shadow/line */\n          transition: color .18s ease, filter .18s ease, box-shadow .18s ease, border-color .18s ease;\n        }\n        .ddc-tab ha-icon{ --mdc-icon-size:18px; }\n        .ddc-tab .ddc-tab-label{ max-width: 100%; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }\n\n        /* 3) Inactive tabs have a faint outline */\n        .ddc-tab::before{\n          content:\"\";\n          position:absolute;\n          inset: 0;\n          border-top-left-radius: 14px;\n          border-top-right-radius: 14px;\n          border: 1px solid color-mix(in oklab, var(--primary-text-color) 12%, transparent); /* faint */\n          border-bottom: none;\n          background: transparent;\n          pointer-events: none;\n          z-index: -1;\n        }\n\n        /* Subtle hover: clearer text only (no movement) */\n        .ddc-tab:hover{\n          color: var(--primary-text-color);\n          filter: saturate(1.05);\n        }\n\n        /* Active tab: elevated, stronger shadow */\n        .ddc-tab.active{\n          color: var(--primary-text-color);\n          z-index: 2;\n        }\n        .ddc-tab.active::before{\n          background: var(--card-background-color, #fff);\n          border-color: var(--divider-color, rgba(0,0,0,.18));\n          box-shadow:\n            0 10px 24px rgba(0,0,0,.16),\n            0 4px 10px rgba(0,0,0,.10),\n            0 0 0 1px color-mix(in oklab, var(--primary-text-color) 10%, transparent);\n          animation: ddc-pop .18s ease-out;  /* quick, pleasing shadow pop */\n        }\n\n        /* 2) Animated TOP line \u2013 appears quickly when tab becomes active */\n        .ddc-tab::after{\n          content:\"\";\n          position:absolute;\n          top: -2px; left: 10px; right: 10px;\n          height: 0;                            /* hidden by default */\n          border-radius: 3px 3px 0 0;\n          background: linear-gradient(90deg, var(--primary-color), #ff4ecd, #00e0ff, var(--primary-color));\n          background-size: 300% 100%;\n          opacity: 0;\n          transform: scaleX(0);                  /* prepare for quick reveal */\n          transform-origin: 50% 50%;\n          transition: transform .16s ease-out, height .16s ease-out, opacity .16s ease-out;\n          pointer-events: none;\n        }\n        .ddc-tab.active::after{\n          height: 3px;\n          opacity: 1;\n          transform: scaleX(1);\n          animation: ddc-rainbow 4s linear infinite;\n        }\n\n        /* Pressed: keep still (no bounce) */\n        .ddc-tab:active{ box-shadow: 0 1px 0 rgba(0,0,0,0); }\n\n        /* Focus ring without motion */\n        .ddc-tab:focus-visible{\n          outline: none;\n          box-shadow: 0 0 0 2px color-mix(in oklab, var(--primary-color) 45%, transparent);\n        }\n\n        /* Mobile scaling \u2014 smaller min width & tighter paddings */\n        @media (max-width: 640px){\n          .ddc-tabs{ gap: 4px; padding: 6px 8px; }\n          .ddc-tab{\n            flex: 1 1 clamp(96px, 34%, 200px);\n            min-width: clamp(96px, 34%, 200px);\n            padding: 6px 10px;\n            font-size: 12px;\n          }\n          .ddc-tab::after{ left: 8px; right: 8px; }\n        }\n\n        /* Vertical tabs rail (transparent) \u2014 centered content too */\n        .ddc-tabs-left{\n          display:flex;\n          flex-direction:column;\n          align-items: stretch;\n          width: clamp(150px, 28%, 220px);\n          padding: 8px 6px;\n          gap: 6px;\n          overflow-y: auto;\n          overflow-x: hidden;\n          border-right: 1px solid var(--divider-color, rgba(0,0,0,.12));\n          border-bottom: none;\n          background: transparent;\n        }\n        .ddc-tabs-left .ddc-tab{\n          justify-content: center;             /* 1) center in vertical list as well */\n          margin: 0;\n          border: 1px solid color-mix(in oklab, var(--primary-text-color) 12%, transparent);\n          border-radius: 10px;\n          padding: 8px 10px;\n          flex: 0 0 auto;\n        }\n        .ddc-tabs-left .ddc-tab::before{ display:none; }\n        .ddc-tabs-left .ddc-tab.active{\n          background: var(--card-background-color, #fff);\n          box-shadow: 0 4px 12px rgba(0,0,0,.12);\n        }\n        .ddc-tabs-left .ddc-tab.active::after{ display:none; } /* top line is only for horizontal */\n\n        /* Animations */\n        @keyframes ddc-rainbow{\n          0% { background-position: 0% 50%; }\n          100% { background-position: 300% 50%; }\n        }\n        @keyframes ddc-pop{\n          0% { box-shadow: 0 0 0 rgba(0,0,0,0); }\n          100% {\n            box-shadow:\n              0 10px 24px rgba(0,0,0,.16),\n              0 4px 10px rgba(0,0,0,.10),\n              0 0 0 1px color-mix(in oklab, var(--primary-text-color) 10%, transparent);\n          }\n        }\n\n        /* Fly\u2011in animation for card wrappers. When the animate_cards\n           configuration option is enabled, card wrappers will animate\n           into view using this keyframe sequence. Cards translate\n           upward while fading in to produce a quick, pleasant fly\u2011in. */\n        @keyframes ddc-card-fly-in{\n          0%   { opacity: 0; transform: translateY(12px); }\n          100% { opacity: 1; transform: translateY(0); }\n        }\n        /* Apply the fly\u2011in animation to visible cards. The animation\n           duration and easing mirror other UI animations for cohesion. */\n        .card-wrapper.ddc-fly-in{\n          animation: ddc-card-fly-in 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n\n      \n        </style>\n        <div class=\"ddc-root\">\n          <div class=\"toolbar\">\n            <button class=\"btn\" id=\"addCardBtn\" style=\"display:none\">\n              <ha-icon icon=\"mdi:plus\"></ha-icon>\n              <span style=\"margin-left:6px\">Add Card</span>\n            </button>\n            <button class=\"btn secondary\" id=\"reloadBtn\" style=\"display:none\">\n              <ha-icon icon=\"mdi:refresh\"></ha-icon>\n              <span style=\"margin-left:6px\">Reload</span>\n            </button>\n            <button class=\"btn secondary\" id=\"diagBtn\" style=\"display:none\">\n              <ha-icon icon=\"mdi:play-circle-outline\"></ha-icon>\n              <span style=\"margin-left:6px\">Diagnostics</span>\n            </button>\n            <button class=\"btn secondary\" id=\"exportBtn\" style=\"display:none\">\n              <ha-icon icon=\"mdi:download\"></ha-icon>\n              <span style=\"margin-left:6px\">Export Design</span>\n            </button>\n            <button class=\"btn secondary\" id=\"importBtn\" style=\"display:none\">\n              <ha-icon icon=\"mdi:upload\"></ha-icon>\n              <span style=\"margin-left:6px\">Import Design</span>\n            </button>\n\n            <!-- Copy and Paste buttons for edit mode -->\n            <button class=\"btn secondary\" id=\"copyBtn\" style=\"display:none\">\n              <ha-icon icon=\"mdi:content-copy\"></ha-icon>\n              <span style=\"margin-left:6px\">Copy</span>\n            </button>\n            <button class=\"btn secondary\" id=\"pasteBtn\" style=\"display:none\">\n              <ha-icon icon=\"mdi:content-paste\"></ha-icon>\n              <span style=\"margin-left:6px\">Paste</span>\n            </button>\n\n            <!-- Dashboard Settings button -->\n            <button class=\"btn secondary\" id=\"settingsBtn\" style=\"display:none\">\n              <ha-icon icon=\"mdi:cog\"></ha-icon>\n              <span style=\"margin-left:6px\">Dashboard Settings</span>\n            </button>\n            <button class=\"btn\" id=\"applyLayoutBtn\" style=\"display:none\">\n              <ha-icon icon=\"mdi:content-save\"></ha-icon>\n              <span style=\"margin-left:6px\">Apply</span>\n            </button>\n            <button class=\"btn info\" id=\"exploreBtn\" style=\"display:none\" title=\"Open HADS (Home Assistant Dashboard Store)\">\n              <ha-icon icon=\"mdi:storefront-outline\"></ha-icon>\n              <span>Open HADS</span>\n            </button>\n            <button class=\"btn warning\" id=\"exitEditBtn\" style=\"display:none\">\n              <ha-icon icon=\"mdi:exit-run\"></ha-icon>\n              <span>Exit edit mode</span>\n            </button>\n            <span class=\"store-badge\" id=\"storeBadge\" title=\"where layout is persisted\">storage: local</span>\n          </div>\n          <div class=\"ddc-tabs\" id=\"tabsBar\" style=\"display:none\"></div>\n          <div class=\"card-container\" id=\"cardContainer\"></div>\n        </div>\n      `;\n      this.cardContainer = this.shadowRoot.querySelector('#cardContainer');\n      try { this._applyBackgroundImageFromConfig?.(); } catch {}\n      this.addButton     = this.shadowRoot.querySelector('#addCardBtn');\n      this.reloadBtn     = this.shadowRoot.querySelector('#reloadBtn');\n      this.diagBtn       = this.shadowRoot.querySelector('#diagBtn');\n      this.exitEditBtn   = this.shadowRoot.querySelector('#exitEditBtn');\n      this.storeBadge    = this.shadowRoot.querySelector('#storeBadge');\n      this.exportBtn     = this.shadowRoot.querySelector('#exportBtn');\n      this.importBtn     = this.shadowRoot.querySelector('#importBtn');\n      this.exploreBtn    = this.shadowRoot.querySelector('#exploreBtn'); \n      this.applyLayoutBtn= this.shadowRoot.querySelector('#applyLayoutBtn');\n      // Copy and Paste buttons (for edit mode)\n      this.copyBtn      = this.shadowRoot.querySelector('#copyBtn');\n      this.pasteBtn     = this.shadowRoot.querySelector('#pasteBtn');\n      this.settingsBtn  = this.shadowRoot.querySelector('#settingsBtn');\n      this.tabsBar      = this.shadowRoot.querySelector('#tabsBar');\n      this.rootEl       = this.shadowRoot.querySelector('.ddc-root');\n      try { this._renderTabs(); this._applyActiveTab(); } catch {}\n     \n\n      this._applyGridVars();\n      \n      this.addButton.addEventListener('click', () => {\n        if (!this.editMode) this._toggleEditMode(true);\n        this._openCardManager();\n      });      \n      this.reloadBtn.addEventListener('click', () => this._initialLoad(true));\n      this.diagBtn.addEventListener('click', () => this._openDiagnostics());\n      this.exitEditBtn.addEventListener('click', () => this._toggleEditMode(false));\n      this.exportBtn.addEventListener('click', () => this._exportDesign());\n      this.importBtn.addEventListener('click', () => this._importDesign());\n      this.applyLayoutBtn.addEventListener('click', () => this._saveLayout(false));\n\n      // Wire up copy/paste handlers. Only enabled in edit mode; see _toggleEditMode.\n      if (this.copyBtn) this.copyBtn.addEventListener('click', () => this._copySelection());\n      if (this.pasteBtn) this.pasteBtn.addEventListener('click', () => this._pasteClipboard());\n\n      // Open the dashboard settings menu when settings button is clicked\n      if (this.settingsBtn) this.settingsBtn.addEventListener('click', () => this._openDashboardSettings());\n       // Ctrl/Cmd + S to Apply while in DDC edit mode\n       window.addEventListener('keydown', (e) => {\n         if (!this.editMode) return;\n         if ((e.ctrlKey || e.metaKey) && (e.key === 's' || e.key === 'S')) {\n           e.preventDefault();\n           this._saveLayout(false);\n         }\n    // Observe host size for auto scaling (legacy retention for compatibility)\n    if (!this.__ddcResizeObs && this.autoResizeCards) {\n      this.__ddcResizeObs = new ResizeObserver(() => this._applyAutoScale?.());\n      try { this.__ddcResizeObs.observe(this); } catch {}\n      try { this.__ddcResizeObs.observe(this.cardContainer); } catch {}\n      try { if (this.parentElement) this.__ddcResizeObs.observe(this.parentElement); } catch {}\n      try { if (this.offsetParent) this.__ddcResizeObs.observe(this.offsetParent); } catch {}\n      window.addEventListener('resize', this.__ddcOnWinResize = () => this._applyAutoScale?.());\n    }\n    // initial scale (legacy)\n    this._applyAutoScale?.();\n\n       });\n\n      this.exploreBtn.addEventListener('click', () =>\n        window.open('https://hads.smarti.dev/', '_blank', 'noopener,noreferrer')\n      );\n\n      // apply container sizing early\n      this._applyContainerSizingFromConfig(true);\n      this._applyAutoScale?.();\n      // Long-press on blank space (4s) to enter edit; Esc exits\n      this._installLongPressToEnterEdit();\n      this._startScaleWatch?.();\n\n      window.addEventListener('keydown', (e)=>{ if (e.key === 'Escape' && this.editMode) this._toggleEditMode(false);\n    // Observe host size for auto scaling\n    if (!this.__ddcResizeObs) {\n      this.__ddcResizeObs = new ResizeObserver(() => this._applyAutoScale?.());\n      this.__ddcResizeObs.observe(this);\n      this.__ddcResizeObs.observe(this.cardContainer);\n      window.addEventListener('resize', this.__ddcOnWinResize = () => this._applyAutoScale?.());\n    }\n    // initial scale\n    this._applyAutoScale?.();\n });\n\n      // selection interactions in container\n      this._installSelectionMarquee();\n      this.cardContainer.addEventListener('mousedown', (e) => {\n        if (!this.editMode) return;\n        if (e.target.closest('.card-wrapper')) return; // handled per-card\n        if (!e.shiftKey && !e.ctrlKey && !e.metaKey) this._clearSelection();\n      });\n    }\n\n    // Persist new option knobs into storage so next load matches the config.\n    // Skip while in HA\u2019s editor preview to avoid churn. Only queue save in edit mode (handled in _queueSave)\n    try { if (!this._isInHaEditorPreview()) this._queueSave('config-change'); } catch {}\n\n    this._updateStoreBadge();\n    if (this.cardContainer) this._toggleEditMode(false);\n\n    // Only rebuild from storage on first boot or when storage_key changes.\n    // For normal config tweaks, just reflow with the new options.\n   // Boot/rebuild logic\n    this.__cfgReady = true;\n    if (keyChanged && this.__booted) {\n      this._initialLoad(true);\n    } else if (!this.__booted && this.__probed) {\n      this.__booted = true;\n      this._initialLoad();\n    } else {\n      this._applyContainerSizingFromConfig(true);\n      this._applyAutoScale?.();\n      this._resizeContainer();\n    }\n  }\n\n  connectedCallback() {\n    try { this._applyHaChromeVisibility_?.(); } catch {}\n    if (!this.__keyHandlerBound) { this.__keyHandler = (e)=>this._onKeyDown_(e); window.addEventListener('keydown', this.__keyHandler); this.__keyHandlerBound = true; }\n    if (!this.__boundExitEdit) {\n      this.__boundExitEdit = () => this._toggleEditMode(false);\n    }\n    window.addEventListener('pagehide', this.__boundExitEdit);\n    window.addEventListener('beforeunload', this.__boundExitEdit);\n  \n    this.__onVis = () => { if (document.visibilityState === 'hidden') this._toggleEditMode(false); };\n    document.addEventListener('visibilitychange', this.__onVis);\n  \n    // NEW: ensure we never boot in edit mode\n    this._toggleEditMode(false);\n  \n\n// Ensure scale reapplies when the card becomes visible (e.g., after a tab switch)\nif (!this.__visObs) {\n  const io = new IntersectionObserver((entries) => {\n    if (entries.some(e => e.isIntersecting)) {\n      requestAnimationFrame(() => this._applyAutoScale && this._applyAutoScale());\n    }\n  }, { root: null, threshold: 0 });\n  io.observe(this);\n  this.__visObs = io;\n}\n\n// Also respond to window resizes\nthis.__ddcOnWinResize = this.__ddcOnWinResize || (() => this._applyAutoScale && this._applyAutoScale());\nwindow.addEventListener('resize', this.__ddcOnWinResize);\n\n    try { this.__ddcBindPointerListeners?.(); } catch {}\n}\n  \n  disconnectedCallback() {\n    try { this._setHeaderVisible_?.(true); this._setSidebarVisible_?.(true); } catch {}\n    try { this._applyHaChromeVisibility_?.(); } catch {}\n    if (this.__keyHandlerBound && this.__keyHandler) { window.removeEventListener('keydown', this.__keyHandler); this.__keyHandlerBound = false; this.__keyHandler = null; }\n    if (!this.__keyHandlerBound) { this.__keyHandler = (e)=>this._onKeyDown_(e); window.addEventListener('keydown', this.__keyHandler); this.__keyHandlerBound = true; }\n    window.removeEventListener('pagehide', this.__boundExitEdit);\n    window.removeEventListener('beforeunload', this.__boundExitEdit);\n    document.removeEventListener('visibilitychange', this.__onVis);\n\n    // cleanup observers\n    try { this.__ddcResizeObs?.disconnect(); } catch {}\n    this.__ddcResizeObs = null;\n\n    // stop scale watcher\n    this._stopScaleWatch?.();\n\n    // remove resize listener\n    if (this.__ddcOnWinResize) {\n      window.removeEventListener('resize', this.__ddcOnWinResize);\n      this.__ddcOnWinResize = null;\n    }\n\n    // NEW: remove long-press listeners if installed\n    if (this.__lpInstalled && this.__lpHandlers) {\n      const cont = this.cardContainer;\n      cont?.removeEventListener('mousedown', this.__lpHandlers.mouseDown);\n      window.removeEventListener('mousemove', this.__lpHandlers.mouseMove);\n      window.removeEventListener('mouseup', this.__lpHandlers.mouseUp);\n      window.removeEventListener('contextmenu', this.__lpHandlers.contextMenu);\n      cont?.removeEventListener('touchstart', this.__lpHandlers.touchStart);\n      window.removeEventListener('touchmove', this.__lpHandlers.touchMove);\n      window.removeEventListener('touchend', this.__lpHandlers.touchEnd);\n      window.removeEventListener('touchcancel', this.__lpHandlers.touchCancel);\n      this.__lpInstalled = false;\n      this.__lpHandlers = null;\n    }\n  \n\ntry { this.__visObs && this.__visObs.disconnect(); } catch(e) {}\nthis.__visObs = null;\nif (this.__ddcOnWinResize) {\n  window.removeEventListener('resize', this.__ddcOnWinResize);\n}\n\n    try {\n      if (this.__ddcPtrBound) {\n        this.removeEventListener('pointerdown', this.__onDDCPointerDown);\n        this.removeEventListener('pointermove', this.__onDDCPointerMove);\n        window.removeEventListener('pointerup', this.__onDDCPointerUp);\n        window.removeEventListener('pointercancel', this.__onDDCPointerUp);\n        this.__ddcPtrBound = false;\n      }\n    } catch {}\n}\n  \n\n  set hass(hass) {\n    this._hass = hass;\n    LOG('set hass');\n    if (!this.__probed && hass) {\n      this.__probed = true;\n      this._probeBackend().then(() => { \n        this.__probed = true; \n        if (!this.__booted && this.__cfgReady) { \n          this.__booted = true; \n          this._initialLoad(true); \n        } \n      });\n    }\n    \n    const wraps = this.cardContainer?.children || [];\n    for (const wrap of wraps) {\n      const c = wrap.firstElementChild;\n      if (c && c.hass !== hass) {\n        c.hass = hass;\n        // Don't reprocess card_mod here - it will be handled by _processCardModOnce\n      }\n    }\n\n    // After updating hass on all cards, re\u2011evaluate visibility so that state\n    // conditions are applied when not editing. Visibility is not applied during\n    // edit mode so that all cards remain visible while editing.\n    try { this._applyVisibility_(); } catch {}\n  }\n  \n  get hass() { return this._hass; }\n\n  /* ------------------------ Initial load / rebuild ------------------------ */\n  async _initialLoad(force = false) {\n    // prevent multiple parallel boots\n    if (this.__booting) return;\n    this.__booting = true;\n\n    try {\n      // mark loading in progress to prevent autosave during rebuild\n      this._loading = true;\n\n      if (force && this.cardContainer) {\n        this.cardContainer.innerHTML = '';\n      }\n\n      this._dbgPush('boot', 'Initial load start', { force });\n\n      const __rebuildAfter = [];\n      let saved = null;\n\n      // Try backend first if available\n      if (this._backendOK && this.storageKey) {\n        try {\n          saved = await this._loadLayoutFromBackend(this.storageKey);\n        } catch (e) {\n          this._dbgPush('boot', 'Backend load failed', { error: String(e) });\n        }\n      }\n\n      // Fallback: localStorage (and migrate to backend if possible)\n      if (!saved && this.storageKey) {\n        let local = null;\n        try {\n          local = JSON.parse(localStorage.getItem(`ddc_local_${this.storageKey}`) || 'null');\n        } catch {}\n        if (local) {\n          this._dbgPush('boot', 'Found local snapshot', { bytes: JSON.stringify(local).length });\n\n          if (this._backendOK) {\n            try {\n              await this._saveLayoutToBackend(this.storageKey, local);\n              this._dbgPush('boot', 'Migrated local -> backend');\n              saved = local;\n            } catch (e) {\n              this._dbgPush('boot', 'Migration failed, staying local', { error: String(e) });\n              saved = local;\n            }\n          } else {\n            saved = local;\n          }\n        }\n      }\n\n      // Fallback: embedded YAML config\n      if (!saved && this._config?.cards?.length) {\n        this._dbgPush('boot', 'Using embedded config');\n        saved = { cards: this._config.cards };\n      }\n\n      // Snapshot of YAML before we overlay anything\n      const yamlCfg = { ...(this._config || {}) };\n\n      // 1) Apply persisted options as baseline\n        if (saved?.options) {\n          const { storage_key, ...optsNoKey } = saved.options;\n          this._applyImportedOptions(optsNoKey, true);\n        } else if (typeof saved?.grid === 'number') {\n        this._applyImportedOptions({ grid: saved.grid }, true);\n      }\n\n      // 2) Overlay explicit YAML options (take precedence)\n      const overrideKeys = [\n        'storage_key','grid','drag_live_snap','auto_save','auto_save_debounce',\n        'container_background','card_background','debug','disable_overlap',\n        'container_size_mode','container_fixed_width','container_fixed_height',\n        'container_preset','container_preset_orientation','tabs','tabs_position','default_tab','hide_tabs_when_single', 'auto_resize_cards'\n      ];\n      const cfgOpts = {};\n      for (const k of overrideKeys) {\n        if (yamlCfg[k] !== undefined) cfgOpts[k] = yamlCfg[k];\n      }\n      if (Object.keys(cfgOpts).length) {\n        this._applyImportedOptions(cfgOpts, true);\n      }\n\n      // Build cards\n      let builtAny = false;\n\n      if (saved?.cards?.length) {\n        for (const conf of saved.cards) {\n          if (!conf?.card || (typeof conf.card === 'object' && Object.keys(conf.card).length === 0)) {\n            // empty/placeholder\n            const wrap = this._makePlaceholderAt(\n              conf.position?.x || 0,\n              conf.position?.y || 0,\n              conf.size?.width  || 200,\n              conf.size?.height || 200\n            );\n            this.cardContainer.appendChild(wrap);\n            try { this._rebuildOnce(wrap.firstElementChild); } catch {}\n            builtAny = true;\n            continue;\n          }\n\n          const cardEl = await this._createCard(conf.card);\n          const wrap = this._makeWrapper(cardEl);\n          if (this.editMode) wrap.classList.add('editing');\n          wrap.dataset.tabId = this._normalizeTabId(conf.tabId || conf.tab_id || this.defaultTab);\n\n          this._setCardPosition(wrap, conf.position?.x || 0, conf.position?.y || 0);\n          wrap.style.width  = `${conf.size?.width  ?? 14 * this.gridSize}px`;\n          wrap.style.height = `${conf.size?.height ?? 10 * this.gridSize}px`;\n          if (conf.z != null) wrap.style.zIndex = String(conf.z);\n\n          this.cardContainer.appendChild(wrap);\n\n          try { this._rebuildOnce(wrap.firstElementChild); } catch {}\n          this._initCardInteract(wrap);\n          builtAny = true;\n        }\n\n        this._resizeContainer();\n        this._applyAutoScale?.();\n        this._dbgPush('boot', 'Layout applied', { count: saved.cards.length });\n      }\n\n      if (!builtAny) {\n        this._showEmptyPlaceholder();\n        this._applyAutoScale?.();\n        this._dbgPush('boot', 'No saved layout found; showing placeholder');\n      }\n\n      this._updateStoreBadge();\n      this._syncEmptyStateUI();\n\n      // Ensure card-mod runs once after first paint\n      if (force) this._cardModProcessed = false;\n      setTimeout(() => {\n        this._processCardModOnce();\n      }, 100);\n\n      // Rebuild signals for nested cards\n      try {\n        __rebuildAfter.forEach((el) => {\n          try {\n            el.dispatchEvent(new Event('ll-rebuild', { bubbles: true, composed: true }));\n          } catch {}\n        });\n      } catch {}\n    } finally {\n      this._loading = false;\n      this.__booting = false;\n      this.__dirty = false;\n      this._updateApplyBtn?.();\n      try { this._renderTabs(); this._applyActiveTab(); } catch {}\n      // Reevaluate visibility after the layout has been built. Cards with\n      // visibility conditions will hide themselves when not in edit mode.\n      try { this._applyVisibility_(); } catch {}\n    }\n  }\n\n\n  \n  /* ------------------------------ Tabs support ------------------------------ */\n  _normalizeTabId(tabId) {\n    const valid = Array.isArray(this.tabs) ? this.tabs.map(t => t.id) : [];\n    if (!valid.length) return this.defaultTab || 'default';\n    return (tabId && valid.includes(tabId)) ? tabId : (this.defaultTab || valid[0]);\n  }\n  _renderTabs() {\n    const bar = this.tabsBar; if (!bar) return;\n    const tabs = Array.isArray(this.tabs) ? this.tabs : [];\n    if (!tabs.length || (tabs.length === 1 && this.hideTabsWhenSingle)) {\n      bar.style.display = 'none';\n      return;\n    }\n    bar.style.display = '';\n    bar.className = 'ddc-tabs ' + (this.tabsPosition === 'left' ? 'ddc-tabs-left' : '');\n    bar.innerHTML = '';\n    for (const t of tabs) {\n      const btn = document.createElement('button');\n      btn.className = 'ddc-tab' + (t.id === this.activeTab ? ' active' : '');\n      btn.dataset.tabId = t.id;\n      btn.title = t.label || t.id;\n      btn.innerHTML = `${t.icon ? `<ha-icon icon=\"${t.icon}\"></ha-icon>` : ''}<span class=\"ddc-tab-label\">${t.label ?? t.id}</span>`;\n      btn.addEventListener('click', () => {\n        if (this.activeTab !== t.id) {\n          this.activeTab = t.id;\n          try { localStorage.setItem(`ddc_lasttab_${this.storageKey}`, t.id); } catch {}\n          this._applyActiveTab();\n          this._renderTabs();\n          // Reapply visibility for the newly active tab. Visibility must be\n          // evaluated after switching tabs so cards with conditions are\n          // properly hidden when the tab becomes active.\n          try { this._applyVisibility_(); } catch {}\n        }\n      });\n      bar.appendChild(btn);\n    }\n    if (this.rootEl) this.rootEl.classList.toggle('ddc-tabs-left-layout', this.tabsPosition === 'left');\n  \n    try { this._updateTabsA11y_?.(); } catch {}\n\n    // After rendering tabs, ensure the bar width matches the visible\n    // card container width (scaled or unscaled). Without syncing the width,\n    // the tabs could stretch to the full page width instead of aligning\n    // with the drag-and-drop container.\n    try { this._syncTabsWidth_?.(); } catch {}\n  }\n  _applyActiveTab() {\n    const current = this._normalizeTabId(this.activeTab);\n    const wraps = this.cardContainer?.querySelectorAll?.('.card-wrapper') || [];\n    wraps.forEach(w => {\n      const tabId = w.dataset.tabId ? this._normalizeTabId(w.dataset.tabId) : this.defaultTab;\n      if (!this.tabs || !this.tabs.length) {\n        w.style.display = '';\n        w.inert = false;\n        w.classList.remove('ddc-hidden');\n        return;\n      }\n      if (tabId === current) {\n        w.style.display = '';\n        w.inert = false;\n        w.classList.remove('ddc-hidden');\n      } else {\n        w.style.display = 'none';\n        w.inert = true;\n        w.classList.add('ddc-hidden');\n        w.classList.remove('ddc-selected');\n      \n    // apply or clear scaling per mode\n    this._applyAutoScale?.();\n  }\n    });\n    try { this._clearSelection(); } catch {}\n    // When card animations are enabled, animate visible cards after switching tabs\n    try {\n      if (this.animateCards) {\n        this._animateCards?.();\n      }\n    } catch {}\n  }\n\n  /**\n   * Animate all visible card wrappers. When the animateCards flag is true\n   * this method is invoked after switching tabs or on initial load. It\n   * iterates over each wrapper that is currently displayed and applies\n   * a CSS class that triggers a short fly\u2011in animation. The class is\n   * removed once the animation completes so subsequent tab switches can\n   * retrigger the animation. Hidden wrappers (display: none) are skipped.\n   */\n  _animateCards() {\n    try {\n      const wraps = this.cardContainer?.querySelectorAll?.('.card-wrapper') || [];\n      wraps.forEach((w) => {\n        // Skip hidden cards. If a wrapper is not visible, don't animate it.\n        const style = window.getComputedStyle ? window.getComputedStyle(w) : null;\n        const isHidden = (w.style.display === 'none') || (style && style.display === 'none') || w.classList.contains('ddc-hidden');\n        if (isHidden) return;\n        // Compute the current transform so we can append our fly\u2011in offset\n        const computed = window.getComputedStyle(w);\n        const initialTransform = (computed && computed.transform && computed.transform !== 'none') ? computed.transform : '';\n        // Build keyframes that animate opacity and translateY without overriding\n        // the existing translate3d applied by the layout. We append our offset\n        // to the current transform so the card flies up from its natural position.\n        const frames = [\n          { opacity: 0, transform: `${initialTransform} translateY(12px)` },\n          { opacity: 1, transform: `${initialTransform}` }\n        ];\n        // Use the Web Animations API to play the animation. The default fill\n        // mode leaves the underlying transform intact once the animation ends.\n        try {\n          w.animate(frames, {\n            duration: 300,\n            easing: 'cubic-bezier(0.4, 0, 0.2, 1)',\n            fill: 'none'\n          });\n        } catch {\n          // Some browsers might not support animate(); if so, fall back to opacity\n          w.style.opacity = '0';\n          requestAnimationFrame(() => {\n            w.style.transition = 'opacity .3s ease';\n            w.style.opacity = '1';\n          });\n        }\n      });\n    } catch (e) {\n      // Suppress errors to avoid breaking the card when animations fail\n      console.warn('[ddc:animate] animation error', e);\n    }\n  }\n  _addTabSelectorToChip(wrapper, entryTabId = null) {\n    if (!this.tabs || !this.tabs.length) return;\n    const chip = wrapper.querySelector('.chip'); if (!chip) return;\n    let sel = chip.querySelector('select.ddc-chip-tab');\n    if (!sel) {\n      sel = document.createElement('select');\n      sel.className = 'ddc-chip-tab';\n      sel.style.marginLeft = '6px';\n      sel.title = 'Assign to tab';\n      chip.appendChild(sel);\n    }\n    sel.innerHTML = '';\n    for (const t of this.tabs) {\n      const opt = document.createElement('option');\n      opt.value = t.id; opt.textContent = t.label || t.id;\n      sel.appendChild(opt);\n    }\n    const cur = this._normalizeTabId(entryTabId || wrapper.dataset.tabId || this.activeTab || this.defaultTab);\n    sel.value = cur;\n    wrapper.dataset.tabId = cur;\n    sel.onchange = () => {\n      wrapper.dataset.tabId = this._normalizeTabId(sel.value);\n      this._applyActiveTab();\n      // Reapply visibility so conditions evaluate in the new tab context.\n      try { this._applyVisibility_(); } catch {}\n      try { this._queueSave('tab-change'); } catch {}\n    };\n  }\n/* ------------------------------ Edit mode ------------------------------ */\n  _toggleEditMode(force=null) {\n    // NEW: kill any in-flight \u201Center edit\u201D timer \n    try { this.__clearPressTimer?.(); } catch {}\n    const entering = (force === null) ? !this.editMode : !!force;\n    const wasOff = !this.editMode && entering;\n  \n    this.editMode = entering;\n\n    this.editMode = entering;\n    this.addButton.style.display   = this.editMode ? 'inline-block' : 'none';\n    this.reloadBtn.style.display   = this.editMode ? 'inline-block' : 'none';\n    this.diagBtn.style.display     = this.editMode ? 'inline-block' : 'none';\n    this.exitEditBtn.style.display = this.editMode ? 'inline-block' : 'none';\n    this.exportBtn.style.display   = this.editMode ? 'inline-block' : 'none';\n    this.importBtn.style.display   = this.editMode ? 'inline-block' : 'none';\n    this.exploreBtn.style.display  = this.editMode ? 'inline-block' : 'none';\n    this.storeBadge.style.display  = this.editMode ? 'inline-block' : 'none';\n    this.applyLayoutBtn.style.display = this.editMode ? 'inline-block' : 'none';\n    // Show copy/paste only during editing\n    if (this.copyBtn)  this.copyBtn.style.display  = this.editMode ? 'inline-block' : 'none';\n    if (this.pasteBtn) this.pasteBtn.style.display = this.editMode ? 'inline-block' : 'none';\n    if (this.settingsBtn) this.settingsBtn.style.display = this.editMode ? 'inline-block' : 'none';\n    this._syncEmptyStateUI();\n    \n    this.cardContainer.classList.toggle('grid-on', this.editMode);\n\n    const wraps = this.cardContainer.querySelectorAll('.card-wrapper');\n    wraps.forEach((w) => {\n      w.classList.toggle('editing', this.editMode);\n      const handle = w.querySelector('.resize-handle');\n      if (handle) handle.style.display = this.editMode ? 'flex' : 'none';\n      if (!w.dataset.placeholder && window.interact) {\n        window.interact(w).draggable(this.editMode).resizable(this.editMode);\n      }\n      w.style.touchAction = this.editMode ? 'none' : 'auto';\n    });\n    if (!this.editMode) this._clearSelection();\n\n    if (!this.editMode) {\n      // clear any stale dragging classes\n      this.cardContainer?.querySelectorAll('.card-wrapper.dragging')\n        .forEach(w => w.classList.remove('dragging'));\n    }\n\n    // Play ripple when switching ON\n    if (wasOff) {\n      // center by default, unless last hold coords known\n      const ox = this.__lastHoldX ?? null;\n      const oy = this.__lastHoldY ?? null;\n      this._playEditRipple(ox, oy);\n    }\n  \n    try { this._applyHaChromeVisibility_?.(); } catch {}\n  }\n\n  _isInHaEditorPreview() {\n    // Walk up through parents and shadow hosts to detect HA's edit/preview dialog\n    let n = this;\n    while (n) {\n      const tag = (n.nodeType === 1 && n.localName) ? n.localName.toLowerCase() : '';\n      if (tag === 'hui-card-editor' || tag === 'hui-dialog-edit-card' || tag === 'hui-card-preview') return true;\n      if (tag === 'ha-dialog' || tag === 'mwc-dialog') return true; // general HA dialogs (edit card, more-info, etc.)\n      const root = n.getRootNode && n.getRootNode();\n      n = n.parentElement || (root && root.host) || null;\n    }\n    return false;\n  }\n\n  // Replace your _installLongPressToEnterEdit with this version:\n  /* 2) Install long-press ONCE, keep handles so we can remove them later */\n  // Replace your existing _installLongPressToEnterEdit() with this:\n// Robust, pointer-events-based long-press to enter edit mode\n_installLongPressToEnterEdit() {\n  if (this.__lpInstalled) return;\n  this.__lpInstalled = true;\n\n  const cont = this.cardContainer;\n  if (!cont) return;\n\n  // Tunables\n  const HOLD_MS  = 800;  // how long to hold\n  const DRIFT_PX = 18;   // cancel if the pointer drifts more than this\n\n  // ---- helpers ------------------------------------------------------------\n  const isElem = (n) => !!n && typeof n === 'object' && n.nodeType === 1; // Element node\n  const containsSafe = (root, node) => {\n    try { return !!(root && node && typeof root.contains === 'function' && isElem(node) && root.contains(node)); }\n    catch { return false; }\n  };\n  const within = (el) => containsSafe(this.cardContainer, el);\n\n  const isOverCard = (ev) => {\n    // 1) Fast path via target.closest\n    const hit = ev.target?.closest?.('.card-wrapper');\n    if (isElem(hit) && within(hit) && !hit.classList.contains('ddc-placeholder')) return true;\n\n    // 2) Robust path via composedPath() (skip non-Elements like window/document)\n    const path = typeof ev.composedPath === 'function' ? ev.composedPath() : [];\n    for (const n of path) {\n      if (!isElem(n)) continue;\n      if (!within(n)) continue;\n      if (n.classList?.contains('card-wrapper') && !n.classList.contains('ddc-placeholder')) return true;\n    }\n    return false;\n  };  \n\n  const makeRing = (x, y) => {\n    const el = document.createElement('div');\n    el.className = 'ddc-press-ring';\n    document.body.appendChild(el); // ensure always visible\n    Object.assign(el.style, {\n      position: 'fixed', left: `${x}px`, top: `${y}px`,\n      zIndex: '100000', width: '44px', height: '44px',\n      pointerEvents: 'none', marginLeft: '-22px', marginTop: '-22px',\n      filter: 'drop-shadow(0 2px 6px rgba(0,0,0,.35))'\n    });\n    el.innerHTML = `\n      <svg viewBox=\"0 0 44 44\" aria-hidden=\"true\" style=\"width:44px;height:44px\">\n        <circle cx=\"22\" cy=\"22\" r=\"18\" style=\"stroke:rgba(255,255,255,.45);stroke-width:4;fill:none\"></circle>\n        <circle class=\"pr-fg\" cx=\"22\" cy=\"22\" r=\"18\" style=\"stroke:var(--primary-color);stroke-width:4;fill:none;stroke-linecap:round\"></circle>\n        <circle cx=\"22\" cy=\"22\" r=\"2\" style=\"fill:var(--primary-color);opacity:.95\"></circle>\n      </svg>`;\n    const fg = el.querySelector('.pr-fg');\n    const r = 18, circ = 2 * Math.PI * r;\n    fg.style.strokeDasharray = `${circ}`;\n    fg.style.strokeDashoffset = `${circ}`;\n    requestAnimationFrame(() => {\n      fg.style.transition = `stroke-dashoffset ${HOLD_MS}ms linear`;\n      fg.style.strokeDashoffset = '0';\n    });\n    return {\n      el,\n      move(nx, ny) { el.style.left = `${nx}px`; el.style.top = `${ny}px`; },\n      remove() { try { el.remove(); } catch {} }\n    };\n  };  \n\n  // ---- state --------------------------------------------------------------\n  let timer = null;\n  let ring  = null;\n  let startX = 0, startY = 0;\n  let activePointerId = null;\n\n  const clearTimer = () => { if (timer) clearTimeout(timer); timer = null; ring?.remove(); ring = null; };\n  this.__clearPressTimer = clearTimer; // allow external cancel on mode changes\n\n\n  \n  // ---- handlers -----------------------------------------------------------\n  const onPointerDown = (e) => {\n    // Left mouse / primary touch only\n    if (e.pointerType === 'mouse' && e.button !== 0) return;\n    if (this._isInHaEditorPreview()) return;\n\n    // Only trigger on empty space *within this container*\n    if (!within(e.target) || isOverCard(e)) return;\n\n    activePointerId = e.pointerId;\n    startX = e.clientX; startY = e.clientY;\n    this.__lastHoldX = startX; this.__lastHoldY = startY;\n\n    // visual progress ring\n    ring = makeRing(startX, startY);\n\n    timer = setTimeout(() => {\n      clearTimer();\n      const toState = !this.editMode;\n      this._toggleEditMode(toState);\n      this._toast?.(`Edit mode ${toState ? 'enabled' : 'disabled'}`);\n    }, HOLD_MS);\n  };\n\n  const onPointerMove = (e) => {\n    if (timer == null || e.pointerId !== activePointerId) return;\n    ring?.move(e.clientX, e.clientY);\n    if (Math.abs(e.clientX - startX) > DRIFT_PX || Math.abs(e.clientY - startY) > DRIFT_PX) {\n      clearTimer();\n    }\n  };\n\n  const onPointerUpOrCancel = (e) => {\n    if (e.pointerId !== activePointerId) return;\n    clearTimer();\n    activePointerId = null;\n  };\n\n  const onContextMenu = (e) => {\n    // prevent the OS context menu *only while* long-press is pending\n    if (timer) { e.preventDefault(); e.stopPropagation(); return false; }\n  };\n\n  const onDblClick = (e) => {\n    if (this._isInHaEditorPreview()) return;\n    if (!within(e.target) || isOverCard(e)) return;\n    const toState = !this.editMode;\n    this._toggleEditMode(toState);\n    this._toast?.(`Edit mode ${toState ? 'enabled' : 'disabled'}`);\n  };\n\n  // ---- wire up ------------------------------------------------------------\n  cont.addEventListener('pointerdown', onPointerDown);\n  window.addEventListener('pointermove', onPointerMove, { passive: true });\n  window.addEventListener('pointerup', onPointerUpOrCancel, { passive: true });\n  window.addEventListener('pointercancel', onPointerUpOrCancel, { passive: true });\n  window.addEventListener('contextmenu', onContextMenu);\n\n  cont.addEventListener('dblclick', onDblClick);\n\n  // keep references for clean-up in disconnectedCallback\n  this.__lpHandlers = { onPointerDown, onPointerMove, onPointerUpOrCancel, onContextMenu, onDblClick };\n}\n\n\n_isLayoutEmpty() {\n  const c = this.cardContainer;\n  if (!c) return true;\n  return c.querySelectorAll('.card-wrapper:not(.ddc-placeholder)').length === 0;\n}\n\n_syncEmptyStateUI() {\n  // Show Add button even outside edit mode when empty; style it as a CTA.\n  const empty = this._isLayoutEmpty();\n  if (this.addButton) {\n    const show = this.editMode || empty;\n    this.addButton.style.display = show ? 'inline-block' : 'none';\n    this.addButton.classList.toggle('cta-empty', !this.editMode && empty);\n  }\n\n  // Keep other toolbar buttons hidden unless we\u2019re in edit mode\n  const toggle = (el) => el && (el.style.display = this.editMode ? 'inline-block' : 'none');\n  toggle(this.reloadBtn);\n  toggle(this.diagBtn);\n  toggle(this.exitEditBtn);\n  toggle(this.exportBtn);\n  toggle(this.importBtn);\n  toggle(this.exploreBtn);\n  toggle(this.storeBadge);\n  toggle(this.applyLayoutBtn);\n  }\n\n    _updateApplyBtn() {\n    if (this.applyLayoutBtn) this.applyLayoutBtn.disabled = !this.__dirty;\n  }\n  _markDirty(reason='') {\n    this.__dirty = true;\n    this._updateApplyBtn();\n    this._dbgPush?.('dirty', 'Marked dirty', { reason });\n  }\n\n  _playEditRipple(clientX=null, clientY=null) {\n    const cont = this.cardContainer;\n    if (!cont) return;\n    const r = cont.getBoundingClientRect();\n    const x = clientX == null ? (r.left + r.width/2) : clientX;\n    const y = clientY == null ? (r.top  + r.height/2) : clientY;\n    const localX = x - r.left;\n    const localY = y - r.top;\n\n    const veil = document.createElement('div');\n    veil.className = 'ddc-ripple-veil';\n    veil.style.setProperty('--rip-x', `${localX}px`);\n    veil.style.setProperty('--rip-y', `${localY}px`);\n    cont.appendChild(veil);\n    setTimeout(()=> veil.remove(), 450);\n  }\n\n  /* ------------------------- Drag/Resize via Interact ------------------------- */\n  _initInteract() {\n    const wraps = this.cardContainer.querySelectorAll('.card-wrapper');\n    wraps.forEach((w) => this._initCardInteract(w));\n  }\n  _initCardInteract(wrap) {\n    if (!window.interact || wrap.dataset.placeholder) return;\n    const gs = this.gridSize, live = !!this.dragLiveSnap;\n\n    // DRAG (supports multi\u2011select move with optional live snap)\n    const restrictMod = window.interact.modifiers.restrictRect({\n      restriction: 'parent',\n      endOnly: true\n    });\n    const mods = [restrictMod];\n\n    // When dragLiveSnap is true, use Interact\u2019s built\u2011in snap modifier so the pointer\n    // (and therefore the element) is snapped to the grid before your handler runs.\n    if (this.dragLiveSnap) {\n      const gridSnap = window.interact.snappers.grid({ x: this.gridSize, y: this.gridSize });\n      mods.push(window.interact.modifiers.snap({\n        targets: [gridSnap],\n        range: Infinity,\n        offset: 'startCoords'\n      }));\n    }\n\n    window.interact(wrap).draggable({\n      enabled: this.editMode,\n      inertia: false,\n      modifiers: mods,\n      listeners: {\n        start: (ev) => {\n          // ensure the clicked card is in the selection\n          if (!this._selection.has(wrap)) {\n            if (!ev?.shiftKey && !ev?.ctrlKey && !ev?.metaKey) this._clearSelection();\n            this._toggleSelection(wrap, true);\n          }\n          const group = Array.from(this._selection);\n          this.__groupDrag = {\n            leader: wrap,\n            members: group,\n            startRaw: new Map(group.map(w => [w, {\n              x: parseFloat(w.getAttribute('data-x-raw')) || parseFloat(w.getAttribute('data-x')) || 0,\n              y: parseFloat(w.getAttribute('data-y-raw')) || parseFloat(w.getAttribute('data-y')) || 0,\n              w: parseFloat(w.style.width)  || w.getBoundingClientRect().width,\n              h: parseFloat(w.style.height) || w.getBoundingClientRect().height,\n            }]))\n          };\n\n          // Capture original raw positions of all cards (non\u2011placeholders) so we can restore them\n          this.__collisionOriginals = new Map();\n          const allCardsStart = this.cardContainer.querySelectorAll('.card-wrapper:not(.ddc-placeholder)');\n          allCardsStart.forEach(c => {\n            const rawX = parseFloat(c.getAttribute('data-x-raw')) || parseFloat(c.getAttribute('data-x')) || 0;\n            const rawY = parseFloat(c.getAttribute('data-y-raw')) || parseFloat(c.getAttribute('data-y')) || 0;\n            this.__collisionOriginals.set(c, { x: rawX, y: rawY });\n          });\n\n          group.forEach(w => {\n            w.classList.add('dragging');\n            if (w.getAttribute('data-x-raw') === null) {\n              w.setAttribute('data-x-raw', w.getAttribute('data-x') || '0');\n            }\n            if (w.getAttribute('data-y-raw') === null) {\n              w.setAttribute('data-y-raw', w.getAttribute('data-y') || '0');\n            }\n          });\n        },\n\n        move: (ev) => {\n          if (!this.__groupDrag) return;\n          const gs   = this.gridSize;\n          const live = !!this.dragLiveSnap;\n          const lead = this.__groupDrag.leader;\n          const srL  = this.__groupDrag.startRaw.get(lead);\n\n          // Compute new raw leader coordinates using pointer delta\n          const curLeadX = (parseFloat(lead.getAttribute('data-x-raw')) || srL.x) + ev.dx;\n          const curLeadY = (parseFloat(lead.getAttribute('data-y-raw')) || srL.y) + ev.dy;\n          const dxLead   = curLeadX - srL.x;\n          const dyLead   = curLeadY - srL.y;\n\n          // Build proposed positions for all selected cards\n          const proposed = this.__groupDrag.members.map(m => {\n            const sr = this.__groupDrag.startRaw.get(m);\n            const rawX  = sr.x + dxLead;\n            const rawY  = sr.y + dyLead;\n            const snapX = live ? Math.round(rawX / gs) * gs : rawX;\n            const snapY = live ? Math.round(rawY / gs) * gs : rawY;\n            return { el: m, rawX, rawY, snapX, snapY, w: sr.w, h: sr.h };\n          });\n\n          // If overlap protection is on, restore other cards and push them out of the way\n          if (this.disableOverlap) {\n            this._pushCardsOutOfTheWay(proposed, dxLead, dyLead, live, gs);\n          }\n\n          // Commit the move: update raw coordinates and apply snapped transform\n          lead.setAttribute('data-x-raw', String(curLeadX));\n          lead.setAttribute('data-y-raw', String(curLeadY));\n          for (const pr of proposed) {\n            pr.el.setAttribute('data-x-raw', String(pr.rawX));\n            pr.el.setAttribute('data-y-raw', String(pr.rawY));\n            this._setCardPosition(pr.el, pr.snapX, pr.snapY);\n          }\n          this._resizeContainer();\n        },\n\n        end: (ev) => {\n          if (!this.__groupDrag) return;\n          const gs = this.gridSize;\n\n          // Gather final positions (unsnapped and snapped) for the dragged group\n          const endRects = this.__groupDrag.members.map(m => {\n            const rawX = parseFloat(m.getAttribute('data-x-raw')) || parseFloat(m.getAttribute('data-x')) || 0;\n            const rawY = parseFloat(m.getAttribute('data-y-raw')) || parseFloat(m.getAttribute('data-y')) || 0;\n            const snapX = Math.round(rawX / gs) * gs;\n            const snapY = Math.round(rawY / gs) * gs;\n            const w  = parseFloat(m.style.width)  || m.getBoundingClientRect().width;\n            const h  = parseFloat(m.style.height) || m.getBoundingClientRect().height;\n            return { el: m, rawX, rawY, snapX, snapY, w, h };\n          });\n\n          // On end, do a final restore/push to prevent leftover overlaps\n          if (this.disableOverlap) {\n            this._pushCardsOutOfTheWay(endRects, 0, 0, false, gs);\n          }\n\n          // Snap cards to the grid and update raw coordinates\n          for (const pr of endRects) {\n            this._setCardPosition(pr.el, pr.snapX, pr.snapY);\n            pr.el.setAttribute('data-x-raw', String(pr.snapX));\n            pr.el.setAttribute('data-y-raw', String(pr.snapY));\n          }\n\n          // Cleanup\n          for (const m of this.__groupDrag.members) m.classList.remove('dragging');\n          this._resizeContainer();\n          if (this._isContainerFixed()) this._clampAllCardsInside();\n          this._queueSave(this.__groupDrag.members.length > 1 ? 'group-drag-end' : 'drag-end');\n          this.__groupDrag = null;\n          this.__collisionOriginals = null;\n        }\n      }\n    });\n\n\n\n    // RESIZE \u2014 bottom-right handle only (single card)\n    window.interact(wrap).resizable({\n      enabled: this.editMode,\n      edges: { right: '.resize-handle', bottom: '.resize-handle' },\n      inertia:false,\n      listeners:{\n        move:(ev)=>{\n          const gs   = this.gridSize;\n          const live = !!this.dragLiveSnap;\n          const curW = parseFloat(wrap.style.width)  || wrap.getBoundingClientRect().width;\n          const curH = parseFloat(wrap.style.height) || wrap.getBoundingClientRect().height;\n    \n          let {width, height} = ev.rect;\n          const wTry = live ? Math.max(gs, Math.round(width/gs)*gs) : width;\n          const hTry = live ? Math.max(gs, Math.round(height/gs)*gs) : height;\n        \n          const x = parseFloat(wrap.getAttribute('data-x')) || 0;\n          const y = parseFloat(wrap.getAttribute('data-y')) || 0;\n        \n          // \u2B07\uFE0F clamp size if container is fixed\n          let nextW = wTry;\n          let nextH = hTry;\n          if (this._isContainerFixed()) {\n            const { w: cw, h: ch } = this._getContainerSize();\n            nextW = Math.min(wTry, Math.max(this.gridSize, cw - x));\n            nextH = Math.min(hTry, Math.max(this.gridSize, ch - y));\n          }\n        \n          const proposed = [ this._rectFor(wrap, x, y, nextW, nextH) ];\n        \n          if (this.disableOverlap && this._anyCollisionFor(proposed, new Set([wrap]))) {\n            return;\n          }\n          wrap.style.width  = `${nextW}px`;\n          wrap.style.height = `${nextH}px`;\n          this._resizeContainer();\n        },\n        end:()=>{\n          const gs = this.gridSize;\n          const prevW = parseFloat(wrap.style.width)  || wrap.getBoundingClientRect().width;\n          const prevH = parseFloat(wrap.style.height) || wrap.getBoundingClientRect().height;\n        \n          let wSnap = Math.max(gs, Math.round(prevW/gs)*gs);\n          let hSnap = Math.max(gs, Math.round(prevH/gs)*gs);\n        \n          const x = parseFloat(wrap.getAttribute('data-x')) || 0;\n          const y = parseFloat(wrap.getAttribute('data-y')) || 0;\n        \n          // \u2B07\uFE0F clamp snapped size if container is fixed\n          if (this._isContainerFixed()) {\n            const { w: cw, h: ch } = this._getContainerSize();\n            wSnap = Math.min(wSnap, Math.max(gs, cw - x));\n            hSnap = Math.min(hSnap, Math.max(gs, ch - y));\n          }\n        \n          const proposed = [ this._rectFor(wrap, x, y, wSnap, hSnap) ];\n        \n          if (this.disableOverlap && this._anyCollisionFor(proposed, new Set([wrap]))) {\n            // keep pre-snap size (already applied)\n          } else {\n            wrap.style.width  = `${wSnap}px`;\n            wrap.style.height = `${hSnap}px`;\n          }\n        \n          this._resizeContainer();\n          if (this._isContainerFixed()) this._clampAllCardsInside();   // optional safety\n          this._queueSave('resize-end');\n        }\n      }\n    });\n\n    // selection with clicks\n    wrap.addEventListener('mousedown', (e) => {\n      if (!this.editMode) return;\n      // Ignore clicks on controls: resize handle, delete handle, or chip actions\n      if (e.target.closest('.resize-handle') || e.target.closest('.delete-handle') || e.target.closest('.chip')) return;\n      if (e.shiftKey || e.ctrlKey || e.metaKey) {\n        e.stopPropagation();\n        this._toggleSelection(wrap); // toggle in multi\n      } else {\n        if (!this._selection.has(wrap)) {\n          this._clearSelection();\n          this._toggleSelection(wrap, true);\n        }\n      }\n    });\n  }\n\n  /* ------------------------ Card creation & wrapper ------------------------ */\n  async _createCard(cfg) {\n    const helpers = (await this._helpersPromise) || await window.loadCardHelpers();\n    const el = helpers.createCardElement(cfg);\n    el.hass = this.hass;\n    \n    // Special handling for mod-card\n    if (cfg.type === 'custom:mod-card') {\n      // mod-card needs to be fully initialized before we can work with it\n      await new Promise(resolve => setTimeout(resolve, 0));\n      \n      // Force mod-card to apply its styles\n      if (el.setConfig && typeof el.setConfig === 'function') {\n        try {\n          // Re-apply config to ensure mod-card processes it\n          el.setConfig(cfg);\n        } catch {}\n      }\n    }\n    \n    return el;\n  }\n\n  _makeWrapper(cardEl) {\n    const wrap = document.createElement('div');\n    wrap.classList.add('card-wrapper');\n    wrap.dataset.tabId = this._normalizeTabId(this.activeTab || this.defaultTab);\n    if (this.editMode) wrap.classList.add('editing');\n    if (!wrap.style.zIndex) wrap.style.zIndex = String(this._highestZ() + 1);\n\n    const chip = document.createElement('div');\n    chip.className = 'chip';\n    chip.innerHTML = `\n      <button class=\"mini\" data-act=\"edit\" title=\"Edit\" aria-label=\"Edit\">\n        <ha-icon icon=\"mdi:pencil\"></ha-icon><span>Edit</span>\n      </button>\n      <button class=\"mini\" data-act=\"duplicate\" title=\"Duplicate\" aria-label=\"Duplicate\">\n        <ha-icon icon=\"mdi:content-copy\"></ha-icon><span>Duplicate</span>\n      </button>\n      <button class=\"mini pill\" data-act=\"front\" title=\"Bring forward\" aria-label=\"Bring forward\">\n        <ha-icon icon=\"mdi:arrange-bring-forward\"></ha-icon>\n      </button>\n      <button class=\"mini pill\" data-act=\"back\" title=\"Send backward\" aria-label=\"Send backward\">\n        <ha-icon icon=\"mdi:arrange-send-backward\"></ha-icon>\n      </button>\n      <button class=\"mini pill\" data-act=\"front-most\" title=\"Bring to front\" aria-label=\"Bring to front\">\n        <ha-icon icon=\"mdi:arrange-bring-to-front\"></ha-icon>\n      </button>\n      <button class=\"mini pill\" data-act=\"back-most\" title=\"Send to back\" aria-label=\"Send to back\">\n        <ha-icon icon=\"mdi:arrange-send-to-back\"></ha-icon>\n      </button>\n    `;\n\n    // Create a dedicated delete handle that sits in the top\u2011left corner. This\n    // replaces the delete button in the chip and mimics the resize handle in\n    // style. Clicking it will remove the card (or multiple cards if a group\n    // selection exists).\n    const delHandle = document.createElement('div');\n    delHandle.className = 'delete-handle';\n    delHandle.innerHTML = `<ha-icon icon=\"mdi:close-thick\"></ha-icon>`;\n    delHandle.addEventListener('click', (e) => {\n      e.stopPropagation();\n      // When multiple cards are selected and the current wrapper is among them,\n      // delete all selected cards. Otherwise delete just this wrapper.\n      if (this._selection.size > 1 && this._selection.has(wrap)) {\n        const toDel = Array.from(this._selection);\n        toDel.forEach(w => w.remove());\n        this._clearSelection();\n        this._resizeContainer();\n        this._queueSave('delete-multi');\n        this._ensurePlaceholderIfEmpty?.();\n      } else {\n        wrap.remove();\n        this._resizeContainer();\n        this._queueSave('delete');\n        this._ensurePlaceholderIfEmpty?.();\n      }\n    });\n\n    // Tab selector UI\n    try { this._addTabSelectorToChip(wrap, wrap.dataset.tabId); } catch {}\n\n    chip.addEventListener('click', async (e) => {\n      e.stopPropagation();\n      const act = e.target?.closest('button')?.dataset?.act; if (!act) return;\n\n      if (act === 'delete') {\n        if (this._selection.size > 1 && this._selection.has(wrap)) {\n          const toDel = Array.from(this._selection);\n          toDel.forEach(w => w.remove());\n          this._clearSelection();\n          this._resizeContainer(); this._queueSave('delete-multi'); this._ensurePlaceholderIfEmpty();\n        } else {\n          wrap.remove(); this._resizeContainer(); this._queueSave('delete'); this._ensurePlaceholderIfEmpty();\n        }\n      } else if (act === 'duplicate' || act === 'copy') {\n        const targets = (this._selection.size > 1 && this._selection.has(wrap)) ? Array.from(this._selection) : [wrap];\n        for (const t of targets) {\n          const cfg = this._extractCardConfig(t.firstElementChild) || {};\n          const dup = await this._createCard(cfg);\n          const w2 = this._makeWrapper(dup);\n          w2.style.width  = t.style.width;\n          w2.style.height = t.style.height;\n          const x = (parseFloat(t.getAttribute('data-x')) || 0) + this.gridSize;\n          const y = (parseFloat(t.getAttribute('data-y')) || 0) + this.gridSize;\n          this._setCardPosition(w2, x, y);\n          w2.style.zIndex = String(this._highestZ() + 1);\n          // Preserve the tab assignment from the original wrapper so that\n          // duplicates appear in the correct tab rather than defaulting to\n          // the currently active tab. See bug #3.\n          try {\n            const tid = t.dataset?.tabId;\n            if (tid) w2.dataset.tabId = tid;\n          } catch {}\n          this.cardContainer.appendChild(w2);\n          // Attach a tab selector to the duplicated wrapper so the user can\n          // reassign it later; pass the current tab so the selector defaults\n          // correctly.\n          try { this._addTabSelectorToChip?.(w2, w2.dataset.tabId); } catch {}\n          try { this._rebuildOnce(w2.firstElementChild); } catch {}\n          this._initCardInteract(w2);\n        }\n        this._resizeContainer();\n        this._queueSave('duplicate');\n      } else if (act === 'front') {\n        // Bring forward by one layer\n        this._adjustZ(wrap, +1);\n      } else if (act === 'back')  {\n        // Send backward by one layer\n        this._adjustZ(wrap, -1);\n      } else if (act === 'front-most') {\n        // Bring selected card(s) to the very front (highest z-index)\n        const targets = (this._selection.size > 1 && this._selection.has(wrap)) ? Array.from(this._selection) : [wrap];\n        // Sort targets by current z-index ascending so their relative order is maintained when moving to top\n        targets.sort((a, b) => {\n          const za = parseInt(a.style.zIndex || '1', 10);\n          const zb = parseInt(b.style.zIndex || '1', 10);\n          return za - zb;\n        });\n        let base = this._highestZ();\n        for (const w of targets) {\n          base += 1;\n          w.style.zIndex = String(base);\n        }\n        this._queueSave('z-change');\n      } else if (act === 'back-most') {\n        // Send selected card(s) to the very back (lowest z-index)\n        const targets = (this._selection.size > 1 && this._selection.has(wrap)) ? Array.from(this._selection) : [wrap];\n        // Sort targets by current z-index descending so their relative order is maintained when moving to bottom\n        targets.sort((a, b) => {\n          const za = parseInt(a.style.zIndex || '1', 10);\n          const zb = parseInt(b.style.zIndex || '1', 10);\n          return zb - za;\n        });\n        // Determine the current minimum z-index among all cards\n        let minZ = Infinity;\n        this.cardContainer.querySelectorAll('.card-wrapper').forEach(w => {\n          const z = parseInt(w.style.zIndex || '1', 10);\n          if (z < minZ) minZ = z;\n        });\n        if (!isFinite(minZ)) minZ = 1;\n        let baseMin = minZ;\n        for (const w of targets) {\n          baseMin -= 1;\n          w.style.zIndex = String(Math.max(1, baseMin));\n        }\n        this._queueSave('z-change');\n      } else if (act === 'edit') {\n        const cfg = this._extractCardConfig(wrap.firstElementChild) || {};\n        await this._openSmartPicker('edit', cfg, async (newCfg) => {\n          const oldEl = wrap.firstElementChild;\n          const newEl = await this._createCard(newCfg);\n\n          // persist cfg on wrapper (and card-mod flag if you use it)\n          try {\n            wrap.dataset.cfg = JSON.stringify(newCfg);\n            if (this._hasCardModDeep?.(newCfg)) wrap.dataset.needsCardMod = 'true';\n            else delete wrap.dataset.needsCardMod;\n          } catch {}\n\n          // swap the element\n          wrap.replaceChild(newEl, oldEl);\n\n          // ensure connected before driving updates (important for Lit cards)\n          await raf();\n          try {\n            newEl.hass = this.hass;\n            newEl.requestUpdate?.();\n            if (newEl.updateComplete) { try { await newEl.updateComplete; } catch {} }\n          } catch {}\n\n          try { this._rebuildOnce(newEl); } catch {}\n          try { newEl.dispatchEvent(new Event('ll-rebuild', { bubbles: true, composed: true })); } catch {}\n\n          this._resizeContainer?.();\n\n          // SAVE -> THEN HARD RELOAD (avoid debounce race)\n          try {\n            clearTimeout(this._saveTimer);           // cancel debounced save\n            await this._saveLayout(true);            // flush save now\n          } catch (e) { console.warn('Save before reload failed', e); }\n\n          window.location.reload();                  // force refresh so edited card appears\n        });\n      }\n    });\n\n    // ADD THE MISSING SHIELD ELEMENT\n    const shield = document.createElement('div');\n    shield.className = 'shield';\n\n    // ADD THE MISSING HANDLE ELEMENT\n    const handle = document.createElement('div');\n    handle.classList.add('resize-handle');\n    if (!this.editMode) handle.style.display = 'none';  // hide handle if not editing\n    handle.title = 'Resize';\n    handle.innerHTML = `<ha-icon icon=\"mdi:resize-bottom-right\"></ha-icon>`;\n\n    // cache the card config on the wrapper\n    try {\n      const cfg = cardEl._config || cardEl.config;\n      if (cfg && typeof cfg === 'object' && Object.keys(cfg).length) {\n        wrap.dataset.cfg = JSON.stringify(cfg);\n        \n        // Mark if this needs card_mod processing\n        if (this._hasCardModDeep(cfg)) { wrap.dataset.needsCardMod = 'true'; }\n      }\n    } catch {}\n\n    // include the delete handle before the resize handle so it appears beneath it in the DOM\n    wrap.append(cardEl, shield, chip, delHandle, handle);\n    // DDC patch: trigger one-time rebuild so nested card_mod attaches\n    try { this._rebuildOnce(cardEl); } catch {}\n    return wrap;\n  }\n\n  _makePlaceholderAt(x=0,y=0,w=400,h=400) {\n    const wrap = document.createElement('div');\n    wrap.classList.add('card-wrapper','ddc-placeholder');\n    wrap.dataset.placeholder = '1';\n    if (this.editMode) wrap.classList.add('editing');\n    this._setCardPosition(wrap, x, y);\n    wrap.style.width = `${w}px`;\n    wrap.style.height = `${h}px`;\n    wrap.style.zIndex = String(this._highestZ() + 1);\n  \n    const inner = document.createElement('div');\n    inner.className = 'ddc-placeholder-inner';\n    // purely decorative; nothing clickable\n    inner.setAttribute('aria-hidden','true');\n\n    // --- Hero UI (image + text) ---\n    const hero = document.createElement('div');\n    hero.className = 'ddc-hero';\n\n    // Optional image: from config.hero_image (e.g. /local/dragdrop-hero.png)\n    // If not provided, this block simply won\u2019t render an <img>.\n    const heroImgUrl = this.heroImage; // already set to default or config override\n    if (heroImgUrl) {\n      const img = document.createElement('img');\n      img.src = heroImgUrl;\n      img.alt = \"\";\n      hero.appendChild(img);\n    }\n\n    // Title + subtitle\n    const title = document.createElement('div');\n    title.className = 'ddc-title';\n    title.textContent = 'Drag & Drop Card';\n    const sub = document.createElement('div');\n    sub.className   = 'ddc-sub';\n    sub.textContent = 'Hold me / double click me to enter Edit mode';\n\n    hero.append(title, sub);\n    inner.appendChild(hero);\n\n    // Let users double-click anywhere on the placeholder to enter edit\n    wrap.addEventListener('dblclick', (e) => {\n      e.stopPropagation();\n      this._toggleEditMode(true);\n    });\n  \n    const shield = document.createElement('div');\n    shield.className = 'shield';\n  \n    wrap.append(inner, shield);\n    return wrap;\n  }\n\n    _processCardModOnce() {\n    // Only run once per load\n    if (this._cardModProcessed) return;\n    this._cardModProcessed = true;\n    \n    const wraps = this.cardContainer?.querySelectorAll('[data-needs-card-mod=\"true\"]') || [];\n    \n    wraps.forEach(wrap => {\n      const card = wrap.firstElementChild;\n      if (!card) return;\n      \n      const config = card._config || card.config;\n      if (!config) return;\n      \n      // For mod-card specifically, we need to wait for it to be fully initialized\n      if (config.type === 'custom:mod-card') {\n        // mod-card needs its inner card to be ready\n        setTimeout(() => {\n          if (card.updateComplete) {\n            card.updateComplete.then(() => {\n              card.requestUpdate();\n            });\n          } else if (card.setConfig) {\n            try {\n              card.setConfig({...config});\n            } catch {}\n          }\n        }, 100);\n      } else if (config.card_mod && card.setConfig) {\n        // Regular card_mod\n        try {\n          card.setConfig({...config});\n        } catch {}\n      }\n    });\n  }\n\n  _showEmptyPlaceholder() {\n    if (this.cardContainer.querySelector('.ddc-placeholder')) return;\n    const p = this._makePlaceholderAt(0,0,200,200);\n    this.cardContainer.appendChild(p);\n    this._resizeContainer();\n    this._syncEmptyStateUI();\n\n  }\n  _hideEmptyPlaceholder() { this.cardContainer.querySelectorAll('.ddc-placeholder').forEach(n => n.remove()); }\n  _ensurePlaceholderIfEmpty() {\n    const realCards = this.cardContainer.querySelectorAll('.card-wrapper:not(.ddc-placeholder)');\n    if (realCards.length === 0) this._showEmptyPlaceholder();\n        this._applyAutoScale?.();\n    this._syncEmptyStateUI();\n  }\n\n  _adjustZ(wrap, delta) {\n    const cur = parseInt(wrap.style.zIndex || '1', 10);\n    let next = cur + delta;\n    next = Math.max(1, Math.min(9999, next));\n    wrap.style.zIndex = String(next);\n    this._queueSave('z-change');\n  }\n\n  _highestZ() {\n    let max = 0;\n    this.cardContainer.querySelectorAll('.card-wrapper').forEach(w => {\n      const z = parseInt(w.style.zIndex || '0', 10);\n      if (z > max) max = z;\n    });\n    return max;\n  }\n\n  _setCardPosition(el, x, y) {\n    // ensure integer CSS pixels and use 3D translate to avoid compositor fuzz\n    const nx = Math.round(x);\n    const ny = Math.round(y);\n    el.style.transform = `translate3d(${nx}px, ${ny}px, 0)`;\n    el.setAttribute('data-x', String(nx));\n    el.setAttribute('data-y', String(ny));\n    el.setAttribute('data-x-raw', String(nx));\n    el.setAttribute('data-y-raw', String(ny));\n  }\n  \n\n  // --- Auto-scale helpers (only active when auto_resize_cards === true) ---\n  _computeDesignSize() {\n    const c = this.cardContainer; if (!c) return { w: 1, h: 1 };\n    // If fixed sizing is enabled, use those dimensions as design space\n    if (this._isContainerFixed()) {\n      const { w, h } = this._resolveFixedSize();\n      return { w: Math.max(1, w), h: Math.max(1, h) };\n    }\n    // Otherwise compute from content extents similar to _resizeContainer\n    let maxX = 0, maxY = 0;\n    const cards = Array.from(c.querySelectorAll('.card-wrapper'));\n    if (!cards.length) {\n      const rect = c.getBoundingClientRect();\n      return { w: Math.max(1, rect.width || 1), h: Math.max(1, rect.height || 1) };\n    }\n    for (const wEl of cards) {\n      const x = parseFloat(wEl.getAttribute('data-x-raw') || wEl.getAttribute('data-x') || '0') || 0;\n      const y = parseFloat(wEl.getAttribute('data-y-raw') || wEl.getAttribute('data-y') || '0') || 0;\n      const w = parseFloat(wEl.style.width)  || wEl.getBoundingClientRect().width  || 0;\n      const h = parseFloat(wEl.style.height) || wEl.getBoundingClientRect().height || 0;\n      const right  = x + w;\n      const bottom = y + h;\n      if (right  > maxX) maxX = right;\n      if (bottom > maxY) maxY = bottom;\n    }\n    // Round up to grid to avoid half pixels\n    const gw = Math.max(1, this.gridSize || 10);\n    maxX = Math.ceil(maxX / gw) * gw;\n    maxY = Math.ceil(maxY / gw) * gw;\n    return { w: Math.max(1, maxX), h: Math.max(1, maxY) };\n  }\n\n\n  /* -------------------- Live scale watcher (rAF fallback) -------------------- */\n  _startScaleWatch() {\n    if (!this.autoResizeCards) return;\n    if (this.__scaleRAF) return;\n    const tick = () => {\n      if (!this.autoResizeCards) { this.__scaleRAF = null; return; }\n      // Check host width; if changed, re-apply scaling\n      const rect = this.getBoundingClientRect();\n      const w = Math.max(1, rect.width || 0);\n      if (w !== this.__lastScaleW) {\n        this.__lastScaleW = w;\n        this._applyAutoScale?.();\n      }\n      this.__scaleRAF = requestAnimationFrame(tick);\n    };\n    this.__scaleRAF = requestAnimationFrame(tick);\n  }\n\n  _stopScaleWatch() {\n    if (this.__scaleRAF) {\n      try { cancelAnimationFrame(this.__scaleRAF); } catch {}\n      this.__scaleRAF = null;\n    }\n  }\n_applyAutoScale() {\n  const c = this.cardContainer; if (!c) return;\n\n  // Keep the wrapper in place\n  if (typeof this._ensureScaleWrapper === 'function') this._ensureScaleWrapper();\n\n  // If auto-resize is off, lock to 1 but still keep scaffold consistent\n  if (!this.autoResizeCards) {\n    // Design size should still reflect config (fixed/preset or content)\n    const d = (typeof this._computeDesignSize === 'function') ? this._computeDesignSize() : { w: c.offsetWidth || 1, h: c.offsetHeight || 1 };\n    c.style.width  = `${d.w}px`;\n    c.style.height = `${d.h}px`;\n    c.style.transform = `scale(1)`;\n    c.style.transformOrigin = 'top left';\n    c.style.position = 'absolute';\n    c.style.top = '0';\n    c.style.left = '0';\n    if (this.__scaleOuter) {\n      // Use parent/host width for layout box so we don't force expansion\n      const pw = (this.parentElement && this.parentElement.getBoundingClientRect?.().width) ||\n                 (this.offsetParent && this.offsetParent.getBoundingClientRect?.().width) ||\n                 (this.getBoundingClientRect && this.getBoundingClientRect().width) ||\n                 this.offsetWidth || d.w;\n      this.__scaleOuter.style.width  = `${Math.max(1, pw)}px`;\n      this.__scaleOuter.style.height = `${Math.max(1, d.h)}px`;\n    }\n    // When not scaling cards, still ensure the tabs bar width matches the\n    // container width. This prevents the bar from overflowing the card.\n    try { this._syncTabsWidth_?.(); } catch {}\n    return;\n  }\n\n  // Determine design size (prefer preset/fixed if configured)\n  const d = (typeof this._computeDesignSize === 'function') ? this._computeDesignSize() : { w: c.offsetWidth || 1, h: c.offsetHeight || 1 };\n\n  // Measure available width from the *parent* (host column) first\n  const pw = (this.parentElement && this.parentElement.getBoundingClientRect?.().width) ||\n             (this.offsetParent && this.offsetParent.getBoundingClientRect?.().width) ||\n             (this.getBoundingClientRect && this.getBoundingClientRect().width) ||\n             this.offsetWidth || d.w;\n  const availableW = Math.max(1, pw);\n\n  // Fit & clamp (never upscale beyond native)\n  const scale = Math.min(availableW / Math.max(1, d.w), 1);\n\n  // Outer layout box follows host width and scaled height\n  if (this.__scaleOuter) {\n    this.__scaleOuter.style.width  = `${availableW}px`;\n    this.__scaleOuter.style.height = `${Math.max(1, d.h * scale)}px`;\n  }\n\n  // Inner canvas stays at design size and is visually scaled\n  c.style.width  = `${d.w}px`;\n  c.style.height = `${d.h}px`;\n  c.style.transform = `scale(${scale})`;\n  c.style.transformOrigin = 'top left';\n  c.style.position = 'absolute';\n  c.style.top = '0';\n  c.style.left = '0';\n\n  // After scaling, synchronise the tabs width with the new visual size.\n  try { this._syncTabsWidth_?.(); } catch {}\n}\n\n\n\n\n  _resizeContainer() {\n    const c = this.cardContainer; if (!c) return;\n  \n    // In fixed modes, do NOT auto-grow/shrink \u2014 the box is hard-locked.\n    if (this._isContainerFixed()) return;\n  \n    // Dynamic mode: compute based on content\n    const cards = Array.from(c.querySelectorAll('.card-wrapper'));\n    let maxX = 0, maxY = 0;\n    cards.forEach((card) => {\n      const r  = card.getBoundingClientRect();\n      const cr = c.getBoundingClientRect();\n      const right  = r.left - cr.left + r.width;\n      const bottom = r.top  - cr.top  + r.height;\n      maxX = Math.max(maxX, right);\n      maxY = Math.max(maxY, bottom);\n    });\n    c.style.width  = `${Math.ceil(maxX/this.gridSize)*this.gridSize || 100}px`;\n    c.style.height = `${Math.ceil(maxY/this.gridSize)*this.gridSize || 100}px`;\n\n    // Whenever the container size changes in dynamic mode, update the tabs bar\n    // width so it remains aligned with the container. If the scale wrapper\n    // recalculates later the call in _applyAutoScale will also update this.\n    try { this._syncTabsWidth_?.(); } catch {}\n  }\n  \n  /**\n  /**\n   * Restore original positions for non-selected cards, then push out of the way.\n   * This uses this.__collisionOriginals (captured on drag start) and avoids overlaps.\n   * @param {Array} proposedRects \u2013 array of { el, rawX, rawY, snapX, snapY, w, h }\n   * @param {number} dxLead \u2013 leader's delta X (to decide horizontal push direction)\n   * @param {number} dyLead \u2013 leader's delta Y (to decide vertical push direction)\n   * @param {boolean} liveSnap \u2013 true if we should snap positions visually\n   * @param {number} gridSize \u2013 current grid size\n   */\n  _pushCardsOutOfTheWay(proposedRects, dxLead, dyLead, liveSnap, gridSize) {\n    if (!this.__collisionOriginals) return;\n\n    const selectedSet = new Set(proposedRects.map(pr => pr.el));\n    const allCards = Array.from(this.cardContainer.querySelectorAll('.card-wrapper'))\n      .filter(w => !w.dataset.placeholder);\n\n    // Determine container bounds (for fixed modes)\n    const isFixed = this._isContainerFixed();\n    const { w: cw, h: ch } = this._getContainerSize();\n\n    // Restore every non-selected card to its original raw position\n    for (const w of allCards) {\n      if (selectedSet.has(w)) continue;\n      const orig = this.__collisionOriginals.get(w);\n      if (orig) {\n        w.setAttribute('data-x-raw', String(orig.x));\n        w.setAttribute('data-y-raw', String(orig.y));\n        const snX = liveSnap ? Math.round(orig.x / gridSize) * gridSize : orig.x;\n        const snY = liveSnap ? Math.round(orig.y / gridSize) * gridSize : orig.y;\n        this._setCardPosition(w, snX, snY);\n      }\n    }\n\n    // Prepare lists for collision checks\n    const selectedRects = proposedRects.map(pr => ({\n      x: pr.snapX,\n      y: pr.snapY,\n      w: pr.w,\n      h: pr.h,\n    }));\n\n    // Map to store the final pushed positions of non-selected cards\n    const finalPos = new Map();\n\n    // Store original widths and heights\n    const cardSizes = new Map();\n    for (const w of allCards) {\n      const width  = parseFloat(w.style.width)  || w.getBoundingClientRect().width;\n      const height = parseFloat(w.style.height) || w.getBoundingClientRect().height;\n      cardSizes.set(w, { w: width, h: height });\n    }\n\n    // Decide primary push direction based on leader movement\n    const signX = (dxLead > 0) ? 1 : (dxLead < 0 ? -1 : 0);\n    const signY = (dyLead > 0) ? 1 : (dyLead < 0 ? -1 : 0);\n    const horizontal = Math.abs(dxLead) >= Math.abs(dyLead);\n\n    // For each non-selected card, compute its new position\n    for (const other of allCards) {\n      if (selectedSet.has(other)) continue;\n      const orig = this.__collisionOriginals.get(other);\n      if (!orig) continue;\n\n      let { x: candidateX, y: candidateY } = orig;\n      const { w: ow, h: oh } = cardSizes.get(other);\n\n      // Determine if it overlaps with any selected rectangle\n      let overlaps = false;\n      for (const sr of selectedRects) {\n        if (this._rectsOverlap({ x: sr.x, y: sr.y, w: sr.w, h: sr.h },\n                              { x: candidateX, y: candidateY, w: ow, h: oh })) {\n          overlaps = true;\n          // Choose initial push direction\n          if (horizontal && signX !== 0) {\n            candidateX = signX > 0 ? sr.x + sr.w : sr.x - ow;\n          } else if (!horizontal && signY !== 0) {\n            candidateY = signY > 0 ? sr.y + sr.h : sr.y - oh;\n          } else {\n            // default horizontal push when no obvious direction\n            candidateX = sr.x + sr.w;\n          }\n          break;\n        }\n      }\n\n      // If overlapping, keep shifting until no collision\n      if (overlaps) {\n        let guard = 0;\n        const dx = horizontal ? (signX !== 0 ? signX * gridSize : gridSize) : 0;\n        const dy = !horizontal ? (signY !== 0 ? signY * gridSize : gridSize) : 0;\n        while (guard < 100) {\n          const candidateRect = { x: candidateX, y: candidateY, w: ow, h: oh };\n          let collision = false;\n\n          // Check against selected\n          for (const sr of selectedRects) {\n            if (this._rectsOverlap(candidateRect, sr)) {\n              collision = true;\n              break;\n            }\n          }\n          // Check against cards already assigned new positions\n          if (!collision) {\n            for (const [, fp] of finalPos) {\n              if (this._rectsOverlap(candidateRect, fp)) {\n                collision = true;\n                break;\n              }\n            }\n          }\n          // Check against container bounds (for fixed container)\n          if (!collision && isFixed) {\n            if (candidateX < 0 || candidateY < 0 ||\n                candidateX + ow > cw || candidateY + oh > ch) {\n              collision = true;\n            }\n          }\n\n          if (!collision) break;\n          // Move further along the chosen axis\n          candidateX += dx;\n          candidateY += dy;\n          guard++;\n        }\n\n        // Finally, clamp to container boundaries for fixed containers\n        if (isFixed) {\n          candidateX = Math.max(0, Math.min(candidateX, Math.max(0, cw - ow)));\n          candidateY = Math.max(0, Math.min(candidateY, Math.max(0, ch - oh)));\n        }\n      }\n\n      finalPos.set(other, { x: candidateX, y: candidateY, w: ow, h: oh });\n      selectedRects.push({ x: candidateX, y: candidateY, w: ow, h: oh });\n    }\n\n    // Apply final positions to non-selected cards\n    for (const [card, pos] of finalPos) {\n      card.setAttribute('data-x-raw', String(pos.x));\n      card.setAttribute('data-y-raw', String(pos.y));\n      const snX = liveSnap ? Math.round(pos.x / gridSize) * gridSize : pos.x;\n      const snY = liveSnap ? Math.round(pos.y / gridSize) * gridSize : pos.y;\n      this._setCardPosition(card, snX, snY);\n    }\n  }\n\n  _rectFor(el, x = null, y = null, wpx = null, hpx = null) {\n    const x0 = x ?? (parseFloat(el.getAttribute('data-x')) || 0);\n    const y0 = y ?? (parseFloat(el.getAttribute('data-y')) || 0);\n    const w  = wpx ?? (parseFloat(el.style.width)  || el.getBoundingClientRect().width  || 0);\n    const h  = hpx ?? (parseFloat(el.style.height) || el.getBoundingClientRect().height || 0);\n    return { x: x0, y: y0, w, h, el };\n  }\n  _rectsOverlap(a, b, eps = 0.5) {\n    return !(a.x + a.w <= b.x + eps || b.x + b.w <= a.x + eps ||\n             a.y + a.h <= b.y + eps || b.y + b.h <= a.y + eps);\n  }\n  _anyCollisionFor(proposedRects, ignoreSet) {\n    const others = Array.from(this.cardContainer.querySelectorAll('.card-wrapper'))\n      .filter(w => !ignoreSet.has(w) && !w.dataset.placeholder);\n    if (!others.length) return false;\n    const otherRects = others.map(w => this._rectFor(w));\n    for (const pr of proposedRects) for (const or of otherRects) {\n      if (this._rectsOverlap(pr, or)) return true;\n    }\n    return false;\n  }\n  _extractCardConfig(cardEl){\n    if (!cardEl) return {};\n    // attempt to read the card's own config\n    const cfg = cardEl._config || cardEl.config;\n    if (cfg && typeof cfg === 'object' && Object.keys(cfg).length) {\n      return cfg;\n    }\n    // fallback: if the wrapper cached a config, use it\n    try {\n      // walk up to the wrapper; .closest may not exist on text nodes\n      const wrap = cardEl.closest ? cardEl.closest('.card-wrapper') : null;\n      const raw  = wrap?.dataset?.cfg;\n      if (raw) {\n        const parsed = JSON.parse(raw);\n        if (parsed && typeof parsed === 'object') return parsed;\n      }\n    } catch {}\n    return {};\n  }\n\n  /* ------------------------------- Picker UI ------------------------------- */\n  async _openCardManager() { await this._openSmartPicker('add'); }\n\n  _catalog() {\n    return [\n      { id:'favorites', name:'Favorites', items:[] },\n      { id:'recent',    name:'Recent',    items:[] },\n      { id:'basics',    name:'Basics', items:[\n        {type:'entities',          name:'Entities',          icon:'mdi:format-list-bulleted'},\n        {type:'entity',            name:'Entity',            icon:'mdi:checkbox-blank-circle-outline'},\n        {type:'tile',              name:'Tile',              icon:'mdi:view-grid-outline'},\n        {type:'button',            name:'Button',            icon:'mdi:gesture-tap-button'},\n        {type:'glance',            name:'Glance',            icon:'mdi:eye-outline'},\n        {type:'markdown',          name:'Markdown',          icon:'mdi:language-markdown'},\n        // NEW: allow adding an empty custom card that the user can edit manually\n        {type:'custom_card',       name:'Custom Card',       icon:'mdi:puzzle-outline'},\n      ]},\n\n      { id:'sensors',   name:'Sensors', items:[\n        {type:'sensor',            name:'Sensor',            icon:'mdi:antenna'},\n        {type:'gauge',             name:'Gauge',             icon:'mdi:gauge'},\n        {type:'history-graph',     name:'History graph',     icon:'mdi:chart-line'},\n        {type:'statistics-graph',  name:'Statistics graph',  icon:'mdi:chart-bar'},\n      ]},\n      { id:'visual', name:'Visual', items:[\n        {type:'picture-entity',    name:'Picture entity',    icon:'mdi:image-outline'},\n        {type:'picture-glance',    name:'Picture glance',    icon:'mdi:image-multiple-outline'},\n        {type:'weather-forecast',  name:'Weather',           icon:'mdi:weather-partly-cloudy'},\n        {type:'map',               name:'Map',               icon:'mdi:map'},\n        {type:'iframe',            name:'iFrame',            icon:'mdi:application'},\n      ]},\n      { id:'controls', name:'Controls', items:[\n        {type:'light',             name:'Light',             icon:'mdi:lightbulb-outline'},\n        {type:'thermostat',        name:'Thermostat',        icon:'mdi:thermostat'},\n        {type:'media-control',     name:'Media control',     icon:'mdi:play-circle-outline'},\n        {type:'alarm-panel',       name:'Alarm panel',       icon:'mdi:shield-home-outline'},\n        {type:'area',              name:'Area',              icon:'mdi:map-marker'},\n      ]},\n    ];\n  }\n\n  /* ---- Find/create a config editor element for a given card type ---- */\n  async _getEditorElementForType(type, cfg) {\n    // Log the start of an editor lookup; this uses console.debug so it is visible\n    try { console.info('[ddc:editor] Requesting editor element', { type, cfg }); } catch {}\n    const helpers = (await this._helpersPromise) || await window.loadCardHelpers();\n  \n    // Warm the module before asking for the class only for built\u2011in HA cards.\n    // Skip preloading for custom cards (including the \"custom_card\" placeholder) since they have no core modules.\n    try {\n      if (typeof type === 'string' && type && !type.startsWith('custom:') && type !== 'custom_card') {\n        await this._ensureCardModuleLoaded(type, cfg);\n      }\n    } catch {}\n  \n    // Provide a bespoke visual editor for the built\u2011in Entity card.  The default\n    // `hui-entity-card-editor` often fails to load or throws errors in certain\n    // environments.  To avoid those problems, always supply our own simple\n    // entity editor when the type is exactly 'entity'.  This editor exposes the\n    // most common options (entity, name, icon, attribute, unit, state_color)\n    // through Home Assistant form elements.  See `_getEntityCardEditor` below.\n    if (typeof type === 'string' && type === 'entity') {\n      try {\n        return await this._getEntityCardEditor(cfg || {});\n      } catch (err) {\n        // fall through and attempt other editors if our custom one fails\n        console.warn('[ddc:editor] Custom entity editor failed', err);\n      }\n    }\n    // We will compute the card class on demand when needed. Avoid keeping a reference\n    // to a potentially undefined variable across different scopes.\n    const getCardClass = async () => {\n      try {\n        if (helpers.getCardElementClass) {\n          // Use the helper if available\n          return await helpers.getCardElementClass(type);\n        }\n        // Fallback: instantiate the card (using a stub) and return its constructor.\n        let baseCfg;\n        if (cfg && typeof cfg === 'object') {\n          // Use the provided config if available to obtain the constructor\n          baseCfg = { type, ...cfg };\n        } else {\n          let stubCfg;\n          try { stubCfg = await this._getStubConfigForType(type); } catch {}\n          baseCfg = stubCfg && typeof stubCfg === 'object' ? { ...stubCfg } : { type };\n        }\n        const inst = helpers.createCardElement(baseCfg);\n        return inst?.constructor || null;\n      } catch {\n        return null;\n      }\n    };\n\n  \n    // 1) Static class-provided editor (preferred)\n    try {\n      const CardClass = await getCardClass();\n      if (CardClass) {\n        // First, attempt to use the classic getConfigElement\n        if (typeof CardClass.getConfigElement === 'function') {\n          const el = await CardClass.getConfigElement();\n          if (el) {\n            try { console.info('[ddc:editor] Found static class editor', { type }); } catch {}\n            return el;\n          }\n        }\n        // Next, attempt to use getConfigForm (introduced in 2022.3) to build a ha-form based editor\n        if (typeof CardClass.getConfigForm === 'function') {\n          try {\n            const formInfo = await CardClass.getConfigForm();\n            if (formInfo && formInfo.schema) {\n              // Ensure ha-form is defined before creating it\n              try { await customElements.whenDefined('ha-form'); } catch {}\n              const formEl = document.createElement('ha-form');\n              formEl.hass = this.hass;\n              // Clone schema to avoid accidental mutations\n              formEl.schema = Array.isArray(formInfo.schema) ? formInfo.schema.map((s) => ({ ...s })) : formInfo.schema;\n              // Use provided computeLabel/computeHelper if available\n              if (typeof formInfo.computeLabel === 'function') {\n                formEl.computeLabel = formInfo.computeLabel.bind(CardClass);\n              }\n              if (typeof formInfo.computeHelper === 'function') {\n                formEl.computeHelper = formInfo.computeHelper.bind(CardClass);\n              }\n              // Provide initial data (cfg) to the form. Spread to avoid mutation\n              formEl.data = { ...cfg };\n              // When the form value changes, fire a value-changed event compatible with our onChange handler\n              formEl.addEventListener('value-changed', (ev) => {\n                // event.detail.value contains the new config object\n              });\n              try { console.info('[ddc:editor] Generated form editor via getConfigForm', { type }); } catch {}\n              return formEl;\n            }\n          } catch {}\n        }\n      }\n    } catch {}\n\n    // 2) Instance-provided editor. Only try this for custom cards. Most built\u2011in\n    // cards either expose a static editor or register a `hui-<type>-card-editor`\n    // tag; instantiating them with invalid or empty configs causes errors (e.g.\n    // \"Entities must be specified\"). For custom cards, we derive a stub config\n    // to satisfy basic validation and then ask the instance for its editor.\n    // For custom cards and the custom placeholder, attempt instance-level editors. The 'entity' card is no longer\n    // treated as a custom card here since HA may provide a built-in form via getConfigForm.\n    if (typeof type === 'string' && (type.startsWith('custom:') || type === 'custom_card')) {\n      try {\n        let stubCfg = undefined;\n        try { stubCfg = await this._getStubConfigForType(type); } catch {}\n        const baseCfg = stubCfg && typeof stubCfg === 'object' ? { ...stubCfg } : { type };\n        const inst = helpers.createCardElement(baseCfg);\n        inst.hass = this.hass;\n        if (typeof inst.getConfigElement === 'function') {\n          const el = await inst.getConfigElement();\n          if (el) {\n            try { console.info('[ddc:editor] Found instance-level editor', { type }); } catch {}\n            return el;\n          }\n        }\n      } catch {}\n    }\n\n\n  \n    // 3) Known/custom-tag editors (registry hint + common conventions) with retries\n    const base = String(type).replace(/^custom:/, '');\n    const reg = Array.isArray(window.customCards) ? window.customCards : [];\n    const entry = reg.find(c =>\n      c?.type === base || c?.type === type || c?.type === `custom:${base}`\n    );\n\n    \n  \n\n    const candidates = [];\n    if (entry?.editor) candidates.push(entry.editor);            // from registry, if present\n    candidates.push(`${base}-editor`, `${base}-config-editor`);  // common conventions\n\n    // New: add the \u201Chui-<type>-card-editor\u201D convention used by core HA cards\n    if (base && typeof base === 'string') {\n      candidates.push(`hui-${base}-card-editor`);\n    }\n\n  \n    for (const tag of candidates) {\n      if (!tag || typeof tag !== 'string') continue;\n      // Try multiple times: immediate and with increasing delays up to ~3s\n      for (const delay of [0, 100, 300, 700, 1500, 3000]) {\n        try {\n          if (!customElements.get(tag)) {\n            await Promise.race([\n              customElements.whenDefined(tag),\n              new Promise(r => setTimeout(r, delay))\n            ]);\n          }\n          if (customElements.get(tag)) {\n            try { console.info('[ddc:editor] Found editor by tag', { type, tag }); } catch {}\n            return document.createElement(tag);\n          }\n        } catch {}\n      }\n    }\n  \n    // No UI editor available\n    return null;\n  }\n\n  // This helps custom cards that register their editor tag after the element loads.\n  async _ensureCardModuleLoaded(type, cfg) {\n    try {\n      const helpers = (await this._helpersPromise) || await window.loadCardHelpers();\n      // Use stub configuration to warm the module by instantiating the card. This\n      // triggers the dynamic import of the card and its editor without causing\n      // validation errors (we'll ignore errors silently). After warmup, the\n      // module should have registered its static methods and editor tags.\n      // Use the provided cfg if present (for existing cards) to ensure valid keys,\n      // otherwise fall back to a stub. Spreading cfg over type ensures the card\n      // receives all its current properties, avoiding validation errors.\n      let baseCfg;\n      if (cfg && typeof cfg === 'object') {\n        baseCfg = { type, ...cfg };\n      } else {\n        let stubCfg = undefined;\n        try { stubCfg = await this._getStubConfigForType(type); } catch {}\n        baseCfg = stubCfg && typeof stubCfg === 'object' ? { ...stubCfg } : { type };\n      }\n      const el = helpers.createCardElement(baseCfg);\n      el.hass = this.hass;\n      const tmp = document.createElement('div');\n      tmp.style.cssText = 'position:fixed;left:-9999px;top:-9999px;opacity:0;pointer-events:none;';\n      tmp.appendChild(el);\n      document.body.appendChild(tmp);\n      await new Promise(r => requestAnimationFrame(r));\n      tmp.remove();\n      try { console.info('[ddc:editor] Warmed card module', { type }); } catch {}\n    } catch {\n      // swallow errors \u2013 the module may still register\n    }\n  }\n  \n  _ensureOverlayZFix() {\n    if (document.querySelector('style[data-ddc-overlay-fix]')) return;\n    const s = document.createElement('style');\n    s.setAttribute('data-ddc-overlay-fix', '');\n    s.textContent = `\n      /* Make common HA overlays float above our modal */\n      vaadin-combo-box-overlay,\n      vaadin-overlay-backdrop,\n      mwc-menu-surface,\n      .mdc-menu-surface--open {\n        z-index: 1000000 !important;\n      }\n    `;\n    document.head.appendChild(s);\n  }\n  \n\n  _customCardsFromRegistry() {\n    const reg = Array.isArray(window.customCards) ? window.customCards : [];\n    return reg\n      .map((cc) => ({\n        type: cc?.type?.startsWith('custom:') ? cc.type : `custom:${cc?.type}`,\n        name: cc?.name || cc?.type || 'Custom card',\n        icon: 'mdi:puzzle-outline',\n        description: cc?.description || '',\n        editorTag: cc?.editor || null,  // <- keep if provided\n      }))\n      .filter((it) => typeof it.type === 'string' && it.type.startsWith('custom:'));\n  }\n\n  _schemaForType(type) {\n    const S = (o) => o; const any = [];\n    return ({\n      'entities': S({ fields:[ {key:'entities', type:'entities', multi:true, domains:any, label:'Entities'} ]}),\n      'entity':   S({ fields:[ {key:'entity', type:'entity', multi:false, domains:any, label:'Entity'} ]}),\n      'sensor':   S({ fields:[ {key:'entity', type:'entity', multi:false, domains:['sensor'], label:'Sensor'}, {key:'name', type:'text', label:'Name (optional)'} ]}),\n      'gauge':    S({ fields:[ {key:'entity', type:'entity', multi:false, domains:['sensor','number','input_number'], label:'Numeric entity'}, {key:'min', type:'number', label:'Min', step:'any'}, {key:'max', type:'number', label:'Max', step:'any'} ]}),\n      'history-graph': S({ fields:[ {key:'entities', type:'entities', multi:true, domains:any, label:'Entities (multiselect)'}, {key:'hours_to_show', type:'number', label:'Hours to show', default:24} ]}),\n      'statistics-graph': S({ fields:[ {key:'entities', type:'entities', multi:true, domains:['sensor','number','input_number'], label:'Entities (multiselect)'}, {key:'chart_type', type:'select', options:['line','bar'], label:'Chart type', default:'line'}, {key:'statistic', type:'select', options:['mean','min','max','sum'], label:'Statistic', default:'mean'} ]}),\n      'glance':   S({ fields:[ {key:'entities', type:'entities', multi:true, domains:any, label:'Entities (multiselect)'} ]}),\n      'picture-glance': S({ fields:[ {key:'entities', type:'entities', multi:true, domains:any, label:'Entities (multiselect)'}, {key:'image', type:'text', label:'Image URL (optional)'} ]}),\n      'picture-entity': S({ fields:[ {key:'entity', type:'entity', multi:false, domains:any, label:'Entity'}, {key:'image', type:'text', label:'Image URL (optional)'} ]}),\n      'weather-forecast': S({ fields:[ {key:'entity', type:'entity', multi:false, domains:['weather'], label:'Weather entity'} ]}),\n      'map': S({ fields:[ {key:'entities', type:'entities', multi:true, domains:['device_tracker','person'], label:'Trackers / people (multiselect)'}, {key:'default_zoom', type:'number', label:'Default zoom', default:14} ]}),\n      'media-control': S({ fields:[ {key:'entity', type:'entity', multi:false, domains:['media_player'], label:'Media player'} ]}),\n      'light': S({ fields:[ {key:'entity', type:'entity', multi:false, domains:['light'], label:'Light'} ]}),\n      'thermostat': S({ fields:[ {key:'entity', type:'entity', multi:false, domains:['climate'], label:'Climate'} ]}),\n      'alarm-panel': S({ fields:[ {key:'entity', type:'entity', multi:false, domains:['alarm_control_panel'], label:'Alarm'} ]}),\n      'markdown': S({ fields:[ {key:'content', type:'textarea', label:'Markdown'} ]}),\n      'tile': S({ fields:[ {key:'entity', type:'entity', multi:false, domains:any, label:'Entity'} ]}),\n      'button': S({ fields:[ {key:'entity', type:'entity', multi:false, domains:any, label:'Entity (optional)'} ]}),\n      'iframe': S({ fields:[ {key:'url', type:'text', label:'URL'} ]}),\n      'area': S({ fields:[ {key:'area', type:'text', label:'Area ID'} ]}),\n    })[type] || { fields: [] };\n  }\n\n  /**\n   * Build a simple visual editor for the built\u2011in Entity card.  The stock\n   * `hui-entity-card-editor` is prone to errors when loaded outside of the\n   * Lovelace editor, so we provide a lightweight form here instead.  The\n   * returned element implements the `setConfig` API and emits a\n   * `config-changed` event whenever the configuration is updated.  Only\n   * common options are exposed; additional options can still be added in the\n   * YAML editor.\n   *\n   * @param {Object} cfg The current card configuration.\n   * @returns {Promise<HTMLElement>}\n   */\n  async _getEntityCardEditor(cfg = {}) {\n    // Create a wrapper element for the editor UI.\n    const wrapper = document.createElement('div');\n    // Style the wrapper to mimic the look of other editors.\n    wrapper.style.display = 'flex';\n    wrapper.style.flexDirection = 'column';\n    wrapper.style.gap = '12px';\n    wrapper.style.padding = '8px 0';\n    // Allow dropdown menus (e.g. ha-select) to overflow this container\n    // without being clipped.  Without this, the attribute dropdown may be\n    // hidden behind the card content.\n    wrapper.style.overflow = 'visible';\n\n    // Local copy of the config that we will mutate.\n    wrapper._cfg = { type: 'entity', ...(cfg || {}) };\n\n    // Helper to dispatch a config-changed event whenever a value changes.\n    const fireChange = () => {\n      // Always build a plain object for the configuration.  Avoid accidental\n      // retention of prototype strings or arrays by using object literal syntax.\n      const clean = { type: 'entity' };\n      // Copy defined keys only.  Include the optional theme in the clean config\n      // so that the YAML shows the selected theme.\n      ['entity', 'name', 'icon', 'attribute', 'unit', 'state_color', 'theme'].forEach((k) => {\n        const v = wrapper._cfg[k];\n        if (v !== undefined && v !== '' && v !== null) {\n          clean[k] = v;\n        }\n      });\n      wrapper.dispatchEvent(new CustomEvent('config-changed', { detail: { config: clean } }));\n    };\n\n    // Build the entity picker row\n    const entRow = document.createElement('div');\n    entRow.style.display = 'flex';\n    entRow.style.flexDirection = 'column';\n    entRow.style.gap = '4px';\n    const entLabel = document.createElement('span');\n    entLabel.textContent = 'Entity';\n    entLabel.style.fontSize = '.8rem';\n    entLabel.style.opacity = '0.8';\n    // Always use the ha-entity-picker so users get a searchable dropdown once the element is defined\n    let entInput = document.createElement('ha-entity-picker');\n    // Provide a label consistent with HA editors\n    entInput.setAttribute('label', 'Select entity');\n    // Listen for changes from the picker.  When the user selects an entity,\n    // update our internal config and fire the change event.\n    entInput.addEventListener('value-changed', (ev) => {\n      // Prevent the event from bubbling up into parent editors which may\n      // incorrectly interpret it as a configuration object\n      ev.stopPropagation();\n      // Extract the selected entity.  Some implementations emit detail.value,\n      // while others set ev.detail directly or expose the value on the target.\n      const newVal = (ev.detail && (ev.detail.value ?? ev.detail)) ?? ev.target?.value;\n      wrapper._cfg.entity = newVal || '';\n      // Rebuild the attribute list for the new entity\n      try { updateAttributeOptions(); } catch {}\n      fireChange();\n    });\n    entRow.appendChild(entLabel);\n    entRow.appendChild(entInput);\n    wrapper.appendChild(entRow);\n\n    // Placeholder for an attribute updater.  This function will be assigned\n    // once the attribute field is created below.  Defining it here ensures\n    // that it is in scope for the entity change handler above.\n    let updateAttributeOptions = () => {};\n\n    // Prepare a grid container for the remaining fields.\n    const grid = document.createElement('div');\n    grid.style.display = 'grid';\n    grid.style.gridTemplateColumns = '1fr 1fr';\n    grid.style.columnGap = '12px';\n    grid.style.rowGap = '12px';\n\n    // Helper to create a field wrapper and append to grid\n    const makeField = (labelText, inputEl) => {\n      const r = document.createElement('div');\n      r.style.display = 'flex';\n      r.style.flexDirection = 'column';\n      r.style.gap = '4px';\n      const lab = document.createElement('span');\n      lab.textContent = labelText;\n      lab.style.fontSize = '.8rem';\n      lab.style.opacity = '0.8';\n      r.appendChild(lab);\n      r.appendChild(inputEl);\n      grid.appendChild(r);\n    };\n\n    // Name field\n    let nameInput;\n    if (customElements.get('ha-textfield')) {\n      nameInput = document.createElement('ha-textfield');\n      nameInput.setAttribute('label', 'Name');\n      nameInput.addEventListener('input', () => {\n        wrapper._cfg.name = nameInput.value || undefined;\n        fireChange();\n      });\n    } else {\n      nameInput = document.createElement('input');\n      nameInput.type = 'text';\n      nameInput.placeholder = 'Name';\n      nameInput.addEventListener('input', () => {\n        wrapper._cfg.name = nameInput.value || undefined;\n        fireChange();\n      });\n      Object.assign(nameInput.style, {\n        padding: '8px 10px',\n        borderRadius: '8px',\n        background: 'var(--ha-card-background, var(--card-background-color, var(--secondary-background-color)))',\n        border: '1px solid var(--divider-color)',\n        color: 'var(--primary-text-color, inherit)',\n        width: '100%',\n        boxSizing: 'border-box'\n      });\n    }\n    makeField('Name', nameInput);\n\n    // Icon field \u2013 provide a searchable icon picker if available.  Fallback to\n    // ha-textfield or native input when the picker is unavailable.\n    let iconInput;\n    if (customElements.get('ha-icon-picker')) {\n      iconInput = document.createElement('ha-icon-picker');\n      iconInput.setAttribute('label', 'Icon');\n      // When the user selects an icon from the picker, update config\n      iconInput.addEventListener('value-changed', (ev) => {\n        ev.stopPropagation();\n        wrapper._cfg.icon = ev.detail?.value || undefined;\n        fireChange();\n      });\n      // Ensure the icon picker overlay appears above surrounding content\n      Object.assign(iconInput.style, { position: 'relative', zIndex: '1000' });\n    } else if (customElements.get('ha-textfield')) {\n      iconInput = document.createElement('ha-textfield');\n      iconInput.setAttribute('label', 'Icon');\n      iconInput.addEventListener('input', () => {\n        wrapper._cfg.icon = iconInput.value || undefined;\n        fireChange();\n      });\n    } else {\n      iconInput = document.createElement('input');\n      iconInput.type = 'text';\n      iconInput.placeholder = 'mdi:icon';\n      iconInput.addEventListener('input', () => {\n        wrapper._cfg.icon = iconInput.value || undefined;\n        fireChange();\n      });\n      Object.assign(iconInput.style, {\n        padding: '8px 10px',\n        borderRadius: '8px',\n        background: 'var(--ha-card-background, var(--card-background-color, var(--secondary-background-color)))',\n        border: '1px solid var(--divider-color)',\n        color: 'var(--primary-text-color, inherit)',\n        width: '100%',\n        boxSizing: 'border-box'\n      });\n    }\n    makeField('Icon', iconInput);\n\n    // Attribute field \u2013 display a dropdown of attributes for the selected entity.\n    let attrInput;\n    // Helper to populate attributes based on the current entity selection\n    updateAttributeOptions = () => {\n      // Determine available attribute names for the selected entity\n      let attrs = [];\n      const eid = wrapper._cfg?.entity;\n      const h = wrapper._hass;\n      if (eid && h && h.states && h.states[eid] && h.states[eid].attributes) {\n        try {\n          attrs = Object.keys(h.states[eid].attributes || {}).filter((k) => k && typeof k === 'string');\n          attrs.sort();\n        } catch {}\n      }\n      const prev = attrInput && typeof attrInput.value !== 'undefined' ? attrInput.value : undefined;\n      const tag = (attrInput?.tagName || '').toLowerCase();\n      // Lookup table for friendlier attribute names.  If an attribute key\n      // exists in this map, its value will be used for the option label; otherwise\n      // the key will be transformed by replacing underscores with spaces and\n      // capitalizing words.\n      const FRIENDLY_ATTR_NAMES = {\n        min_color_temp_kelvin: 'Minimum color temperature (Kelvin)',\n        max_color_temp_kelvin: 'Maximum color temperature (Kelvin)',\n        min_color_temp_mireds: 'Minimum color temperature (mireds)',\n        max_color_temp_mireds: 'Maximum color temperature (mireds)',\n        min_mireds: 'Minimum color temperature (mireds)',\n        max_mireds: 'Maximum color temperature (mireds)',\n        effect_list: 'Available effects',\n        color_mode: 'Color mode',\n        brightness: 'Brightness',\n        hs_color: 'Hs color',\n        rgb_color: 'Rgb color',\n        xy_color: 'Xy color',\n        entity_id: 'Entity ID',\n        friendly_name: 'Friendly name',\n        icon: 'Icon'\n      };\n      // Helper to compute a label from an attribute key\n      const makeLabel = (key) => {\n        if (FRIENDLY_ATTR_NAMES[key]) return FRIENDLY_ATTR_NAMES[key];\n        return key\n          .split('_')\n          .map((part) => {\n            if (!part) return part;\n            // Preserve units like kelvin/mireds in parentheses\n            if (part.toLowerCase() === 'kelvin') return 'Kelvin';\n            if (part.toLowerCase() === 'mireds') return 'mireds';\n            return part.charAt(0).toUpperCase() + part.slice(1);\n          })\n          .join(' ');\n      };\n      if (tag === 'ha-combo-box') {\n        // Build array of objects for the combo box\n        const items = attrs.map((name) => ({ value: name, label: makeLabel(name) }));\n        // Always include an empty item as first entry to allow clearing the selection\n        items.unshift({ value: '', label: '' });\n        attrInput.items = items;\n        // Restore previous selection if still valid\n        if (prev && attrs.includes(prev)) {\n          attrInput.value = prev;\n        } else {\n          attrInput.value = '';\n        }\n      } else if (tag === 'ha-select') {\n        // Clear current items\n        attrInput.innerHTML = '';\n        // Add an empty option\n        const emptyItem = document.createElement('mwc-list-item');\n        emptyItem.setAttribute('value', '');\n        emptyItem.textContent = '';\n        attrInput.appendChild(emptyItem);\n        for (const name of attrs) {\n          const item = document.createElement('mwc-list-item');\n          item.setAttribute('value', name);\n          item.textContent = makeLabel(name);\n          attrInput.appendChild(item);\n        }\n        // Restore previous selection if still valid\n        if (prev && attrs.includes(prev)) {\n          attrInput.value = prev;\n        } else {\n          attrInput.value = '';\n        }\n        attrInput.requestUpdate?.();\n      } else if (tag === 'select') {\n        attrInput.innerHTML = '';\n        const emptyOpt = document.createElement('option');\n        emptyOpt.value = '';\n        emptyOpt.textContent = '';\n        attrInput.appendChild(emptyOpt);\n        for (const name of attrs) {\n          const opt = document.createElement('option');\n          opt.value = name;\n          opt.textContent = makeLabel(name);\n          attrInput.appendChild(opt);\n        }\n        if (prev && attrs.includes(prev)) {\n          attrInput.value = prev;\n        }\n      }\n    };\n\n    // Create the attribute input. Prefer ha-combo-box (for searchable dropdown and correct overlay),\n    // fall back to ha-select, then native select if neither is available.  We\n    // mirror the semantics of the entity picker so the dropdown is rendered in a\n    // global overlay and not clipped by the card.\n    if (customElements.get('ha-combo-box')) {\n      attrInput = document.createElement('ha-combo-box');\n      attrInput.setAttribute('label', 'Attribute');\n      // Provide item-label and item-value paths for our objects\n      attrInput.setAttribute('item-label-path', 'label');\n      attrInput.setAttribute('item-value-path', 'value');\n      attrInput.setAttribute('allow-custom-value', 'false');\n      attrInput.addEventListener('value-changed', (ev) => {\n        // The value may be in ev.detail.value or directly in attrInput.value depending on the component implementation.\n        ev.stopPropagation();\n        const val = ev.detail?.value ?? attrInput.value;\n        wrapper._cfg.attribute = val || undefined;\n        fireChange();\n      });\n    } else if (customElements.get('ha-select')) {\n      attrInput = document.createElement('ha-select');\n      attrInput.setAttribute('label', 'Attribute');\n      attrInput.addEventListener('selected', (ev) => {\n        ev.stopPropagation();\n        // Update config with selected attribute or undefined if empty\n        wrapper._cfg.attribute = attrInput.value || undefined;\n        fireChange();\n      });\n      // Ensure the dropdown menu appears above surrounding card content\n      Object.assign(attrInput.style, { position: 'relative', zIndex: '1000' });\n    } else {\n      attrInput = document.createElement('select');\n      // Always include an empty option; options will be populated by updateAttributeOptions\n      const emptyOpt = document.createElement('option');\n      emptyOpt.value = '';\n      emptyOpt.textContent = '';\n      attrInput.appendChild(emptyOpt);\n      attrInput.addEventListener('change', (ev) => {\n        ev.stopPropagation();\n        wrapper._cfg.attribute = attrInput.value || undefined;\n        fireChange();\n      });\n      // Apply HA-like styling to the native select fallback\n      Object.assign(attrInput.style, {\n        padding: '8px 10px',\n        borderRadius: '8px',\n        background: 'var(--ha-card-background, var(--card-background-color, var(--secondary-background-color)))',\n        border: '1px solid var(--divider-color)',\n        color: 'var(--primary-text-color, inherit)',\n        width: '100%',\n        boxSizing: 'border-box'\n      });\n      // Ensure the dropdown menu appears above surrounding card content\n      Object.assign(attrInput.style, { position: 'relative', zIndex: '1000' });\n    }\n    // Populate attributes once element is ready (initially empty).  We'll call\n    // updateAttributeOptions whenever the entity or hass changes.\n    updateAttributeOptions();\n    makeField('Attribute', attrInput);\n\n    // Unit field\n    let unitInput;\n    if (customElements.get('ha-textfield')) {\n      unitInput = document.createElement('ha-textfield');\n      unitInput.setAttribute('label', 'Unit');\n      unitInput.addEventListener('input', () => {\n        wrapper._cfg.unit = unitInput.value || undefined;\n        fireChange();\n      });\n    } else {\n      unitInput = document.createElement('input');\n      unitInput.type = 'text';\n      unitInput.placeholder = 'Unit';\n      unitInput.addEventListener('input', () => {\n        wrapper._cfg.unit = unitInput.value || undefined;\n        fireChange();\n      });\n      Object.assign(unitInput.style, {\n        padding: '8px 10px',\n        borderRadius: '8px',\n        background: 'var(--ha-card-background, var(--card-background-color, var(--secondary-background-color)))',\n        border: '1px solid var(--divider-color)',\n        color: 'var(--primary-text-color, inherit)',\n        width: '100%',\n        boxSizing: 'border-box'\n      });\n    }\n    makeField('Unit', unitInput);\n\n    // Theme (optional) field - allow specifying a theme name from a dropdown\n    let themeInput;\n    // Use ha-select if available; otherwise fall back to a native select element.  The\n    // ha-select component uses mwc-list-item children to represent options.  We\n    // populate the options later when hass is set.\n    if (customElements.get('ha-select')) {\n      themeInput = document.createElement('ha-select');\n      themeInput.setAttribute('label', 'Theme (optional)');\n      // When the user picks an item, update config\n      themeInput.addEventListener('selected', (ev) => {\n        // Prevent propagation to avoid other handlers treating the value as config\n        ev.stopPropagation();\n        wrapper._cfg.theme = themeInput.value || undefined;\n        fireChange();\n      });\n    } else {\n      themeInput = document.createElement('select');\n      // Always include an empty option so users can clear their selection.  We\n      // recreate the option list when hass is set so we don't duplicate items.\n      const emptyOpt = document.createElement('option');\n      emptyOpt.value = '';\n      emptyOpt.textContent = '';\n      themeInput.appendChild(emptyOpt);\n      themeInput.addEventListener('change', (ev) => {\n        ev.stopPropagation();\n        wrapper._cfg.theme = themeInput.value || undefined;\n        fireChange();\n      });\n      // Apply HA-like styling to the native select fallback\n      Object.assign(themeInput.style, {\n        padding: '8px 10px',\n        borderRadius: '8px',\n        background: 'var(--ha-card-background, var(--card-background-color, var(--secondary-background-color)))',\n        border: '1px solid var(--divider-color)',\n        color: 'var(--primary-text-color, inherit)',\n        width: '100%',\n        boxSizing: 'border-box'\n      });\n    }\n    makeField('Theme (optional)', themeInput);\n\n    // State color toggle field\n    let colorInput;\n    if (customElements.get('ha-switch')) {\n      colorInput = document.createElement('ha-switch');\n      colorInput.addEventListener('change', () => {\n        wrapper._cfg.state_color = !!colorInput.checked;\n        fireChange();\n      });\n    } else {\n      colorInput = document.createElement('input');\n      colorInput.type = 'checkbox';\n      colorInput.addEventListener('change', () => {\n        wrapper._cfg.state_color = !!colorInput.checked;\n        fireChange();\n      });\n    }\n    // Build a field wrapper for state color and append to grid\n    const colWrap = document.createElement('div');\n    colWrap.style.display = 'flex';\n    colWrap.style.alignItems = 'center';\n    colWrap.style.gap = '8px';\n    const colorLabel = document.createElement('span');\n    colorLabel.textContent = 'Show state color';\n    colorLabel.style.fontSize = '.8rem';\n    colorLabel.style.opacity = '0.8';\n    colWrap.appendChild(colorLabel);\n    colWrap.appendChild(colorInput);\n    grid.appendChild(colWrap);\n\n    // Append grid to wrapper\n    wrapper.appendChild(grid);\n\n    // Provide a setConfig method to populate fields from an existing config\n    wrapper.setConfig = (cfg2 = {}) => {\n      wrapper._cfg = { type: 'entity', ...(cfg2 || {}) };\n      const c = wrapper._cfg;\n      // Update each field if available\n      if (entInput) {\n        if ('value' in entInput) entInput.value = c.entity || '';\n        if (entInput.setAttribute) entInput.setAttribute('value', c.entity || '');\n      }\n      if (nameInput) {\n        nameInput.value = c.name || '';\n      }\n      if (iconInput) {\n        iconInput.value = c.icon || '';\n      }\n      if (attrInput) {\n        try { updateAttributeOptions(); } catch {}\n        // After repopulating options, restore the selected attribute if it exists\n        attrInput.value = c.attribute || '';\n      }\n      if (unitInput) {\n        unitInput.value = c.unit || '';\n      }\n      if (themeInput) {\n        themeInput.value = c.theme || '';\n      }\n      if (colorInput) {\n        if ('checked' in colorInput) colorInput.checked = !!c.state_color;\n      }\n    };\n\n    // Define reactive hass property so that nested pickers receive hass\n    Object.defineProperty(wrapper, 'hass', {\n      get() {\n        return this._hass;\n      },\n      set(v) {\n        this._hass = v;\n        // Pass hass to the entity picker so it can populate entities internally.  Assign\n        // the property even if the custom element isn't yet defined; once the\n        // element upgrades, it will use this value.  Additionally, if the\n        // element hasn't been registered yet, schedule a second assignment when\n        // it upgrades to ensure the suggestions list appears.\n        if (entInput) {\n          try { entInput.hass = v; } catch {}\n          // If ha-entity-picker is not yet defined, wait for it to be ready and then\n          // reassign the hass property.  This mirrors the logic used in the\n          // visibility editor to ensure the picker upgrades correctly.\n          if (!customElements.get('ha-entity-picker')) {\n            customElements.whenDefined('ha-entity-picker').then(() => {\n              try { entInput.hass = this._hass; entInput.requestUpdate?.(); } catch {}\n            }).catch(() => {});\n          }\n        }\n        // Pass hass to the icon picker so it can populate icons.  Assign even\n        // if the custom element isn't defined yet; we'll reassign after upgrade.\n        if (iconInput) {\n          try { iconInput.hass = v; } catch {}\n          if (!customElements.get('ha-icon-picker')) {\n            customElements.whenDefined('ha-icon-picker').then(() => {\n              try { iconInput.hass = this._hass; iconInput.requestUpdate?.(); } catch {}\n            }).catch(() => {});\n          }\n        }\n        // Populate the theme dropdown with available themes.  We support both\n        // ha-select (using mwc-list-item children) and a native select element.  For\n        // ha-select, use mwc-list-item; for native selects, use option elements.\n        if (themeInput) {\n          // Determine available theme names\n          let themeNames = [];\n          if (v && v.themes) {\n            if (v.themes.themes) {\n              themeNames = Object.keys(v.themes.themes);\n            } else if (typeof v.themes === 'object') {\n              themeNames = Object.keys(v.themes).filter((k) => k !== 'default_theme');\n            }\n          }\n          // Save previous value to restore after repopulating\n          const prevVal = themeInput.value;\n          const tag = (themeInput.tagName || '').toLowerCase();\n          if (tag === 'ha-select') {\n            // Clear existing items\n            themeInput.innerHTML = '';\n            // Insert an empty item to allow clearing the selection\n            const emptyItem = document.createElement('mwc-list-item');\n            emptyItem.setAttribute('value', '');\n            emptyItem.textContent = '';\n            themeInput.appendChild(emptyItem);\n            for (const name of themeNames) {\n              const item = document.createElement('mwc-list-item');\n              item.setAttribute('value', name);\n              item.textContent = name;\n              themeInput.appendChild(item);\n            }\n            // Restore previous selection if it still exists\n            if (prevVal && themeNames.includes(prevVal)) {\n              themeInput.value = prevVal;\n            } else if (!prevVal) {\n              themeInput.value = '';\n            }\n            // Request update in case the component uses LitElement\n            themeInput.requestUpdate?.();\n          } else if (tag === 'select') {\n            // Clear existing options\n            themeInput.innerHTML = '';\n            const emptyOpt = document.createElement('option');\n            emptyOpt.value = '';\n            emptyOpt.textContent = '';\n            themeInput.appendChild(emptyOpt);\n            for (const name of themeNames) {\n              const o = document.createElement('option');\n              o.value = name;\n              o.textContent = name;\n              themeInput.appendChild(o);\n            }\n            if (prevVal && Array.from(themeInput.options).some(o => o.value === prevVal)) {\n              themeInput.value = prevVal;\n            }\n          }\n        }\n\n        // Update attribute options when hass changes since the list of\n        // attributes depends on the selected entity and the hass states.  This\n        // ensures that if hass updates after the editor is created, the\n        // attribute dropdown stays in sync with the current entity.\n        try { updateAttributeOptions(); } catch {}\n      }\n    });\n\n    // Populate initial configuration\n    wrapper.setConfig(cfg || {});\n    // Return the wrapped editor\n    return wrapper;\n  }\n\n  _shapeBySchema(type, cfg = {}) {\n    const sc = this._schemaForType(type) || { fields: [] };\n    const out = { ...cfg, type };\n\n    for (const f of sc.fields) {\n      let v = out[f.key];\n\n      if (f.type === 'entities') {\n        const arr = Array.isArray(v) ? v : (v != null && v !== '' ? [v] : []);\n        const clean = arr.filter(Boolean);\n        if (clean.length) out[f.key] = clean;\n        else delete out[f.key];\n      }\n      else if (f.type === 'entity') {\n        if (Array.isArray(v)) v = v[0];\n        if (v == null || v === '') delete out[f.key];\n        else out[f.key] = String(v);\n      }\n      else if (f.type === 'number') {\n        if (v == null || v === '') { delete out[f.key]; }\n        else {\n          const n = Number(v);\n          if (Number.isFinite(n)) out[f.key] = n;\n          else delete out[f.key];\n        }\n      }\n      else if (f.type === 'select' || f.type === 'text' || f.type === 'textarea') {\n        if (v == null || v === '') delete out[f.key];\n        else out[f.key] = v;\n      }\n    }\n    return out;\n  }\n\n  _statesList(domains) {\n    const all = Object.keys(this.hass?.states || {});\n    if (!domains || !domains.length) return all;\n\n    if (!this.__domainIndex || this.__domainIndex._gen !== all.length) {\n      const map = {};\n      for (const id of all) {\n        const d = id.split('.')[0];\n        (map[d] ||= []).push(id);\n      }\n      this.__domainIndex = { _gen: all.length, map };\n    }\n    const out = [];\n    for (const d of domains) if (this.__domainIndex.map[d]) out.push(...this.__domainIndex.map[d]);\n    return out;\n  }\n  _isNumericEntity(eid) {\n    const st = this.hass?.states?.[eid]; if (!st) return false;\n    const v = Number(st.state); return Number.isFinite(v);\n  }\n\n  _getFaves(){ try { return new Set(JSON.parse(localStorage.getItem('ddc_faves')||'[]')); } catch { return new Set(); } }\n  _setFaves(set){ try { localStorage.setItem('ddc_faves', JSON.stringify(Array.from(set))); } catch {} }\n  _getRecent(){ try { return JSON.parse(localStorage.getItem('ddc_recent_types')||'[]'); } catch { return []; } }\n  _pushRecent(type){ try { const r = this._getRecent().filter(t=>t!==type); r.unshift(type); if (r.length>10) r.length=10; localStorage.setItem('ddc_recent_types', JSON.stringify(r)); } catch{} }\n\n  /* ----------------------------- YAML editor helpers ----------------------------- */\n  async _ensureCodeMirror() {\n    if (this.__cmReady) return;\n    if (!document.querySelector('link[data-cm-core]')) {\n      const l = document.createElement('link');\n      l.rel = 'stylesheet';\n      l.href = 'https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css';\n      l.setAttribute('data-cm-core','');\n      document.head.appendChild(l);\n    }\n    await new Promise((resolve) => {\n      if (window.CodeMirror) return resolve();\n      const s = document.createElement('script');\n      s.src = 'https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js';\n      s.onload = resolve;\n      document.head.appendChild(s);\n    });\n    await new Promise((resolve) => {\n      if (window.CodeMirror?.mimeModes?.yaml) return resolve();\n      const s = document.createElement('script');\n      s.src = 'https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/yaml/yaml.min.js';\n      s.onload = resolve;\n      document.head.appendChild(s);\n    });\n    this.__cmReady = true;\n  }\n\n  async _mountYamlEditor(hostEl, initialCfg, onValidChange, onInvalidChange) {\n    const dump = (o) => (window.jsyaml ? window.jsyaml.dump(o) : JSON.stringify(o, null, 2));\n    const parse = (t) => (window.jsyaml ? window.jsyaml.load(t) : JSON.parse(t));\n    hostEl.innerHTML = '';\n    const initialText = dump(initialCfg);\n\n    if (customElements.get('ha-code-editor')) {\n      const ed = document.createElement('ha-code-editor');\n      ed.mode = 'yaml';\n      ed.hass = this.hass;\n      ed.value = initialText;\n      ed.style.display = 'block';\n      ed.style.height = '260px';\n      hostEl.appendChild(ed);\n\n      let programmatic = false;\n      ed.addEventListener('value-changed', (e) => {\n        if (programmatic) return;\n        const txt = e.detail?.value ?? ed.value ?? '';\n        try { onValidChange(parse(txt)); }\n        catch (err) { onInvalidChange?.(err); }\n      });\n      return {\n        setValue: (cfg) => {\n          const txt = dump(cfg);\n          if ((ed.value ?? '') !== txt) { programmatic = true; ed.value = txt; programmatic = false; }\n        }\n      };\n    }\n\n    try {\n      await this._ensureCodeMirror();\n      const cm = window.CodeMirror(hostEl, {\n        value: initialText,\n        mode: 'yaml',\n        lineNumbers: true,\n        lineWrapping: true,\n        indentUnit: 2,\n        tabSize: 2\n      });\n      let programmatic = false;\n      cm.on('change', () => {\n        if (programmatic) return;\n        const text = cm.getValue();\n        try { onValidChange(parse(text)); }\n        catch (e) { onInvalidChange?.(e); }\n      });\n      return {\n        setValue: (cfg) => {\n          const txt = dump(cfg);\n          if (cm.getValue() !== txt) { programmatic = true; cm.setValue(txt); programmatic = false; }\n        }\n      };\n    } catch {\n      const ta = document.createElement('textarea');\n      ta.style.width = '100%';\n      ta.style.height = '260px';\n      ta.value = initialText;\n      ta.addEventListener('input', () => {\n        try { onValidChange(parse(ta.value)); }\n        catch (e) { onInvalidChange?.(e); }\n      });\n      hostEl.appendChild(ta);\n      return { setValue: (cfg) => { const txt = dump(cfg); if (ta.value !== txt) ta.value = txt; } };\n    }\n  }\n\n  /* ----------------------- Picker (fast, cached) ----------------------- */\n  \n    _createVirtualList({ container, items, rowHeight = 36, renderRow }) {\n    container.style.position = 'relative';\n    container.style.overflow = 'auto';\n    const spacer = document.createElement('div');\n    spacer.style.height = `${items.length * rowHeight}px`;\n    container.innerHTML = '';\n    container.appendChild(spacer);\n\n    const mount = new Map(); // index -> element\n    const render = () => {\n      const scrollTop = container.scrollTop;\n      const h = container.clientHeight;\n      const first = Math.max(0, Math.floor(scrollTop / rowHeight) - 6);\n      const last  = Math.min(items.length - 1, Math.ceil((scrollTop + h) / rowHeight) + 6);\n\n      // remove out-of-window rows\n      for (const [i, el] of mount) {\n        if (i < first || i > last) { el.remove(); mount.delete(i); }\n      }\n      // add visible rows\n      for (let i = first; i <= last; i++) {\n        if (mount.has(i)) continue;\n        const el = renderRow(items[i], i);\n        el.style.position = 'absolute';\n        el.style.left = '0';\n        el.style.right = '0';\n        el.style.top = `${i * rowHeight}px`;\n        mount.set(i, el);\n        container.appendChild(el);\n      }\n    };\n\n    container.addEventListener('scroll', render, { passive: true });\n    new ResizeObserver(render).observe(container);\n    render();\n\n    return {\n      refresh(newItems) {\n        if (newItems) {\n          items = newItems;\n          spacer.style.height = `${items.length * rowHeight}px`;\n          for (const [, el] of mount) el.remove();\n          mount.clear();\n        }\n        render();\n      }\n    };\n  }\n  \n  async _openSmartPicker(mode='add', initialCfg=null, onCommit=null) {\n\n    \n    const close = () => modal.remove();\n    const modal = document.createElement('div'); modal.className='modal';\n    modal.innerHTML = `\n      <div class=\"dialog\" role=\"dialog\" aria-modal=\"true\">\n        <div class=\"dlg-head\">\n          <h3>${mode==='edit'?'Edit card':'Add a card'}</h3>\n          <div style=\"display:flex;gap:10px;flex:1\">\n            <input id=\"search\" placeholder=\"Search cards (name or type)\u2026\" aria-label=\"search\" style=\"flex:1;padding:10px 12px;border-radius:12px;border:1px solid var(--divider-color);background:var(--primary-background-color);color:var(--primary-text-color)\">\n          </div>\n          <button class=\"btn secondary\" id=\"cancelBtn\"><ha-icon icon=\"mdi:close\"></ha-icon><span style=\"margin-left:6px\">Cancel</span></button>\n          <button class=\"btn\" id=\"addBtn\" disabled>${mode==='edit'\n            ? '<ha-icon icon=\"mdi:content-save\"></ha-icon><span style=\"margin-left:6px\">Update</span>'\n            : '<ha-icon icon=\"mdi:plus\"></ha-icon><span style=\"margin-left:6px\">Add</span>'}\n          </button>\n        </div>\n        <div id=\"layoutGrid\" class=\"layout\">\n          <div class=\"pane\" id=\"leftPane\"></div>\n          <div class=\"pane\" id=\"rightPane\">\n            <div class=\"rightGrid\">\n              <div class=\"sec\" id=\"quickFillSec\" style=\"grid-column:1;grid-row:1\">\n                <div class=\"hd\">Quick fill <span style=\"opacity:.7;font-size:.85rem\">card-aware</span></div>\n                <div class=\"bd\" id=\"quickFill\"></div>\n              </div>\n\n              <div class=\"sec\" style=\"grid-column:2;grid-row:1 / span 3;min-height:0;position:relative\">\n                <div class=\"hd\">Preview</div>\n                <div class=\"spin-center\" id=\"previewSpin\" hidden>\n                  <ha-circular-progress indeterminate></ha-circular-progress>\n                </div>\n                <div class=\"bd\" style=\"min-height:0\"><div id=\"cardHost\"></div></div>\n              </div>\n\n              <div class=\"sec\" id=\"optionsSec\" style=\"grid-column:1;grid-row:2;min-height:0;position:relative\">\n                <div class=\"hd\">\n                  <span>Card options (official editor)</span>\n                  <div id=\"optTabs\" class=\"tabs\">\n                    <button id=\"tabVisual\" class=\"tab active\" aria-selected=\"true\">Visual</button>\n                    <button id=\"tabYaml\" class=\"tab\">YAML</button>\n                    <!-- DDC: Visibility tab allows configuring when the card should be shown -->\n                    <button id=\"tabVis\" class=\"tab\">Visibility</button>\n                  </div>\n                </div>\n                <div class=\"spin-center\" id=\"editorSpin\" hidden>\n                  <ha-circular-progress indeterminate></ha-circular-progress>\n                </div>\n                <div class=\"bd\" style=\"min-height:0\">\n                  <div id=\"editorHost\"></div>\n                  <div id=\"err\" class=\"err\" hidden style=\"color:var(--error-color);font-size:.9rem\"></div>\n                </div>\n              </div>\n\n              <div class=\"sec\" id=\"yamlSec\" style=\"grid-column:1;grid-row:3;min-height:0\">\n                <div class=\"hd\">YAML editor</div>\n                <div class=\"bd\" style=\"min-height:0\">\n                  <div id=\"yamlHost\"></div>\n                  <div id=\"yamlErr\" class=\"err\" hidden style=\"color:var(--error-color);font-size:.9rem;margin-top:8px\"></div>\n                </div>\n              </div>\n\n              <!-- DDC: Visibility section shares the same grid row as YAML. It is hidden by default and shown when the Visibility tab is selected. -->\n              <div class=\"sec\" id=\"visSec\" style=\"grid-column:1;grid-row:3;min-height:0;display:none\">\n                <div class=\"hd\">Visibility</div>\n                <div class=\"bd\" style=\"min-height:0\">\n                  <div id=\"visHost\"></div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"dlg-foot\">\n          <span style=\"flex:1;opacity:.75;font-size:.85rem\">Tip: use <ha-icon icon=\"mdi:star-outline\"></ha-icon> to favorite cards you use often</span>\n          <button class=\"btn secondary\" id=\"footCancel\"><ha-icon icon=\"mdi:close\"></ha-icon><span style=\"margin-left:6px\">Cancel</span></button>\n          <button class=\"btn\" id=\"footAdd\" disabled>${mode==='edit'\n            ? '<ha-icon icon=\"mdi:content-save\"></ha-icon><span style=\"margin-left:6px\">Update</span>'\n            : '<ha-icon icon=\"mdi:plus\"></ha-icon><span style=\"margin-left:6px\">Add</span>'}\n          </button>\n        </div>\n      </div>`;\n    this.shadowRoot.appendChild(modal);\n\n    const left = modal.querySelector('#leftPane');\n    const addTop = modal.querySelector('#addBtn');\n    const addBottom = modal.querySelector('#footAdd');\n    const cancelTop = modal.querySelector('#cancelBtn');\n    const cancelBot = modal.querySelector('#footCancel');\n    const search = modal.querySelector('#search');\n    const cardHost = modal.querySelector('#cardHost');\n    const editorHost = modal.querySelector('#editorHost');\n    const editorSpin = modal.querySelector('#editorSpin');\n    const quickFill = modal.querySelector('#quickFill');\n    const yamlHost = modal.querySelector('#yamlHost');\n    const yamlErr = modal.querySelector('#yamlErr');\n    const yamlSec = modal.querySelector('#yamlSec');\n    const tabVisual = modal.querySelector('#tabVisual');\n    const tabYaml = modal.querySelector('#tabYaml');\n    // Visibility tab and section references\n    const tabVis = modal.querySelector('#tabVis');\n    const visSec = modal.querySelector('#visSec');\n    const visHost = modal.querySelector('#visHost');\n    const err = modal.querySelector('#err');\n    const previewSpin = modal.querySelector('#previewSpin');\n    const enableCommit = (on) => { addTop.disabled = addBottom.disabled = !on; };\n    const setError = (msg) => { if (!msg){ err.hidden=true; err.textContent=''; } else { err.hidden=false; err.textContent=msg; } };\n\n    const faves = this._getFaves();\n    const recent = this._getRecent();\n    const catalog = this._catalog();\n    const favSection = catalog.find(c=>c.id==='favorites');\n    const recSection = catalog.find(c=>c.id==='recent');\n    const allItems = catalog.flatMap(c => c.items || []);\n    favSection.items = allItems.filter(i => faves.has(i.type));\n    recSection.items = recent.map(t => allItems.find(i => i.type===t)).filter(Boolean);\n\n    const customItems = this._customCardsFromRegistry();\n    if (customItems.length) {\n      catalog.push({\n        id: 'custom',\n        name: 'Custom (installed)',\n        items: customItems,\n      });\n    }\n\n    // ---------------------------------------------------------------------------\n    // UI tweaks: hide quick fill area, add selected-card headline and fave toggle\n    // Hide the quick fill section entirely so the editor can use the full height.\n    const quickFillSecDiv = modal.querySelector('#quickFillSec');\n    if (quickFillSecDiv) quickFillSecDiv.style.display = 'none';\n    // Do not reposition the options and YAML sections. The original\n    // grid-template-rows assigns a flexible row (1fr) to the YAML section,\n    // allowing it to scroll instead of forcing the entire editor to grow.\n\n    // Set up a header in the editor for showing the selected card and a star to\n    // favorite the current card.  We create the elements once and update them\n    // whenever a different card is selected.  Favorites are persisted using\n    // existing _getFaves/_setFaves helpers.\n    const optionsHd = modal.querySelector('#optionsSec .hd');\n    // Local references for the header label and star button\n    let selInfo;\n    let favBtn;\n    // Function to update the star icon state based on whether the current card\n    // type is favorited.  Called whenever the favorites set or currentType changes.\n    const updateFavStar = () => {\n      if (!favBtn) return;\n      const on = currentType && faves.has(currentType);\n      const icon = favBtn.querySelector('ha-icon');\n      if (icon) icon.setAttribute('icon', on ? 'mdi:star' : 'mdi:star-outline');\n    };\n    // Function to update the headline text and star icon.  Called from selectType.\n    const updateHeader = (type) => {\n      if (selInfo) {\n        const item = allItems.find(i => i.type === type);\n        const nm = item ? item.name : (type || '');\n        selInfo.textContent = nm;\n      }\n      updateFavStar();\n    };\n    // Only initialize the header once.\n    if (optionsHd && !optionsHd.querySelector('.sel-info')) {\n      // Hide the existing static label if present\n      const titleSpan = optionsHd.querySelector('span');\n      if (titleSpan) {\n        titleSpan.style.display = 'none';\n      }\n      // Create the dynamic selected-card label\n      selInfo = document.createElement('span');\n      selInfo.className = 'sel-info';\n      // Flex so it grows to fill space before the star button\n      selInfo.style.flex = '1';\n      selInfo.style.fontWeight = 'bold';\n      selInfo.style.paddingRight = '8px';\n      optionsHd.insertBefore(selInfo, optionsHd.firstChild);\n      // Create the favorite star button\n      favBtn = document.createElement('button');\n      favBtn.className = 'icon-btn';\n      favBtn.setAttribute('title','Favorite');\n      Object.assign(favBtn.style, {\n        display: 'inline-flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        width: '28px',\n        height: '28px',\n        borderRadius: '6px',\n        border: '1px solid var(--divider-color)',\n        background: 'var(--primary-background-color)',\n        padding: '0',\n        marginLeft: '4px',\n        cursor: 'pointer'\n      });\n      favBtn.innerHTML = '<ha-icon icon=\"mdi:star-outline\"></ha-icon>';\n      optionsHd.appendChild(favBtn);\n      // Clicking the star toggles favorite status for the current card.\n      favBtn.addEventListener('click', (e) => {\n        e.stopPropagation();\n        if (!currentType) return;\n        if (faves.has(currentType)) {\n          faves.delete(currentType);\n        } else {\n          faves.add(currentType);\n        }\n        this._setFaves(faves);\n        updateFavStar();\n        // Re-render the list so the favorites section reflects the new state\n        renderLeft();\n      });\n    }\n    // End of UI tweaks\n\n    let __activeTab = 'visual';\n\n    const showTab = (name) => {\n      // Determine which of the three tabs is active\n      const wantYaml = name === 'yaml';\n      const wantVis  = name === 'vis';\n      const wantVisual = !wantYaml && !wantVis;\n\n      // Update tab button styling and ARIA attributes\n      tabVisual.classList.toggle('active', wantVisual);\n      tabVisual.setAttribute('aria-selected', String(wantVisual));\n      tabYaml.classList.toggle('active', wantYaml);\n      tabYaml.setAttribute('aria-selected', String(wantYaml));\n      if (tabVis) {\n        tabVis.classList.toggle('active', wantVis);\n        tabVis.setAttribute('aria-selected', String(wantVis));\n      }\n\n      // Show/hide the appropriate editor sections. Visual uses editorHost;\n      // YAML uses yamlSec; Visibility uses visSec. Only one is visible at a time.\n      editorHost.parentElement.style.display = wantVisual ? '' : 'none';\n      yamlSec.style.display   = wantYaml  ? '' : 'none';\n      if (visSec) visSec.style.display = wantVis ? '' : 'none';\n\n      if (wantYaml) {\n        yamlSec.scrollIntoView({ behavior:'smooth', block:'start' });\n      } else if (wantVis && visSec) {\n        visSec.scrollIntoView({ behavior:'smooth', block:'start' });\n      }\n\n      __activeTab = wantYaml ? 'yaml' : (wantVis ? 'vis' : 'visual');\n    };\n    \n    tabVisual.addEventListener('click', async () => {\n      showTab('visual');\n      // Mount a new editor the first time; reuse it afterward by updating config.\n      // Because visualEditor is reset in selectType(), this will always mount a fresh editor for a new card type.\n      if (!visualEditor) {\n        await mountVisualEditor(currentConfig);\n      } else {\n        try { visualEditor.setConfig?.(currentConfig); } catch {}\n      }\n    });\n\n    tabYaml.addEventListener('click', () => showTab('yaml'));\n\n    // When the Visibility tab is clicked, switch to the visibility editor.\n    if (tabVis) {\n      tabVis.addEventListener('click', () => {\n        showTab('vis');\n        // Build or refresh the visibility UI whenever the tab is opened.\n        try { buildVisUI(currentConfig); } catch {}\n      });\n    }\n    \n    // default: Visual\n    showTab('visual');\n\n    const filteredCatalog = () => {\n      const q = search.value.trim().toLowerCase();\n      return catalog\n        .map(section => ({\n          ...section,\n          items: (section.items || []).filter(\n            it => !q || it.name.toLowerCase().includes(q) || it.type.toLowerCase().includes(q)\n          )\n        }))\n        .filter(sec => (sec.items && sec.items.length) || sec.id === 'favorites' || sec.id === 'recent');\n    };\n\n    const renderLeft = () => {\n      const view = filteredCatalog();\n      left.innerHTML = '';\n      view.forEach(cat => {\n        const div = document.createElement('div');\n        div.style.padding = '12px';\n        div.style.borderBottom = '1px solid var(--divider-color)';\n        const h = document.createElement('h4'); h.textContent = cat.name; h.style.margin='0 0 10px 0'; h.style.fontSize='.92rem'; h.style.opacity='.85';\n        div.appendChild(h);\n\n        if (!cat.items.length && (cat.id==='favorites' || cat.id==='recent')) {\n          const p = document.createElement('div'); p.style.opacity='.6'; p.style.fontSize='.85rem'; p.textContent = cat.id==='favorites' ? 'No favorites yet.' : 'No recent items yet.'; div.appendChild(p);\n        } else {\n          cat.items.forEach(item => {\n            const b = document.createElement('button');\n            b.innerHTML = `<span style=\"display:inline-flex;align-items:center;gap:8px\">\n              <ha-icon icon=\"${item.icon}\"></ha-icon><span>${item.name}</span>\n            </span>`;\n            Object.assign(b.style,{display:'block',width:'100%',textAlign:'left',border:'none',background:'transparent',padding:'8px',borderRadius:'10px',cursor:'pointer'});\n            b.addEventListener('click', async () => { highlight(b); await selectType(item.type); });\n            div.appendChild(b);\n          });\n        }\n        left.appendChild(div);\n      });\n    };\n\n    const highlight = (btn) => {\n      // Reset all buttons to default appearance\n      left.querySelectorAll('button').forEach(b => {\n        b.classList.remove('active');\n        b.style.background = 'transparent';\n        b.style.color = '';\n      });\n      // Highlight the selected button so it is obvious which one is active.\n      if (btn) {\n        btn.classList.add('active');\n        // Soft highlight background and primary color text for contrast\n        btn.style.background = 'rgba(3,169,244,.12)';\n        btn.style.color = 'var(--primary-color)';\n      }\n    };\n\n    let currentConfig = null;\n    let currentType = null;\n    let yamlEditorApi = null;\n    let visualEditor = null;\n    let editor = null;\n    let pickSeq = 0; // stale-select guard\n    let __previewTimer = null;\n    let __lastPreviewCfgJSON = '';\n\n    const buildQuickFill = (type, cfg) => {\n      const sc = this._schemaForType(type);\n      quickFill.innerHTML = '';\n      if (!sc.fields.length) {\n        quickFill.innerHTML = `<div style=\"opacity:.7;font-size:.9rem\">No quick fill for this card \u2014 use the editors below.</div>`;\n        return;\n      }\n      const all = Object.keys(this.hass?.states || {});\n      const fieldWrap = document.createElement('div');\n\n      const addEntityItem = (eid, arr, container, keyForMulti) => {\n        const div = document.createElement('div');\n        Object.assign(div.style,{padding:'8px 10px',border:'1px solid var(--divider-color)',borderRadius:'10px',cursor:'pointer',userSelect:'none',display:'flex',alignItems:'center',gap:'8px'});\n        div.innerHTML = `<ha-icon icon=\"mdi:checkbox-blank-outline\"></ha-icon><span>${eid}</span>`;\n        if (arr.includes(eid)) {\n          div.style.background='rgba(3,169,244,.12)'; div.style.borderColor='var(--primary-color)';\n          div.querySelector('ha-icon').setAttribute('icon','mdi:checkbox-marked');\n        }\n        div.addEventListener('click', async () => {\n          const idx = arr.indexOf(eid);\n          if (idx>=0) arr.splice(idx,1); else arr.push(eid);\n          const on = arr.includes(eid);\n          div.style.background = on ? 'rgba(3,169,244,.12)' : '';\n          div.style.borderColor = on ? 'var(--primary-color)' : 'var(--divider-color)';\n          div.querySelector('ha-icon').setAttribute('icon', on ? 'mdi:checkbox-marked' : 'mdi:checkbox-blank-outline');\n          currentConfig = this._shapeBySchema(type, {...currentConfig, [keyForMulti]: [...arr]});\n          mountPreview(currentConfig);\n          yamlEditorApi?.setValue(currentConfig);\n        });\n        container.appendChild(div);\n      };\n\n      sc.fields.forEach(f => {\n        const row = document.createElement('div'); Object.assign(row.style,{display:'flex',gap:'8px',alignItems:'center',marginBottom:'8px'});\n        const label = document.createElement('label'); label.textContent = f.label || f.key; label.style.minWidth='130px';\n\n        if (f.type === 'entities') {\n          const wrap = document.createElement('div'); wrap.style.flex='1';\n          const filter = document.createElement('input');\n          Object.assign(filter, { placeholder:'Filter entities\u2026' });\n          Object.assign(filter.style, {\n            width:'100%', padding:'8px 10px', borderRadius:'10px',\n            border:'1px solid var(--divider-color)',\n            background:'var(--card-background-color)', color:'var(--primary-text-color)'\n          });\n          const list = document.createElement('div');\n          Object.assign(list.style, {\n            maxHeight:'220px', overflow:'auto', marginTop:'8px',\n            border:'1px solid var(--divider-color)', borderRadius:'10px', padding:'6px'\n          });\n          const pool = (f.domains && f.domains.length) ? this._statesList(f.domains) : all;\n          const selected = Array.isArray(cfg[f.key]) ? [...cfg[f.key]] : (cfg[f.key] ? [cfg[f.key]] : []);\n\n          // virtualized row renderer\n          const renderRow = (eid) => {\n            const div = document.createElement('div');\n            Object.assign(div.style, {\n              padding:'6px 10px', margin:'4px 0',\n              border:'1px solid var(--divider-color)', borderRadius:'10px',\n              cursor:'pointer', display:'flex', alignItems:'center', gap:'8px', background:''\n            });\n            const icon = document.createElement('ha-icon');\n            icon.setAttribute('icon','mdi:checkbox-blank-outline');\n            icon.style.setProperty('--mdc-icon-size','18px');\n            const text = document.createElement('span');\n            text.textContent = eid;\n            text.style.whiteSpace = 'nowrap';\n            text.style.overflow = 'hidden';\n            text.style.textOverflow = 'ellipsis';\n            div.append(icon, text);\n\n            const paint = () => {\n              const on = selected.includes(eid);\n              div.style.background = on ? 'rgba(3,169,244,.12)' : '';\n              div.style.borderColor = on ? 'var(--primary-color)' : 'var(--divider-color)';\n              icon.setAttribute('icon', on ? 'mdi:checkbox-marked' : 'mdi:checkbox-blank-outline');\n            };\n            paint();\n\n            div.addEventListener('click', () => {\n              const idx = selected.indexOf(eid);\n              if (idx >= 0) selected.splice(idx, 1); else selected.push(eid);\n              currentConfig = this._shapeBySchema(type, {...currentConfig, [f.key]: [...selected]});\n              mountPreview(currentConfig);\n              yamlEditorApi?.setValue(currentConfig);\n              paint();\n            });\n\n            return div;\n          };\n\n          let filtered = pool;\n          this._createVirtualList({ container: list, items: filtered, rowHeight: 36, renderRow });\n\n          filter.addEventListener('input', () => {\n            const q = filter.value.trim().toLowerCase();\n            filtered = pool.filter(eid => !q || eid.toLowerCase().includes(q));\n            this._createVirtualList({ container: list, items: filtered, rowHeight: 36, renderRow });\n          });\n\n          wrap.append(filter, list);\n          row.append(label, wrap);\n          currentConfig = this._shapeBySchema(type, {...cfg, [f.key]: selected});\n        }\n\n        if (f.type === 'entity') {\n          const dsWrap = document.createElement('div'); dsWrap.style.flex='1'; dsWrap.style.position='relative';\n          const ds = document.createElement('input'); ds.setAttribute('list', 'ddc_entlist_'+f.key);\n          Object.assign(ds.style,{width:'100%',padding:'8px 10px 8px 36px',borderRadius:'10px',border:'1px solid var(--divider-color)'});\n          ds.placeholder = `Select ${f.label?.toLowerCase() || 'entity'}\u2026`;\n          const iconLead = document.createElement('ha-icon'); iconLead.setAttribute('icon','mdi:magnify');\n          Object.assign(iconLead.style,{position:'absolute',left:'10px',top:'8px',width:'18px',height:'18px','--mdc-icon-size':'18px',opacity:'.7'});\n          const dl = document.createElement('datalist'); dl.id = 'ddc_entlist_'+f.key;\n          const pool = (f.domains && f.domains.length) ? this._statesList(f.domains) : Object.keys(this.hass?.states || {});\n          dl.innerHTML = pool.map(e => `<option value=\"${e}\">`).join('');\n          ds.value = Array.isArray(cfg[f.key]) ? (cfg[f.key][0] || '') : (cfg[f.key] || '');\n          ds.addEventListener('change', async () => {\n            currentConfig = this._shapeBySchema(type, {...currentConfig, [f.key]: ds.value || undefined});\n            mountPreview(currentConfig);\n            yamlEditorApi?.setValue(currentConfig);\n          });\n          dsWrap.append(iconLead, ds, dl);\n          row.append(label, dsWrap);\n        }\n\n        if (f.type === 'number') {\n          const inpWrap = document.createElement('div'); inpWrap.style.flex='1'; inpWrap.style.position='relative';\n          const inp = document.createElement('input'); inp.type='number'; if (f.step) inp.step=f.step;\n          Object.assign(inp.style,{width:'100%',padding:'8px 10px 8px 36px',borderRadius:'10px',border:'1px solid var(--divider-color)'});\n          const numIcon = document.createElement('ha-icon'); numIcon.setAttribute('icon','mdi:counter'); Object.assign(numIcon.style,{position:'absolute',left:'10px',top:'8px','--mdc-icon-size':'18px',width:'18px',height:'18px',opacity:'.7'});\n          inp.value = cfg[f.key] ?? f.default ?? '';\n          inp.addEventListener('input', async () => {\n            const v = inp.value==='' ? undefined : Number(inp.value);\n            currentConfig = this._shapeBySchema(type, {...currentConfig, [f.key]: isNaN(v)? undefined : v});\n            mountPreview(currentConfig);\n            yamlEditorApi?.setValue(currentConfig);\n          });\n          inpWrap.append(numIcon, inp);\n          row.append(label, inpWrap);\n        }\n\n        if (f.type === 'select') {\n          const selWrap = document.createElement('div'); selWrap.style.flex='1'; selWrap.style.position='relative';\n          const sel = document.createElement('select'); Object.assign(sel.style,{width:'100%',padding:'8px 10px 8px 36px',borderRadius:'10px',border:'1px solid var(--divider-color)'});\n          const selIcon = document.createElement('ha-icon'); selIcon.setAttribute('icon','mdi:format-list-bulleted'); Object.assign(selIcon.style,{position:'absolute',left:'10px',top:'8px','--mdc-icon-size':'18px',width:'18px',height:'18px',opacity:'.7'});\n          (f.options||[]).forEach(o => { const opt = document.createElement('option'); opt.value = o; sel.appendChild(opt); });\n          sel.value = cfg[f.key] ?? f.default ?? (f.options?.[0] || '');\n          sel.addEventListener('change', async () => {\n            currentConfig = this._shapeBySchema(type, {...currentConfig, [f.key]: sel.value});\n            mountPreview(currentConfig);\n            yamlEditorApi?.setValue(currentConfig);\n          });\n          selWrap.append(selIcon, sel);\n          row.append(label, selWrap);\n        }\n\n        if (f.type === 'text') {\n          const inpWrap = document.createElement('div'); inpWrap.style.flex='1'; inpWrap.style.position='relative';\n          const inp = document.createElement('input'); inp.type='text';\n          Object.assign(inp.style,{width:'100%',padding:'8px 10px 8px 36px',borderRadius:'10px',border:'1px solid var(--divider-color)'});\n          const tIcon = document.createElement('ha-icon'); tIcon.setAttribute('icon','mdi:text'); Object.assign(tIcon.style,{position:'absolute',left:'10px',top:'8px','--mdc-icon-size':'18px',width:'18px',height:'18px',opacity:'.7'});\n          inp.value = cfg[f.key] ?? '';\n          inp.addEventListener('input', async () => {\n            currentConfig = this._shapeBySchema(type, {...currentConfig, [f.key]: inp.value || undefined});\n            mountPreview(currentConfig);\n            yamlEditorApi?.setValue(currentConfig);\n          });\n          inpWrap.append(tIcon, inp);\n          row.append(label, inpWrap);\n        }\n\n        if (f.type === 'textarea') {\n          const ta = document.createElement('textarea');\n          Object.assign(ta.style,{flex:'1',minHeight:'120px',padding:'8px 10px',borderRadius:'10px',border:'1px solid var(--divider-color)'});\n          ta.value = cfg[f.key] ?? '';\n          ta.addEventListener('input', async () => {\n            currentConfig = this._shapeBySchema(type, {...currentConfig, [f.key]: ta.value || ''});\n            mountPreview(currentConfig);\n            yamlEditorApi?.setValue(currentConfig);\n          });\n          row.append(label, ta);\n        }\n\n        fieldWrap.appendChild(row);\n      });\n\n      quickFill.innerHTML = '';\n      quickFill.appendChild(fieldWrap);\n    };\n\n    /**\n     * Render the visibility editor UI. This editor allows the user to define\n     * simple conditions that control when a card should be shown. Conditions\n     * mirror the core Home Assistant visibility feature: each object in the\n     * visibility array is evaluated and all conditions must pass for the card\n     * to be visible. Only top\u2011level AND conditions are supported by this UI.\n     *\n     * Supported condition types:\n     *  - state: entity and state string\n     *  - numeric_state: entity with optional above/below thresholds\n     *  - screen: media query string\n     *  - user: comma separated user ids\n     */\n    // Maintain collapse/expand state for each visibility condition. A WeakMap\n    // allows us to associate transient UI state with each condition object\n    // without persisting it back into the config. The state survives\n    // re-rendering because the same condition objects are reused in the visList.\n    const visExpansionStates = new WeakMap();\n\n    const buildVisUIOld = (cfg) => {\n      if (!visHost) return;\n      // Ensure visibility exists on the config. Clone to avoid mutating directly.\n      let visList = Array.isArray(cfg?.visibility) ? cfg.visibility.map(c => ({ ...c })) : [];\n      const reRender = () => buildVisUI(currentConfig);\n      const updateConfig = () => {\n        // Remove empty conditions\n        visList = visList.filter((c) => c && typeof c === 'object' && c.condition);\n        currentConfig = { ...currentConfig, visibility: visList };\n        try { yamlEditorApi?.setValue(currentConfig); } catch {}\n        try { visualEditor?.setConfig?.(currentConfig); } catch {}\n        mountPreview(currentConfig);\n      };\n      const render = () => {\n        visHost.innerHTML = '';\n        // If no conditions are defined, show a friendly hint\n        if (!visList || !visList.length) {\n          const p = document.createElement('div');\n          p.style.opacity = '.7';\n          p.style.fontSize = '.9rem';\n          p.style.marginBottom = '8px';\n          p.textContent = 'No conditions defined \u2013 this card is always visible.';\n          visHost.appendChild(p);\n        }\n        visList.forEach((cond, idx) => {\n          // Container for each condition\n          const row = document.createElement('div');\n          Object.assign(row.style, { display:'flex', flexDirection:'column', gap:'6px', marginBottom:'12px', border:'1px solid var(--divider-color)', borderRadius:'8px', padding:'8px' });\n          // Header with icon and type label\n          const headerDiv = document.createElement('div');\n          Object.assign(headerDiv.style, { display:'flex', alignItems:'center', justifyContent:'space-between', marginBottom:'4px' });\n          const leftWrap = document.createElement('div');\n          leftWrap.style.display = 'flex';\n          leftWrap.style.alignItems = 'center';\n          leftWrap.style.gap = '6px';\n          const icon = document.createElement('ha-icon');\n          let iconName = 'mdi:filter';\n          const type = cond.condition || 'state';\n          if (type === 'numeric_state') iconName = 'mdi:numeric';\n          else if (type === 'screen') iconName = 'mdi:monitor';\n          else if (type === 'user') iconName = 'mdi:account';\n          else if (type === 'state') iconName = 'mdi:state-machine';\n          icon.setAttribute('icon', iconName);\n          const labelSpan = document.createElement('span');\n          labelSpan.style.fontWeight = 'bold';\n          labelSpan.style.textTransform = 'capitalize';\n          labelSpan.textContent = (type === 'numeric_state') ? 'Entity numeric state' : (type === 'state' ? 'Entity state' : (type === 'screen' ? 'Screen' : 'User'));\n          leftWrap.appendChild(icon);\n          leftWrap.appendChild(labelSpan);\n          headerDiv.appendChild(leftWrap);\n          // Menu: remove button\n          const del = document.createElement('button');\n          del.setAttribute('title','Remove condition');\n          del.innerHTML = '<ha-icon icon=\"mdi:trash-can-outline\"></ha-icon>';\n          Object.assign(del.style, { border:'none', background:'transparent', cursor:'pointer', padding:'4px', display:'inline-flex', alignItems:'center' });\n          // Ensure the delete button is positioned above other elements\n          del.style.position = 'relative';\n          del.style.zIndex = '1000';\n          del.addEventListener('click', (ev) => {\n            // Prevent the click from bubbling to parent elements (which may lock the editor)\n            ev.preventDefault();\n            ev.stopPropagation();\n            // Remove the correct condition using indexOf on the current list. This\n            // avoids relying on the stale idx value.\n            const index = visList.indexOf(cond);\n            if (index > -1) {\n              visList.splice(index, 1);\n            }\n            currentConfig.visibility = visList;\n            render();\n            updateConfig();\n          });\n          headerDiv.appendChild(del);\n          row.appendChild(headerDiv);\n          // Type selector (for choosing the condition type)\n          const typeRow = document.createElement('div');\n          typeRow.style.display = 'flex';\n          typeRow.style.gap = '8px';\n          const typeLabel = document.createElement('label');\n          typeLabel.textContent = 'Type';\n          typeLabel.style.fontSize = '.85rem';\n          typeLabel.style.marginRight = '4px';\n          const typeSel = document.createElement('select');\n          ['state','numeric_state','screen','user'].forEach((opt) => {\n            const o = document.createElement('option');\n            o.value = opt;\n            o.textContent = opt.replace('_',' ');\n            typeSel.appendChild(o);\n          });\n          typeSel.value = type;\n          typeSel.addEventListener('change', () => {\n            cond.condition = typeSel.value;\n            delete cond.entity; delete cond.state; delete cond.state_not;\n            delete cond.above; delete cond.below;\n            delete cond.media_query; delete cond.users;\n            render();\n            updateConfig();\n          });\n          typeRow.appendChild(typeLabel);\n          typeRow.appendChild(typeSel);\n          row.appendChild(typeRow);\n          // Fields container\n          const fields = document.createElement('div');\n          Object.assign(fields.style, { display:'flex', flexWrap:'wrap', gap:'8px', alignItems:'center' });\n          const addField = (labelText, inputEl) => {\n            const fieldWrap = document.createElement('div');\n            fieldWrap.style.display = 'flex';\n            fieldWrap.style.flexDirection = 'column';\n            fieldWrap.style.gap = '4px';\n            fieldWrap.style.minWidth = '150px';\n            const lbl = document.createElement('span');\n            lbl.textContent = labelText;\n            lbl.style.fontSize = '.75rem';\n            fieldWrap.appendChild(lbl);\n            fieldWrap.appendChild(inputEl);\n            fields.appendChild(fieldWrap);\n          };\n          // Render condition-specific fields\n          const renderFields = () => {\n            fields.innerHTML = '';\n            if (cond.condition === 'state') {\n              // Entity picker\n              let entPicker;\n              if (customElements.get('ha-entity-picker')) {\n                entPicker = document.createElement('ha-entity-picker');\n                entPicker.hass = this.hass;\n                entPicker.setAttribute('label','Select entity');\n                // Ensure the clear icon is visible to allow clearing the selected entity\n                entPicker.removeAttribute('hide-clear-icon');\n                entPicker.value = cond.entity || '';\n                entPicker.addEventListener('value-changed', (ev) => {\n                  // Update the selected entity.  Stop propagation so parent\n                  // controls (like delete) do not mis-handle the event.\n                  ev.stopPropagation();\n                  cond.entity = ev.detail.value || '';\n                  updateConfig();\n                });\n              } else {\n                entPicker = document.createElement('input');\n                entPicker.value = cond.entity || '';\n                entPicker.addEventListener('input', () => {\n                  cond.entity = entPicker.value.trim();\n                  updateConfig();\n                });\n                // Apply Home Assistant-like styling to the entity input fallback\n                Object.assign(entPicker.style, {\n                  padding: '8px 10px',\n                  borderRadius: '8px',\n                  background: 'var(--ha-card-background, var(--card-background-color, var(--secondary-background-color)))',\n                  border: '1px solid var(--divider-color)',\n                  color: 'var(--primary-text-color, inherit)',\n                  width: '100%',\n                  boxSizing: 'border-box'\n                });\n              }\n              addField('Entity', entPicker);\n              // Equals / Not equals selector \u2013 use ha-select when available for native styling\n              let opSel;\n              if (customElements.get('ha-select')) {\n                opSel = document.createElement('ha-select');\n                // Build options using mwc-list-item\n                const optEq = document.createElement('mwc-list-item');\n                optEq.setAttribute('value', 'state');\n                optEq.textContent = 'State is equal to';\n                const optNeq = document.createElement('mwc-list-item');\n                optNeq.setAttribute('value', 'state_not');\n                optNeq.textContent = 'State is not equal to';\n                opSel.appendChild(optEq);\n                opSel.appendChild(optNeq);\n                opSel.value = cond.state_not != null ? 'state_not' : 'state';\n                // Listen for selected event to update config\n                opSel.addEventListener('selected', (ev) => {\n                  // Prevent bubbling to avoid the editor being marked dirty incorrectly\n                  ev.stopPropagation();\n                  const v = cond.state_not != null ? cond.state_not : cond.state;\n                  if (opSel.value === 'state_not') {\n                    cond.state_not = v;\n                    delete cond.state;\n                  } else {\n                    cond.state = v;\n                    delete cond.state_not;\n                  }\n                  updateConfig();\n                });\n              } else {\n                // Fallback to native select\n                opSel = document.createElement('select');\n                opSel.innerHTML = '<option value=\"state\">State is equal to</option><option value=\"state_not\">State is not equal to</option>';\n                opSel.value = cond.state_not != null ? 'state_not' : 'state';\n                // Apply HA-like styling\n                Object.assign(opSel.style, {\n                  padding: '8px 10px',\n                  borderRadius: '8px',\n                  background: 'var(--ha-card-background, var(--card-background-color, var(--secondary-background-color)))',\n                  border: '1px solid var(--divider-color)',\n                  color: 'var(--primary-text-color, inherit)',\n                  width: '100%',\n                  boxSizing: 'border-box'\n                });\n                opSel.addEventListener('change', (ev) => {\n                  ev.stopPropagation();\n                  const v = cond.state_not != null ? cond.state_not : cond.state;\n                  if (opSel.value === 'state_not') {\n                    cond.state_not = v;\n                    delete cond.state;\n                  } else {\n                    cond.state = v;\n                    delete cond.state_not;\n                  }\n                  updateConfig();\n                });\n              }\n              addField('Match type', opSel);\n              // State value input \u2013 use ha-textfield when available for proper styling\n              let stInput;\n              if (customElements.get('ha-textfield')) {\n                stInput = document.createElement('ha-textfield');\n                stInput.value = (cond.state_not != null ? cond.state_not : cond.state) || '';\n                stInput.setAttribute('label', '');\n                stInput.addEventListener('input', (ev) => {\n                  // Update the state value immediately. Stop propagation so the\n                  // card editor does not misinterpret the input as a click\n                  // outside the field.  Ensure only one of state/state_not\n                  // exists at a time.\n                  ev.stopPropagation();\n                  const key = opSel.value;\n                  cond[key] = stInput.value;\n                  const other = key === 'state' ? 'state_not' : 'state';\n                  delete cond[other];\n                  updateConfig();\n                });\n              } else {\n                stInput = document.createElement('input');\n                stInput.value = (cond.state_not != null ? cond.state_not : cond.state) || '';\n                // Apply HA-like styling\n                Object.assign(stInput.style, {\n                  padding: '8px 10px',\n                  borderRadius: '8px',\n                  background: 'var(--ha-card-background, var(--card-background-color, var(--secondary-background-color)))',\n                  border: '1px solid var(--divider-color)',\n                  color: 'var(--primary-text-color, inherit)',\n                  width: '100%',\n                  boxSizing: 'border-box'\n                });\n                stInput.addEventListener('input', (ev) => {\n                  // Mirror numeric state behaviour: update immediately on each\n                  // keystroke and stop propagation so parent controls remain\n                  // responsive.  Ensure only one of state/state_not exists.\n                  ev.stopPropagation();\n                  const key = opSel.value;\n                  cond[key] = stInput.value;\n                  const other = key === 'state' ? 'state_not' : 'state';\n                  delete cond[other];\n                  updateConfig();\n                });\n              }\n              addField('State', stInput);\n            } else if (cond.condition === 'numeric_state') {\n              let entPicker;\n              if (customElements.get('ha-entity-picker')) {\n                entPicker = document.createElement('ha-entity-picker');\n                entPicker.hass = this.hass;\n              entPicker.setAttribute('label','Select entity');\n              entPicker.removeAttribute('hide-clear-icon');\n                entPicker.value = cond.entity || '';\n              entPicker.addEventListener('value-changed', (ev) => {\n                  ev.stopPropagation();\n                  cond.entity = ev.detail.value || '';\n                  updateConfig();\n                });\n              } else {\n                entPicker = document.createElement('input');\n                entPicker.value = cond.entity || '';\n                entPicker.addEventListener('input', () => {\n                  cond.entity = entPicker.value.trim();\n                  updateConfig();\n                });\n                // Apply Home Assistant-like styling to the entity input fallback\n                Object.assign(entPicker.style, {\n                  padding: '8px 10px',\n                  borderRadius: '8px',\n                  background: 'var(--ha-card-background, var(--card-background-color, var(--secondary-background-color)))',\n                  border: '1px solid var(--divider-color)',\n                  color: 'var(--primary-text-color, inherit)',\n                  width: '100%',\n                  boxSizing: 'border-box'\n                });\n              }\n              addField('Entity', entPicker);\n              // Above threshold \u2013 use ha-textfield (type number) when available\n              let aboveField;\n              if (customElements.get('ha-textfield')) {\n                aboveField = document.createElement('ha-textfield');\n                aboveField.setAttribute('type', 'number');\n                aboveField.value = cond.above != null ? cond.above : '';\n                aboveField.addEventListener('input', (ev) => {\n                  ev.stopPropagation();\n                  const v = aboveField.value;\n                  if (v === '' || isNaN(Number(v))) delete cond.above;\n                  else cond.above = Number(v);\n                  updateConfig();\n                });\n              } else {\n                aboveField = document.createElement('input');\n                aboveField.type = 'number';\n                aboveField.value = cond.above != null ? cond.above : '';\n                Object.assign(aboveField.style, {\n                  padding: '8px 10px',\n                  borderRadius: '8px',\n                  background: 'var(--ha-card-background, var(--card-background-color, var(--secondary-background-color)))',\n                  border: '1px solid var(--divider-color)',\n                  color: 'var(--primary-text-color, inherit)',\n                  width: '100%',\n                  boxSizing: 'border-box'\n                });\n                aboveField.addEventListener('input', () => {\n                  const v = aboveField.value;\n                  if (v === '' || isNaN(Number(v))) delete cond.above;\n                  else cond.above = Number(v);\n                  updateConfig();\n                });\n              }\n              addField('Above', aboveField);\n              // Below threshold \u2013 use ha-textfield when available\n              let belowField;\n              if (customElements.get('ha-textfield')) {\n                belowField = document.createElement('ha-textfield');\n                belowField.setAttribute('type', 'number');\n                belowField.value = cond.below != null ? cond.below : '';\n                belowField.addEventListener('input', (ev) => {\n                  ev.stopPropagation();\n                  const v = belowField.value;\n                  if (v === '' || isNaN(Number(v))) delete cond.below;\n                  else cond.below = Number(v);\n                  updateConfig();\n                });\n              } else {\n                belowField = document.createElement('input');\n                belowField.type = 'number';\n                belowField.value = cond.below != null ? cond.below : '';\n                Object.assign(belowField.style, {\n                  padding: '8px 10px',\n                  borderRadius: '8px',\n                  background: 'var(--ha-card-background, var(--card-background-color, var(--secondary-background-color)))',\n                  border: '1px solid var(--divider-color)',\n                  color: 'var(--primary-text-color, inherit)',\n                  width: '100%',\n                  boxSizing: 'border-box'\n                });\n                belowField.addEventListener('input', () => {\n                  const v = belowField.value;\n                  if (v === '' || isNaN(Number(v))) delete cond.below;\n                  else cond.below = Number(v);\n                  updateConfig();\n                });\n              }\n              addField('Below', belowField);\n            } else if (cond.condition === 'screen') {\n              // Predefined options for screen sizes\n              const screenSel = document.createElement('select');\n              const presets = [\n                { label:'Custom', value:'' },\n                { label:'Mobile (max-width: 599px)', value:'(max-width: 599px)' },\n                { label:'Tablet (600px - 991px)', value:'(min-width: 600px) and (max-width: 991px)' },\n                { label:'Desktop (min-width: 992px)', value:'(min-width: 992px)' }\n              ];\n              presets.forEach(p => {\n                const o = document.createElement('option');\n                o.value = p.value;\n                o.textContent = p.label;\n                screenSel.appendChild(o);\n              });\n              screenSel.value = presets.find(p => p.value === (cond.media_query || ''))?.value ?? '';\n              screenSel.addEventListener('change', () => {\n                cond.media_query = screenSel.value;\n                updateConfig();\n              });\n              addField('Screen size', screenSel);\n              // If custom selected, show text input for custom media query\n              if (screenSel.value === '') {\n                const customInp = document.createElement('input');\n                customInp.placeholder = 'e.g. (min-width: 1280px)';\n                customInp.value = cond.media_query || '';\n                customInp.addEventListener('input', () => {\n                  cond.media_query = customInp.value;\n                  updateConfig();\n                });\n                addField('Custom query', customInp);\n              }\n            } else if (cond.condition === 'user') {\n              let userPicker;\n              if (customElements.get('ha-user-picker')) {\n                userPicker = document.createElement('ha-user-picker');\n                userPicker.hass = this.hass;\n                userPicker.value = Array.isArray(cond.users) ? cond.users : [];\n                userPicker.addEventListener('value-changed', (ev) => {\n                  cond.users = Array.isArray(ev.detail.value) ? ev.detail.value : [ev.detail.value];\n                  updateConfig();\n                });\n              } else {\n                userPicker = document.createElement('input');\n                userPicker.value = Array.isArray(cond.users) ? cond.users.join(',') : '';\n                userPicker.addEventListener('input', () => {\n                  cond.users = userPicker.value.split(',').map(s => s.trim()).filter(Boolean);\n                  updateConfig();\n                });\n              }\n              addField('Users', userPicker);\n            }\n          };\n          renderFields();\n          row.appendChild(fields);\n          visHost.appendChild(row);\n        });\n        // Add condition button\n        const addBtn = document.createElement('button');\n        addBtn.className = 'btn';\n        addBtn.innerHTML = '<ha-icon icon=\"mdi:plus\"></ha-icon><span style=\"margin-left:6px\">Add condition</span>';\n        Object.assign(addBtn.style, { marginTop:'8px' });\n        addBtn.addEventListener('click', () => {\n          visList.push({ condition:'state', entity:'', state:'' });\n          currentConfig.visibility = visList;\n          render();\n          updateConfig();\n        });\n        visHost.appendChild(addBtn);\n      };\n      // Initialize\n      render();\n    };\n\n    /**\n     * Enhanced visibility editor UI supporting nested AND/OR groups and a\n     * selection menu when adding new conditions. This implementation renders\n     * conditions recursively and stores expansion state in the shared\n     * visExpansionStates WeakMap. It does not modify the existing\n     * buildVisUIOld implementation but overrides usage by defining a new\n     * buildVisUI constant. Calls throughout the card manager will use this\n     * enhanced editor.\n     */\n    const buildVisUI = (cfg) => {\n      if (!visHost) return;\n      // Use the actual visibility array (do not clone) so updates persist.\n      let visList = Array.isArray(cfg?.visibility) ? cfg.visibility : [];\n      // Cache for asynchronous user list fetches.  We only fetch once per\n      // buildVisUI invocation to avoid redundant requests.\n      let __cachedUserList = null;\n      const fetchUsers = async () => {\n        // Return cached list if already fetched\n        if (__cachedUserList) return __cachedUserList;\n        try {\n          // Attempt to use WebSocket API to list users (requires admin privileges)\n          if (this.hass && typeof this.hass.callWS === 'function') {\n            try {\n              const resp = await this.hass.callWS({ type: 'config/auth/list' });\n              if (Array.isArray(resp)) {\n                __cachedUserList = resp;\n                return resp;\n              }\n            } catch {}\n          }\n          // Fallback to REST API (may require auth)\n          if (this.hass && typeof this.hass.callApi === 'function') {\n            try {\n              const resp = await this.hass.callApi('get', 'users');\n              if (Array.isArray(resp)) {\n                __cachedUserList = resp;\n                return resp;\n              }\n            } catch {}\n          }\n          // Attempt to extract users from hass object when API is unavailable.\n          const fallbackLists = [];\n          // Some HA versions expose authorized users or user registry on hass\n          // Try various common properties to discover user info\n          if (this.hass && this.hass.users && Array.isArray(this.hass.users)) {\n            fallbackLists.push(...this.hass.users);\n          }\n          if (this.hass && this.hass.userData && Array.isArray(this.hass.userData.users)) {\n            fallbackLists.push(...this.hass.userData.users);\n          }\n          if (this.hass && this.hass.authorizedUsers && Array.isArray(this.hass.authorizedUsers)) {\n            fallbackLists.push(...this.hass.authorizedUsers);\n          }\n          // Remove duplicates based on id\n          if (fallbackLists.length) {\n            const map = new Map();\n            fallbackLists.forEach((u) => {\n              const uid = u.id || u.user_id || u.uid || u.name || '';\n              if (!map.has(uid)) map.set(uid, u);\n            });\n            const arr = Array.from(map.values());\n            __cachedUserList = arr;\n            return arr;\n          }\n        } catch {}\n        // If nothing is found, return empty array\n        __cachedUserList = [];\n        return [];\n      };\n\n      const updateConfig = () => {\n        // Clean up any null/undefined conditions\n        visList = visList.filter((c) => c && typeof c === 'object' && c.condition);\n        currentConfig.visibility = visList;\n        try { yamlEditorApi?.setValue(currentConfig); } catch {}\n        try { visualEditor?.setConfig?.(currentConfig); } catch {}\n        mountPreview(currentConfig);\n      };\n      const render = () => {\n        visHost.innerHTML = '';\n        // Instruction message\n        const instr = document.createElement('div');\n        instr.style.opacity = '.75';\n        instr.style.fontSize = '.85rem';\n        instr.style.marginBottom = '12px';\n        instr.textContent = 'The card will be shown when ALL conditions below are fulfilled. If no conditions are set, the card will always be shown.';\n        visHost.appendChild(instr);\n        // Recursive render for lists\n        const renderList = (list, container) => {\n          list.forEach((cond, idx) => {\n            renderCondition(cond, list, idx, container);\n          });\n          // Add button for this list\n          const addWrap = document.createElement('div');\n          addWrap.style.marginTop = '8px';\n          const btn = document.createElement('button');\n          btn.className = 'btn';\n          btn.innerHTML = '<ha-icon icon=\"mdi:plus\"></ha-icon><span style=\"margin-left:6px\">Add condition</span>';\n          // Apply pill-like styling similar to the official editor\n          Object.assign(btn.style, {\n            display: 'flex',\n            alignItems: 'center',\n            gap: '6px',\n            padding: '6px 12px',\n            border: 'none',\n            borderRadius: '20px',\n            background: 'var(--primary-color)',\n            color: 'var(--text-primary-color, #fff)',\n            cursor: 'pointer',\n            fontWeight: '500',\n          });\n          btn.addEventListener('click', (ev) => {\n            ev.stopPropagation();\n            // Toggle menu\n            const existing = addWrap.querySelector('.add-menu');\n            if (existing) {\n              existing.remove();\n              return;\n            }\n            const menu = document.createElement('div');\n            menu.className = 'add-menu';\n            Object.assign(menu.style, {\n              position: 'relative',\n              marginTop: '4px',\n              border: '1px solid var(--divider-color)',\n              borderRadius: '8px',\n              background: 'var(--card-background-color, var(--secondary-background-color))',\n              boxShadow: '0 2px 4px rgba(0,0,0,0.2)'\n            });\n            const options = [\n              { type: 'numeric_state', label: 'Entity numeric state', icon: 'mdi:numeric' },\n              { type: 'state', label: 'Entity state', icon: 'mdi:state-machine' },\n              { type: 'screen', label: 'Screen', icon: 'mdi:monitor' },\n              { type: 'user', label: 'User', icon: 'mdi:account' },\n              { type: 'and', label: 'And', icon: 'mdi:logic-and' },\n              { type: 'or', label: 'Or', icon: 'mdi:logic-or' }\n            ];\n            options.forEach((opt) => {\n              const item = document.createElement('div');\n              item.style.display = 'flex';\n              item.style.alignItems = 'center';\n              item.style.gap = '8px';\n              item.style.padding = '6px 12px';\n              item.style.cursor = 'pointer';\n              item.addEventListener('mouseenter', () => item.style.background = 'var(--hover-color, #444)');\n              item.addEventListener('mouseleave', () => item.style.background = '');\n              item.addEventListener('click', () => {\n                menu.remove();\n                let newCond;\n                if (opt.type === 'and' || opt.type === 'or') {\n                  newCond = { condition: opt.type, conditions: [] };\n                } else if (opt.type === 'state') {\n                  newCond = { condition: 'state', entity: '', state: '' };\n                } else if (opt.type === 'numeric_state') {\n                  newCond = { condition: 'numeric_state', entity: '' };\n                } else if (opt.type === 'screen') {\n                  newCond = { condition: 'screen', media_query: '' };\n                } else if (opt.type === 'user') {\n                  newCond = { condition: 'user', users: [] };\n                }\n                list.push(newCond);\n                visExpansionStates.set(newCond, true);\n                updateConfig();\n                render();\n              });\n              const ic = document.createElement('ha-icon');\n              ic.setAttribute('icon', opt.icon);\n              item.appendChild(ic);\n              const la = document.createElement('span');\n              la.textContent = opt.label;\n              item.appendChild(la);\n              menu.appendChild(item);\n            });\n            addWrap.appendChild(menu);\n          });\n          addWrap.appendChild(btn);\n          container.appendChild(addWrap);\n        };\n        const renderCondition = (cond, parentList, idx, container) => {\n          const type = cond.condition || 'state';\n          let expanded = visExpansionStates.get(cond);\n          if (expanded === undefined) expanded = visList.length === 1;\n          const row = document.createElement('div');\n          // Style the condition container to more closely resemble Home Assistant\u2019s editor cards.\n          Object.assign(row.style, {\n            display: 'flex',\n            flexDirection: 'column',\n            border: '1px solid var(--divider-color)',\n            borderLeft: '3px solid var(--primary-color)',\n            borderRadius: '12px',\n            padding: '16px',\n            marginBottom: '20px',\n            background: 'var(--ha-card-background, var(--card-background-color, var(--secondary-background-color)))',\n            boxShadow: 'var(--ha-card-box-shadow, 0 2px 6px rgba(0, 0, 0, 0.15))'\n          });\n          // Header\n          const header = document.createElement('div');\n          header.style.display = 'flex';\n          header.style.alignItems = 'center';\n          header.style.justifyContent = 'space-between';\n          header.style.marginBottom = '8px';\n          // Subtle bottom border to separate header from fields\n          header.style.borderBottom = '1px solid var(--divider-color)';\n          header.style.paddingBottom = '4px';\n          // Ensure the header sits above any overlay elements (e.g. selects)\n          header.style.position = 'relative';\n          const left = document.createElement('div');\n          left.style.display = 'flex';\n          left.style.alignItems = 'center';\n          left.style.gap = '6px';\n          const toggle = document.createElement('button');\n          toggle.innerHTML = `<ha-icon icon=\"${expanded ? 'mdi:chevron-down' : 'mdi:chevron-right'}\"></ha-icon>`;\n          Object.assign(toggle.style, {\n            border: 'none',\n            background: 'transparent',\n            cursor: 'pointer',\n            padding: '4px',\n            display: 'inline-flex',\n            alignItems: 'center'\n          });\n          toggle.addEventListener('click', (ev) => {\n            ev.stopPropagation();\n            visExpansionStates.set(cond, !expanded);\n            render();\n          });\n          left.appendChild(toggle);\n          // Icon\n          const ic = document.createElement('ha-icon');\n          let iconName = 'mdi:filter';\n          if (type === 'numeric_state') iconName = 'mdi:numeric';\n          else if (type === 'screen') iconName = 'mdi:monitor';\n          else if (type === 'user') iconName = 'mdi:account';\n          else if (type === 'state') iconName = 'mdi:state-machine';\n          else if (type === 'and') iconName = 'mdi:logic-and';\n          else if (type === 'or') iconName = 'mdi:logic-or';\n          ic.setAttribute('icon', iconName);\n          left.appendChild(ic);\n          const lab = document.createElement('span');\n          lab.style.fontWeight = '600';\n          lab.style.fontSize = '0.95rem';\n          lab.style.textTransform = 'capitalize';\n          lab.textContent = (type === 'numeric_state')\n            ? 'Entity numeric state'\n            : (type === 'state'\n                ? 'Entity state'\n                : (type === 'screen'\n                    ? 'Screen'\n                    : (type === 'user'\n                        ? 'User'\n                        : (type === 'and' ? 'And' : 'Or'))));\n          left.appendChild(lab);\n          header.appendChild(left);\n          // Remove button\n          const rm = document.createElement('button');\n          rm.setAttribute('title', 'Remove condition');\n          rm.innerHTML = '<ha-icon icon=\"mdi:trash-can-outline\"></ha-icon>';\n          Object.assign(rm.style, {\n            border: 'none',\n            background: 'transparent',\n            cursor: 'pointer',\n            padding: '4px',\n            display: 'inline-flex',\n            alignItems: 'center'\n          });\n          // Ensure the remove button stays clickable above other elements\n          rm.style.position = 'relative';\n          rm.style.zIndex = '1000';\n          rm.addEventListener('click', (ev) => {\n            // Prevent default and stop propagation so the click does not get swallowed\n            ev.preventDefault();\n            ev.stopPropagation();\n            // Locate this condition in its parent list and remove it. Using\n            // indexOf ensures we remove the correct object even if indices\n            // shift due to other operations.\n            const index = parentList.indexOf(cond);\n            if (index > -1) {\n              parentList.splice(index, 1);\n            }\n            updateConfig();\n            render();\n          });\n          header.appendChild(rm);\n          row.appendChild(header);\n          // Leaf\n          if (type !== 'and' && type !== 'or') {\n            if (expanded) {\n              // Omit the type selector row for leaf conditions. Users choose the\n              // condition type when adding a condition. To change types, remove\n              // the condition and add a new one.  This streamlines the UI to\n              // more closely match the native Home Assistant appearance.\n              // Fields container\n              const fields = document.createElement('div');\n              // Arrange input fields in a single column to more closely match the\n              // native Home Assistant editor.  Each field will stack below the\n              // previous one.  Use a consistent vertical gap for breathing room.\n              Object.assign(fields.style, {\n                display: 'flex',\n                flexDirection: 'column',\n                gap: '14px',\n                alignItems: 'stretch'\n              });\n              const addField = (lbl, inputEl) => {\n                const wrap = document.createElement('div');\n                wrap.style.display = 'flex';\n                wrap.style.flexDirection = 'column';\n                wrap.style.gap = '4px';\n                const l = document.createElement('span');\n                l.textContent = lbl;\n                l.style.fontSize = '.75rem';\n                wrap.appendChild(l);\n                wrap.appendChild(inputEl);\n                fields.appendChild(wrap);\n                // Apply dark styling to plain input/select elements for a cohesive look\n                const tn = (inputEl.tagName || '').toLowerCase();\n                if (tn === 'input' || tn === 'select') {\n                  Object.assign(inputEl.style, {\n                    padding: '8px 10px',\n                    borderRadius: '8px',\n                    background: 'var(--ha-card-background, var(--card-background-color, var(--secondary-background-color)))',\n                    border: '1px solid var(--divider-color)',\n                    color: 'var(--primary-text-color, inherit)',\n                    width: '100%',\n                    boxSizing: 'border-box'\n                  });\n                }\n              };\n              if (cond.condition === 'state') {\n                // Always attempt to use ha-entity-picker for a consistent user experience.\n                let ent = document.createElement('ha-entity-picker');\n                // Provide initial value and hass as soon as possible.\n                ent.value = cond.entity || '';\n                // In some cases the custom element may not yet be defined. When it\n                // upgrades, assign hass and register event listeners. Until then,\n                // these assignments are harmless no-ops.\n                ent.hass = this.hass;\n                ent.setAttribute('label', 'Select entity');\n                // Listen for changes when the element is ready.  The event\n                // listener will still fire once upgraded.\n                ent.addEventListener('value-changed', (ev) => {\n                  // Update the selected entity.  Do not stop propagation here\n                  // so that other click handlers (like remove) continue to work\n                  // properly.  This mirrors the behaviour of numeric state.\n                  cond.entity = ev.detail.value || '';\n                  updateConfig();\n                });\n                // If the element is not yet defined, re-render once it is.\n                if (!customElements.get('ha-entity-picker')) {\n                  customElements.whenDefined('ha-entity-picker').then(() => {\n                    // Re-render this condition to upgrade from a plain element to\n                    // the actual picker UI. Preserve expansion state.\n                    render();\n                  }).catch(() => {});\n                }\n                addField('Entity', ent);\n                // Equals / Not equals selector \u2013 use ha-select if available for native styling\n                let op;\n                if (customElements.get('ha-select')) {\n                  op = document.createElement('ha-select');\n                  const optEq = document.createElement('mwc-list-item');\n                  optEq.setAttribute('value', 'state');\n                  optEq.textContent = 'State is equal to';\n                  const optNeq = document.createElement('mwc-list-item');\n                  optNeq.setAttribute('value', 'state_not');\n                  optNeq.textContent = 'State is not equal to';\n                  op.appendChild(optEq);\n                  op.appendChild(optNeq);\n                  op.value = cond.state_not != null ? 'state_not' : 'state';\n                  op.addEventListener('selected', (ev) => {\n                    ev.stopPropagation();\n                    const v = cond.state_not != null ? cond.state_not : cond.state;\n                    if (op.value === 'state_not') {\n                      cond.state_not = v;\n                      delete cond.state;\n                    } else {\n                      cond.state = v;\n                      delete cond.state_not;\n                    }\n                    updateConfig();\n                  });\n                } else {\n                  op = document.createElement('select');\n                  op.innerHTML = '<option value=\"state\">State is equal to</option><option value=\"state_not\">State is not equal to</option>';\n                  op.value = cond.state_not != null ? 'state_not' : 'state';\n                  op.addEventListener('change', (ev) => {\n                    ev.stopPropagation();\n                    const v = cond.state_not != null ? cond.state_not : cond.state;\n                    if (op.value === 'state_not') {\n                      cond.state_not = v;\n                      delete cond.state;\n                    } else {\n                      cond.state = v;\n                      delete cond.state_not;\n                    }\n                    updateConfig();\n                  });\n                  // Apply HA-like styling to the fallback select\n                  Object.assign(op.style, {\n                    padding: '8px 10px',\n                    borderRadius: '8px',\n                    background: 'var(--ha-card-background, var(--card-background-color, var(--secondary-background-color)))',\n                    border: '1px solid var(--divider-color)',\n                    color: 'var(--primary-text-color, inherit)',\n                    width: '100%',\n                    boxSizing: 'border-box'\n                  });\n                }\n                addField('Match type', op);\n                // State value input \u2013 use ha-textfield when available\n                let st;\n                if (customElements.get('ha-textfield')) {\n                st = document.createElement('ha-textfield');\n                  st.value = (cond.state_not != null ? cond.state_not : cond.state) || '';\n                  st.setAttribute('label', '');\n                st.addEventListener('input', (ev) => {\n                    // Mirror numeric state behaviour: update on each keystroke\n                    // and stop propagation so parent controls remain responsive.\n                    // Ensure only one of state/state_not exists.\n                    ev.stopPropagation();\n                    const key = op.value;\n                    cond[key] = st.value;\n                    const other = key === 'state' ? 'state_not' : 'state';\n                    delete cond[other];\n                    updateConfig();\n                  });\n                } else {\n                st = document.createElement('input');\n                  st.value = (cond.state_not != null ? cond.state_not : cond.state) || '';\n                  // Apply HA-like styling to the fallback input\n                  Object.assign(st.style, {\n                    padding: '8px 10px',\n                    borderRadius: '8px',\n                    background: 'var(--ha-card-background, var(--card-background-color, var(--secondary-background-color)))',\n                    border: '1px solid var(--divider-color)',\n                    color: 'var(--primary-text-color, inherit)',\n                    width: '100%',\n                    boxSizing: 'border-box'\n                  });\n                  st.addEventListener('input', (ev) => {\n                    // Mirror numeric state behaviour: update immediately on\n                    // input and stop propagation so the event does not bubble.\n                    // Ensure only one of state/state_not exists at a time.\n                    ev.stopPropagation();\n                    const key = op.value;\n                    cond[key] = st.value;\n                    const other = key === 'state' ? 'state_not' : 'state';\n                    delete cond[other];\n                    updateConfig();\n                  });\n                }\n                addField('State', st);\n              } else if (cond.condition === 'numeric_state') {\n                // Always attempt to use ha-entity-picker for numeric state conditions.\n                let ent = document.createElement('ha-entity-picker');\n                // Provide initial value and hass property.\n                ent.value = cond.entity || '';\n                ent.hass = this.hass;\n                ent.setAttribute('label', 'Select entity');\n                // Show clear icon so the user can remove the selected entity\n                ent.removeAttribute('hide-clear-icon');\n                ent.addEventListener('value-changed', (ev) => {\n                  cond.entity = ev.detail.value || '';\n                  updateConfig();\n                });\n                // If the custom element is not yet defined, re-render when it upgrades.\n                if (!customElements.get('ha-entity-picker')) {\n                  customElements.whenDefined('ha-entity-picker').then(() => {\n                    render();\n                  }).catch(() => {});\n                }\n                addField('Entity', ent);\n                // Above threshold \u2013 use ha-textfield when available\n                let above;\n                if (customElements.get('ha-textfield')) {\n                  above = document.createElement('ha-textfield');\n                  above.setAttribute('type', 'number');\n                  above.value = cond.above != null ? cond.above : '';\n                above.addEventListener('input', (ev) => {\n                    ev.stopPropagation();\n                    const v = above.value;\n                    if (v === '' || isNaN(Number(v))) delete cond.above;\n                    else cond.above = Number(v);\n                    updateConfig();\n                  });\n                } else {\n                  above = document.createElement('input');\n                  above.type = 'number';\n                  above.value = cond.above != null ? cond.above : '';\n                  // Apply HA-like styling to the fallback numeric input\n                  Object.assign(above.style, {\n                    padding: '8px 10px',\n                    borderRadius: '8px',\n                    background: 'var(--ha-card-background, var(--card-background-color, var(--secondary-background-color)))',\n                    border: '1px solid var(--divider-color)',\n                    color: 'var(--primary-text-color, inherit)',\n                    width: '100%',\n                    boxSizing: 'border-box'\n                  });\n                  above.addEventListener('input', () => {\n                    const v = above.value;\n                    if (v === '' || isNaN(Number(v))) delete cond.above;\n                    else cond.above = Number(v);\n                    updateConfig();\n                  });\n                }\n                addField('Above', above);\n                // Below threshold \u2013 use ha-textfield when available\n                let below;\n                if (customElements.get('ha-textfield')) {\n                  below = document.createElement('ha-textfield');\n                  below.setAttribute('type', 'number');\n                  below.value = cond.below != null ? cond.below : '';\n                below.addEventListener('input', (ev) => {\n                    ev.stopPropagation();\n                    const v = below.value;\n                    if (v === '' || isNaN(Number(v))) delete cond.below;\n                    else cond.below = Number(v);\n                    updateConfig();\n                  });\n                } else {\n                  below = document.createElement('input');\n                  below.type = 'number';\n                  below.value = cond.below != null ? cond.below : '';\n                  // Apply HA-like styling to the fallback numeric input\n                  Object.assign(below.style, {\n                    padding: '8px 10px',\n                    borderRadius: '8px',\n                    background: 'var(--ha-card-background, var(--card-background-color, var(--secondary-background-color)))',\n                    border: '1px solid var(--divider-color)',\n                    color: 'var(--primary-text-color, inherit)',\n                    width: '100%',\n                    boxSizing: 'border-box'\n                  });\n                  below.addEventListener('input', () => {\n                    const v = below.value;\n                    if (v === '' || isNaN(Number(v))) delete cond.below;\n                    else cond.below = Number(v);\n                    updateConfig();\n                  });\n                }\n                addField('Below', below);\n              } else if (cond.condition === 'screen') {\n                const opts = [\n                  { label: 'Mobile', query: '(max-width: 599px)' },\n                  { label: 'Tablet (min: 768px)', query: '(min-width: 768px)' },\n                  { label: 'Desktop (min: 1024px)', query: '(min-width: 1024px)' },\n                  { label: 'Wide (min: 1280px)', query: '(min-width: 1280px)' }\n                ];\n                if (!Array.isArray(cond.media_query_list)) cond.media_query_list = [];\n                const box = document.createElement('div');\n                box.style.display = 'flex';\n                box.style.flexDirection = 'column';\n                box.style.gap = '4px';\n                opts.forEach((opt) => {\n                  const rowcb = document.createElement('label');\n                  rowcb.style.display = 'flex';\n                  rowcb.style.alignItems = 'center';\n                  rowcb.style.gap = '6px';\n                  const cb = document.createElement('input');\n                  cb.type = 'checkbox';\n                  cb.checked = cond.media_query_list.includes(opt.query);\n                  cb.addEventListener('change', () => {\n                    if (cb.checked) {\n                      cond.media_query_list.push(opt.query);\n                    } else {\n                      cond.media_query_list = cond.media_query_list.filter((q) => q !== opt.query);\n                    }\n                    cond.media_query = cond.media_query_list.join(',');\n                    updateConfig();\n                  });\n                  const sp = document.createElement('span');\n                  sp.textContent = opt.label;\n                  rowcb.appendChild(cb);\n                  rowcb.appendChild(sp);\n                  box.appendChild(rowcb);\n                });\n                addField('Screen sizes', box);\n              } else if (cond.condition === 'user') {\n                let up;\n                if (customElements.get('ha-user-picker')) {\n                  // Use the built\u2011in user picker when available\n                  up = document.createElement('ha-user-picker');\n                  up.hass = this.hass;\n                  up.setAttribute('label', 'Select user');\n                  up.value = Array.isArray(cond.users) ? cond.users : [];\n                  up.addEventListener('value-changed', (ev) => {\n                    const val = ev.detail.value;\n                    cond.users = Array.isArray(val) ? val : [val];\n                    updateConfig();\n                  });\n                } else {\n                  // Fallback: create a container that will be filled asynchronously\n                  up = document.createElement('div');\n                  up.style.display = 'flex';\n                  up.style.flexDirection = 'column';\n                  up.style.gap = '4px';\n                    // Show a loading indicator while fetching\n                  const loading = document.createElement('span');\n                  loading.style.opacity = '0.7';\n                  loading.style.fontSize = '.85rem';\n                  loading.textContent = 'Loading users\u2026';\n                  up.appendChild(loading);\n                  // Preserve current selection\n                  const selUsers = Array.isArray(cond.users) ? cond.users : [];\n                  fetchUsers().then((uList) => {\n                    up.innerHTML = '';\n                    if (Array.isArray(uList) && uList.length) {\n                      // Build checkbox list for each user\n                      uList.forEach((u) => {\n                        const uid = u.id || u.user_id || u.uid || u.name || '';\n                        const uname = u.name || uid;\n                        const lbl = document.createElement('label');\n                        lbl.style.display = 'flex';\n                        lbl.style.alignItems = 'center';\n                        lbl.style.gap = '6px';\n                        lbl.style.padding = '4px 0';\n                        const cb = document.createElement('input');\n                        cb.type = 'checkbox';\n                        cb.checked = selUsers.includes(uid) || selUsers.includes(uname);\n                        cb.addEventListener('change', () => {\n                          let arr = Array.isArray(cond.users) ? cond.users.slice() : [];\n                          if (cb.checked) {\n                            if (!arr.includes(uid)) arr.push(uid);\n                          } else {\n                            arr = arr.filter((x) => x !== uid && x !== uname);\n                          }\n                          cond.users = arr;\n                          updateConfig();\n                        });\n                        const sp = document.createElement('span');\n                        sp.textContent = uname;\n                        lbl.appendChild(cb);\n                        lbl.appendChild(sp);\n                        up.appendChild(lbl);\n                      });\n                    } else {\n                      // Still fallback to simple input if no users found via API\n                      const inp = document.createElement('input');\n                      inp.value = Array.isArray(cond.users) ? cond.users.join(',') : '';\n                      // Style the manual users input for consistency\n                      Object.assign(inp.style, {\n                        padding: '6px 10px',\n                        borderRadius: '6px',\n                        border: '1px solid var(--divider-color)',\n                        background: 'var(--card-background-color, var(--secondary-background-color))',\n                        color: 'var(--primary-text-color, inherit)'\n                      });\n                      const commit = () => {\n                        cond.users = inp.value.split(',').map((s) => s.trim()).filter(Boolean);\n                        updateConfig();\n                      };\n                      inp.addEventListener('change', commit);\n                      inp.addEventListener('blur', commit);\n                      up.appendChild(inp);\n                    }\n                  });\n                }\n                addField('Users', up);\n              }\n              row.appendChild(fields);\n            }\n          } else {\n            // Group\n            if (expanded) {\n              if (!Array.isArray(cond.conditions)) cond.conditions = [];\n              const childContainer = document.createElement('div');\n              childContainer.style.marginLeft = '16px';\n              renderList(cond.conditions, childContainer);\n              row.appendChild(childContainer);\n            }\n          }\n          container.appendChild(row);\n        };\n        // Render top level\n        renderList(visList, visHost);\n      };\n      render();\n    };\n\n    const mountPreview = (cfg) => {\n      if ((cfg?.type || '') === 'custom_card') {\n        __lastPreviewCfgJSON = JSON.stringify(cfg || {});\n        cardHost.innerHTML = '<div style=\"opacity:.6;font-size:.9rem;padding:8px\">Preview not available for the custom card placeholder. Use the YAML editor.</div>';\n        previewSpin.hidden = true;\n        return;\n      }\n      const cfgJSON = JSON.stringify(cfg || {});\n      if (cfgJSON === __lastPreviewCfgJSON) return; // same config, skip\n      __lastPreviewCfgJSON = cfgJSON;\n      if (__previewTimer) clearTimeout(__previewTimer);\n      __previewTimer = setTimeout(async () => {\n        const seq = ++pickSeq;\n        previewSpin.hidden = false;\n        cardHost.innerHTML = '';\n        await raf();\n        try {\n          const helpers = (await this._helpersPromise) || await window.loadCardHelpers();\n          if (seq !== pickSeq) return;\n          const temp = helpers.createCardElement(cfg); temp.hass = this.hass;\n          if (seq !== pickSeq) return;\n          cardHost.appendChild(temp);\n        } catch {}\n        finally { if (seq === pickSeq) previewSpin.hidden = true; }\n      }, 150); // 150\u2013250ms is a sweet spot\n    };\n\n      const mountVisualEditor = async (cfg) => {\n        const seq = ++pickSeq;\n        editorSpin.hidden = false;\n        editorHost.innerHTML = '';\n        await idle();\n\n        const wantType = cfg.type || currentType;\n\n        editor = await this._getEditorElementForType(wantType, cfg);\n\n\n        // \uD83D\uDEAB Visual editor not supported for the placeholder entry\n        if (wantType === 'custom_card') {\n          // Show a friendly note and switch to YAML\n          const p = document.createElement('div');\n          p.style.opacity = '.7';\n          p.style.fontSize = '.9rem';\n          p.textContent = 'Custom card placeholder: use the YAML editor to paste the card type and options.';\n          editorHost.appendChild(p);\n\n          visualEditor = null;\n          if (__activeTab !== 'yaml') showTab('yaml');\n          enableCommit(true);\n          editorSpin.hidden = true;\n          return false;\n        }\n\n      if (!editor) {\n        // No UI editor \u2192 show YAML (unless user explicitly selected Visual)\n        const p = document.createElement('div');\n        p.style.opacity = '.7'; p.style.fontSize = '.9rem';\n        p.textContent = 'This card does not support a visual editor. Please use the YAML tab to configure it.';\n        if (seq === pickSeq) {\n          editorHost.appendChild(p);\n          editorSpin.hidden = true;\n        }\n        visualEditor = null;\n        enableCommit(true);\n        if (__activeTab !== 'visual') showTab('yaml');\n        return false;\n}\n    \n      try {\n        editor.hass = this.hass;\n        if (!editor.isConnected) editorHost.appendChild(editor);\n\n        // small yield before setConfig to help late-attaching internals\n        await Promise.resolve();\n        try { editor.setConfig(cfg); } catch (e) { /* YAML still works */ }\n\n        // Try official getStubConfig once (may load modules) to improve defaults\n        try {\n          const helpers = (await this._helpersPromise) || await window.loadCardHelpers();\n          const CardClass = helpers.getCardElementClass ? await helpers.getCardElementClass(cfg.type || currentType) : null;\n          if (CardClass?.getStubConfig) {\n            const all = Object.keys(this.hass?.states || {});\n            const byDomain = (d)=>all.filter((e)=>e.startsWith(d+'.'));\n            const better = await CardClass.getStubConfig(this.hass, all, byDomain);\n            if (better) cfg = this._shapeBySchema(cfg.type || currentType, { ...better });\n          }\n        } catch {}\n\n        // small yield before setConfig to help late-attaching internals\n        await Promise.resolve();\n        try { editor.setConfig(cfg); } catch (e) { /* YAML still works */ }\n    \n        // Remove old listeners if any\n        if (visualEditor && this.__onEditorChange) {\n          visualEditor.removeEventListener('config-changed', this.__onEditorChange);\n          visualEditor.removeEventListener('value-changed', this.__onEditorChange);\n        }\n    \n        const onChange = async (e) => {\n          const next = e.detail?.config ?? e.detail?.value; // some editors fire value-changed\n          if (!next) return;\n          const nextType = next.type || currentType;\n          currentType = nextType;\n          currentConfig = this._shapeBySchema(nextType, next);\n    \n          setError('');\n          enableCommit(true);\n          buildQuickFill(currentType, currentConfig);\n          mountPreview(currentConfig);\n          yamlEditorApi?.setValue(currentConfig);\n        };\n    \n        this.__onEditorChange = onChange;\n        editor.addEventListener('config-changed', onChange);\n        editor.addEventListener('value-changed', onChange);\n    \n        visualEditor = editor;\n    \n        // If a UI exists and the user hasn\u2019t explicitly chosen YAML \u2192 show Visual\n        if (__activeTab !== 'yaml') showTab('visual');\n    \n        enableCommit(true);\n        return true;\n      } finally {\n        if (seq === pickSeq) editorSpin.hidden = true;\n      }\n    };\n    \n\n    const mountYaml = async (cfg) => {\n      yamlEditorApi = await this._mountYamlEditor(\n        yamlHost,\n        cfg,\n        async (parsed) => {\n          try {\n            const nextType = parsed?.type || currentType;\n            const shaped = this._shapeBySchema(nextType, parsed || {});\n            const typeChanged = nextType !== currentType;\n    \n            currentType = nextType;\n            currentConfig = shaped;\n    \n            yamlErr.hidden = true; yamlErr.textContent = '';\n            enableCommit(true);\n    \n            if (typeChanged) {\n              buildQuickFill(currentType, currentConfig);\n              // Only update Visual if it\u2019s already mounted\n              if (visualEditor) {\n                try { visualEditor.setConfig?.(currentConfig); } catch {}\n                if (__activeTab !== 'yaml') showTab('visual');\n              }\n              // When the card type changes via YAML, rebuild the visibility UI\n              try { buildVisUI(currentConfig); } catch {}\n            } else {\n              try { visualEditor?.setConfig?.(currentConfig); } catch {}\n              mountPreview(currentConfig);\n              // Update the visibility UI when YAML modifies non-type properties\n              try { buildVisUI(currentConfig); } catch {}\n            }\n\n          } catch (e) {\n            yamlErr.hidden = false;\n            yamlErr.textContent = `Invalid config: ${String(e?.message || e)}`;\n            enableCommit(false);\n          }\n        },\n        (e) => {\n          yamlErr.hidden = false;\n          yamlErr.textContent = `Invalid YAML: ${String(e?.message || e)}`;\n          enableCommit(false);\n        }\n      );\n    };\n    \n\n    const getStub = async (type) => {\n      if (this.__stubCache.has(type)) return { ...this.__stubCache.get(type) };\n      // Fast local stub first (no heavy module loads)\n      let cfg = await this._getStubConfigForType(type);\n      this.__stubCache.set(type, { ...cfg });\n      return { ...cfg };\n    };\n\n    const selectType = async (type) => {\n      yamlErr.hidden = true; yamlErr.textContent = '';\n      setError('');\n      currentType = type;\n      // Update the selected-card headline and favorite star when a new card is chosen\n      try {\n        if (typeof updateHeader === 'function') updateHeader(type);\n      } catch {\n        // ignore if updateHeader is undefined or throws\n      }\n    \n      const cfg = (mode==='edit' && initialCfg && initialCfg.type===type)\n        ? { ...initialCfg }\n        : await getStub(type);\n    \n      currentConfig = this._shapeBySchema(type, cfg);\n\n      // Reset any previously mounted visual editor so the correct one loads for this card\n      visualEditor = null;\n\n      buildQuickFill(type, currentConfig);\n      await mountYaml(currentConfig);\n      await raf();\n      mountPreview(currentConfig); // debounced version\n\n      // Rebuild the visibility UI for the selected type/config. This ensures the\n      // visibility editor reflects any conditions stored in the config when a\n      // different card type is selected.\n      try { buildVisUI(currentConfig); } catch {}\n\n      // Do not reuse an old editor; mount the visual editor by default when adding a new card.\n      // Attempt to mount the visual editor for the selected type. If the card does\n      // not support a visual editor, mountVisualEditor will handle showing a\n      // message and fallback to YAML internally.\n      try {\n        // Try mounting visual editor for the current configuration. If the\n        // returned value is false, the card lacks a visual editor.\n        const visReady = await mountVisualEditor(currentConfig);\n        showTab(visReady ? 'visual' : 'yaml');\n      } catch {\n        // On error, fall back to YAML\n        showTab('yaml');\n      }\n      enableCommit(true);\n\n    };\n    const commit = async () => {\n      if (!currentConfig) return;\n      const finalCfg = this._shapeBySchema(currentType, currentConfig);\n      if (mode === 'edit' && typeof onCommit === 'function') {\n        await onCommit(finalCfg);\n      } else {\n        await this._addPickedCardToLayout(finalCfg);\n        this._pushRecent((finalCfg||{}).type);\n      }\n      close();\n    };\n\n    cancelTop.addEventListener('click', close);\n    cancelBot.addEventListener('click', close);\n    addTop.addEventListener('click', commit);\n    addBottom.addEventListener('click', commit);\n    modal.addEventListener('keydown', (e) => { if (e.key === 'Escape') close(); if (e.key === 'Enter' && !addTop.disabled) commit(); });\n\n    let __searchTimer = null;\n    search.addEventListener('input', () => {\n      if (__searchTimer) clearTimeout(__searchTimer);\n      __searchTimer = setTimeout(renderLeft, 120);\n    });\n\n\n    renderLeft();\n    // --- Ensure something is selected so YAML/preview mount immediately ---\n    const pickDefaultType = () => {\n      // Prefer recent if present; otherwise fall back to 'entities'\n      const r = this._getRecent?.() || [];\n      const firstRecent = r.find(Boolean);\n      return firstRecent || 'entities';\n    };\n\n    await selectType(pickDefaultType());\n    enableCommit(true);\n\n    // default selection\n    if (mode === 'edit' && initialCfg) {\n      await selectType(initialCfg.type || 'entities');\n      enableCommit(true);\n    }\n  }\n\n  /* ------------------------- Stubs / helpers (cards) ------------------------- */\nasync _getStubConfigForType(type) {\n    const helpers = (await this._helpersPromise) || await window.loadCardHelpers();\n    let CardClass = null;\n\n    // Provide a blank stub when the user selects the \"Custom Card\" entry.\n    // A blank type lets the YAML editor drive the configuration entirely.\n    if (type === 'custom_card') return null;\n\n    try { if (helpers.getCardElementClass) CardClass = await helpers.getCardElementClass(type); } catch {}\n    const all = Object.keys(this.hass?.states || {});\n    const byDomain = (d)=>all.filter((e)=>e.startsWith(d+'.'));\n    let base = { type };\n    if (CardClass?.getStubConfig) {\n      try {\n        const stub = await CardClass.getStubConfig(this.hass, all, byDomain);\n        if (type !== 'entity') {\n          // keep old behavior for all non-entity cards\n          return stub;\n        }\n        // For 'entity': merge the stub but DO NOT return yet \u2014 let defaults fill .entity if missing\n        if (stub && typeof stub === 'object') base = { ...base, ...stub };\n      } catch {}\n    }\n    const first = all[0];\n    const firstSensor = byDomain('sensor')[0] || first;\n\n    if (['entity','sensor','button','gauge','tile','light','thermostat','media-control','alarm-panel','picture-entity','weather-forecast','map'].includes(type)) {\n      // Provide sensible defaults for cards that require an `entity` field.\n      const defaultEntity = ({\n        'sensor': firstSensor,\n        'gauge':  (byDomain('sensor').find(this._isNumericEntity.bind(this)) || firstSensor),\n        'media-control': byDomain('media_player')[0] || first,\n        'light': byDomain('light')[0] || first,\n        'thermostat': byDomain('climate')[0] || first,\n        'alarm-panel': byDomain('alarm_control_panel')[0] || first,\n        'weather-forecast': byDomain('weather')[0] || first,\n        'map': byDomain('device_tracker')[0] || byDomain('person')[0] || first,\n      })[type] || firstSensor || first;\n      if (['entity','sensor','button','gauge','tile','light','thermostat','media-control','alarm-panel','picture-entity'].includes(type)) {\n        base.entity = defaultEntity;\n      } else if (type === 'weather-forecast') {\n        base.entity = defaultEntity;\n        base.show_current = true;\n        base.show_forecast = true;\n        base.forecast_type = 'daily';\n      } else if (type === 'map') {\n        base.entities = [defaultEntity].filter(Boolean);\n        base.theme_mode = 'auto';\n      }\n    }\n    if (['entities','glance','picture-glance','history-graph','statistics-graph'].includes(type)) {\n      const pick = (domains) => (domains?.length ? all.filter(e => domains.includes(e.split('.')[0])) : all).slice(0,3);\n      if (type === 'statistics-graph') base.entities = pick(['sensor','number','input_number']);\n      else base.entities = pick();\n    }\n    if (type === 'markdown') {\n      // Provide a minimal content so the card does not error\n      base.content = 'Markdown card';\n    }\n    if (type === 'sensor') {\n      base.graph = 'line';\n    }\n    if (type === 'button') {\n      base.show_name = true;\n      base.show_icon = true;\n    }\n    if (type === 'tile') {\n      base.features_position = 'bottom';\n      base.vertical = false;\n    }\n    if (type === 'picture-glance') {\n      base.title = base.title || 'Glance';\n      // Provide placeholder image if none available\n      base.image = base.image || 'https://demo.home-assistant.io/stub_config/kitchen.png';\n    }\n    if (type === 'picture-entity') {\n      base.image = base.image || 'https://demo.home-assistant.io/stub_config/bedroom.png';\n    }\n    if (type === 'iframe') {\n      base.url = base.url || 'https://www.home-assistant.io';\n      base.aspect_ratio = base.aspect_ratio || '50%';\n    }\n    if (type === 'history-graph') {\n      // Entities already set; nothing extra\n    }\n    if (type === 'statistics-graph') {\n      // Entities already set; nothing extra\n    }\n    if (type === 'alarm-panel') {\n      base.states = base.states || ['arm_home','arm_away'];\n    }\n    if (type === 'area') {\n      // pick first area from hass.areas if available; else use the first area name from states (area). This is a guess.\n      try {\n        const areas = (this.hass && this.hass.areas) ? Object.values(this.hass.areas) : [];\n        if (areas.length) {\n          base.area = areas[0].area_id || areas[0].name || areas[0].id;\n        } else {\n          // fallback: pick the domain of the first entity as area name\n          base.area = first ? first.split('.')[0] : 'default_area';\n        }\n        // Add optional defaults similar to built-in card example\n        base.display_type = 'picture';\n        base.alert_classes = base.alert_classes || ['moisture','motion'];\n        base.sensor_classes = base.sensor_classes || ['temperature','humidity'];\n        base.features_position = 'bottom';\n      } catch {}\n    }\n    // Note: area card and other complex cards are not given defaults here\n    return base;\n  }\n\n  _getNextAvailablePosition() {\n    const wraps = Array.from(this.cardContainer.querySelectorAll('.card-wrapper:not(.ddc-placeholder)'));\n    const occupied = new Set();\n    const gs = this.gridSize;\n    wraps.forEach((w) => {\n      const x = (parseFloat(w.getAttribute('data-x')) || 0);\n      const y = (parseFloat(w.getAttribute('data-y')) || 0);\n      const width  = parseFloat(getComputedStyle(w).width)  || 100;\n      const height = parseFloat(getComputedStyle(w).height) || 100;\n      const xStart = Math.floor(x/gs), yStart = Math.floor(y/gs);\n      const xEnd   = Math.floor((x+width)/gs), yEnd = Math.floor((y+height)/gs);\n      for (let xi=xStart; xi<xEnd; xi++) for (let yi=yStart; yi<yEnd; yi++) occupied.add(`${xi}-${yi}`);\n    });\n    let xi=0, yi=0;\n    while (occupied.has(`${xi}-${yi}`)) { xi+=6; if (xi>60) { xi=0; yi+=6; } }\n    return { x: xi*gs, y: yi*gs };\n  }\n\n  async _addPickedCardToLayout(cardConfig) {\n    this._hideEmptyPlaceholder();\n    const cardEl = await this._createCard(cardConfig);\n    const wrap = this._makeWrapper(cardEl);\n    const next = this._getNextAvailablePosition();\n    this._setCardPosition(wrap, next.x, next.y);\n    wrap.style.width  = `${14*this.gridSize}px`;\n    wrap.style.height = `${10*this.gridSize}px`;\n    wrap.style.zIndex = String(this._highestZ() + 1);\n    this.cardContainer.appendChild(wrap);\n    \n  try { this._rebuildOnce(wrap.firstElementChild); } catch {}\n    this._initCardInteract(wrap);\n    this._resizeContainer();\n    this._queueSave('add');\n    this._toast('Card added to layout.');\n    this._syncEmptyStateUI();\n\n    // After inserting a new card, reevaluate visibility so any conditions\n    // attached to the new card are applied immediately (if not in edit mode).\n    try { this._applyVisibility_(); } catch {}\n  }\n\n  /* ------------------------------ Selection utils ------------------------------ */\n  _toggleSelection(wrap, force=null) {\n    const on = force==null ? !this._selection.has(wrap) : !!force;\n    if (on) this._selection.add(wrap); else this._selection.delete(wrap);\n    wrap.classList.toggle('selected', on);\n  }\n  _clearSelection() {\n    for (const w of this._selection) w.classList.remove('selected');\n    this._selection.clear();\n  }\n\n  /**\n   * Copy the currently selected cards into a global clipboard. When invoked,\n   * this will capture the configuration and layout of each selected card and\n   * store it on the window object so that it may be pasted into the same\n   * dashboard or a completely different drag-and-drop card instance. The\n   * relative arrangement of cards is preserved based on the top\u2011leftmost\n   * card in the selection.\n   */\n  _copySelection() {\n    try {\n      // Determine selected wrappers. If nothing is selected, bail early.\n      const wrappers = this._selection ? Array.from(this._selection) : [];\n      if (!wrappers.length) {\n        this._toast?.('Nothing selected to copy.');\n        return;\n      }\n      // Compute the minimum x/y across the selection to preserve relative offsets\n      let minX = Infinity, minY = Infinity;\n      const items = [];\n      for (const w of wrappers) {\n        // skip placeholders\n        if (w.dataset.placeholder) continue;\n        const x = parseFloat(w.getAttribute('data-x')) || 0;\n        const y = parseFloat(w.getAttribute('data-y')) || 0;\n        if (x < minX) minX = x;\n        if (y < minY) minY = y;\n      }\n      for (const w of wrappers) {\n        if (w.dataset.placeholder) continue;\n        const cfg = this._extractCardConfig(w.firstElementChild) || {};\n        const x = parseFloat(w.getAttribute('data-x')) || 0;\n        const y = parseFloat(w.getAttribute('data-y')) || 0;\n        const width  = w.style.width  || `${w.getBoundingClientRect().width}px`;\n        const height = w.style.height || `${w.getBoundingClientRect().height}px`;\n        items.push({ cfg, dx: x - minX, dy: y - minY, width, height });\n      }\n      // Save to global clipboard. Use a namespaced key to avoid collisions.\n      window.__DDC_CLIPBOARD__ = { items };\n      this._toast?.(`Copied ${items.length} card${items.length === 1 ? '' : 's'}.`);\n    } catch (err) {\n      console.warn('[drag-and-drop-card] Copy failed', err);\n      this._toast?.('Copy failed.');\n    }\n  }\n\n  /**\n   * Paste cards from the global clipboard into this drag\u2011and\u2011drop card. The\n   * pasted cards will retain their relative arrangement and sizing, and will\n   * be placed into the currently active tab. If no valid clipboard data is\n   * present, the user will be notified. Cards are offset from the top\u2011left\n   * corner by one grid unit and shifted repeatedly until no collision with\n   * existing cards is detected.\n   */\n  async _pasteClipboard() {\n    try {\n      const clip = window.__DDC_CLIPBOARD__;\n      if (!clip || !Array.isArray(clip.items) || !clip.items.length) {\n        this._toast?.('Clipboard is empty.');\n        return;\n      }\n      const items = clip.items;\n      // Determine a collision\u2011free base position. We attempt to place the\n      // group starting at one grid unit from the origin and slide further\n      // down/right until no overlap occurs.\n      let shift = 1;\n      let proposedRects;\n      do {\n        const baseX = this.gridSize * shift;\n        const baseY = this.gridSize * shift;\n        proposedRects = items.map((it) => {\n          const w = parseFloat(it.width) || 0;\n          const h = parseFloat(it.height) || 0;\n          return { x: baseX + (it.dx || 0), y: baseY + (it.dy || 0), w, h };\n        });\n        shift += 1;\n        // Break if no collision; ignore nothing (empty set) so all existing cards count\n      } while (this._anyCollisionFor(proposedRects, new Set()));\n      // Use the final baseX/baseY from the previous iteration\n      const baseX = this.gridSize * (shift - 1);\n      const baseY = this.gridSize * (shift - 1);\n      // Create each card, apply sizing and position, and attach to the DOM\n      for (const it of items) {\n        const cfg = it.cfg || {};\n        const cardEl = await this._createCard(cfg);\n        const wrap = this._makeWrapper(cardEl);\n        // Sizing\n        wrap.style.width  = it.width;\n        wrap.style.height = it.height;\n        // Positioning: maintain relative dx/dy within group\n        const x = baseX + (it.dx || 0);\n        const y = baseY + (it.dy || 0);\n        this._setCardPosition(wrap, x, y);\n        // Bring to front\n        wrap.style.zIndex = String(this._highestZ() + 1);\n        // Assign to current tab\n        try {\n          const tid = this._normalizeTabId(this.activeTab || this.defaultTab);\n          if (tid) wrap.dataset.tabId = tid;\n        } catch {}\n        // Append and initialize\n        this.cardContainer.appendChild(wrap);\n        // Do not attach a tab selector when pasting. Pasted cards are assigned\n        // to the current tab automatically and the user does not need to\n        // reassign them immediately.\n        try { this._rebuildOnce(wrap.firstElementChild); } catch {}\n        this._initCardInteract(wrap);\n      }\n      // Ensure the container grows and the active tab filter is applied\n      this._resizeContainer();\n      this._applyActiveTab();\n      // Persist the change\n      this._queueSave?.('paste');\n      this._toast?.(`Pasted ${items.length} card${items.length === 1 ? '' : 's'}.`);\n    } catch (err) {\n      console.warn('[drag-and-drop-card] Paste failed', err);\n      this._toast?.('Paste failed.');\n    }\n  }\n\n  _installSelectionMarquee() {\n    const cont = this.cardContainer;\n    let startX=0, startY=0, marquee=null, active=false;\n\n    const toLocal = (ev) => {\n      const r = cont.getBoundingClientRect();\n      const x = ('touches' in ev && ev.touches[0]) ? ev.touches[0].clientX : ev.clientX;\n      const y = ('touches' in ev && ev.touches[0]) ? ev.touches[0].clientY : ev.clientY;\n      return { x: x - r.left, y: y - r.top };\n    };\n\n    const updateSel = (x,y) => {\n      const minX = Math.min(x, startX), maxX = Math.max(x, startX);\n      const minY = Math.min(y, startY), maxY = Math.max(y, startY);\n      marquee.style.left = `${minX}px`;\n      marquee.style.top = `${minY}px`;\n      marquee.style.width = `${maxX-minX}px`;\n      marquee.style.height= `${maxY-minY}px`;\n\n      const rRect = marquee.getBoundingClientRect();\n      const wraps = cont.querySelectorAll('.card-wrapper:not(.ddc-placeholder)');\n      this._clearSelection();\n      wraps.forEach(w => {\n        const wr = w.getBoundingClientRect();\n        const overlap = !(wr.right < rRect.left || wr.left > rRect.right || wr.bottom < rRect.top || wr.top > rRect.bottom);\n        if (overlap) this._toggleSelection(w, true);\n      });\n    };\n\n    const down = (e) => {\n      if (!this.editMode) return;\n      if (e.target.closest('.card-wrapper')) return;\n      active = true;\n      const p = toLocal(e);\n      startX = p.x; startY = p.y;\n      marquee = document.createElement('div');\n      marquee.className = 'marquee';\n      marquee.style.left = `${startX}px`;\n      marquee.style.top  = `${startY}px`;\n      cont.appendChild(marquee);\n      e.preventDefault();\n    };\n    const move = (e) => { if (!active || !marquee) return; updateSel(toLocal(e).x, toLocal(e).y); };\n    const up = () => { if (!active) return; active = false; if (marquee) marquee.remove(); marquee = null; };\n\n    cont.addEventListener('mousedown', down);\n    window.addEventListener('mousemove', move);\n    window.addEventListener('mouseup', up);\n    cont.addEventListener('touchstart', (e)=>{ if (!this.editMode) return; if (e.target.closest('.card-wrapper')) return; down(e); }, {passive:false});\n    window.addEventListener('touchmove', (e)=>{ move(e); }, {passive:false});\n    window.addEventListener('touchend', up);\n    window.addEventListener('touchcancel', up);\n  }\n\n  /* ------------------------------ Diagnostics ------------------------------ */\n  async _openDiagnostics() {\n    const modal = document.createElement('div');\n    modal.className = 'modal';\n    const sk = this.storageKey || '(none)';\n    const usingHost = this._backendOK && !!this.storageKey;\n\n    const logsToHtml = (rows) => rows.slice(-200).map(r =>\n      `<div style=\"font-family:monospace;font-size:.85rem;line-height:1.3\">\n        <span style=\"opacity:.6\">${r.t}</span>\n        <b style=\"margin-left:6px;color:#03a9f4\">[${r.kind}]</b>\n        <span style=\"margin-left:6px\">${this._safe(r.msg)}</span>\n        ${r.extra ? `<pre style=\"margin:4px 0 0 0;white-space:pre-wrap;background:var(--card-background-color);border:1px solid var(--divider-color);border-radius:8px;padding:6px;max-height:160px;overflow:auto\">${this._safe(JSON.stringify(r.extra, null, 2))}</pre>` : ''}\n      </div>`\n    ).join('');\n\n    modal.innerHTML = `\n      <div class=\"dialog\" style=\"max-width:1100px;width:min(1100px,95%);height:min(90vh,860px)\">\n        <div class=\"dlg-head\">\n          <h3>Drag & Drop \u2014 Diagnostics</h3>\n          <button class=\"btn secondary\" id=\"closeDiag\"><ha-icon icon=\"mdi:close\"></ha-icon><span style=\"margin-left:6px\">Close</span></button>\n        </div>\n        <div style=\"display:block;overflow:auto;padding:12px\">\n          <div class=\"section\" style=\"border:1px solid var(--divider-color);border-radius:12px;background:var(--card-background-color);margin-bottom:10px\">\n            <div class=\"hd\" style=\"display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid var(--divider-color);font-weight:600\">Status</div>\n            <div class=\"bd\" style=\"padding:12px\">\n              <div style=\"display:grid;grid-template-columns:220px 1fr;gap:6px;align-items:center\">\n                <div>Storage key (raw \u2192 slug)</div><div><code>${this._safe(this._config?.storage_key || '')}</code> \u2192 <code>${this._safe(sk)}</code></div>\n                <div>Backend reachable</div><div><b>${this._backendOK ? 'YES' : 'NO'}</b></div>\n                <div>Persist target</div><div><b>${usingHost ? 'Host (backend)' : 'Browser (localStorage)'}</b></div>\n                <div>Auto-save</div><div>${this.autoSave ? `ON (${this.autoSaveDebounce} ms)` : 'OFF'}</div>\n                <div>Cards mounted</div><div>${this.cardContainer?.querySelectorAll('.card-wrapper:not(.ddc-placeholder)').length || 0}</div>\n              </div>\n              <div style=\"margin-top:10px;display:flex;gap:8px;flex-wrap:wrap\">\n                <button class=\"btn\" id=\"testRoundtrip\"><ha-icon icon=\"mdi:sync\"></ha-icon><span style=\"margin-left:6px\">Test backend round-trip</span></button>\n                <button class=\"btn secondary\" id=\"exportJson\"><ha-icon icon=\"mdi:download\"></ha-icon><span style=\"margin-left:6px\">Export JSON</span></button>\n                <button class=\"btn secondary\" id=\"importJson\"><ha-icon icon=\"mdi:upload\"></ha-icon><span style=\"margin-left:6px\">Import JSON</span></button>\n                <button class=\"btn\" id=\"forceSave\"><ha-icon icon=\"mdi:content-save\"></ha-icon><span style=\"margin-left:6px\">Force save now</span></button>\n                <button class=\"btn secondary\" id=\"refreshKeys\"><ha-icon icon=\"mdi:refresh\"></ha-icon><span style=\"margin-left:6px\">Refresh backend keys</span></button>\n              </div>\n            </div>\n          </div>\n          <div class=\"section\" style=\"border:1px solid var(--divider-color);border-radius:12px;background:var(--card-background-color)\">\n            <div class=\"hd\" style=\"display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid var(--divider-color);font-weight:600\">Logs (latest)</div>\n            <div class=\"bd\" id=\"logArea\" style=\"padding:12px;max-height:420px;overflow:auto\">${logsToHtml(this._dbgDump())}</div>\n          </div>\n        </div>\n      </div>`;\n\n    const close = () => modal.remove();\n    modal.querySelector('#closeDiag').addEventListener('click', close);\n    this.shadowRoot.appendChild(modal);\n\n    const refreshLogs = () => {\n      const logArea = modal.querySelector('#logArea');\n      const logsToHtmlLocal = (rows) => rows.slice(-200).map(r =>\n        `<div style=\"font-family:monospace;font-size:.85rem;line-height:1.3\">\n          <span style=\"opacity:.6\">${r.t}</span>\n          <b style=\"margin-left:6px;color:#03a9f4\">[${r.kind}]</b>\n          <span style=\"margin-left:6px\">${this._safe(r.msg)}</span>\n          ${r.extra ? `<pre style=\"margin:4px 0 0 0;white-space:pre-wrap;background:var(--card-background-color);border:1px solid var(--divider-color);border-radius:8px;padding:6px;max-height:160px;overflow:auto\">${this._safe(JSON.stringify(r.extra, null, 2))}</pre>` : ''}\n        </div>`\n      ).join('');\n      logArea.innerHTML = logsToHtmlLocal(this._dbgDump());\n      logArea.scrollTop = logArea.scrollHeight;\n    };\n\n    modal.querySelector('#refreshKeys').addEventListener('click', async () => {\n      try { this._dbgPush('probe', 'Manual refresh'); await this._probeBackend(); }\n      finally { refreshLogs(); }\n    });\n\n    modal.querySelector('#forceSave').addEventListener('click', async () => {\n      await this._saveLayout(false);\n      refreshLogs();\n    });\n\n    modal.querySelector('#exportJson').addEventListener('click', () => {\n      const wraps = Array.from(this.cardContainer.querySelectorAll('.card-wrapper:not(.ddc-placeholder)'));\n      const saved = wraps.map((w)=>{\n        const x = parseFloat(w.getAttribute('data-x')) || 0;\n        const y = parseFloat(w.getAttribute('data-y')) || 0;\n        const width  = parseFloat(w.style.width)  || w.getBoundingClientRect().width;\n        const height = parseFloat(w.style.height) || w.getBoundingClientRect().height;\n        const z = parseInt(w.style.zIndex || '1', 10);\n        const cardCfg = this._extractCardConfig(w.firstElementChild);\n        const tabId = w.dataset.tabId || this.defaultTab;\n        return { card: cardCfg, position:{x,y}, size:{width,height}, z, tabId };\n      });\n        const payload = {\n            version: 2,\n            options: this._exportableOptions(),\n            cards: saved\n        };\n      const blob = new Blob([JSON.stringify(payload,null,2)], {type:'application/json'});\n      const a = document.createElement('a');\n      a.href = URL.createObjectURL(blob);\n      a.download = `ddc_${this.storageKey || 'layout'}.json`;\n      a.click();\n      URL.revokeObjectURL(a.href);\n    });\n\n    modal.querySelector('#importJson').addEventListener('click', async () => {\n      const inp = document.createElement('input');\n      inp.type = 'file'; inp.accept = 'application/json';\n      inp.onchange = async () => {\n        const file = inp.files?.[0]; if (!file) return;\n        const txt = await file.text();\n        try {\n          const json = JSON.parse(txt);\n          this._dbgPush('import', 'Loaded file', { bytes: txt.length });\n          this.cardContainer.innerHTML = '';\n          if (json.cards?.length) {\n            for (const conf of json.cards) {\n              if (!conf?.card || (typeof conf.card === 'object' && Object.keys(conf.card).length === 0)) {\n                const p = this._makePlaceholderAt(conf.position?.x||0, conf.position?.y||0, conf.size?.width||200, conf.size?.height||200);\n                this.cardContainer.appendChild(p);\n              } else {\n                const el = await this._createCard(conf.card);\n                const wrap = this._makeWrapper(el);\n                this._setCardPosition(wrap, conf.position?.x||0, conf.position?.y||0);\n            wrap.dataset.tabId = this._normalizeTabId(conf.tabId || conf.tab_id || this.defaultTab);\n            this._setCardPosition(wrap, conf.position?.x||0, conf.position?.y||0);\n                wrap.style.width = `${conf.size?.width||140}px`;\n                wrap.style.height= `${conf.size?.height||100}px`;\n                this.cardContainer.appendChild(wrap);\n                \n        try { this._rebuildOnce(wrap.firstElementChild); } catch {}\nthis._initCardInteract(wrap);\n              }\n            }\n          } else {\n            this._showEmptyPlaceholder();\n        this._applyAutoScale?.();\n          }\n          this._resizeContainer();\n          await this._saveLayout(false);\n        } catch (e) {\n          this._dbgPush('import', 'Parse failed', { error: String(e) });\n        }\n        const ev = new Event('ddc-logrefresh'); window.dispatchEvent(ev);\n      };\n      inp.click();\n    });\n\n    modal.querySelector('#testRoundtrip').addEventListener('click', async () => {\n      if (!this._backendOK) {\n        this._dbgPush('test', 'Backend not reachable, aborting');\n        return refreshLogs();\n      }\n      const key = (this.storageKey || 'ddc_test') + '_selftest';\n      const payload = { t: Date.now(), msg: 'roundtrip' };\n      try {\n        await this._saveLayoutToBackend(key, payload);\n        const back = await this._loadLayoutFromBackend(key);\n        this._dbgPush('test', 'Round-trip result', { wrote: payload, read: back });\n      } catch (e) {\n        this._dbgPush('test', 'Round-trip failed', { error: String(e) });\n      }\n      refreshLogs();\n    });\n\n    refreshLogs();\n  }\n\n  /* ------------------------ Dashboard Settings ------------------------ */\n  /**\n   * Opens a settings dialog allowing the user to configure dashboard\u2011wide\n   * options such as grid size, auto resize, animations and HA chrome\n   * visibility. The menu is designed to be simple and intuitive. Changes\n   * are applied when the user clicks Save.\n   */\n  _openDashboardSettings() {\n    // Build modal container\n    const modal = document.createElement('div');\n    modal.className = 'modal';\n    // Use the existing .dialog styles for consistent centering and sizing. Limit\n    // the maximum width so the settings sheet doesn't overwhelm the screen.\n    modal.innerHTML = `\n      <div class=\"dialog\" role=\"dialog\" aria-modal=\"true\" style=\"max-width:600px\">\n        <div class=\"dlg-head\" style=\"display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-bottom:1px solid var(--divider-color,rgba(0,0,0,.12))\">\n          <h3 style=\"margin:0;font-size:1.2rem\">Dashboard Settings</h3>\n          <button class=\"btn secondary\" id=\"ddc-settings-close\" style=\"margin:0\">\n            <ha-icon icon=\"mdi:close\"></ha-icon>\n          </button>\n        </div>\n        <div class=\"settings-body\" style=\"display:flex;flex-direction:column;gap:18px;padding:16px;overflow-y:auto;max-height:70vh\">\n          <!-- Layout options -->\n          <div>\n            <h4 style=\"margin:0 0 8px 0;font-size:1rem;font-weight:600\">Layout</h4>\n            <label style=\"display:flex;flex-direction:column;font-size:.95rem;margin-bottom:10px\">\n              <span style=\"margin-bottom:4px\">Grid size (px)</span>\n              <input type=\"number\" id=\"ddc-setting-gridSize\" min=\"10\" max=\"500\" step=\"1\" style=\"padding:6px;border:1px solid var(--divider-color,rgba(0,0,0,.3));border-radius:6px\" />\n            </label>\n            <label style=\"display:flex;align-items:center;gap:8px;font-size:.95rem;margin-bottom:8px\">\n              <input type=\"checkbox\" id=\"ddc-setting-autoResize\" />\n              <span>Auto resize cards</span>\n            </label>\n            <label style=\"display:flex;align-items:center;gap:8px;font-size:.95rem;margin-bottom:8px\">\n              <input type=\"checkbox\" id=\"ddc-setting-dragSnap\" />\n              <span>Drag live snap</span>\n            </label>\n            <label style=\"display:flex;align-items:center;gap:8px;font-size:.95rem;margin-bottom:8px\">\n              <input type=\"checkbox\" id=\"ddc-setting-autoSave\" />\n              <span>Auto save</span>\n            </label>\n            <label style=\"display:flex;flex-direction:column;font-size:.95rem;margin-bottom:10px\">\n              <span style=\"margin-bottom:4px\">Auto save delay (ms)</span>\n              <input type=\"number\" id=\"ddc-setting-autoSaveDebounce\" min=\"100\" max=\"10000\" step=\"100\" style=\"padding:6px;border:1px solid var(--divider-color,rgba(0,0,0,.3));border-radius:6px\" />\n            </label>\n            <label style=\"display:flex;flex-direction:column;font-size:.95rem;margin-bottom:10px\">\n              <span style=\"margin-bottom:4px\">Container size mode</span>\n              <select id=\"ddc-setting-sizeMode\" style=\"padding:6px;border:1px solid var(--divider-color,rgba(0,0,0,.3));border-radius:6px\">\n                <option value=\"dynamic\">Dynamic</option>\n                <option value=\"preset\">Preset</option>\n                <option value=\"fixed_custom\">Fixed (custom)</option>\n              </select>\n            </label>\n            <!-- Additional inputs for size mode (custom width/height or preset list) will be injected here -->\n            <div id=\"ddc-setting-sizeExtras\"></div>\n            <label style=\"display:flex;flex-direction:column;font-size:.95rem;margin-bottom:10px\">\n              <span style=\"margin-bottom:4px\">Container orientation</span>\n              <select id=\"ddc-setting-orient\" style=\"padding:6px;border:1px solid var(--divider-color,rgba(0,0,0,.3));border-radius:6px\">\n                <option value=\"auto\">Auto</option>\n                <option value=\"landscape\">Landscape</option>\n                <option value=\"portrait\">Portrait</option>\n              </select>\n            </label>\n            <label style=\"display:flex;align-items:center;gap:8px;font-size:.95rem;margin-bottom:8px\">\n              <input type=\"checkbox\" id=\"ddc-setting-disableOverlap\" />\n              <span>Disable overlap</span>\n            </label>\n          </div>\n\n          <!-- Appearance options -->\n          <div>\n            <h4 style=\"margin:16px 0 8px 0;font-size:1rem;font-weight:600\">Appearance</h4>\n            <label style=\"display:flex;flex-direction:column;font-size:.95rem;margin-bottom:10px\">\n              <span style=\"margin-bottom:4px\">Container background (CSS)</span>\n              <input type=\"text\" id=\"ddc-setting-containerBg\" placeholder=\"e.g. transparent or #123456\" style=\"padding:6px;border:1px solid var(--divider-color,rgba(0,0,0,.3));border-radius:6px\" />\n            </label>\n            <label style=\"display:flex;flex-direction:column;font-size:.95rem;margin-bottom:10px\">\n              <span style=\"margin-bottom:4px\">Card background (CSS)</span>\n              <input type=\"text\" id=\"ddc-setting-cardBg\" placeholder=\"e.g. var(--ha-card-background)\" style=\"padding:6px;border:1px solid var(--divider-color,rgba(0,0,0,.3));border-radius:6px\" />\n            </label>\n            <label style=\"display:flex;flex-direction:column;font-size:.95rem;margin-bottom:10px\">\n              <span style=\"margin-bottom:4px\">Background image URL</span>\n              <input type=\"text\" id=\"ddc-setting-bgImg\" placeholder=\"Image URL\" style=\"padding:6px;border:1px solid var(--divider-color,rgba(0,0,0,.3));border-radius:6px\" />\n            </label>\n          </div>\n\n          <!-- Behaviour options -->\n          <div>\n            <h4 style=\"margin:16px 0 8px 0;font-size:1rem;font-weight:600\">Behaviour</h4>\n            <label style=\"display:flex;align-items:center;gap:8px;font-size:.95rem;margin-bottom:8px\">\n              <input type=\"checkbox\" id=\"ddc-setting-animate\" />\n              <span>Animate cards</span>\n            </label>\n            <label style=\"display:flex;align-items:center;gap:8px;font-size:.95rem;margin-bottom:8px\">\n              <input type=\"checkbox\" id=\"ddc-setting-debug\" />\n              <span>Enable debug logging</span>\n            </label>\n            <label style=\"display:flex;align-items:center;gap:8px;font-size:.95rem;margin-bottom:8px\">\n              <input type=\"checkbox\" id=\"ddc-setting-hideHdr\" />\n              <span>Hide HA Header</span>\n            </label>\n            <label style=\"display:flex;align-items:center;gap:8px;font-size:.95rem;margin-bottom:8px\">\n              <input type=\"checkbox\" id=\"ddc-setting-hideSbar\" />\n              <span>Hide HA Sidebar</span>\n            </label>\n          </div>\n\n        </div>\n        <div style=\"display:flex;justify-content:flex-end;gap:10px;padding:12px 16px;border-top:1px solid var(--divider-color,rgba(0,0,0,.12))\">\n          <button class=\"btn secondary\" id=\"ddc-settings-cancel\">Cancel</button>\n          <button class=\"btn\" id=\"ddc-settings-save\">Save</button>\n        </div>\n      </div>\n    `;\n    // Only allow one modal at a time across the card. If any modal exists in\n    // the shadow root (including other DDC modals), remove it before\n    // opening the settings. This prevents overlapping dialog layers.\n    const existingModal = this.shadowRoot.querySelector('.modal');\n    if (existingModal) {\n      try { existingModal.remove(); } catch {}\n      // clear any stored references\n      if (this.__settingsModal === existingModal) this.__settingsModal = null;\n    }\n\n    // If a previous settings modal specifically exists, remove it as well\n    if (this.__settingsModal) {\n      try { this.__settingsModal.remove(); } catch {}\n      this.__settingsModal = null;\n    }\n    // Append to our own shadow root so built-in .modal styles apply and centering works\n    this.__settingsModal = modal;\n    this.shadowRoot.appendChild(modal);\n\n    // Prepopulate current settings\n    const chkAuto    = modal.querySelector('#ddc-setting-autoResize');\n    const inpGrid    = modal.querySelector('#ddc-setting-gridSize');\n    const chkAnim    = modal.querySelector('#ddc-setting-animate');\n    const chkHdr     = modal.querySelector('#ddc-setting-hideHdr');\n    const chkBar     = modal.querySelector('#ddc-setting-hideSbar');\n    const chkSnap    = modal.querySelector('#ddc-setting-dragSnap');\n    const chkASave   = modal.querySelector('#ddc-setting-autoSave');\n    const inpDeb     = modal.querySelector('#ddc-setting-autoSaveDebounce');\n    const selSize    = modal.querySelector('#ddc-setting-sizeMode');\n    const selOrient  = modal.querySelector('#ddc-setting-orient');\n    const chkOverlap = modal.querySelector('#ddc-setting-disableOverlap');\n    const inpCBg     = modal.querySelector('#ddc-setting-containerBg');\n    const inpCardBg  = modal.querySelector('#ddc-setting-cardBg');\n    const inpBgImg   = modal.querySelector('#ddc-setting-bgImg');\n    const chkDebug   = modal.querySelector('#ddc-setting-debug');\n    // hero image and tabs position are intentionally omitted from the settings UI\n\n    if (chkAuto)    chkAuto.checked    = !!this.autoResizeCards;\n    if (inpGrid)    inpGrid.value      = String(this.gridSize || 100);\n    if (chkAnim)    chkAnim.checked    = !!this.animateCards;\n    if (chkHdr)     chkHdr.checked     = !!this.hideHaHeader;\n    if (chkBar)     chkBar.checked     = !!this.hideHaSidebar;\n    if (chkSnap)    chkSnap.checked    = !!this.dragLiveSnap;\n    if (chkASave)   chkASave.checked   = !!this.autoSave;\n    if (inpDeb)     inpDeb.value       = String(this.autoSaveDebounce ?? 800);\n    if (selSize)    selSize.value      = String(this.containerSizeMode || 'dynamic');\n    if (selOrient)  selOrient.value    = String(this.containerPresetOrient || 'auto');\n    if (chkOverlap) chkOverlap.checked = !!this.disableOverlap;\n    if (inpCBg)     inpCBg.value       = String(this.containerBackground || '');\n    if (inpCardBg)  inpCardBg.value    = String(this.cardBackground || '');\n    if (inpBgImg)   {\n      const bgObj = (this._config?.background_image ?? this._config?.bg_image) || {};\n      inpBgImg.value = bgObj.src ? String(bgObj.src) : '';\n    }\n    if (chkDebug)   chkDebug.checked   = !!this.debug;\n\n    // Build extra inputs for container size mode (custom dimensions or preset list)\n    try {\n      const extrasDiv = modal.querySelector('#ddc-setting-sizeExtras');\n      const updateSizeExtras = () => {\n        if (!extrasDiv) return;\n        extrasDiv.innerHTML = '';\n        const modeVal = selSize?.value || 'dynamic';\n        if (modeVal === 'fixed_custom') {\n          // Custom width and height inputs\n          const wrapW = document.createElement('label');\n          wrapW.style.display = 'flex';\n          wrapW.style.flexDirection = 'column';\n          wrapW.style.fontSize = '.95rem';\n          wrapW.style.marginBottom = '10px';\n          const spanW = document.createElement('span');\n          spanW.textContent = 'Custom width (px)';\n          spanW.style.marginBottom = '4px';\n          const inpW = document.createElement('input');\n          inpW.type = 'number';\n          inpW.id = 'ddc-setting-custW';\n          inpW.min = '100';\n          inpW.max = '10000';\n          inpW.step = '10';\n          inpW.style.padding = '6px';\n          inpW.style.border = '1px solid var(--divider-color,rgba(0,0,0,.3))';\n          inpW.style.borderRadius = '6px';\n          inpW.value = String(this.containerFixedWidth ?? 800);\n          wrapW.appendChild(spanW);\n          wrapW.appendChild(inpW);\n          const wrapH = document.createElement('label');\n          wrapH.style.display = 'flex';\n          wrapH.style.flexDirection = 'column';\n          wrapH.style.fontSize = '.95rem';\n          wrapH.style.marginBottom = '10px';\n          const spanH = document.createElement('span');\n          spanH.textContent = 'Custom height (px)';\n          spanH.style.marginBottom = '4px';\n          const inpH = document.createElement('input');\n          inpH.type = 'number';\n          inpH.id = 'ddc-setting-custH';\n          inpH.min = '100';\n          inpH.max = '10000';\n          inpH.step = '10';\n          inpH.style.padding = '6px';\n          inpH.style.border = '1px solid var(--divider-color,rgba(0,0,0,.3))';\n          inpH.style.borderRadius = '6px';\n          inpH.value = String(this.containerFixedHeight ?? 600);\n          wrapH.appendChild(spanH);\n          wrapH.appendChild(inpH);\n          extrasDiv.appendChild(wrapW);\n          extrasDiv.appendChild(wrapH);\n        } else if (modeVal === 'preset') {\n          // Preset list select\n          const wrap = document.createElement('label');\n          wrap.style.display = 'flex';\n          wrap.style.flexDirection = 'column';\n          wrap.style.fontSize = '.95rem';\n          wrap.style.marginBottom = '10px';\n          const span = document.createElement('span');\n          span.textContent = 'Preset size';\n          span.style.marginBottom = '4px';\n          const select = document.createElement('select');\n          select.id = 'ddc-setting-preset';\n          select.style.padding = '6px';\n          select.style.border = '1px solid var(--divider-color,rgba(0,0,0,.3))';\n          select.style.borderRadius = '6px';\n          // Populate options from size presets\n          const presets = (typeof DragAndDropCard !== 'undefined' && DragAndDropCard._sizePresets) ? DragAndDropCard._sizePresets() : [];\n          presets.forEach(p => {\n            const opt = document.createElement('option');\n            opt.value = p.key;\n            opt.textContent = `${p.label || p.key} (${p.w}\u00D7${p.h})`;\n            select.appendChild(opt);\n          });\n          // Preselect current preset if available\n          select.value = String(this.containerPreset || 'fhd');\n          wrap.appendChild(span);\n          wrap.appendChild(select);\n          extrasDiv.appendChild(wrap);\n        }\n      };\n      // initial call\n      updateSizeExtras();\n      // update when size mode changes\n      selSize?.addEventListener('change', updateSizeExtras);\n    } catch (err) {\n      console.warn('[drag-and-drop-card] Failed to build container size extras', err);\n    }\n\n    // Remove modal helper\n    const closeModal = () => {\n      try { modal.remove(); } catch {}\n      if (this.__settingsModal === modal) this.__settingsModal = null;\n    };\n    // Close handlers\n    modal.querySelector('#ddc-settings-close')?.addEventListener('click', (e) => { e.stopPropagation(); closeModal(); });\n    modal.querySelector('#ddc-settings-cancel')?.addEventListener('click', (e) => { e.stopPropagation(); closeModal(); });\n    // Save handler\n    modal.querySelector('#ddc-settings-save')?.addEventListener('click', (e) => {\n      e.stopPropagation();\n      // Read values\n      const newAuto      = !!chkAuto?.checked;\n      const newGrid      = parseInt(inpGrid?.value || '0', 10);\n      const newAnim      = !!chkAnim?.checked;\n      const newHideHdr   = !!chkHdr?.checked;\n      const newHideBar   = !!chkBar?.checked;\n      const newSnap      = !!chkSnap?.checked;\n      const newASave     = !!chkASave?.checked;\n      const newDeb       = parseInt(inpDeb?.value || '0', 10);\n      const newSize      = selSize?.value || 'dynamic';\n      const newOrient    = selOrient?.value || 'auto';\n      const newOverlap   = !!chkOverlap?.checked;\n      const newCBg       = (inpCBg?.value || '').trim();\n      const newCardBg    = (inpCardBg?.value || '').trim();\n      const newBgImg     = (inpBgImg?.value || '').trim();\n      const newDebug     = !!chkDebug?.checked;\n      // hero and tabs position not exposed to user\n      try {\n        // Auto resize cards\n        this.autoResizeCards = newAuto;\n        if (this.autoResizeCards) this._startScaleWatch?.();\n        else this._stopScaleWatch?.();\n        // Grid size\n        if (!isNaN(newGrid) && newGrid > 0 && newGrid !== this.gridSize) {\n          this.gridSize = newGrid;\n          this._applyGridVars?.();\n          this._resizeContainer?.();\n        }\n        // Drag live snap\n        const snapChanged = newSnap !== this.dragLiveSnap;\n        this.dragLiveSnap = newSnap;\n        if (snapChanged) {\n          // Re-init interact on all cards so the snap modifiers take effect\n          this._initInteract?.();\n        }\n        // Auto save\n        this.autoSave = newASave;\n        // Auto save debounce\n        if (!isNaN(newDeb) && newDeb > 0) this.autoSaveDebounce = newDeb;\n        // Container size mode\n        const sizeChanged = newSize !== this.containerSizeMode;\n        this.containerSizeMode = newSize;\n        // Container orientation\n        const orientChanged = newOrient !== this.containerPresetOrient;\n        this.containerPresetOrient = newOrient;\n        if (sizeChanged || orientChanged) {\n          // When size or orientation changes, recalc container\n          this._resizeContainer?.();\n        }\n\n        // Apply fixed custom or preset dimensions\n        if (newSize === 'fixed_custom') {\n          // Read custom width & height from inputs and apply immediately\n          const wVal = parseInt(modal.querySelector('#ddc-setting-custW')?.value || '0', 10);\n          const hVal = parseInt(modal.querySelector('#ddc-setting-custH')?.value || '0', 10);\n          if (!isNaN(wVal) && wVal > 0) this.containerFixedWidth  = wVal;\n          if (!isNaN(hVal) && hVal > 0) this.containerFixedHeight = hVal;\n          // Recompute container size after updating custom dims\n          this._resizeContainer?.();\n        } else if (newSize === 'preset') {\n          const presetVal = modal.querySelector('#ddc-setting-preset')?.value;\n          if (presetVal) this.containerPreset = presetVal;\n          // Recompute container size after updating preset\n          this._resizeContainer?.();\n        }\n        // Disable overlap\n        this.disableOverlap = newOverlap;\n        // Container background\n        if (newCBg) {\n          this.containerBackground = newCBg;\n          this.style.setProperty('--ddc-bg', this.containerBackground);\n        }\n        // Card background\n        if (newCardBg) {\n          this.cardBackground = newCardBg;\n          this.style.setProperty('--ddc-card-bg', this.cardBackground);\n        }\n        // Background image (only src)\n        // Background image (only src) \u2014 immutable update (avoids \"read-only\" error)\n        if (newBgImg) {\n          const prevBg = (this._config && this._config.background_image) || {};\n          this._config = { ...this._config, background_image: { ...prevBg, src: newBgImg } };\n        } else {\n          const { background_image, ...rest } = this._config || {};\n          this._config = rest;\n        }\n        // Debug\n        this.debug = newDebug;\n        // Animate cards\n        this.animateCards = newAnim;\n        // Hide HA chrome\n        this.hideHaHeader  = newHideHdr;\n        this.hideHaSidebar = newHideBar;\n        this._applyHaChromeVisibility_?.();\n        // Apply background image (if changed)\n        if (newBgImg) {\n          this._applyBackgroundImageFromConfig?.();\n        }\n        // Update underlying config so changes persist in YAML/storage\n        try {\n          if (!this._config) this._config = {};\n          this._config.grid                    = this.gridSize;\n          this._config.auto_resize_cards       = !!this.autoResizeCards;\n          this._config.drag_live_snap          = !!this.dragLiveSnap;\n          this._config.auto_save               = !!this.autoSave;\n          this._config.auto_save_debounce      = this.autoSaveDebounce;\n          this._config.container_size_mode     = this.containerSizeMode;\n          this._config.container_preset_orientation = this.containerPresetOrient;\n          this._config.container_fixed_width   = this.containerFixedWidth;\n          this._config.container_fixed_height  = this.containerFixedHeight;\n          this._config.container_preset        = this.containerPreset;\n          this._config.disable_overlap         = !!this.disableOverlap;\n          this._config.container_background    = this.containerBackground;\n          this._config.card_background         = this.cardBackground;\n          this._config.debug                   = !!this.debug;\n          this._config.animate_cards           = !!this.animateCards;\n          this._config.hide_HA_Header          = !!this.hideHaHeader;\n          this._config.hide_HA_Sidebar         = !!this.hideHaSidebar;\n          // Background image src is already updated in this._config.background_image above\n        } catch (cfgErr) {\n          console.warn('[drag-and-drop-card] Failed to update config', cfgErr);\n        }\n        // Persist changes\n        // Persist changes exactly like the Visual Editor (Storage dashboards)\n        this._persistThisCardConfigToStorage_()\n          .catch((e) => {\n            console.warn('[drag-and-drop-card] Storage save failed (is this a YAML dashboard?)', e);\n            // Optional: toast for the user:\n            // this._showToast_?.('Could not save to dashboard storage. Is this a YAML dashboard?');\n          });\n      } catch (err) {\n        console.warn('[drag-and-drop-card] Failed to apply settings', err);\n      }\n      closeModal();\n    });\n  }\n\n  \n  /* ----------------------------- Export / Import Design ----------------------------- */\n\n\n  // Put these inside the class\n\n  /** Only the exportable knobs the user set in the UI */\n  _exportableOptions() {\n    const opt = {\n      storage_key: this.storageKey || undefined,\n      grid: this.gridSize,\n      container_background: this.containerBackground,\n      card_background: this.cardBackground,\n      disable_overlap: !!this.disableOverlap,\n      drag_live_snap: !!this.dragLiveSnap,\n      auto_save: !!this.autoSave,\n      auto_save_debounce: this.autoSaveDebounce,\n      debug: !!this.debug,\n      container_size_mode: this.containerSizeMode,\n      container_preset_orientation: this.containerPresetOrient,\n      container_fixed_width: this.containerFixedWidth ?? undefined,\n      container_fixed_height: this.containerFixedHeight ?? undefined,\n      container_preset: this.containerPreset,\n      tabs: this.tabs,\n      tabs_position: this.tabsPosition,\n      default_tab: this.defaultTab,\n      hide_tabs_when_single: !!this.hideTabsWhenSingle,\n          auto_resize_cards: !!this.autoResizeCards,\n};\n    // strip undefined to keep files tidy\n    Object.keys(opt).forEach(k => opt[k] === undefined && delete opt[k]);\n    return opt;\n  }\n\n  /** Apply options WITHOUT triggering a full rebuild */\n  _applyImportedOptions(opts = {}, recalc = true) {\n    if (opts && Object.prototype.hasOwnProperty.call(opts, 'storage_key')) {\n    // If storage_key changed, push it into HA editor immediately\n     if (this._isInHaEditorPreview()) {\n       try {\n         const updatedCfg = { type: 'custom:drag-and-drop-card', ...(this._config || {}) };\n         this.dispatchEvent(new CustomEvent('config-changed', {\n           detail: { config: updatedCfg },\n           bubbles: true,\n           composed: true,\n         }));\n       } catch {}\n     }\n    }\n\n    // keep the original config around, but merge options into live props\n    this._config = { ...(this._config || {}), ...opts };\n\n    if ('storage_key' in opts)        this.storageKey = opts.storage_key || undefined;\n    this._syncEditorsStorageKey();\n    if ('grid' in opts)               this.gridSize = Number(opts.grid) || 10;\n    if ('drag_live_snap' in opts)     this.dragLiveSnap = !!opts.drag_live_snap;\n    if ('auto_save' in opts)          this.autoSave = !!opts.auto_save;\n    if ('auto_save_debounce' in opts) this.autoSaveDebounce = Number(opts.auto_save_debounce) || 800;\n    if ('container_background' in opts) this.containerBackground = opts.container_background ?? 'transparent';\n    if ('card_background' in opts)      this.cardBackground = opts.card_background ?? 'var(--ha-card-background, var(--card-background-color))';\n    if ('debug' in opts)              this.debug = !!opts.debug;\n    if ('disable_overlap' in opts)    this.disableOverlap = !!opts.disable_overlap;\n\n    if ('container_size_mode' in opts)        this.containerSizeMode = opts.container_size_mode || 'dynamic';\n    if ('container_fixed_width' in opts)      this.containerFixedWidth  = Number(opts.container_fixed_width)  || null;\n    if ('container_fixed_height' in opts)     this.containerFixedHeight = Number(opts.container_fixed_height) || null;\n    if ('container_preset' in opts)           this.containerPreset = opts.container_preset || 'fhd';\n    if ('container_preset_orientation' in opts) this.containerPresetOrient = opts.container_preset_orientation || 'auto';\n    \n    if ('auto_resize_cards' in opts) {\n      this.autoResizeCards = !!opts.auto_resize_cards;\n      if (this.autoResizeCards) this._startScaleWatch?.(); else this._stopScaleWatch?.();\n      this._applyAutoScale?.();\n    }\n\n\n\n    // reflect to CSS\n    this.style.setProperty('--ddc-bg', this.containerBackground);\n    this.style.setProperty('--ddc-card-bg', this.cardBackground);\n    this._applyGridVars();\n\n    if (recalc) {\n      this._applyContainerSizingFromConfig(true);\n      this._applyAutoScale?.();\n      this._resizeContainer();\n      this._updateStoreBadge?.();\n      this._applyAutoScale?.();\n\n    }\n  }\n\n  _exportDesign() {\n    const wraps = Array.from(\n      this.cardContainer.querySelectorAll('.card-wrapper:not(.ddc-placeholder)')\n    );\n    const saved = wraps.map((w) => { // DDC tabs\n        \n      const x = parseFloat(w.getAttribute('data-x')) || 0;\n      const y = parseFloat(w.getAttribute('data-y')) || 0;\n      const width  = parseFloat(w.style.width)  || w.getBoundingClientRect().width;\n      const height = parseFloat(w.style.height) || w.getBoundingClientRect().height;\n      const z = parseInt(w.style.zIndex || '1', 10);\n      const cardCfg = this._extractCardConfig(w.firstElementChild);\n      const tabId = w.dataset.tabId || this.defaultTab;\n        return { card: cardCfg, position:{x,y}, size:{width,height}, z, tabId };\n    });\n\n    const payload = {\n      version: 2,\n      options: this._exportableOptions(),\n      cards: saved\n    };\n\n    // NEW: preserve card_mod (if present) as part of options so it exports with the design\n    if (this._config && this._config.card_mod) {\n      payload.options = payload.options || {};\n      payload.options.card_mod = this._config.card_mod;\n    }\n\n    const name = `DragAndDrop_Design_${this.storageKey || 'layout'}.json`;\n    const blob = new Blob([JSON.stringify(payload, null, 2)], { type:'application/json' });\n    const a = document.createElement('a');\n    a.href = URL.createObjectURL(blob);\n    a.download = name;\n    a.click();\n    URL.revokeObjectURL(a.href);\n    this._toast('Design exported.');\n  }  \n  \n_importDesign() {\n  const inp = document.createElement('input');\n  inp.type = 'file';\n  inp.accept = 'application/json';\n\n  // ---- tweak these if you like ----\n  const HARD_REPLACE = true;                 // fully overwrite existing options\n  const ADOPT_IMPORTED_STORAGE_KEY = false;  // keep current storage_key by default\n  const KNOWN_OPT_KEYS = [\n    'grid','drag_live_snap','auto_save','auto_save_debounce',\n    'container_background','card_background','debug','disable_overlap',\n    'container_size_mode','container_fixed_width','container_fixed_height',\n    'container_preset','container_preset_orientation',\n    'tabs','tabs_position','default_tab','hide_tabs_when_single',\n    'card_mod','storage_key'\n  ];\n  // ----------------------------------\n\n  inp.onchange = async () => {\n    const file = inp.files?.[0]; if (!file) return;\n    const txt = await file.text();\n\n    try {\n      const json = JSON.parse(txt);\n      const prevStorageKey = this.storageKey || this._config?.storage_key || null;\n\n      // -------- BACK-COMPAT: synthesize tabs if missing in older exports --------\n      const hasOptionsTabs = !!(json.options && Array.isArray(json.options.tabs));\n      const hasCardTabIds  = Array.isArray(json.cards) && json.cards.some(c => c?.tabId || c?.tab_id);\n\n      // Build a compatible tabs list:\n      // 1) If options.tabs exist, use them.\n      // 2) Else if cards have tabIds, synthesize from distinct ids.\n      // 3) Else create a single default tab.\n      let compatTabs = [];\n      if (hasOptionsTabs) {\n        compatTabs = json.options.tabs;\n      } else if (hasCardTabIds) {\n        const uniq = Array.from(new Set(json.cards.map(c => c?.tabId || c?.tab_id).filter(Boolean)));\n        compatTabs = uniq.map(id => ({ id, label: id }));\n      } else {\n        compatTabs = [{ id: 'default', label: 'Layout' }];\n      }\n\n      const compatTabsPosition = (json.options?.tabs_position === 'left')\n        ? 'left'\n        : (this.tabsPosition || 'top');\n\n      const compatDefaultTab =\n        json.options?.default_tab\n        || (compatTabs[0]?.id || 'default');\n\n      const compatHideSingle =\n        (json.options?.hide_tabs_when_single !== undefined)\n          ? !!json.options.hide_tabs_when_single\n          : true;\n      // -------------------------------------------------------------------------\n\n      // ---- APPLY OPTIONS (with hard-replace or merge) ----\n      if (json.options) {\n        const imported = { ...json.options };\n        if (!ADOPT_IMPORTED_STORAGE_KEY) delete imported.storage_key;\n\n        if (HARD_REPLACE) {\n          const cfg = this._config || { type: 'custom:drag-and-drop-card' };\n\n          // 1) remove stale option keys that aren't in the import\n          for (const k of KNOWN_OPT_KEYS) {\n            if (k === 'storage_key' && !ADOPT_IMPORTED_STORAGE_KEY) continue;\n            if (!(k in imported) && k in cfg) delete cfg[k];\n          }\n\n          // 2) clear any previously-applied DOM styles that could linger\n          try {\n            if (this.cardContainer) {\n              this.cardContainer.style.background = '';\n              this.cardContainer.style.width = '';\n              this.cardContainer.style.height = '';\n            }\n            this.style?.removeProperty?.('--ddc-container-bg');\n            this.style?.removeProperty?.('--ddc-card-bg');\n          } catch {}\n\n          // 3) apply imported options\n          this._config = { ...cfg, ...imported };\n          if (!('card_mod' in imported)) delete this._config.card_mod;\n\n          if (ADOPT_IMPORTED_STORAGE_KEY && imported.storage_key) {\n            this.storageKey = imported.storage_key;\n          }\n\n          if (this._opts) {\n            this._opts = { ...this._opts, ...imported };\n            for (const k of KNOWN_OPT_KEYS) {\n              if (!(k in imported)) delete this._opts[k];\n            }\n          }\n\n          this._applyOptionsToDom?.(this._config);\n          this.requestUpdate?.();\n        } else {\n          this._applyImportedOptions(imported, true);\n          if (imported.card_mod !== undefined) {\n            this._config = this._config || {};\n            this._config.card_mod = imported.card_mod;\n            this.requestUpdate?.();\n          }\n        }\n      } else if (typeof json.grid === 'number') {\n        // v1 fallback\n        const imported = { grid: json.grid };\n        HARD_REPLACE\n          ? (this._config = { ...(this._config||{}), ...imported })\n          : this._applyImportedOptions(imported, true);\n        this.requestUpdate?.();\n      }\n\n      // Ensure instance tab options exist even for old files (after options applied)\n      if (!Array.isArray(this.tabs) || !this.tabs.length) this.tabs = compatTabs;\n      if (!this.tabsPosition) this.tabsPosition = compatTabsPosition;\n      if (!this.defaultTab) this.defaultTab = compatDefaultTab;\n      if (this.hideTabsWhenSingle === undefined) this.hideTabsWhenSingle = compatHideSingle;\n      this.rootEl?.classList?.toggle?.('ddc-tabs-left-layout', this.tabsPosition === 'left');\n\n      // ---- PERSIST IMPORTED OPTIONS TO YAML (replace semantics) ----\n      try {\n        const targetKey = this._config?.storage_key || this.storageKey || null;\n\n        // Start from what the file had (v2) or v1 fallback\n        const importedOptions = json.options\n          ?? (typeof json.grid === 'number' ? { grid: json.grid } : {});\n\n        // Ensure tabs keys are present (either from file or from current instance state)\n        const persistOptions = {\n          ...importedOptions,\n          tabs: importedOptions.tabs ?? this.tabs ?? [],\n          tabs_position: importedOptions.tabs_position ?? this.tabsPosition ?? 'top',\n          default_tab: importedOptions.default_tab\n            ?? this.defaultTab\n            ?? ((importedOptions.tabs?.[0]?.id) || (this.tabs?.[0]?.id) || 'default'),\n          hide_tabs_when_single:\n            importedOptions.hide_tabs_when_single ?? (this.hideTabsWhenSingle ?? true),\n        };\n\n        // Unless you want to adopt the incoming storage_key, drop it\n        if (!ADOPT_IMPORTED_STORAGE_KEY) delete persistOptions.storage_key;\n\n        if (!targetKey) {\n          console.warn('[ddc:import] No storage_key on this card; aborting YAML persist.');\n        } else {\n          const result = await this._persistOptionsToYaml?.(persistOptions, {\n            forceTargetKey: String(targetKey),\n            noDownload: true,\n            replace: true,\n            wipeUnknownKeys: true,\n          });\n          const yamlOk = !!(result && result.yamlSaved);\n          console.debug?.('[ddc:import] YAML persist result:', yamlOk);\n        }\n\n        // SAFETY NET: push tabs into the live card config (so the UI editor/YAML reflects it immediately)\n        try {\n          const cfg = { type: 'custom:drag-and-drop-card', ...(this._config || {}) };\n          cfg.tabs = persistOptions.tabs;\n          cfg.tabs_position = persistOptions.tabs_position;\n          cfg.default_tab = persistOptions.default_tab;\n          cfg.hide_tabs_when_single = !!persistOptions.hide_tabs_when_single;\n\n          this.dispatchEvent(new CustomEvent('config-changed', {\n            detail: { config: cfg },\n            bubbles: true,\n            composed: true,\n          }));\n        } catch {}\n      } catch (e) {\n        console.warn('[ddc:import] YAML persist failed:', e);\n      }\n\n      // ---- BUILD CARDS ----\n      this.cardContainer.innerHTML = '';\n      if (Array.isArray(json.cards) && json.cards.length) {\n        for (const conf of json.cards) {\n          const x = conf.position?.x || 0;\n          const y = conf.position?.y || 0;\n          const w = conf.size?.width  || 140;\n          const h = conf.size?.height || 100;\n          const z = conf.z;\n          const tabId = this._normalizeTabId(conf.tabId || conf.tab_id || this.defaultTab);\n\n          if (!conf?.card || (typeof conf.card === 'object' && !Object.keys(conf.card).length)) {\n            // placeholder still respects tab\n            const p = this._makePlaceholderAt(x, y, w, h);\n            p.dataset.tabId = tabId;\n            this.cardContainer.appendChild(p);\n            continue;\n          }\n\n          const el = await this._createCard(conf.card);\n          const wrap = this._makeWrapper(el);\n          wrap.dataset.tabId = tabId;\n          this._setCardPosition(wrap, x, y);\n          wrap.style.width  = `${w}px`;\n          wrap.style.height = `${h}px`;\n          if (z != null) wrap.style.zIndex = String(z);\n          this.cardContainer.appendChild(wrap);\n\n          try { this._rebuildOnce(wrap.firstElementChild); } catch {}\n          this._initCardInteract(wrap);\n        }\n      } else {\n        this._showEmptyPlaceholder();\n        this._applyAutoScale?.();\n      }\n\n      // apply container sizing/appearance and refresh tabs UI now that cards exist\n      this._applyOptionsToDom?.(this._config);\n      this._resizeContainer();\n      try {\n        this.rootEl?.classList?.toggle?.('ddc-tabs-left-layout', this.tabsPosition === 'left');\n        this._renderTabs?.();\n        this._applyActiveTab?.();\n      } catch {}\n\n      // ---- SAVE LAYOUT ----\n      try {\n        if (this._saveTimer) clearTimeout(this._saveTimer);\n        await this._saveLayout(true);  // NOTE: ensure _saveLayout returns {\u2026, tabId} per card\n        this._toast?.('Design imported & saved. Reloading...');\n        window.location.reload();\n      } catch (e) {\n        console.warn('[ddc:import] saveLayout failed', e);\n        this._markDirty?.('import');\n        this._toast?.('Design imported \u2014 click Apply to save.');\n      }\n    } catch (e) {\n      console.error('Import failed', e);\n      this._toast?.('Import failed \u2014 invalid file.');\n    }\n  };\n\n  inp.click();\n}\n\n\n  \n  // ===== DDC: Lovelace persistence helpers (import options -> stored YAML) =====\n  _getLovelace() {\n    // Walk up from this element through shadow roots\n    let hop = 0, host = this;\n    while (host && hop++ < 20) {\n      const root = host.getRootNode?.();\n      const rHost = root?.host;\n      if (rHost?.tagName === 'HUI-ROOT') return rHost.lovelace;\n      host = rHost || host.parentElement;\n    }\n    // Breadth-first fallback\n    const seen = new Set(), q = [document];\n    while (q.length) {\n      const n = q.shift();\n      if (!n || seen.has(n)) continue;\n      seen.add(n);\n      if (n.host?.tagName === 'HUI-ROOT') return n.host.lovelace;\n      if (n.tagName === 'HUI-ROOT') return n.lovelace;\n      if (n.shadowRoot) q.push(n.shadowRoot);\n      if (n.children) for (const c of n.children) q.push(c);\n    }\n    return undefined;\n  }\n\n  _scanDdcCards(cfg) {\n    const hits = []; // { view:number, path:string[], card:object }\n    const push = (view, path, obj) => {\n      if (obj?.type === 'custom:drag-and-drop-card') hits.push({ view, path: [...path], card: obj });\n    };\n    const visit = (node, viewIdx, path) => {\n      if (!node) return;\n      if (Array.isArray(node)) { node.forEach((n, i) => visit(n, viewIdx, path.concat(i))); return; }\n      if (typeof node !== 'object') return;\n\n      if ('type' in node) push(viewIdx, path, node);\n\n      for (const [k, v] of Object.entries(node)) {\n        if (k === 'views' && Array.isArray(v)) v.forEach((vv, i) => visit(vv, i, ['views', i]));\n        else if (Array.isArray(v)) visit(v, viewIdx, path.concat(k));\n        else if (v && typeof v === 'object') visit(v, viewIdx, path.concat(k));\n      }\n    };\n    visit(cfg, -1, []);\n    return hits;\n  }\n\n  async _persistOptionsToYaml(opts, { prevKey = null, patchAllInCurrentViewIfNoKey = false } = {}) {\n    try {\n      const ll = this._getLovelace();\n      if (!ll) { console.debug('[ddc:import] persist: no lovelace root'); return false; }\n      if (typeof ll.saveConfig !== 'function') { console.debug('[ddc:import] persist: dashboard not in Storage mode'); return false; }\n\n      // Deep clone to avoid mutating live config\n      const cfg = JSON.parse(JSON.stringify(ll.config));\n      const hits = this._scanDdcCards(cfg);\n      const curView = ll.current_view ?? 0;\n\n      console.debug('[ddc:import] persist: found DDC cards', hits.map(h => ({ view: h.view, path: h.path.join('.'), storage_key: h.card.storage_key || null })));\n\n      const newKey = opts?.storage_key ?? null;\n      const keys = [];\n      if (prevKey) keys.push(prevKey);\n      if (newKey) keys.push(newKey);\n      if (this.storageKey) keys.push(this.storageKey);\n      if (this._config?.storage_key) keys.push(this._config.storage_key);\n\n      // Prefer exact key matches (either previous or new)\n      let targets = hits.filter(h => h.card.storage_key && keys.includes(h.card.storage_key));\n\n      // If no exact match: if only one DDC in current view, target it\n       if (!targets.length) {\n        const inCur = hits.filter(h => h.view === curView);\n         if (inCur.length === 1) targets = inCur;   // safe only if exactly one\n         // else: no target \u2192 abort instead of touching multiple cards\n       }\n\n      // As a last resort, if there is only one DDC overall, patch it\n      if (!targets.length && hits.length === 1) targets = hits;\n\n      if (!targets.length) {\n        console.debug('[ddc:import] persist: no target. Provide a unique storage_key on this card and import again.', { prevKey, newKey, storageKey: this.storageKey });\n        return false;\n      }\n\n       // Build a patch for options ONLY \u2014 never stamp a global storage_key into multiple cards\n       const basePatch = { type: 'custom:drag-and-drop-card', ...opts };\n       // Remove any incoming storage_key so it doesn't overwrite per-card keys accidentally\n       if ('storage_key' in basePatch) delete basePatch.storage_key;\n       if ('storageKey' in basePatch)  delete basePatch.storageKey;\n \n       for (const t of targets) {\n         // Resolve the YAML object to patch\n         let ref = cfg;\n         for (const seg of t.path) ref = ref[seg];\n \n         // Remember the card\u2019s existing key (support legacy camelCase & nested)\n         const existingKey =\n           ref?.storage_key ?? ref?.storageKey ?? ref?.options?.storage_key ?? ref?.options?.storageKey ?? null;\n \n         // Decide if this specific card is being renamed (only when prevKey\u2192newKey and it matches)\n         const shouldRename = !!(prevKey && newKey && existingKey === prevKey && newKey !== prevKey);\n \n         // Apply options WITHOUT a key\n         Object.assign(ref, basePatch);\n \n         // Restore / set the right key per-card\n         if (shouldRename) {\n           ref.storage_key = String(newKey);\n         } else if (existingKey) {\n           ref.storage_key = String(existingKey);\n         }\n         // Clean up legacy field\n         if ('storageKey' in ref) delete ref.storageKey;\n       }\n\n      console.debug('[ddc:import] persist \u2192 saving', { patched: targets.length, keysTried: keys, patch });\n      await ll.saveConfig(cfg);\n      return true;\n    } catch (e) {\n      console.warn('[ddc:import] persist error', e);\n      return false;\n    }\n  }\n/* ----------------------------- Save / load ----------------------------- */\n  _queueSave(reason='auto') {\n    // Always mark dirty so Apply becomes enabled\n    this._markDirty(reason);\n    // only queue save when autosave is enabled, not loading, and in edit mode\n    if (!this.autoSave) return;\n    // skip saving while the layout is still loading\n    if (this._loading) return;\n    // respect the user expectation that saving should only happen in edit mode\n    if (!this.editMode) return;\n    this._dbgPush('autosave', 'Queued', { reason, debounce: this.autoSaveDebounce });\n    clearTimeout(this._saveTimer);\n    this._saveTimer = setTimeout(() => this._saveLayout(true), this.autoSaveDebounce);\n  }\n\n  async _saveLayout(silent = true) {\n    const wraps = Array.from(this.cardContainer.querySelectorAll('.card-wrapper:not(.ddc-placeholder)'));\n    const saved = wraps.map((w)=>{\n      const x = parseFloat(w.getAttribute('data-x')) || 0;\n      const y = parseFloat(w.getAttribute('data-y')) || 0;\n      const width  = parseFloat(w.style.width)  || w.getBoundingClientRect().width;\n      const height = parseFloat(w.style.height) || w.getBoundingClientRect().height;\n      const z = parseInt(w.style.zIndex || '1', 10);\n      const cardCfg = this._extractCardConfig(w.firstElementChild);\n      const tabId = w.dataset.tabId || this.defaultTab;\n        return { card: cardCfg, position:{x,y}, size:{width,height}, z, tabId };\n    });\n    const payload = {\n       version: 2,\n       options: this._exportableOptions(),\n       cards: saved\n     };\n\n    try { localStorage.setItem(`ddc_local_${this.storageKey || 'default'}`, JSON.stringify(payload)); } catch {}\n\n    if (!this.storageKey) { if (!silent) this._toast('Saved locally (no storage_key set).');\n      this.__dirty = false; this._updateApplyBtn();\n      return; }\n\n    try {\n      await this._saveLayoutToBackend(this.storageKey, payload);\n      if (!silent) this._toast('Layout saved.');\n      this.__dirty = false; this._updateApplyBtn();\n    } catch (e) {\n      console.error('Backend save failed', e);\n      this._dbgPush('save', 'Backend save failed', { error: String(e) });\n      if (!silent) this._toast('Backend save failed \u2014 kept local copy.');\n    }\n  }\n\n  async _probeBackend() {\n    this._backendOK = false;\n    const t0 = performance.now();\n    try {\n      this._dbgPush('probe', 'GET /api/dragdrop_storage (list keys)');\n      const r = await this.hass.callApi('get', 'dragdrop_storage');\n      const ms = Math.round(performance.now() - t0);\n      this._dbgPush('probe', `OK (${ms} ms)`, r);\n      this._backendOK = !!r;\n    } catch (e) {\n      const ms = Math.round(performance.now() - t0);\n      this._dbgPush('probe', `FAILED (${ms} ms)`, { error: String(e) });\n      this._backendOK = false;\n    }\n    this._updateStoreBadge();\n  }\n\n  async _loadLayoutFromBackend(key) {\n    const url = `dragdrop_storage/${encodeURIComponent(key)}`;\n    const t0 = performance.now();\n    try {\n      this._dbgPush('load', `GET /api/${url}`);\n      const data = await this.hass.callApi('get', url);\n      const ms = Math.round(performance.now() - t0);\n      this._dbgPush('load', `OK (${ms} ms)`, { bytes: JSON.stringify(data||'').length });\n      return data;\n    } catch (e) {\n      const ms = Math.round(performance.now() - t0);\n      this._dbgPush('load', `FAILED (${ms} ms)`, { error: String(e) });\n      return null;\n    }\n  }\n\n  async _saveLayoutToBackend(key, data) {\n    const url = `dragdrop_storage/${encodeURIComponent(key)}`;\n    const size = JSON.stringify(data).length;\n    const t0 = performance.now();\n    try {\n      this._dbgPush('save', `POST /api/${url}`, { bytes: size });\n      const res = await this.hass.callApi('post', url, data);\n      const ms = Math.round(performance.now() - t0);\n      this._dbgPush('save', `OK (${ms} ms)`, res);\n      return res;\n    } catch (e) {\n      const ms = Math.round(performance.now() - t0);\n      this._dbgPush('save', `FAILED (${ms} ms)`, { error: String(e), bytes: size });\n      throw e;\n    }\n  }\n\n  _updateStoreBadge() {\n    const el = this.storeBadge; if (!el) return;\n    const usingHost = this._backendOK && !!this.storageKey;\n    el.textContent = usingHost ? 'storage: backend - OK' : 'storage: local. Your Changes are NOT being SAVED. You need to download the Drag and Drop Card backend integration';\n    el.style.background = usingHost ? 'rgba(76,175,80,.15)' : 'rgba(255,193,7,.15)';\n    el.style.borderColor = usingHost ? 'rgba(76,175,80,.45)' : 'rgba(255,193,7,.45)';\n  }\n\n  /* ----------------------------- Utilities ----------------------------- */\n  _toast(message) {\n    const ev = new Event('hass-notification');\n    ev.detail = { message };\n    window.dispatchEvent(ev);\n  }\n  _huiRoot() {\n    try {\n      const ha   = document.querySelector('home-assistant');\n      const main = ha?.shadowRoot?.querySelector('home-assistant-main');\n      const drawer = main?.shadowRoot?.querySelector('ha-drawer') || main;\n      const ppr = drawer?.shadowRoot?.querySelector('partial-panel-resolver') || drawer;\n      const panel = ppr?.shadowRoot?.querySelector('ha-panel-lovelace') || drawer?.shadowRoot?.querySelector('ha-panel-lovelace');\n      return panel?.shadowRoot?.querySelector('hui-root') || null;\n    } catch { return null; }\n  }\n  getCardSize(){ return 3; }\n}\n\nif (!customElements.get('drag-and-drop-card')) {\n  customElements.define('drag-and-drop-card', DragAndDropCard);\n}\n\n/* Register in HA's card picker */\n(() => {\n  try {\n    const list = (window.customCards = window.customCards || []);\n    if (!list.some(c => c.type === 'drag-and-drop-card')) {\n      list.push({\n        type: 'drag-and-drop-card',   // no \"custom:\" here\n        name: 'Drag & Drop Card',\n        description: 'Freeform drag/resize/snap-to-grid canvas for Lovelace cards.',\n        preview: false\n      });\n    }\n  } catch (e) { /* no-op */ }\n})();\n\n\n/* ==========================================================================\n   Integrated card-mod compatibility enhancements\n   - Ensures card-mod styles apply to nested cards inside drag-and-drop-card\n   - No extra resource needed; executed as part of this script\n   - Uses a guarded (WeakSet) ll-rebuild dispatch on newly added card elements\n   ========================================================================== */\n(() => {\n  const SEEN = new WeakSet();\n\n  const isLikelyCard = (el) => {\n    try {\n      if (!(el instanceof Element)) return false;\n      const n = el.localName || \"\";\n      if (!n) return false;\n      if (n === \"ha-card\") return true;\n      if (n.endsWith(\"-card\")) return true; // hui-*, custom:*, mushroom-*, etc.\n      return false;\n    } catch { return false; }\n  };\n\n  const rebuildOnce = (el) => {\n    try {\n      if (!el || SEEN.has(el)) return;\n      SEEN.add(el);\n      el.dispatchEvent(new Event('ll-rebuild', { bubbles: true, composed: true }));\n    } catch {}\n  };\n\n  const deepScan = (root) => {\n    try {\n      if (!root) return;\n      if (root instanceof Element && isLikelyCard(root)) rebuildOnce(root);\n      const all = (root instanceof ShadowRoot ? root : root).querySelectorAll?.(\"*\");\n      if (!all) return;\n      for (const el of all) {\n        if (isLikelyCard(el)) rebuildOnce(el);\n        const sr = el.shadowRoot;\n        if (sr) { try { deepScan(sr); } catch {} }\n      }\n    } catch {}\n  };\n\n  const installOnInstance = (host) => {\n    try {\n      if (!host || host.__ddcCardModIntegrated) return;\n      host.__ddcCardModIntegrated = true;\n      const root = host.shadowRoot || host;\n\n      // Initial scan (covers already rendered children)\n      deepScan(root);\n\n      // Observe newly added content within the card\n      const mo = new MutationObserver((muts) => {\n        for (const m of muts) {\n          if (!m.addedNodes || !m.addedNodes.length) continue;\n          for (const n of m.addedNodes) {\n            if (n instanceof Element || n instanceof ShadowRoot) {\n              deepScan(n);\n            }\n          }\n        }\n      });\n      mo.observe(root, { childList: true, subtree: true });\n      host.__ddcCardModIntegratedObserver = mo;\n\n      // Follow-up scans for lazy renders\n      setTimeout(() => { try { deepScan(root); } catch {} }, 250);\n      setTimeout(() => { try { deepScan(root); } catch {} }, 1000);\n    } catch {}\n  };\n\n  const hookExisting = () => {\n    try {\n      document.querySelectorAll(\"drag-and-drop-card\").forEach(installOnInstance);\n    } catch {}\n  };\n\n  if (window.customElements && window.customElements.whenDefined) {\n    window.customElements.whenDefined(\"drag-and-drop-card\").then(() => {\n      // Install on existing instances\n      hookExisting();\n      // Patch prototype to auto-install on future instances\n      const ctor = window.customElements.get(\"drag-and-drop-card\");\n      if (ctor && ctor.prototype) {\n        const origConnected = ctor.prototype.connectedCallback;\n        ctor.prototype.connectedCallback = function() {\n          try { origConnected && origConnected.call(this); } finally {\n            installOnInstance(this);\n          }\n        };\n      }\n      // As a fallback, watch the DOM for new instances\n      const docObserver = new MutationObserver(() => hookExisting());\n      docObserver.observe(document.documentElement, { childList: true, subtree: true });\n    });\n  } else {\n    // Very old environment: periodic best-effort scan\n    const iv = setInterval(hookExisting, 1000);\n    setTimeout(() => clearInterval(iv), 10000);\n  }\n})();\n\n/* ==== DDC AUGMENTATION v6: backup on persist + inline toolbar switcher + load-by-key + edit-mode visibility ==== */\n(function(){\n  const tag = 'drag-and-drop-card';\n  const Cls = customElements.get(tag);\n  if (!Cls) { console.warn('[ddc:augment] Could not find custom element', tag); return; }\n\n  function _getLovelace() {\n    try {\n      let hop = 0, host = this;\n      while (host && hop++ < 20) {\n        const root = host.getRootNode?.();\n        const rHost = root?.host;\n        if (rHost?.tagName === 'HUI-ROOT') return rHost.lovelace;\n        host = rHost || host.parentElement;\n      }\n      const seen = new Set(), q = [document];\n      while (q.length) {\n        const n = q.shift();\n        if (!n || seen.has(n)) continue;\n        seen.add(n);\n        if (n.host?.tagName === 'HUI-ROOT') return n.host.lovelace;\n        if (n.tagName === 'HUI-ROOT') return n.lovelace;\n        if (n.shadowRoot) q.push(n.shadowRoot);\n        if (n.children) for (const c of n.children) q.push(c);\n      }\n    } catch(e) {}\n    return undefined;\n  }\n  function _scanDdcCards(cfg) {\n    const hits = [];\n    const push = (view, path, obj) => { if (obj?.type === 'custom:drag-and-drop-card') hits.push({ view, path: [...path], card: obj }); };\n    const visit = (node, viewIdx, path) => {\n      if (!node) return;\n      if (Array.isArray(node)) { node.forEach((n, i) => visit(n, viewIdx, path.concat(i))); return; }\n      if (typeof node !== 'object') return;\n      if ('type' in node) push(viewIdx, path, node);\n      for (const [k, v] of Object.entries(node)) {\n        if (k === 'views' && Array.isArray(v)) v.forEach((vv, i) => visit(vv, i, ['views', i]));\n        else if (Array.isArray(v)) visit(v, viewIdx, path.concat(k));\n        else if (v && typeof v === 'object') visit(v, viewIdx, path.concat(k));\n      }\n    };\n    visit(cfg, -1, []);\n    return hits;\n  }\n  function _makeYamlBackup(llConfig, targets, patch) {\n    const when = new Date().toISOString().replace(/[:.]/g,'-');\n    const items = targets.map(t => {\n      let ref = llConfig;\n      for (const seg of t.path) ref = ref[seg];\n      return { view: t.view, path: t.path, storage_key: (ref && ref.storage_key) || null, before: ref, patch };\n    });\n    const backup = { kind: 'ddc-import-backup', created_at: when, count: items.length, items };\n    try {\n      const key = `ddc.backup.${when}`;\n      localStorage.setItem(key, JSON.stringify(backup));\n      const all = Object.keys(localStorage).filter(k => k.startsWith('ddc.backup.')).sort().reverse();\n      for (const k of all.slice(10)) localStorage.removeItem(k);\n    } catch(e){}\n    return { name: `ddc_backup_${when}.json`, data: backup };\n  }\n  function _offerBackupDownload(name, obj) {\n    try {\n      const blob = new Blob([JSON.stringify(obj, null, 2)], { type: 'application/json' });\n      const url  = URL.createObjectURL(blob);\n      const a    = document.createElement('a');\n      a.href = url; a.download = name;\n      document.body.appendChild(a); a.click(); a.remove();\n      setTimeout(() => URL.revokeObjectURL(url), 1500);\n    } catch(e){ console.warn('[ddc:backup] download failed', e); }\n  }\n  function _recordRecentKey(key) {\n    if (!key) return;\n    try {\n      const K = 'ddc.recent.keys';\n      const arr = JSON.parse(localStorage.getItem(K) || '[]');\n      if (!arr.includes(key)) arr.unshift(key);\n      localStorage.setItem(K, JSON.stringify(arr.slice(0, 20)));\n    } catch {}\n  }\n  function _getRecentKeys() {\n    try { return JSON.parse(localStorage.getItem('ddc.recent.keys') || '[]'); } catch { return []; }\n  }\n  function _collectBackupKeys() {\n    const keys = new Set();\n    try {\n      const names = Object.keys(localStorage).filter(k => k.startsWith('ddc.backup.')).sort().reverse();\n      for (const name of names) {\n        try {\n          const obj = JSON.parse(localStorage.getItem(name) || 'null');\n          if (obj && obj.items) {\n            for (const it of obj.items) {\n              const sk = it?.before?.storage_key || it?.patch?.storage_key;\n              if (sk) keys.add(sk);\n            }\n          }\n        } catch {}\n      }\n    } catch {}\n    return Array.from(keys);\n  }\nasync function _persistOptionsToYaml(opts, {\n  forceTargetKey = null,   // when set, import ONLY into card with this key\n  onlyThisCard   = false,  // reserved; current impl always enforces single-card import\n  prevKey,\n  noDownload\n} = {}) {\n  const ll = this._getLovelace?.() || _getLovelace.call(this);\n  if (!ll) { console.debug('[ddc:import] persist: no lovelace root'); return false; }\n  if (typeof ll.saveConfig !== 'function') { console.debug('[ddc:import] persist: dashboard not in Storage mode'); return false; }\n\n  // Determine the EXACT key we will import into (the clicked card)\n  const norm = (s) => (typeof s === 'string' ? s.trim() : null);\n  const myKey =\n    norm(forceTargetKey) ||\n    norm(this?._config?.storage_key) ||\n    norm(this?.storageKey) ||\n    norm(prevKey);\n\n  if (!myKey) {\n    console.warn('[ddc:import] persist: missing target storage_key on this card; aborting');\n    return false;\n  }\n\n  // Clone config and scan\n  const cfg  = JSON.parse(JSON.stringify(ll.config));\n  const hits = (this._scanDdcCards || _scanDdcCards)(cfg);\n\n  console.debug('[ddc:import] persist: found DDC cards',\n    hits.map(h => ({\n      view: h.view,\n      path: h.path.join('.'),\n      storage_key: (h.card && (h.card.storage_key || h.card.storageKey)) || null\n    }))\n  );\n\n  // Select exactly one target by key (no \u201Cpatch-all-in-view\u201D fallback)\n  let targets = hits.filter(h => {\n    const sk =\n      norm(h.card?.storage_key) ??\n      norm(h.card?.storageKey) ??\n      norm(h.card?.options?.storage_key) ??\n      norm(h.card?.options?.storageKey);\n    return sk === myKey;\n  });\n\n  if (targets.length !== 1) {\n    console.warn('[ddc:import] persist: expected exactly one target with key, got', targets.length, { myKey });\n    return false;\n  }\n\n  // Build patch WITHOUT storage_key so we don't overwrite per-card keys\n  const patch = { type: 'custom:drag-and-drop-card', ...(opts || {}) };\n  if ('storage_key' in patch)  delete patch.storage_key;\n  if ('storageKey'  in patch)  delete patch.storageKey;\n  if (patch?.options) {\n    if ('storage_key' in patch.options) delete patch.options.storage_key;\n    if ('storageKey'  in patch.options) delete patch.options.storageKey;\n  }\n     // IMPORTANT: do NOT put the actual layout into Lovelace YAML\n   const cardsForStorage = Array.isArray(patch.cards) ? patch.cards : null;\n   delete patch.cards;\n\n  // Optional: backup (keeps your previous behavior if helpers exist)\n  try {\n    const backup = _makeYamlBackup?.(ll.config, targets, patch);\n    if (backup) {\n      console.debug('[ddc:import] backup created', { file: backup.name, items: backup.data?.count });\n      if (!noDownload && typeof _offerBackupDownload === 'function') _offerBackupDownload(backup.name, backup.data);\n    }\n  } catch (e) {\n    console.debug('[ddc:import] backup skipped/error:', e?.message || e);\n  }\n\n  // Apply to the single matched ref\n  const t = targets[0];\n  let ref = cfg;\n  for (const seg of t.path) ref = ref[seg];\n\n  const existingKey =\n    norm(ref?.storage_key) ??\n    norm(ref?.storageKey) ?? null;\n\n  Object.assign(ref, patch);\n\n  // Preserve the original key on this card\n  if (existingKey) {\n    ref.storage_key = existingKey;\n  } else {\n    ref.storage_key = myKey;\n  }\n  if ('storageKey' in ref) delete ref.storageKey;\n\n  console.debug('[ddc:import] persist \u2192 saving', {\n    patched: 1,\n    into_key: ref.storage_key,\n    ignored_file_key: norm(opts?.storage_key) || norm(opts?.storageKey) || null\n  });\n\n  await ll.saveConfig(cfg);\n  // Let the caller know if there were cards to save elsewhere\n  return { yamlSaved: true, cardsForStorage };\n}\n\n  async function _fetchBackendKeys() {\n    const parseKeys = (data) => {\n      if (!data) return [];\n      if (Array.isArray(data)) return data;\n      if (Array.isArray(data?.keys)) return data.keys;\n      if (Array.isArray(data?.dashboards)) return data.dashboards;\n      if (Array.isArray(data?.entries)) return data.entries.map(e => e.key || e.id || e.name).filter(Boolean);\n      if (Array.isArray(data?.items)) return data.items.map(e => e.key || e.id || e.name).filter(Boolean);\n      if (typeof data === 'object') {\n        for (const v of Object.values(data)) {\n          if (Array.isArray(v) && v.every(x => typeof x === 'string')) return v;\n        }\n      }\n      return [];\n    };\n    try {\n      if (this?.hass?.callApi) {\n        const r = await this.hass.callApi('get', 'dragdrop_storage');\n        const k = parseKeys(r);\n        if (k.length) return k;\n      }\n    } catch(e) { console.debug('[ddc:switcher] hass.callApi dragdrop_storage failed', e); }\n    const urls = ['/api/dragdrop_storage', '/api/dragdrop_storage/keys', '/api/dragdrop_storage/list', '/api/dragdrop_storage?all=1'];\n    for (const url of urls) {\n      try {\n        const resp = await fetch(url, { cache: 'no-store' });\n        const json = await resp.json();\n        const k = parseKeys(json);\n        if (k.length) return k;\n      } catch(e) {}\n    }\n    return [];\n  }\n  async function _fetchLayoutByKey(key) {\n    const parseDesign = (data) => {\n      if (!data) return null;\n      if (data.options || data.cards) return data;\n      if (typeof data.design === 'object') return data.design;\n      if (typeof data.payload === 'object') return data.payload;\n      try { if (typeof data === 'string') return JSON.parse(data); } catch {}\n      return null;\n    };\n    const tryCall = async (method, path, params) => {\n      try {\n        if (this?.hass?.callApi) {\n          const r = await this.hass.callApi(method, path, params);\n          const d = parseDesign(r);\n          if (d) return d;\n        }\n      } catch(e) {}\n      return null;\n    };\n    const tryFetch = async (url) => {\n      try {\n        const resp = await fetch(url, { cache: 'no-store' });\n        const ct = resp.headers.get('content-type') || '';\n        if (ct.includes('application/json') || ct.includes('text/plain')) {\n          const j = await resp.json().catch(()=>null) || await resp.text().catch(()=>null);\n          const d = parseDesign(j);\n          if (d) return d;\n        }\n      } catch(e) {}\n      return null;\n    };\n    const enc = encodeURIComponent(key);\n    return await (tryCall('get', `dragdrop_storage/${enc}`)\n      || tryFetch(`/api/dragdrop_storage/${enc}`)\n      || tryFetch(`/api/dragdrop_storage?key=${enc}`)\n      || tryCall('post', 'dragdrop_storage/get', { key })\n      || null);\n  }\n  async function _applyDesignObject(json, { source='switcher', newKey=null } = {}) {\n    if (!json || typeof json !== 'object') throw new Error('Invalid design payload');\n    const prevKey = this.storageKey || this._config?.storage_key || null;\n    try { this._dbgInit?.(); this._dbgPush?.('import', 'Begin import (programmatic)', { source, newKey }); } catch {}\n    if (json.options) {\n      const { storage_key, ...optsNoKey } = json.options;\n      this._applyImportedOptions?.(optsNoKey, true);\n    } else if (typeof json.grid === 'number') {\n      this._applyImportedOptions?.({ grid: json.grid }, true);\n    }\n    const key = newKey || json?.options?.storage_key || prevKey;\n    if (key) {\n      this.storageKey = key;\n      this._config = { ...(this._config || {}), storage_key: key };\n      try { this._syncEditorsStorageKey?.(); } catch {}\n    }\n    try {\n      const toPersist = json.options ?? (typeof json.grid === 'number' ? { grid: json.grid } : {});\n      await (this._persistOptionsToYaml?.call(this, { ...toPersist, storage_key: key }, { prevKey, noDownload: (source==='switcher') }));\n    } catch(e) { console.warn('[ddc:apply] persist failed', e); }\n    try {\n      this.cardContainer.innerHTML = '';\n      if (Array.isArray(json.cards) && json.cards.length) {\n        for (const conf of json.cards) {\n          if (!conf?.card || (typeof conf.card === 'object' && Object.keys(conf.card).length === 0)) {\n            const p = this._makePlaceholderAt?.(conf.position?.x||0, conf.position?.y||0, conf.size?.width||200, conf.size?.height||200);\n            if (p) this.cardContainer.appendChild(p);\n          } else {\n            const el = await this._createCard(conf.card);\n            const wrap = this._makeWrapper(el);\n            this._setCardPosition?.(wrap, conf.position?.x||0, conf.position?.y||0);\n            wrap.style.width  = `${conf.size?.width||140}px`;\n            wrap.style.height = `${conf.size?.height||100}px`;\n            if (conf.z != null) wrap.style.zIndex = String(conf.z);\n            this.cardContainer.appendChild(wrap);\n            try { this._rebuildOnce?.(wrap.firstElementChild); } catch {}\n            this._initCardInteract?.(wrap);\n          }\n        }\n      } else {\n        this._showEmptyPlaceholder?.();\n      }\n      this._resizeContainer?.();\n      this._markDirty?.('import');\n      this._toast?.(source==='switcher' ? `Loaded layout \"${key}\"` : 'Design imported');\n    } catch(e) {\n      console.error('[ddc:apply] rebuild failed', e);\n      this._toast?.('Import failed during rebuild.');\n    }\n  }\n  function _updateSwitcherVisibility() {\n    try {\n      const host = this.shadowRoot || this.renderRoot || this;\n      const el = host.querySelector('.ddc-switcher-inline');\n      if (!el) return;\n      const ll = this._getLovelace?.() || _getLovelace.call(this);\n      let edit = false;\n      try {\n        const hui = (host.getRootNode && host.getRootNode())?.host;\n        edit = !!(ll && (ll.editMode === true || (hui && hui.editMode === true)));\n      } catch {}\n      el.style.display = edit ? 'inline-flex' : 'none';\n    } catch {}\n  }\n  function _ensureInlineSwitcher() {\n    try {\n      if (this._ddcSwitcherInstalled) return;\n      const host = this.shadowRoot || this.renderRoot || this;\n      const toolbar = host.querySelector('.toolbar');\n      if (!toolbar) return;\n      const wrap = document.createElement('div');\n      wrap.className = 'ddc-switcher-inline';\n      Object.assign(wrap.style, { display: 'inline-flex', gap: '6px', alignItems: 'center', marginLeft: 'auto' });\n      const label = document.createElement('span');\n      label.textContent = 'Layout:';\n      label.style.fontSize = '12px';\n      label.style.opacity = '0.8';\n      const select = document.createElement('select');\n      Object.assign(select.style, {\n        fontSize: '12px', padding: '4px 6px', borderRadius: '8px',\n        border: '1px solid var(--divider-color, #999)',\n        background: 'var(--card-background-color, #fff)'\n      });\n      select.title = 'Select stored layout (storage_key)';\n      select.id = 'ddcKeySelect';\n      const btn = document.createElement('button');\n      btn.className = 'btn secondary';\n      btn.type = 'button';\n      btn.style.padding = '6px 10px';\n      btn.innerHTML = '<ha-icon icon=\"mdi:refresh\"></ha-icon><span style=\"margin-left:6px\">Refresh</span>';\n      wrap.appendChild(label);\n      wrap.appendChild(select);\n      wrap.appendChild(btn);\n      toolbar.appendChild(wrap);\n      this._ddcSwitcherInstalled = true;\n      const fill = async () => {\n        const current = this.storageKey || (this._config && this._config.storage_key) || '';\n        const serverKeys = await _fetchBackendKeys.call(this);\n        const backupKeys = _collectBackupKeys();\n        const recentKeys = _getRecentKeys();\n        const toUnique = (arr) => Array.from(new Set(arr.filter(Boolean)));\n        const server = toUnique(serverKeys);\n        const backups = toUnique(backupKeys);\n        const recent = toUnique(recentKeys);\n        select.innerHTML = '';\n        if (current && !server.includes(current) && !backups.includes(current) && !recent.includes(current)) {\n          const opt = document.createElement('option');\n          opt.value = current;\n          opt.textContent = `${current} (current)`;\n          opt.selected = true; // ensure the dropdown shows the actual current value\n          select.appendChild(opt);\n        }\n        const makeGroup = (label, list) => {\n          if (!list.length) return;\n          const og = document.createElement('optgroup'); og.label = label;\n          list.forEach(k => {\n            const o = document.createElement('option'); o.value = k; o.textContent = k; if (k===current) o.selected = true;\n            og.appendChild(o);\n          });\n          select.appendChild(og);\n        };\n        makeGroup('Server', server);\n        makeGroup('Backups', backups);\n        makeGroup('Recent', recent);\n        if (!select.children.length) {\n          const none = document.createElement('option'); none.value=''; none.textContent='\u2014 none \u2014'; none.selected = true;\n          select.appendChild(none);\n        }\n        _updateSwitcherVisibility.call(this);\n      };\n      fill();\n      btn.addEventListener('click', fill);\n      \n      select.addEventListener('change', async (e) => {\n        const newKey = String(e.target.value || '');\n        if (!newKey) return;\n        if (this._ddcLoadingFromKey) return;\n        this._ddcLoadingFromKey = true;\n\n        try {\n          const design = await _fetchLayoutByKey.call(this, newKey);\n          if (!design) {\n            this._toast?.(`No layout found for \"${newKey}\"`);\n            return;\n          }\n\n          // Apply the newly selected design to the canvas\n          await _applyDesignObject.call(this, design, { source: 'switcher', newKey });\n          this._resizeContainer?.();\n          this._toast?.(`Loaded layout \"${newKey}\"`);\n\n          // ---- PERSIST THE SELECTED KEY *TO THE CARD OPTIONS* ----\n          // IMPORTANT: persist against the *old* key so the YAML updater finds this card\n          const oldKey = String(this._config?.storage_key || this.storageKey || '');\n\n          let persistOk = false;\n          try {\n            const persistOpts = oldKey\n              ? { forceTargetKey: oldKey, noDownload: true }\n              : { noDownload: true };\n\n            // NOTE: in YAML mode this can resolve to false (no exception)\n            persistOk = await this._persistOptionsToYaml({ storage_key: newKey }, persistOpts);\n          } catch (err) {\n            console.warn('[ddc:switcher] failed to persist storage_key to YAML', err);\n            this._toast?.('Failed to persist selected layout. Keeping current.');\n            return; // bail so we don't reload into the wrong key\n          }\n\n          // Always update in-memory state so the UI reflects the selection now\n          this.storageKey = newKey;\n          if (this._config) this._config.storage_key = newKey;\n\n          // If persistence didn\u2019t actually happen (e.g., YAML mode), stop here\u2014don\u2019t reload\n          if (!persistOk) {\n            console.warn('[ddc:switcher] persist returned false (likely YAML mode). Skipping reload.');\n            // Optional: remember across reloads if you want\n            // localStorage.setItem('ddc:lastKey', newKey);\n            return;\n          }\n\n          // ---- FLUSH SAVE UNDER THE *NEW* KEY, THEN HARD-RELOAD ----\n          try {\n            if (this._saveTimer) clearTimeout(this._saveTimer);\n            await this._saveLayout(true); // writes under this.storageKey (now newKey)\n          } catch (e2) {\n            console.warn('[ddc:switcher] saveLayout failed', e2);\n            this._markDirty?.('switcher');\n            this._toast?.('Layout loaded \u2014 click Apply to save.');\n            return;\n          }\n\n          // Only reload if persist succeeded (storage/dashboard mode)\n          window.location.reload();\n\n          // Finally, reload so the selected layout is what loads on startup\n          window.location.reload();\n\n        } catch (err) {\n          console.warn('[ddc:switcher] load/apply failed', err);\n          this._toast?.('Failed to load layout.');\n        } finally {\n          this._ddcLoadingFromKey = false;\n        }\n      });\n      this._ddcVisTimer && clearInterval(this._ddcVisTimer);\n      this._ddcVisTimer = setInterval(() => _updateSwitcherVisibility.call(this), 800);\n      _updateSwitcherVisibility.call(this);\n    } catch(e) {\n      console.warn('[ddc:switcher] inline install failed', e);\n    }\n  }\n  if (!Cls.prototype._getLovelace) Cls.prototype._getLovelace = _getLovelace;\n  if (!Cls.prototype._scanDdcCards) Cls.prototype._scanDdcCards = _scanDdcCards;\n  Cls.prototype._persistOptionsToYaml = _persistOptionsToYaml;\n  if (!Cls.prototype._applyDesignObject) Cls.prototype._applyDesignObject = _applyDesignObject;\n  try {\n    const desc = Object.getOwnPropertyDescriptor(Cls.prototype, 'hass');\n    if (desc && (desc.set || desc.get)) {\n      const origSet = desc.set;\n      Object.defineProperty(Cls.prototype, 'hass', {\n        configurable: true, enumerable: true,\n        set(v) { if (origSet) origSet.call(this, v); try { _ensureInlineSwitcher.call(this); } catch(e){} },\n        get: desc.get || function(){ return this._hass; }\n      });\n    } else if (typeof Cls.prototype.setHass === 'function') {\n      const orig = Cls.prototype.setHass;\n      Cls.prototype.setHass = function(v){ if (orig) orig.call(this, v); try { _ensureInlineSwitcher.call(this); } catch(e){} }\n    } else {\n      const origUpdate = Cls.prototype.updated || Cls.prototype.firstUpdated;\n      Cls.prototype.updated = function(...args){ if (origUpdate) origUpdate.apply(this, args); try { _ensureInlineSwitcher.call(this); } catch(e){} }\n    }\n  } catch(e){ console.warn('[ddc:switcher] wrap hass setter failed', e); }\n})();\n/* ==== /DDC AUGMENTATION v6 ==== */", "\n/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */\nfunction isNothing(subject) {\n  return (typeof subject === 'undefined') || (subject === null);\n}\n\n\nfunction isObject(subject) {\n  return (typeof subject === 'object') && (subject !== null);\n}\n\n\nfunction toArray(sequence) {\n  if (Array.isArray(sequence)) return sequence;\n  else if (isNothing(sequence)) return [];\n\n  return [ sequence ];\n}\n\n\nfunction extend(target, source) {\n  var index, length, key, sourceKeys;\n\n  if (source) {\n    sourceKeys = Object.keys(source);\n\n    for (index = 0, length = sourceKeys.length; index < length; index += 1) {\n      key = sourceKeys[index];\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\n\nfunction repeat(string, count) {\n  var result = '', cycle;\n\n  for (cycle = 0; cycle < count; cycle += 1) {\n    result += string;\n  }\n\n  return result;\n}\n\n\nfunction isNegativeZero(number) {\n  return (number === 0) && (Number.NEGATIVE_INFINITY === 1 / number);\n}\n\n\nvar isNothing_1      = isNothing;\nvar isObject_1       = isObject;\nvar toArray_1        = toArray;\nvar repeat_1         = repeat;\nvar isNegativeZero_1 = isNegativeZero;\nvar extend_1         = extend;\n\nvar common = {\n\tisNothing: isNothing_1,\n\tisObject: isObject_1,\n\ttoArray: toArray_1,\n\trepeat: repeat_1,\n\tisNegativeZero: isNegativeZero_1,\n\textend: extend_1\n};\n\n// YAML error class. http://stackoverflow.com/questions/8458984\n\n\nfunction formatError(exception, compact) {\n  var where = '', message = exception.reason || '(unknown reason)';\n\n  if (!exception.mark) return message;\n\n  if (exception.mark.name) {\n    where += 'in \"' + exception.mark.name + '\" ';\n  }\n\n  where += '(' + (exception.mark.line + 1) + ':' + (exception.mark.column + 1) + ')';\n\n  if (!compact && exception.mark.snippet) {\n    where += '\\n\\n' + exception.mark.snippet;\n  }\n\n  return message + ' ' + where;\n}\n\n\nfunction YAMLException$1(reason, mark) {\n  // Super constructor\n  Error.call(this);\n\n  this.name = 'YAMLException';\n  this.reason = reason;\n  this.mark = mark;\n  this.message = formatError(this, false);\n\n  // Include stack trace in error object\n  if (Error.captureStackTrace) {\n    // Chrome and NodeJS\n    Error.captureStackTrace(this, this.constructor);\n  } else {\n    // FF, IE 10+ and Safari 6+. Fallback for others\n    this.stack = (new Error()).stack || '';\n  }\n}\n\n\n// Inherit from Error\nYAMLException$1.prototype = Object.create(Error.prototype);\nYAMLException$1.prototype.constructor = YAMLException$1;\n\n\nYAMLException$1.prototype.toString = function toString(compact) {\n  return this.name + ': ' + formatError(this, compact);\n};\n\n\nvar exception = YAMLException$1;\n\n// get snippet for a single line, respecting maxLength\nfunction getLine(buffer, lineStart, lineEnd, position, maxLineLength) {\n  var head = '';\n  var tail = '';\n  var maxHalfLength = Math.floor(maxLineLength / 2) - 1;\n\n  if (position - lineStart > maxHalfLength) {\n    head = ' ... ';\n    lineStart = position - maxHalfLength + head.length;\n  }\n\n  if (lineEnd - position > maxHalfLength) {\n    tail = ' ...';\n    lineEnd = position + maxHalfLength - tail.length;\n  }\n\n  return {\n    str: head + buffer.slice(lineStart, lineEnd).replace(/\\t/g, '\u2192') + tail,\n    pos: position - lineStart + head.length // relative position\n  };\n}\n\n\nfunction padStart(string, max) {\n  return common.repeat(' ', max - string.length) + string;\n}\n\n\nfunction makeSnippet(mark, options) {\n  options = Object.create(options || null);\n\n  if (!mark.buffer) return null;\n\n  if (!options.maxLength) options.maxLength = 79;\n  if (typeof options.indent      !== 'number') options.indent      = 1;\n  if (typeof options.linesBefore !== 'number') options.linesBefore = 3;\n  if (typeof options.linesAfter  !== 'number') options.linesAfter  = 2;\n\n  var re = /\\r?\\n|\\r|\\0/g;\n  var lineStarts = [ 0 ];\n  var lineEnds = [];\n  var match;\n  var foundLineNo = -1;\n\n  while ((match = re.exec(mark.buffer))) {\n    lineEnds.push(match.index);\n    lineStarts.push(match.index + match[0].length);\n\n    if (mark.position <= match.index && foundLineNo < 0) {\n      foundLineNo = lineStarts.length - 2;\n    }\n  }\n\n  if (foundLineNo < 0) foundLineNo = lineStarts.length - 1;\n\n  var result = '', i, line;\n  var lineNoLength = Math.min(mark.line + options.linesAfter, lineEnds.length).toString().length;\n  var maxLineLength = options.maxLength - (options.indent + lineNoLength + 3);\n\n  for (i = 1; i <= options.linesBefore; i++) {\n    if (foundLineNo - i < 0) break;\n    line = getLine(\n      mark.buffer,\n      lineStarts[foundLineNo - i],\n      lineEnds[foundLineNo - i],\n      mark.position - (lineStarts[foundLineNo] - lineStarts[foundLineNo - i]),\n      maxLineLength\n    );\n    result = common.repeat(' ', options.indent) + padStart((mark.line - i + 1).toString(), lineNoLength) +\n      ' | ' + line.str + '\\n' + result;\n  }\n\n  line = getLine(mark.buffer, lineStarts[foundLineNo], lineEnds[foundLineNo], mark.position, maxLineLength);\n  result += common.repeat(' ', options.indent) + padStart((mark.line + 1).toString(), lineNoLength) +\n    ' | ' + line.str + '\\n';\n  result += common.repeat('-', options.indent + lineNoLength + 3 + line.pos) + '^' + '\\n';\n\n  for (i = 1; i <= options.linesAfter; i++) {\n    if (foundLineNo + i >= lineEnds.length) break;\n    line = getLine(\n      mark.buffer,\n      lineStarts[foundLineNo + i],\n      lineEnds[foundLineNo + i],\n      mark.position - (lineStarts[foundLineNo] - lineStarts[foundLineNo + i]),\n      maxLineLength\n    );\n    result += common.repeat(' ', options.indent) + padStart((mark.line + i + 1).toString(), lineNoLength) +\n      ' | ' + line.str + '\\n';\n  }\n\n  return result.replace(/\\n$/, '');\n}\n\n\nvar snippet = makeSnippet;\n\nvar TYPE_CONSTRUCTOR_OPTIONS = [\n  'kind',\n  'multi',\n  'resolve',\n  'construct',\n  'instanceOf',\n  'predicate',\n  'represent',\n  'representName',\n  'defaultStyle',\n  'styleAliases'\n];\n\nvar YAML_NODE_KINDS = [\n  'scalar',\n  'sequence',\n  'mapping'\n];\n\nfunction compileStyleAliases(map) {\n  var result = {};\n\n  if (map !== null) {\n    Object.keys(map).forEach(function (style) {\n      map[style].forEach(function (alias) {\n        result[String(alias)] = style;\n      });\n    });\n  }\n\n  return result;\n}\n\nfunction Type$1(tag, options) {\n  options = options || {};\n\n  Object.keys(options).forEach(function (name) {\n    if (TYPE_CONSTRUCTOR_OPTIONS.indexOf(name) === -1) {\n      throw new exception('Unknown option \"' + name + '\" is met in definition of \"' + tag + '\" YAML type.');\n    }\n  });\n\n  // TODO: Add tag format check.\n  this.options       = options; // keep original options in case user wants to extend this type later\n  this.tag           = tag;\n  this.kind          = options['kind']          || null;\n  this.resolve       = options['resolve']       || function () { return true; };\n  this.construct     = options['construct']     || function (data) { return data; };\n  this.instanceOf    = options['instanceOf']    || null;\n  this.predicate     = options['predicate']     || null;\n  this.represent     = options['represent']     || null;\n  this.representName = options['representName'] || null;\n  this.defaultStyle  = options['defaultStyle']  || null;\n  this.multi         = options['multi']         || false;\n  this.styleAliases  = compileStyleAliases(options['styleAliases'] || null);\n\n  if (YAML_NODE_KINDS.indexOf(this.kind) === -1) {\n    throw new exception('Unknown kind \"' + this.kind + '\" is specified for \"' + tag + '\" YAML type.');\n  }\n}\n\nvar type = Type$1;\n\n/*eslint-disable max-len*/\n\n\n\n\n\nfunction compileList(schema, name) {\n  var result = [];\n\n  schema[name].forEach(function (currentType) {\n    var newIndex = result.length;\n\n    result.forEach(function (previousType, previousIndex) {\n      if (previousType.tag === currentType.tag &&\n          previousType.kind === currentType.kind &&\n          previousType.multi === currentType.multi) {\n\n        newIndex = previousIndex;\n      }\n    });\n\n    result[newIndex] = currentType;\n  });\n\n  return result;\n}\n\n\nfunction compileMap(/* lists... */) {\n  var result = {\n        scalar: {},\n        sequence: {},\n        mapping: {},\n        fallback: {},\n        multi: {\n          scalar: [],\n          sequence: [],\n          mapping: [],\n          fallback: []\n        }\n      }, index, length;\n\n  function collectType(type) {\n    if (type.multi) {\n      result.multi[type.kind].push(type);\n      result.multi['fallback'].push(type);\n    } else {\n      result[type.kind][type.tag] = result['fallback'][type.tag] = type;\n    }\n  }\n\n  for (index = 0, length = arguments.length; index < length; index += 1) {\n    arguments[index].forEach(collectType);\n  }\n  return result;\n}\n\n\nfunction Schema$1(definition) {\n  return this.extend(definition);\n}\n\n\nSchema$1.prototype.extend = function extend(definition) {\n  var implicit = [];\n  var explicit = [];\n\n  if (definition instanceof type) {\n    // Schema.extend(type)\n    explicit.push(definition);\n\n  } else if (Array.isArray(definition)) {\n    // Schema.extend([ type1, type2, ... ])\n    explicit = explicit.concat(definition);\n\n  } else if (definition && (Array.isArray(definition.implicit) || Array.isArray(definition.explicit))) {\n    // Schema.extend({ explicit: [ type1, type2, ... ], implicit: [ type1, type2, ... ] })\n    if (definition.implicit) implicit = implicit.concat(definition.implicit);\n    if (definition.explicit) explicit = explicit.concat(definition.explicit);\n\n  } else {\n    throw new exception('Schema.extend argument should be a Type, [ Type ], ' +\n      'or a schema definition ({ implicit: [...], explicit: [...] })');\n  }\n\n  implicit.forEach(function (type$1) {\n    if (!(type$1 instanceof type)) {\n      throw new exception('Specified list of YAML types (or a single Type object) contains a non-Type object.');\n    }\n\n    if (type$1.loadKind && type$1.loadKind !== 'scalar') {\n      throw new exception('There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.');\n    }\n\n    if (type$1.multi) {\n      throw new exception('There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.');\n    }\n  });\n\n  explicit.forEach(function (type$1) {\n    if (!(type$1 instanceof type)) {\n      throw new exception('Specified list of YAML types (or a single Type object) contains a non-Type object.');\n    }\n  });\n\n  var result = Object.create(Schema$1.prototype);\n\n  result.implicit = (this.implicit || []).concat(implicit);\n  result.explicit = (this.explicit || []).concat(explicit);\n\n  result.compiledImplicit = compileList(result, 'implicit');\n  result.compiledExplicit = compileList(result, 'explicit');\n  result.compiledTypeMap  = compileMap(result.compiledImplicit, result.compiledExplicit);\n\n  return result;\n};\n\n\nvar schema = Schema$1;\n\nvar str = new type('tag:yaml.org,2002:str', {\n  kind: 'scalar',\n  construct: function (data) { return data !== null ? data : ''; }\n});\n\nvar seq = new type('tag:yaml.org,2002:seq', {\n  kind: 'sequence',\n  construct: function (data) { return data !== null ? data : []; }\n});\n\nvar map = new type('tag:yaml.org,2002:map', {\n  kind: 'mapping',\n  construct: function (data) { return data !== null ? data : {}; }\n});\n\nvar failsafe = new schema({\n  explicit: [\n    str,\n    seq,\n    map\n  ]\n});\n\nfunction resolveYamlNull(data) {\n  if (data === null) return true;\n\n  var max = data.length;\n\n  return (max === 1 && data === '~') ||\n         (max === 4 && (data === 'null' || data === 'Null' || data === 'NULL'));\n}\n\nfunction constructYamlNull() {\n  return null;\n}\n\nfunction isNull(object) {\n  return object === null;\n}\n\nvar _null = new type('tag:yaml.org,2002:null', {\n  kind: 'scalar',\n  resolve: resolveYamlNull,\n  construct: constructYamlNull,\n  predicate: isNull,\n  represent: {\n    canonical: function () { return '~';    },\n    lowercase: function () { return 'null'; },\n    uppercase: function () { return 'NULL'; },\n    camelcase: function () { return 'Null'; },\n    empty:     function () { return '';     }\n  },\n  defaultStyle: 'lowercase'\n});\n\nfunction resolveYamlBoolean(data) {\n  if (data === null) return false;\n\n  var max = data.length;\n\n  return (max === 4 && (data === 'true' || data === 'True' || data === 'TRUE')) ||\n         (max === 5 && (data === 'false' || data === 'False' || data === 'FALSE'));\n}\n\nfunction constructYamlBoolean(data) {\n  return data === 'true' ||\n         data === 'True' ||\n         data === 'TRUE';\n}\n\nfunction isBoolean(object) {\n  return Object.prototype.toString.call(object) === '[object Boolean]';\n}\n\nvar bool = new type('tag:yaml.org,2002:bool', {\n  kind: 'scalar',\n  resolve: resolveYamlBoolean,\n  construct: constructYamlBoolean,\n  predicate: isBoolean,\n  represent: {\n    lowercase: function (object) { return object ? 'true' : 'false'; },\n    uppercase: function (object) { return object ? 'TRUE' : 'FALSE'; },\n    camelcase: function (object) { return object ? 'True' : 'False'; }\n  },\n  defaultStyle: 'lowercase'\n});\n\nfunction isHexCode(c) {\n  return ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */)) ||\n         ((0x41/* A */ <= c) && (c <= 0x46/* F */)) ||\n         ((0x61/* a */ <= c) && (c <= 0x66/* f */));\n}\n\nfunction isOctCode(c) {\n  return ((0x30/* 0 */ <= c) && (c <= 0x37/* 7 */));\n}\n\nfunction isDecCode(c) {\n  return ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */));\n}\n\nfunction resolveYamlInteger(data) {\n  if (data === null) return false;\n\n  var max = data.length,\n      index = 0,\n      hasDigits = false,\n      ch;\n\n  if (!max) return false;\n\n  ch = data[index];\n\n  // sign\n  if (ch === '-' || ch === '+') {\n    ch = data[++index];\n  }\n\n  if (ch === '0') {\n    // 0\n    if (index + 1 === max) return true;\n    ch = data[++index];\n\n    // base 2, base 8, base 16\n\n    if (ch === 'b') {\n      // base 2\n      index++;\n\n      for (; index < max; index++) {\n        ch = data[index];\n        if (ch === '_') continue;\n        if (ch !== '0' && ch !== '1') return false;\n        hasDigits = true;\n      }\n      return hasDigits && ch !== '_';\n    }\n\n\n    if (ch === 'x') {\n      // base 16\n      index++;\n\n      for (; index < max; index++) {\n        ch = data[index];\n        if (ch === '_') continue;\n        if (!isHexCode(data.charCodeAt(index))) return false;\n        hasDigits = true;\n      }\n      return hasDigits && ch !== '_';\n    }\n\n\n    if (ch === 'o') {\n      // base 8\n      index++;\n\n      for (; index < max; index++) {\n        ch = data[index];\n        if (ch === '_') continue;\n        if (!isOctCode(data.charCodeAt(index))) return false;\n        hasDigits = true;\n      }\n      return hasDigits && ch !== '_';\n    }\n  }\n\n  // base 10 (except 0)\n\n  // value should not start with `_`;\n  if (ch === '_') return false;\n\n  for (; index < max; index++) {\n    ch = data[index];\n    if (ch === '_') continue;\n    if (!isDecCode(data.charCodeAt(index))) {\n      return false;\n    }\n    hasDigits = true;\n  }\n\n  // Should have digits and should not end with `_`\n  if (!hasDigits || ch === '_') return false;\n\n  return true;\n}\n\nfunction constructYamlInteger(data) {\n  var value = data, sign = 1, ch;\n\n  if (value.indexOf('_') !== -1) {\n    value = value.replace(/_/g, '');\n  }\n\n  ch = value[0];\n\n  if (ch === '-' || ch === '+') {\n    if (ch === '-') sign = -1;\n    value = value.slice(1);\n    ch = value[0];\n  }\n\n  if (value === '0') return 0;\n\n  if (ch === '0') {\n    if (value[1] === 'b') return sign * parseInt(value.slice(2), 2);\n    if (value[1] === 'x') return sign * parseInt(value.slice(2), 16);\n    if (value[1] === 'o') return sign * parseInt(value.slice(2), 8);\n  }\n\n  return sign * parseInt(value, 10);\n}\n\nfunction isInteger(object) {\n  return (Object.prototype.toString.call(object)) === '[object Number]' &&\n         (object % 1 === 0 && !common.isNegativeZero(object));\n}\n\nvar int = new type('tag:yaml.org,2002:int', {\n  kind: 'scalar',\n  resolve: resolveYamlInteger,\n  construct: constructYamlInteger,\n  predicate: isInteger,\n  represent: {\n    binary:      function (obj) { return obj >= 0 ? '0b' + obj.toString(2) : '-0b' + obj.toString(2).slice(1); },\n    octal:       function (obj) { return obj >= 0 ? '0o'  + obj.toString(8) : '-0o'  + obj.toString(8).slice(1); },\n    decimal:     function (obj) { return obj.toString(10); },\n    /* eslint-disable max-len */\n    hexadecimal: function (obj) { return obj >= 0 ? '0x' + obj.toString(16).toUpperCase() :  '-0x' + obj.toString(16).toUpperCase().slice(1); }\n  },\n  defaultStyle: 'decimal',\n  styleAliases: {\n    binary:      [ 2,  'bin' ],\n    octal:       [ 8,  'oct' ],\n    decimal:     [ 10, 'dec' ],\n    hexadecimal: [ 16, 'hex' ]\n  }\n});\n\nvar YAML_FLOAT_PATTERN = new RegExp(\n  // 2.5e4, 2.5 and integers\n  '^(?:[-+]?(?:[0-9][0-9_]*)(?:\\\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?' +\n  // .2e4, .2\n  // special case, seems not from spec\n  '|\\\\.[0-9_]+(?:[eE][-+]?[0-9]+)?' +\n  // .inf\n  '|[-+]?\\\\.(?:inf|Inf|INF)' +\n  // .nan\n  '|\\\\.(?:nan|NaN|NAN))$');\n\nfunction resolveYamlFloat(data) {\n  if (data === null) return false;\n\n  if (!YAML_FLOAT_PATTERN.test(data) ||\n      // Quick hack to not allow integers end with `_`\n      // Probably should update regexp & check speed\n      data[data.length - 1] === '_') {\n    return false;\n  }\n\n  return true;\n}\n\nfunction constructYamlFloat(data) {\n  var value, sign;\n\n  value  = data.replace(/_/g, '').toLowerCase();\n  sign   = value[0] === '-' ? -1 : 1;\n\n  if ('+-'.indexOf(value[0]) >= 0) {\n    value = value.slice(1);\n  }\n\n  if (value === '.inf') {\n    return (sign === 1) ? Number.POSITIVE_INFINITY : Number.NEGATIVE_INFINITY;\n\n  } else if (value === '.nan') {\n    return NaN;\n  }\n  return sign * parseFloat(value, 10);\n}\n\n\nvar SCIENTIFIC_WITHOUT_DOT = /^[-+]?[0-9]+e/;\n\nfunction representYamlFloat(object, style) {\n  var res;\n\n  if (isNaN(object)) {\n    switch (style) {\n      case 'lowercase': return '.nan';\n      case 'uppercase': return '.NAN';\n      case 'camelcase': return '.NaN';\n    }\n  } else if (Number.POSITIVE_INFINITY === object) {\n    switch (style) {\n      case 'lowercase': return '.inf';\n      case 'uppercase': return '.INF';\n      case 'camelcase': return '.Inf';\n    }\n  } else if (Number.NEGATIVE_INFINITY === object) {\n    switch (style) {\n      case 'lowercase': return '-.inf';\n      case 'uppercase': return '-.INF';\n      case 'camelcase': return '-.Inf';\n    }\n  } else if (common.isNegativeZero(object)) {\n    return '-0.0';\n  }\n\n  res = object.toString(10);\n\n  // JS stringifier can build scientific format without dots: 5e-100,\n  // while YAML requres dot: 5.e-100. Fix it with simple hack\n\n  return SCIENTIFIC_WITHOUT_DOT.test(res) ? res.replace('e', '.e') : res;\n}\n\nfunction isFloat(object) {\n  return (Object.prototype.toString.call(object) === '[object Number]') &&\n         (object % 1 !== 0 || common.isNegativeZero(object));\n}\n\nvar float = new type('tag:yaml.org,2002:float', {\n  kind: 'scalar',\n  resolve: resolveYamlFloat,\n  construct: constructYamlFloat,\n  predicate: isFloat,\n  represent: representYamlFloat,\n  defaultStyle: 'lowercase'\n});\n\nvar json = failsafe.extend({\n  implicit: [\n    _null,\n    bool,\n    int,\n    float\n  ]\n});\n\nvar core = json;\n\nvar YAML_DATE_REGEXP = new RegExp(\n  '^([0-9][0-9][0-9][0-9])'          + // [1] year\n  '-([0-9][0-9])'                    + // [2] month\n  '-([0-9][0-9])$');                   // [3] day\n\nvar YAML_TIMESTAMP_REGEXP = new RegExp(\n  '^([0-9][0-9][0-9][0-9])'          + // [1] year\n  '-([0-9][0-9]?)'                   + // [2] month\n  '-([0-9][0-9]?)'                   + // [3] day\n  '(?:[Tt]|[ \\\\t]+)'                 + // ...\n  '([0-9][0-9]?)'                    + // [4] hour\n  ':([0-9][0-9])'                    + // [5] minute\n  ':([0-9][0-9])'                    + // [6] second\n  '(?:\\\\.([0-9]*))?'                 + // [7] fraction\n  '(?:[ \\\\t]*(Z|([-+])([0-9][0-9]?)' + // [8] tz [9] tz_sign [10] tz_hour\n  '(?::([0-9][0-9]))?))?$');           // [11] tz_minute\n\nfunction resolveYamlTimestamp(data) {\n  if (data === null) return false;\n  if (YAML_DATE_REGEXP.exec(data) !== null) return true;\n  if (YAML_TIMESTAMP_REGEXP.exec(data) !== null) return true;\n  return false;\n}\n\nfunction constructYamlTimestamp(data) {\n  var match, year, month, day, hour, minute, second, fraction = 0,\n      delta = null, tz_hour, tz_minute, date;\n\n  match = YAML_DATE_REGEXP.exec(data);\n  if (match === null) match = YAML_TIMESTAMP_REGEXP.exec(data);\n\n  if (match === null) throw new Error('Date resolve error');\n\n  // match: [1] year [2] month [3] day\n\n  year = +(match[1]);\n  month = +(match[2]) - 1; // JS month starts with 0\n  day = +(match[3]);\n\n  if (!match[4]) { // no hour\n    return new Date(Date.UTC(year, month, day));\n  }\n\n  // match: [4] hour [5] minute [6] second [7] fraction\n\n  hour = +(match[4]);\n  minute = +(match[5]);\n  second = +(match[6]);\n\n  if (match[7]) {\n    fraction = match[7].slice(0, 3);\n    while (fraction.length < 3) { // milli-seconds\n      fraction += '0';\n    }\n    fraction = +fraction;\n  }\n\n  // match: [8] tz [9] tz_sign [10] tz_hour [11] tz_minute\n\n  if (match[9]) {\n    tz_hour = +(match[10]);\n    tz_minute = +(match[11] || 0);\n    delta = (tz_hour * 60 + tz_minute) * 60000; // delta in mili-seconds\n    if (match[9] === '-') delta = -delta;\n  }\n\n  date = new Date(Date.UTC(year, month, day, hour, minute, second, fraction));\n\n  if (delta) date.setTime(date.getTime() - delta);\n\n  return date;\n}\n\nfunction representYamlTimestamp(object /*, style*/) {\n  return object.toISOString();\n}\n\nvar timestamp = new type('tag:yaml.org,2002:timestamp', {\n  kind: 'scalar',\n  resolve: resolveYamlTimestamp,\n  construct: constructYamlTimestamp,\n  instanceOf: Date,\n  represent: representYamlTimestamp\n});\n\nfunction resolveYamlMerge(data) {\n  return data === '<<' || data === null;\n}\n\nvar merge = new type('tag:yaml.org,2002:merge', {\n  kind: 'scalar',\n  resolve: resolveYamlMerge\n});\n\n/*eslint-disable no-bitwise*/\n\n\n\n\n\n// [ 64, 65, 66 ] -> [ padding, CR, LF ]\nvar BASE64_MAP = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\\n\\r';\n\n\nfunction resolveYamlBinary(data) {\n  if (data === null) return false;\n\n  var code, idx, bitlen = 0, max = data.length, map = BASE64_MAP;\n\n  // Convert one by one.\n  for (idx = 0; idx < max; idx++) {\n    code = map.indexOf(data.charAt(idx));\n\n    // Skip CR/LF\n    if (code > 64) continue;\n\n    // Fail on illegal characters\n    if (code < 0) return false;\n\n    bitlen += 6;\n  }\n\n  // If there are any bits left, source was corrupted\n  return (bitlen % 8) === 0;\n}\n\nfunction constructYamlBinary(data) {\n  var idx, tailbits,\n      input = data.replace(/[\\r\\n=]/g, ''), // remove CR/LF & padding to simplify scan\n      max = input.length,\n      map = BASE64_MAP,\n      bits = 0,\n      result = [];\n\n  // Collect by 6*4 bits (3 bytes)\n\n  for (idx = 0; idx < max; idx++) {\n    if ((idx % 4 === 0) && idx) {\n      result.push((bits >> 16) & 0xFF);\n      result.push((bits >> 8) & 0xFF);\n      result.push(bits & 0xFF);\n    }\n\n    bits = (bits << 6) | map.indexOf(input.charAt(idx));\n  }\n\n  // Dump tail\n\n  tailbits = (max % 4) * 6;\n\n  if (tailbits === 0) {\n    result.push((bits >> 16) & 0xFF);\n    result.push((bits >> 8) & 0xFF);\n    result.push(bits & 0xFF);\n  } else if (tailbits === 18) {\n    result.push((bits >> 10) & 0xFF);\n    result.push((bits >> 2) & 0xFF);\n  } else if (tailbits === 12) {\n    result.push((bits >> 4) & 0xFF);\n  }\n\n  return new Uint8Array(result);\n}\n\nfunction representYamlBinary(object /*, style*/) {\n  var result = '', bits = 0, idx, tail,\n      max = object.length,\n      map = BASE64_MAP;\n\n  // Convert every three bytes to 4 ASCII characters.\n\n  for (idx = 0; idx < max; idx++) {\n    if ((idx % 3 === 0) && idx) {\n      result += map[(bits >> 18) & 0x3F];\n      result += map[(bits >> 12) & 0x3F];\n      result += map[(bits >> 6) & 0x3F];\n      result += map[bits & 0x3F];\n    }\n\n    bits = (bits << 8) + object[idx];\n  }\n\n  // Dump tail\n\n  tail = max % 3;\n\n  if (tail === 0) {\n    result += map[(bits >> 18) & 0x3F];\n    result += map[(bits >> 12) & 0x3F];\n    result += map[(bits >> 6) & 0x3F];\n    result += map[bits & 0x3F];\n  } else if (tail === 2) {\n    result += map[(bits >> 10) & 0x3F];\n    result += map[(bits >> 4) & 0x3F];\n    result += map[(bits << 2) & 0x3F];\n    result += map[64];\n  } else if (tail === 1) {\n    result += map[(bits >> 2) & 0x3F];\n    result += map[(bits << 4) & 0x3F];\n    result += map[64];\n    result += map[64];\n  }\n\n  return result;\n}\n\nfunction isBinary(obj) {\n  return Object.prototype.toString.call(obj) ===  '[object Uint8Array]';\n}\n\nvar binary = new type('tag:yaml.org,2002:binary', {\n  kind: 'scalar',\n  resolve: resolveYamlBinary,\n  construct: constructYamlBinary,\n  predicate: isBinary,\n  represent: representYamlBinary\n});\n\nvar _hasOwnProperty$3 = Object.prototype.hasOwnProperty;\nvar _toString$2       = Object.prototype.toString;\n\nfunction resolveYamlOmap(data) {\n  if (data === null) return true;\n\n  var objectKeys = [], index, length, pair, pairKey, pairHasKey,\n      object = data;\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    pair = object[index];\n    pairHasKey = false;\n\n    if (_toString$2.call(pair) !== '[object Object]') return false;\n\n    for (pairKey in pair) {\n      if (_hasOwnProperty$3.call(pair, pairKey)) {\n        if (!pairHasKey) pairHasKey = true;\n        else return false;\n      }\n    }\n\n    if (!pairHasKey) return false;\n\n    if (objectKeys.indexOf(pairKey) === -1) objectKeys.push(pairKey);\n    else return false;\n  }\n\n  return true;\n}\n\nfunction constructYamlOmap(data) {\n  return data !== null ? data : [];\n}\n\nvar omap = new type('tag:yaml.org,2002:omap', {\n  kind: 'sequence',\n  resolve: resolveYamlOmap,\n  construct: constructYamlOmap\n});\n\nvar _toString$1 = Object.prototype.toString;\n\nfunction resolveYamlPairs(data) {\n  if (data === null) return true;\n\n  var index, length, pair, keys, result,\n      object = data;\n\n  result = new Array(object.length);\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    pair = object[index];\n\n    if (_toString$1.call(pair) !== '[object Object]') return false;\n\n    keys = Object.keys(pair);\n\n    if (keys.length !== 1) return false;\n\n    result[index] = [ keys[0], pair[keys[0]] ];\n  }\n\n  return true;\n}\n\nfunction constructYamlPairs(data) {\n  if (data === null) return [];\n\n  var index, length, pair, keys, result,\n      object = data;\n\n  result = new Array(object.length);\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    pair = object[index];\n\n    keys = Object.keys(pair);\n\n    result[index] = [ keys[0], pair[keys[0]] ];\n  }\n\n  return result;\n}\n\nvar pairs = new type('tag:yaml.org,2002:pairs', {\n  kind: 'sequence',\n  resolve: resolveYamlPairs,\n  construct: constructYamlPairs\n});\n\nvar _hasOwnProperty$2 = Object.prototype.hasOwnProperty;\n\nfunction resolveYamlSet(data) {\n  if (data === null) return true;\n\n  var key, object = data;\n\n  for (key in object) {\n    if (_hasOwnProperty$2.call(object, key)) {\n      if (object[key] !== null) return false;\n    }\n  }\n\n  return true;\n}\n\nfunction constructYamlSet(data) {\n  return data !== null ? data : {};\n}\n\nvar set = new type('tag:yaml.org,2002:set', {\n  kind: 'mapping',\n  resolve: resolveYamlSet,\n  construct: constructYamlSet\n});\n\nvar _default = core.extend({\n  implicit: [\n    timestamp,\n    merge\n  ],\n  explicit: [\n    binary,\n    omap,\n    pairs,\n    set\n  ]\n});\n\n/*eslint-disable max-len,no-use-before-define*/\n\n\n\n\n\n\n\nvar _hasOwnProperty$1 = Object.prototype.hasOwnProperty;\n\n\nvar CONTEXT_FLOW_IN   = 1;\nvar CONTEXT_FLOW_OUT  = 2;\nvar CONTEXT_BLOCK_IN  = 3;\nvar CONTEXT_BLOCK_OUT = 4;\n\n\nvar CHOMPING_CLIP  = 1;\nvar CHOMPING_STRIP = 2;\nvar CHOMPING_KEEP  = 3;\n\n\nvar PATTERN_NON_PRINTABLE         = /[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7F-\\x84\\x86-\\x9F\\uFFFE\\uFFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF]/;\nvar PATTERN_NON_ASCII_LINE_BREAKS = /[\\x85\\u2028\\u2029]/;\nvar PATTERN_FLOW_INDICATORS       = /[,\\[\\]\\{\\}]/;\nvar PATTERN_TAG_HANDLE            = /^(?:!|!!|![a-z\\-]+!)$/i;\nvar PATTERN_TAG_URI               = /^(?:!|[^,\\[\\]\\{\\}])(?:%[0-9a-f]{2}|[0-9a-z\\-#;\\/\\?:@&=\\+\\$,_\\.!~\\*'\\(\\)\\[\\]])*$/i;\n\n\nfunction _class(obj) { return Object.prototype.toString.call(obj); }\n\nfunction is_EOL(c) {\n  return (c === 0x0A/* LF */) || (c === 0x0D/* CR */);\n}\n\nfunction is_WHITE_SPACE(c) {\n  return (c === 0x09/* Tab */) || (c === 0x20/* Space */);\n}\n\nfunction is_WS_OR_EOL(c) {\n  return (c === 0x09/* Tab */) ||\n         (c === 0x20/* Space */) ||\n         (c === 0x0A/* LF */) ||\n         (c === 0x0D/* CR */);\n}\n\nfunction is_FLOW_INDICATOR(c) {\n  return c === 0x2C/* , */ ||\n         c === 0x5B/* [ */ ||\n         c === 0x5D/* ] */ ||\n         c === 0x7B/* { */ ||\n         c === 0x7D/* } */;\n}\n\nfunction fromHexCode(c) {\n  var lc;\n\n  if ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */)) {\n    return c - 0x30;\n  }\n\n  /*eslint-disable no-bitwise*/\n  lc = c | 0x20;\n\n  if ((0x61/* a */ <= lc) && (lc <= 0x66/* f */)) {\n    return lc - 0x61 + 10;\n  }\n\n  return -1;\n}\n\nfunction escapedHexLen(c) {\n  if (c === 0x78/* x */) { return 2; }\n  if (c === 0x75/* u */) { return 4; }\n  if (c === 0x55/* U */) { return 8; }\n  return 0;\n}\n\nfunction fromDecimalCode(c) {\n  if ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */)) {\n    return c - 0x30;\n  }\n\n  return -1;\n}\n\nfunction simpleEscapeSequence(c) {\n  /* eslint-disable indent */\n  return (c === 0x30/* 0 */) ? '\\x00' :\n        (c === 0x61/* a */) ? '\\x07' :\n        (c === 0x62/* b */) ? '\\x08' :\n        (c === 0x74/* t */) ? '\\x09' :\n        (c === 0x09/* Tab */) ? '\\x09' :\n        (c === 0x6E/* n */) ? '\\x0A' :\n        (c === 0x76/* v */) ? '\\x0B' :\n        (c === 0x66/* f */) ? '\\x0C' :\n        (c === 0x72/* r */) ? '\\x0D' :\n        (c === 0x65/* e */) ? '\\x1B' :\n        (c === 0x20/* Space */) ? ' ' :\n        (c === 0x22/* \" */) ? '\\x22' :\n        (c === 0x2F/* / */) ? '/' :\n        (c === 0x5C/* \\ */) ? '\\x5C' :\n        (c === 0x4E/* N */) ? '\\x85' :\n        (c === 0x5F/* _ */) ? '\\xA0' :\n        (c === 0x4C/* L */) ? '\\u2028' :\n        (c === 0x50/* P */) ? '\\u2029' : '';\n}\n\nfunction charFromCodepoint(c) {\n  if (c <= 0xFFFF) {\n    return String.fromCharCode(c);\n  }\n  // Encode UTF-16 surrogate pair\n  // https://en.wikipedia.org/wiki/UTF-16#Code_points_U.2B010000_to_U.2B10FFFF\n  return String.fromCharCode(\n    ((c - 0x010000) >> 10) + 0xD800,\n    ((c - 0x010000) & 0x03FF) + 0xDC00\n  );\n}\n\nvar simpleEscapeCheck = new Array(256); // integer, for fast access\nvar simpleEscapeMap = new Array(256);\nfor (var i = 0; i < 256; i++) {\n  simpleEscapeCheck[i] = simpleEscapeSequence(i) ? 1 : 0;\n  simpleEscapeMap[i] = simpleEscapeSequence(i);\n}\n\n\nfunction State$1(input, options) {\n  this.input = input;\n\n  this.filename  = options['filename']  || null;\n  this.schema    = options['schema']    || _default;\n  this.onWarning = options['onWarning'] || null;\n  // (Hidden) Remove? makes the loader to expect YAML 1.1 documents\n  // if such documents have no explicit %YAML directive\n  this.legacy    = options['legacy']    || false;\n\n  this.json      = options['json']      || false;\n  this.listener  = options['listener']  || null;\n\n  this.implicitTypes = this.schema.compiledImplicit;\n  this.typeMap       = this.schema.compiledTypeMap;\n\n  this.length     = input.length;\n  this.position   = 0;\n  this.line       = 0;\n  this.lineStart  = 0;\n  this.lineIndent = 0;\n\n  // position of first leading tab in the current line,\n  // used to make sure there are no tabs in the indentation\n  this.firstTabInLine = -1;\n\n  this.documents = [];\n\n  /*\n  this.version;\n  this.checkLineBreaks;\n  this.tagMap;\n  this.anchorMap;\n  this.tag;\n  this.anchor;\n  this.kind;\n  this.result;*/\n\n}\n\n\nfunction generateError(state, message) {\n  var mark = {\n    name:     state.filename,\n    buffer:   state.input.slice(0, -1), // omit trailing \\0\n    position: state.position,\n    line:     state.line,\n    column:   state.position - state.lineStart\n  };\n\n  mark.snippet = snippet(mark);\n\n  return new exception(message, mark);\n}\n\nfunction throwError(state, message) {\n  throw generateError(state, message);\n}\n\nfunction throwWarning(state, message) {\n  if (state.onWarning) {\n    state.onWarning.call(null, generateError(state, message));\n  }\n}\n\n\nvar directiveHandlers = {\n\n  YAML: function handleYamlDirective(state, name, args) {\n\n    var match, major, minor;\n\n    if (state.version !== null) {\n      throwError(state, 'duplication of %YAML directive');\n    }\n\n    if (args.length !== 1) {\n      throwError(state, 'YAML directive accepts exactly one argument');\n    }\n\n    match = /^([0-9]+)\\.([0-9]+)$/.exec(args[0]);\n\n    if (match === null) {\n      throwError(state, 'ill-formed argument of the YAML directive');\n    }\n\n    major = parseInt(match[1], 10);\n    minor = parseInt(match[2], 10);\n\n    if (major !== 1) {\n      throwError(state, 'unacceptable YAML version of the document');\n    }\n\n    state.version = args[0];\n    state.checkLineBreaks = (minor < 2);\n\n    if (minor !== 1 && minor !== 2) {\n      throwWarning(state, 'unsupported YAML version of the document');\n    }\n  },\n\n  TAG: function handleTagDirective(state, name, args) {\n\n    var handle, prefix;\n\n    if (args.length !== 2) {\n      throwError(state, 'TAG directive accepts exactly two arguments');\n    }\n\n    handle = args[0];\n    prefix = args[1];\n\n    if (!PATTERN_TAG_HANDLE.test(handle)) {\n      throwError(state, 'ill-formed tag handle (first argument) of the TAG directive');\n    }\n\n    if (_hasOwnProperty$1.call(state.tagMap, handle)) {\n      throwError(state, 'there is a previously declared suffix for \"' + handle + '\" tag handle');\n    }\n\n    if (!PATTERN_TAG_URI.test(prefix)) {\n      throwError(state, 'ill-formed tag prefix (second argument) of the TAG directive');\n    }\n\n    try {\n      prefix = decodeURIComponent(prefix);\n    } catch (err) {\n      throwError(state, 'tag prefix is malformed: ' + prefix);\n    }\n\n    state.tagMap[handle] = prefix;\n  }\n};\n\n\nfunction captureSegment(state, start, end, checkJson) {\n  var _position, _length, _character, _result;\n\n  if (start < end) {\n    _result = state.input.slice(start, end);\n\n    if (checkJson) {\n      for (_position = 0, _length = _result.length; _position < _length; _position += 1) {\n        _character = _result.charCodeAt(_position);\n        if (!(_character === 0x09 ||\n              (0x20 <= _character && _character <= 0x10FFFF))) {\n          throwError(state, 'expected valid JSON character');\n        }\n      }\n    } else if (PATTERN_NON_PRINTABLE.test(_result)) {\n      throwError(state, 'the stream contains non-printable characters');\n    }\n\n    state.result += _result;\n  }\n}\n\nfunction mergeMappings(state, destination, source, overridableKeys) {\n  var sourceKeys, key, index, quantity;\n\n  if (!common.isObject(source)) {\n    throwError(state, 'cannot merge mappings; the provided source object is unacceptable');\n  }\n\n  sourceKeys = Object.keys(source);\n\n  for (index = 0, quantity = sourceKeys.length; index < quantity; index += 1) {\n    key = sourceKeys[index];\n\n    if (!_hasOwnProperty$1.call(destination, key)) {\n      destination[key] = source[key];\n      overridableKeys[key] = true;\n    }\n  }\n}\n\nfunction storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, valueNode,\n  startLine, startLineStart, startPos) {\n\n  var index, quantity;\n\n  // The output is a plain object here, so keys can only be strings.\n  // We need to convert keyNode to a string, but doing so can hang the process\n  // (deeply nested arrays that explode exponentially using aliases).\n  if (Array.isArray(keyNode)) {\n    keyNode = Array.prototype.slice.call(keyNode);\n\n    for (index = 0, quantity = keyNode.length; index < quantity; index += 1) {\n      if (Array.isArray(keyNode[index])) {\n        throwError(state, 'nested arrays are not supported inside keys');\n      }\n\n      if (typeof keyNode === 'object' && _class(keyNode[index]) === '[object Object]') {\n        keyNode[index] = '[object Object]';\n      }\n    }\n  }\n\n  // Avoid code execution in load() via toString property\n  // (still use its own toString for arrays, timestamps,\n  // and whatever user schema extensions happen to have @@toStringTag)\n  if (typeof keyNode === 'object' && _class(keyNode) === '[object Object]') {\n    keyNode = '[object Object]';\n  }\n\n\n  keyNode = String(keyNode);\n\n  if (_result === null) {\n    _result = {};\n  }\n\n  if (keyTag === 'tag:yaml.org,2002:merge') {\n    if (Array.isArray(valueNode)) {\n      for (index = 0, quantity = valueNode.length; index < quantity; index += 1) {\n        mergeMappings(state, _result, valueNode[index], overridableKeys);\n      }\n    } else {\n      mergeMappings(state, _result, valueNode, overridableKeys);\n    }\n  } else {\n    if (!state.json &&\n        !_hasOwnProperty$1.call(overridableKeys, keyNode) &&\n        _hasOwnProperty$1.call(_result, keyNode)) {\n      state.line = startLine || state.line;\n      state.lineStart = startLineStart || state.lineStart;\n      state.position = startPos || state.position;\n      throwError(state, 'duplicated mapping key');\n    }\n\n    // used for this specific key only because Object.defineProperty is slow\n    if (keyNode === '__proto__') {\n      Object.defineProperty(_result, keyNode, {\n        configurable: true,\n        enumerable: true,\n        writable: true,\n        value: valueNode\n      });\n    } else {\n      _result[keyNode] = valueNode;\n    }\n    delete overridableKeys[keyNode];\n  }\n\n  return _result;\n}\n\nfunction readLineBreak(state) {\n  var ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch === 0x0A/* LF */) {\n    state.position++;\n  } else if (ch === 0x0D/* CR */) {\n    state.position++;\n    if (state.input.charCodeAt(state.position) === 0x0A/* LF */) {\n      state.position++;\n    }\n  } else {\n    throwError(state, 'a line break is expected');\n  }\n\n  state.line += 1;\n  state.lineStart = state.position;\n  state.firstTabInLine = -1;\n}\n\nfunction skipSeparationSpace(state, allowComments, checkIndent) {\n  var lineBreaks = 0,\n      ch = state.input.charCodeAt(state.position);\n\n  while (ch !== 0) {\n    while (is_WHITE_SPACE(ch)) {\n      if (ch === 0x09/* Tab */ && state.firstTabInLine === -1) {\n        state.firstTabInLine = state.position;\n      }\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    if (allowComments && ch === 0x23/* # */) {\n      do {\n        ch = state.input.charCodeAt(++state.position);\n      } while (ch !== 0x0A/* LF */ && ch !== 0x0D/* CR */ && ch !== 0);\n    }\n\n    if (is_EOL(ch)) {\n      readLineBreak(state);\n\n      ch = state.input.charCodeAt(state.position);\n      lineBreaks++;\n      state.lineIndent = 0;\n\n      while (ch === 0x20/* Space */) {\n        state.lineIndent++;\n        ch = state.input.charCodeAt(++state.position);\n      }\n    } else {\n      break;\n    }\n  }\n\n  if (checkIndent !== -1 && lineBreaks !== 0 && state.lineIndent < checkIndent) {\n    throwWarning(state, 'deficient indentation');\n  }\n\n  return lineBreaks;\n}\n\nfunction testDocumentSeparator(state) {\n  var _position = state.position,\n      ch;\n\n  ch = state.input.charCodeAt(_position);\n\n  // Condition state.position === state.lineStart is tested\n  // in parent on each call, for efficiency. No needs to test here again.\n  if ((ch === 0x2D/* - */ || ch === 0x2E/* . */) &&\n      ch === state.input.charCodeAt(_position + 1) &&\n      ch === state.input.charCodeAt(_position + 2)) {\n\n    _position += 3;\n\n    ch = state.input.charCodeAt(_position);\n\n    if (ch === 0 || is_WS_OR_EOL(ch)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction writeFoldedLines(state, count) {\n  if (count === 1) {\n    state.result += ' ';\n  } else if (count > 1) {\n    state.result += common.repeat('\\n', count - 1);\n  }\n}\n\n\nfunction readPlainScalar(state, nodeIndent, withinFlowCollection) {\n  var preceding,\n      following,\n      captureStart,\n      captureEnd,\n      hasPendingContent,\n      _line,\n      _lineStart,\n      _lineIndent,\n      _kind = state.kind,\n      _result = state.result,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (is_WS_OR_EOL(ch)      ||\n      is_FLOW_INDICATOR(ch) ||\n      ch === 0x23/* # */    ||\n      ch === 0x26/* & */    ||\n      ch === 0x2A/* * */    ||\n      ch === 0x21/* ! */    ||\n      ch === 0x7C/* | */    ||\n      ch === 0x3E/* > */    ||\n      ch === 0x27/* ' */    ||\n      ch === 0x22/* \" */    ||\n      ch === 0x25/* % */    ||\n      ch === 0x40/* @ */    ||\n      ch === 0x60/* ` */) {\n    return false;\n  }\n\n  if (ch === 0x3F/* ? */ || ch === 0x2D/* - */) {\n    following = state.input.charCodeAt(state.position + 1);\n\n    if (is_WS_OR_EOL(following) ||\n        withinFlowCollection && is_FLOW_INDICATOR(following)) {\n      return false;\n    }\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n  captureStart = captureEnd = state.position;\n  hasPendingContent = false;\n\n  while (ch !== 0) {\n    if (ch === 0x3A/* : */) {\n      following = state.input.charCodeAt(state.position + 1);\n\n      if (is_WS_OR_EOL(following) ||\n          withinFlowCollection && is_FLOW_INDICATOR(following)) {\n        break;\n      }\n\n    } else if (ch === 0x23/* # */) {\n      preceding = state.input.charCodeAt(state.position - 1);\n\n      if (is_WS_OR_EOL(preceding)) {\n        break;\n      }\n\n    } else if ((state.position === state.lineStart && testDocumentSeparator(state)) ||\n               withinFlowCollection && is_FLOW_INDICATOR(ch)) {\n      break;\n\n    } else if (is_EOL(ch)) {\n      _line = state.line;\n      _lineStart = state.lineStart;\n      _lineIndent = state.lineIndent;\n      skipSeparationSpace(state, false, -1);\n\n      if (state.lineIndent >= nodeIndent) {\n        hasPendingContent = true;\n        ch = state.input.charCodeAt(state.position);\n        continue;\n      } else {\n        state.position = captureEnd;\n        state.line = _line;\n        state.lineStart = _lineStart;\n        state.lineIndent = _lineIndent;\n        break;\n      }\n    }\n\n    if (hasPendingContent) {\n      captureSegment(state, captureStart, captureEnd, false);\n      writeFoldedLines(state, state.line - _line);\n      captureStart = captureEnd = state.position;\n      hasPendingContent = false;\n    }\n\n    if (!is_WHITE_SPACE(ch)) {\n      captureEnd = state.position + 1;\n    }\n\n    ch = state.input.charCodeAt(++state.position);\n  }\n\n  captureSegment(state, captureStart, captureEnd, false);\n\n  if (state.result) {\n    return true;\n  }\n\n  state.kind = _kind;\n  state.result = _result;\n  return false;\n}\n\nfunction readSingleQuotedScalar(state, nodeIndent) {\n  var ch,\n      captureStart, captureEnd;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x27/* ' */) {\n    return false;\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n  state.position++;\n  captureStart = captureEnd = state.position;\n\n  while ((ch = state.input.charCodeAt(state.position)) !== 0) {\n    if (ch === 0x27/* ' */) {\n      captureSegment(state, captureStart, state.position, true);\n      ch = state.input.charCodeAt(++state.position);\n\n      if (ch === 0x27/* ' */) {\n        captureStart = state.position;\n        state.position++;\n        captureEnd = state.position;\n      } else {\n        return true;\n      }\n\n    } else if (is_EOL(ch)) {\n      captureSegment(state, captureStart, captureEnd, true);\n      writeFoldedLines(state, skipSeparationSpace(state, false, nodeIndent));\n      captureStart = captureEnd = state.position;\n\n    } else if (state.position === state.lineStart && testDocumentSeparator(state)) {\n      throwError(state, 'unexpected end of the document within a single quoted scalar');\n\n    } else {\n      state.position++;\n      captureEnd = state.position;\n    }\n  }\n\n  throwError(state, 'unexpected end of the stream within a single quoted scalar');\n}\n\nfunction readDoubleQuotedScalar(state, nodeIndent) {\n  var captureStart,\n      captureEnd,\n      hexLength,\n      hexResult,\n      tmp,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x22/* \" */) {\n    return false;\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n  state.position++;\n  captureStart = captureEnd = state.position;\n\n  while ((ch = state.input.charCodeAt(state.position)) !== 0) {\n    if (ch === 0x22/* \" */) {\n      captureSegment(state, captureStart, state.position, true);\n      state.position++;\n      return true;\n\n    } else if (ch === 0x5C/* \\ */) {\n      captureSegment(state, captureStart, state.position, true);\n      ch = state.input.charCodeAt(++state.position);\n\n      if (is_EOL(ch)) {\n        skipSeparationSpace(state, false, nodeIndent);\n\n        // TODO: rework to inline fn with no type cast?\n      } else if (ch < 256 && simpleEscapeCheck[ch]) {\n        state.result += simpleEscapeMap[ch];\n        state.position++;\n\n      } else if ((tmp = escapedHexLen(ch)) > 0) {\n        hexLength = tmp;\n        hexResult = 0;\n\n        for (; hexLength > 0; hexLength--) {\n          ch = state.input.charCodeAt(++state.position);\n\n          if ((tmp = fromHexCode(ch)) >= 0) {\n            hexResult = (hexResult << 4) + tmp;\n\n          } else {\n            throwError(state, 'expected hexadecimal character');\n          }\n        }\n\n        state.result += charFromCodepoint(hexResult);\n\n        state.position++;\n\n      } else {\n        throwError(state, 'unknown escape sequence');\n      }\n\n      captureStart = captureEnd = state.position;\n\n    } else if (is_EOL(ch)) {\n      captureSegment(state, captureStart, captureEnd, true);\n      writeFoldedLines(state, skipSeparationSpace(state, false, nodeIndent));\n      captureStart = captureEnd = state.position;\n\n    } else if (state.position === state.lineStart && testDocumentSeparator(state)) {\n      throwError(state, 'unexpected end of the document within a double quoted scalar');\n\n    } else {\n      state.position++;\n      captureEnd = state.position;\n    }\n  }\n\n  throwError(state, 'unexpected end of the stream within a double quoted scalar');\n}\n\nfunction readFlowCollection(state, nodeIndent) {\n  var readNext = true,\n      _line,\n      _lineStart,\n      _pos,\n      _tag     = state.tag,\n      _result,\n      _anchor  = state.anchor,\n      following,\n      terminator,\n      isPair,\n      isExplicitPair,\n      isMapping,\n      overridableKeys = Object.create(null),\n      keyNode,\n      keyTag,\n      valueNode,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch === 0x5B/* [ */) {\n    terminator = 0x5D;/* ] */\n    isMapping = false;\n    _result = [];\n  } else if (ch === 0x7B/* { */) {\n    terminator = 0x7D;/* } */\n    isMapping = true;\n    _result = {};\n  } else {\n    return false;\n  }\n\n  if (state.anchor !== null) {\n    state.anchorMap[state.anchor] = _result;\n  }\n\n  ch = state.input.charCodeAt(++state.position);\n\n  while (ch !== 0) {\n    skipSeparationSpace(state, true, nodeIndent);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if (ch === terminator) {\n      state.position++;\n      state.tag = _tag;\n      state.anchor = _anchor;\n      state.kind = isMapping ? 'mapping' : 'sequence';\n      state.result = _result;\n      return true;\n    } else if (!readNext) {\n      throwError(state, 'missed comma between flow collection entries');\n    } else if (ch === 0x2C/* , */) {\n      // \"flow collection entries can never be completely empty\", as per YAML 1.2, section 7.4\n      throwError(state, \"expected the node content, but found ','\");\n    }\n\n    keyTag = keyNode = valueNode = null;\n    isPair = isExplicitPair = false;\n\n    if (ch === 0x3F/* ? */) {\n      following = state.input.charCodeAt(state.position + 1);\n\n      if (is_WS_OR_EOL(following)) {\n        isPair = isExplicitPair = true;\n        state.position++;\n        skipSeparationSpace(state, true, nodeIndent);\n      }\n    }\n\n    _line = state.line; // Save the current line.\n    _lineStart = state.lineStart;\n    _pos = state.position;\n    composeNode(state, nodeIndent, CONTEXT_FLOW_IN, false, true);\n    keyTag = state.tag;\n    keyNode = state.result;\n    skipSeparationSpace(state, true, nodeIndent);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if ((isExplicitPair || state.line === _line) && ch === 0x3A/* : */) {\n      isPair = true;\n      ch = state.input.charCodeAt(++state.position);\n      skipSeparationSpace(state, true, nodeIndent);\n      composeNode(state, nodeIndent, CONTEXT_FLOW_IN, false, true);\n      valueNode = state.result;\n    }\n\n    if (isMapping) {\n      storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, valueNode, _line, _lineStart, _pos);\n    } else if (isPair) {\n      _result.push(storeMappingPair(state, null, overridableKeys, keyTag, keyNode, valueNode, _line, _lineStart, _pos));\n    } else {\n      _result.push(keyNode);\n    }\n\n    skipSeparationSpace(state, true, nodeIndent);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if (ch === 0x2C/* , */) {\n      readNext = true;\n      ch = state.input.charCodeAt(++state.position);\n    } else {\n      readNext = false;\n    }\n  }\n\n  throwError(state, 'unexpected end of the stream within a flow collection');\n}\n\nfunction readBlockScalar(state, nodeIndent) {\n  var captureStart,\n      folding,\n      chomping       = CHOMPING_CLIP,\n      didReadContent = false,\n      detectedIndent = false,\n      textIndent     = nodeIndent,\n      emptyLines     = 0,\n      atMoreIndented = false,\n      tmp,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch === 0x7C/* | */) {\n    folding = false;\n  } else if (ch === 0x3E/* > */) {\n    folding = true;\n  } else {\n    return false;\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n\n  while (ch !== 0) {\n    ch = state.input.charCodeAt(++state.position);\n\n    if (ch === 0x2B/* + */ || ch === 0x2D/* - */) {\n      if (CHOMPING_CLIP === chomping) {\n        chomping = (ch === 0x2B/* + */) ? CHOMPING_KEEP : CHOMPING_STRIP;\n      } else {\n        throwError(state, 'repeat of a chomping mode identifier');\n      }\n\n    } else if ((tmp = fromDecimalCode(ch)) >= 0) {\n      if (tmp === 0) {\n        throwError(state, 'bad explicit indentation width of a block scalar; it cannot be less than one');\n      } else if (!detectedIndent) {\n        textIndent = nodeIndent + tmp - 1;\n        detectedIndent = true;\n      } else {\n        throwError(state, 'repeat of an indentation width identifier');\n      }\n\n    } else {\n      break;\n    }\n  }\n\n  if (is_WHITE_SPACE(ch)) {\n    do { ch = state.input.charCodeAt(++state.position); }\n    while (is_WHITE_SPACE(ch));\n\n    if (ch === 0x23/* # */) {\n      do { ch = state.input.charCodeAt(++state.position); }\n      while (!is_EOL(ch) && (ch !== 0));\n    }\n  }\n\n  while (ch !== 0) {\n    readLineBreak(state);\n    state.lineIndent = 0;\n\n    ch = state.input.charCodeAt(state.position);\n\n    while ((!detectedIndent || state.lineIndent < textIndent) &&\n           (ch === 0x20/* Space */)) {\n      state.lineIndent++;\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    if (!detectedIndent && state.lineIndent > textIndent) {\n      textIndent = state.lineIndent;\n    }\n\n    if (is_EOL(ch)) {\n      emptyLines++;\n      continue;\n    }\n\n    // End of the scalar.\n    if (state.lineIndent < textIndent) {\n\n      // Perform the chomping.\n      if (chomping === CHOMPING_KEEP) {\n        state.result += common.repeat('\\n', didReadContent ? 1 + emptyLines : emptyLines);\n      } else if (chomping === CHOMPING_CLIP) {\n        if (didReadContent) { // i.e. only if the scalar is not empty.\n          state.result += '\\n';\n        }\n      }\n\n      // Break this `while` cycle and go to the funciton's epilogue.\n      break;\n    }\n\n    // Folded style: use fancy rules to handle line breaks.\n    if (folding) {\n\n      // Lines starting with white space characters (more-indented lines) are not folded.\n      if (is_WHITE_SPACE(ch)) {\n        atMoreIndented = true;\n        // except for the first content line (cf. Example 8.1)\n        state.result += common.repeat('\\n', didReadContent ? 1 + emptyLines : emptyLines);\n\n      // End of more-indented block.\n      } else if (atMoreIndented) {\n        atMoreIndented = false;\n        state.result += common.repeat('\\n', emptyLines + 1);\n\n      // Just one line break - perceive as the same line.\n      } else if (emptyLines === 0) {\n        if (didReadContent) { // i.e. only if we have already read some scalar content.\n          state.result += ' ';\n        }\n\n      // Several line breaks - perceive as different lines.\n      } else {\n        state.result += common.repeat('\\n', emptyLines);\n      }\n\n    // Literal style: just add exact number of line breaks between content lines.\n    } else {\n      // Keep all line breaks except the header line break.\n      state.result += common.repeat('\\n', didReadContent ? 1 + emptyLines : emptyLines);\n    }\n\n    didReadContent = true;\n    detectedIndent = true;\n    emptyLines = 0;\n    captureStart = state.position;\n\n    while (!is_EOL(ch) && (ch !== 0)) {\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    captureSegment(state, captureStart, state.position, false);\n  }\n\n  return true;\n}\n\nfunction readBlockSequence(state, nodeIndent) {\n  var _line,\n      _tag      = state.tag,\n      _anchor   = state.anchor,\n      _result   = [],\n      following,\n      detected  = false,\n      ch;\n\n  // there is a leading tab before this token, so it can't be a block sequence/mapping;\n  // it can still be flow sequence/mapping or a scalar\n  if (state.firstTabInLine !== -1) return false;\n\n  if (state.anchor !== null) {\n    state.anchorMap[state.anchor] = _result;\n  }\n\n  ch = state.input.charCodeAt(state.position);\n\n  while (ch !== 0) {\n    if (state.firstTabInLine !== -1) {\n      state.position = state.firstTabInLine;\n      throwError(state, 'tab characters must not be used in indentation');\n    }\n\n    if (ch !== 0x2D/* - */) {\n      break;\n    }\n\n    following = state.input.charCodeAt(state.position + 1);\n\n    if (!is_WS_OR_EOL(following)) {\n      break;\n    }\n\n    detected = true;\n    state.position++;\n\n    if (skipSeparationSpace(state, true, -1)) {\n      if (state.lineIndent <= nodeIndent) {\n        _result.push(null);\n        ch = state.input.charCodeAt(state.position);\n        continue;\n      }\n    }\n\n    _line = state.line;\n    composeNode(state, nodeIndent, CONTEXT_BLOCK_IN, false, true);\n    _result.push(state.result);\n    skipSeparationSpace(state, true, -1);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if ((state.line === _line || state.lineIndent > nodeIndent) && (ch !== 0)) {\n      throwError(state, 'bad indentation of a sequence entry');\n    } else if (state.lineIndent < nodeIndent) {\n      break;\n    }\n  }\n\n  if (detected) {\n    state.tag = _tag;\n    state.anchor = _anchor;\n    state.kind = 'sequence';\n    state.result = _result;\n    return true;\n  }\n  return false;\n}\n\nfunction readBlockMapping(state, nodeIndent, flowIndent) {\n  var following,\n      allowCompact,\n      _line,\n      _keyLine,\n      _keyLineStart,\n      _keyPos,\n      _tag          = state.tag,\n      _anchor       = state.anchor,\n      _result       = {},\n      overridableKeys = Object.create(null),\n      keyTag        = null,\n      keyNode       = null,\n      valueNode     = null,\n      atExplicitKey = false,\n      detected      = false,\n      ch;\n\n  // there is a leading tab before this token, so it can't be a block sequence/mapping;\n  // it can still be flow sequence/mapping or a scalar\n  if (state.firstTabInLine !== -1) return false;\n\n  if (state.anchor !== null) {\n    state.anchorMap[state.anchor] = _result;\n  }\n\n  ch = state.input.charCodeAt(state.position);\n\n  while (ch !== 0) {\n    if (!atExplicitKey && state.firstTabInLine !== -1) {\n      state.position = state.firstTabInLine;\n      throwError(state, 'tab characters must not be used in indentation');\n    }\n\n    following = state.input.charCodeAt(state.position + 1);\n    _line = state.line; // Save the current line.\n\n    //\n    // Explicit notation case. There are two separate blocks:\n    // first for the key (denoted by \"?\") and second for the value (denoted by \":\")\n    //\n    if ((ch === 0x3F/* ? */ || ch === 0x3A/* : */) && is_WS_OR_EOL(following)) {\n\n      if (ch === 0x3F/* ? */) {\n        if (atExplicitKey) {\n          storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, null, _keyLine, _keyLineStart, _keyPos);\n          keyTag = keyNode = valueNode = null;\n        }\n\n        detected = true;\n        atExplicitKey = true;\n        allowCompact = true;\n\n      } else if (atExplicitKey) {\n        // i.e. 0x3A/* : */ === character after the explicit key.\n        atExplicitKey = false;\n        allowCompact = true;\n\n      } else {\n        throwError(state, 'incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line');\n      }\n\n      state.position += 1;\n      ch = following;\n\n    //\n    // Implicit notation case. Flow-style node as the key first, then \":\", and the value.\n    //\n    } else {\n      _keyLine = state.line;\n      _keyLineStart = state.lineStart;\n      _keyPos = state.position;\n\n      if (!composeNode(state, flowIndent, CONTEXT_FLOW_OUT, false, true)) {\n        // Neither implicit nor explicit notation.\n        // Reading is done. Go to the epilogue.\n        break;\n      }\n\n      if (state.line === _line) {\n        ch = state.input.charCodeAt(state.position);\n\n        while (is_WHITE_SPACE(ch)) {\n          ch = state.input.charCodeAt(++state.position);\n        }\n\n        if (ch === 0x3A/* : */) {\n          ch = state.input.charCodeAt(++state.position);\n\n          if (!is_WS_OR_EOL(ch)) {\n            throwError(state, 'a whitespace character is expected after the key-value separator within a block mapping');\n          }\n\n          if (atExplicitKey) {\n            storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, null, _keyLine, _keyLineStart, _keyPos);\n            keyTag = keyNode = valueNode = null;\n          }\n\n          detected = true;\n          atExplicitKey = false;\n          allowCompact = false;\n          keyTag = state.tag;\n          keyNode = state.result;\n\n        } else if (detected) {\n          throwError(state, 'can not read an implicit mapping pair; a colon is missed');\n\n        } else {\n          state.tag = _tag;\n          state.anchor = _anchor;\n          return true; // Keep the result of `composeNode`.\n        }\n\n      } else if (detected) {\n        throwError(state, 'can not read a block mapping entry; a multiline key may not be an implicit key');\n\n      } else {\n        state.tag = _tag;\n        state.anchor = _anchor;\n        return true; // Keep the result of `composeNode`.\n      }\n    }\n\n    //\n    // Common reading code for both explicit and implicit notations.\n    //\n    if (state.line === _line || state.lineIndent > nodeIndent) {\n      if (atExplicitKey) {\n        _keyLine = state.line;\n        _keyLineStart = state.lineStart;\n        _keyPos = state.position;\n      }\n\n      if (composeNode(state, nodeIndent, CONTEXT_BLOCK_OUT, true, allowCompact)) {\n        if (atExplicitKey) {\n          keyNode = state.result;\n        } else {\n          valueNode = state.result;\n        }\n      }\n\n      if (!atExplicitKey) {\n        storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, valueNode, _keyLine, _keyLineStart, _keyPos);\n        keyTag = keyNode = valueNode = null;\n      }\n\n      skipSeparationSpace(state, true, -1);\n      ch = state.input.charCodeAt(state.position);\n    }\n\n    if ((state.line === _line || state.lineIndent > nodeIndent) && (ch !== 0)) {\n      throwError(state, 'bad indentation of a mapping entry');\n    } else if (state.lineIndent < nodeIndent) {\n      break;\n    }\n  }\n\n  //\n  // Epilogue.\n  //\n\n  // Special case: last mapping's node contains only the key in explicit notation.\n  if (atExplicitKey) {\n    storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, null, _keyLine, _keyLineStart, _keyPos);\n  }\n\n  // Expose the resulting mapping.\n  if (detected) {\n    state.tag = _tag;\n    state.anchor = _anchor;\n    state.kind = 'mapping';\n    state.result = _result;\n  }\n\n  return detected;\n}\n\nfunction readTagProperty(state) {\n  var _position,\n      isVerbatim = false,\n      isNamed    = false,\n      tagHandle,\n      tagName,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x21/* ! */) return false;\n\n  if (state.tag !== null) {\n    throwError(state, 'duplication of a tag property');\n  }\n\n  ch = state.input.charCodeAt(++state.position);\n\n  if (ch === 0x3C/* < */) {\n    isVerbatim = true;\n    ch = state.input.charCodeAt(++state.position);\n\n  } else if (ch === 0x21/* ! */) {\n    isNamed = true;\n    tagHandle = '!!';\n    ch = state.input.charCodeAt(++state.position);\n\n  } else {\n    tagHandle = '!';\n  }\n\n  _position = state.position;\n\n  if (isVerbatim) {\n    do { ch = state.input.charCodeAt(++state.position); }\n    while (ch !== 0 && ch !== 0x3E/* > */);\n\n    if (state.position < state.length) {\n      tagName = state.input.slice(_position, state.position);\n      ch = state.input.charCodeAt(++state.position);\n    } else {\n      throwError(state, 'unexpected end of the stream within a verbatim tag');\n    }\n  } else {\n    while (ch !== 0 && !is_WS_OR_EOL(ch)) {\n\n      if (ch === 0x21/* ! */) {\n        if (!isNamed) {\n          tagHandle = state.input.slice(_position - 1, state.position + 1);\n\n          if (!PATTERN_TAG_HANDLE.test(tagHandle)) {\n            throwError(state, 'named tag handle cannot contain such characters');\n          }\n\n          isNamed = true;\n          _position = state.position + 1;\n        } else {\n          throwError(state, 'tag suffix cannot contain exclamation marks');\n        }\n      }\n\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    tagName = state.input.slice(_position, state.position);\n\n    if (PATTERN_FLOW_INDICATORS.test(tagName)) {\n      throwError(state, 'tag suffix cannot contain flow indicator characters');\n    }\n  }\n\n  if (tagName && !PATTERN_TAG_URI.test(tagName)) {\n    throwError(state, 'tag name cannot contain such characters: ' + tagName);\n  }\n\n  try {\n    tagName = decodeURIComponent(tagName);\n  } catch (err) {\n    throwError(state, 'tag name is malformed: ' + tagName);\n  }\n\n  if (isVerbatim) {\n    state.tag = tagName;\n\n  } else if (_hasOwnProperty$1.call(state.tagMap, tagHandle)) {\n    state.tag = state.tagMap[tagHandle] + tagName;\n\n  } else if (tagHandle === '!') {\n    state.tag = '!' + tagName;\n\n  } else if (tagHandle === '!!') {\n    state.tag = 'tag:yaml.org,2002:' + tagName;\n\n  } else {\n    throwError(state, 'undeclared tag handle \"' + tagHandle + '\"');\n  }\n\n  return true;\n}\n\nfunction readAnchorProperty(state) {\n  var _position,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x26/* & */) return false;\n\n  if (state.anchor !== null) {\n    throwError(state, 'duplication of an anchor property');\n  }\n\n  ch = state.input.charCodeAt(++state.position);\n  _position = state.position;\n\n  while (ch !== 0 && !is_WS_OR_EOL(ch) && !is_FLOW_INDICATOR(ch)) {\n    ch = state.input.charCodeAt(++state.position);\n  }\n\n  if (state.position === _position) {\n    throwError(state, 'name of an anchor node must contain at least one character');\n  }\n\n  state.anchor = state.input.slice(_position, state.position);\n  return true;\n}\n\nfunction readAlias(state) {\n  var _position, alias,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x2A/* * */) return false;\n\n  ch = state.input.charCodeAt(++state.position);\n  _position = state.position;\n\n  while (ch !== 0 && !is_WS_OR_EOL(ch) && !is_FLOW_INDICATOR(ch)) {\n    ch = state.input.charCodeAt(++state.position);\n  }\n\n  if (state.position === _position) {\n    throwError(state, 'name of an alias node must contain at least one character');\n  }\n\n  alias = state.input.slice(_position, state.position);\n\n  if (!_hasOwnProperty$1.call(state.anchorMap, alias)) {\n    throwError(state, 'unidentified alias \"' + alias + '\"');\n  }\n\n  state.result = state.anchorMap[alias];\n  skipSeparationSpace(state, true, -1);\n  return true;\n}\n\nfunction composeNode(state, parentIndent, nodeContext, allowToSeek, allowCompact) {\n  var allowBlockStyles,\n      allowBlockScalars,\n      allowBlockCollections,\n      indentStatus = 1, // 1: this>parent, 0: this=parent, -1: this<parent\n      atNewLine  = false,\n      hasContent = false,\n      typeIndex,\n      typeQuantity,\n      typeList,\n      type,\n      flowIndent,\n      blockIndent;\n\n  if (state.listener !== null) {\n    state.listener('open', state);\n  }\n\n  state.tag    = null;\n  state.anchor = null;\n  state.kind   = null;\n  state.result = null;\n\n  allowBlockStyles = allowBlockScalars = allowBlockCollections =\n    CONTEXT_BLOCK_OUT === nodeContext ||\n    CONTEXT_BLOCK_IN  === nodeContext;\n\n  if (allowToSeek) {\n    if (skipSeparationSpace(state, true, -1)) {\n      atNewLine = true;\n\n      if (state.lineIndent > parentIndent) {\n        indentStatus = 1;\n      } else if (state.lineIndent === parentIndent) {\n        indentStatus = 0;\n      } else if (state.lineIndent < parentIndent) {\n        indentStatus = -1;\n      }\n    }\n  }\n\n  if (indentStatus === 1) {\n    while (readTagProperty(state) || readAnchorProperty(state)) {\n      if (skipSeparationSpace(state, true, -1)) {\n        atNewLine = true;\n        allowBlockCollections = allowBlockStyles;\n\n        if (state.lineIndent > parentIndent) {\n          indentStatus = 1;\n        } else if (state.lineIndent === parentIndent) {\n          indentStatus = 0;\n        } else if (state.lineIndent < parentIndent) {\n          indentStatus = -1;\n        }\n      } else {\n        allowBlockCollections = false;\n      }\n    }\n  }\n\n  if (allowBlockCollections) {\n    allowBlockCollections = atNewLine || allowCompact;\n  }\n\n  if (indentStatus === 1 || CONTEXT_BLOCK_OUT === nodeContext) {\n    if (CONTEXT_FLOW_IN === nodeContext || CONTEXT_FLOW_OUT === nodeContext) {\n      flowIndent = parentIndent;\n    } else {\n      flowIndent = parentIndent + 1;\n    }\n\n    blockIndent = state.position - state.lineStart;\n\n    if (indentStatus === 1) {\n      if (allowBlockCollections &&\n          (readBlockSequence(state, blockIndent) ||\n           readBlockMapping(state, blockIndent, flowIndent)) ||\n          readFlowCollection(state, flowIndent)) {\n        hasContent = true;\n      } else {\n        if ((allowBlockScalars && readBlockScalar(state, flowIndent)) ||\n            readSingleQuotedScalar(state, flowIndent) ||\n            readDoubleQuotedScalar(state, flowIndent)) {\n          hasContent = true;\n\n        } else if (readAlias(state)) {\n          hasContent = true;\n\n          if (state.tag !== null || state.anchor !== null) {\n            throwError(state, 'alias node should not have any properties');\n          }\n\n        } else if (readPlainScalar(state, flowIndent, CONTEXT_FLOW_IN === nodeContext)) {\n          hasContent = true;\n\n          if (state.tag === null) {\n            state.tag = '?';\n          }\n        }\n\n        if (state.anchor !== null) {\n          state.anchorMap[state.anchor] = state.result;\n        }\n      }\n    } else if (indentStatus === 0) {\n      // Special case: block sequences are allowed to have same indentation level as the parent.\n      // http://www.yaml.org/spec/1.2/spec.html#id2799784\n      hasContent = allowBlockCollections && readBlockSequence(state, blockIndent);\n    }\n  }\n\n  if (state.tag === null) {\n    if (state.anchor !== null) {\n      state.anchorMap[state.anchor] = state.result;\n    }\n\n  } else if (state.tag === '?') {\n    // Implicit resolving is not allowed for non-scalar types, and '?'\n    // non-specific tag is only automatically assigned to plain scalars.\n    //\n    // We only need to check kind conformity in case user explicitly assigns '?'\n    // tag, for example like this: \"!<?> [0]\"\n    //\n    if (state.result !== null && state.kind !== 'scalar') {\n      throwError(state, 'unacceptable node kind for !<?> tag; it should be \"scalar\", not \"' + state.kind + '\"');\n    }\n\n    for (typeIndex = 0, typeQuantity = state.implicitTypes.length; typeIndex < typeQuantity; typeIndex += 1) {\n      type = state.implicitTypes[typeIndex];\n\n      if (type.resolve(state.result)) { // `state.result` updated in resolver if matched\n        state.result = type.construct(state.result);\n        state.tag = type.tag;\n        if (state.anchor !== null) {\n          state.anchorMap[state.anchor] = state.result;\n        }\n        break;\n      }\n    }\n  } else if (state.tag !== '!') {\n    if (_hasOwnProperty$1.call(state.typeMap[state.kind || 'fallback'], state.tag)) {\n      type = state.typeMap[state.kind || 'fallback'][state.tag];\n    } else {\n      // looking for multi type\n      type = null;\n      typeList = state.typeMap.multi[state.kind || 'fallback'];\n\n      for (typeIndex = 0, typeQuantity = typeList.length; typeIndex < typeQuantity; typeIndex += 1) {\n        if (state.tag.slice(0, typeList[typeIndex].tag.length) === typeList[typeIndex].tag) {\n          type = typeList[typeIndex];\n          break;\n        }\n      }\n    }\n\n    if (!type) {\n      throwError(state, 'unknown tag !<' + state.tag + '>');\n    }\n\n    if (state.result !== null && type.kind !== state.kind) {\n      throwError(state, 'unacceptable node kind for !<' + state.tag + '> tag; it should be \"' + type.kind + '\", not \"' + state.kind + '\"');\n    }\n\n    if (!type.resolve(state.result, state.tag)) { // `state.result` updated in resolver if matched\n      throwError(state, 'cannot resolve a node with !<' + state.tag + '> explicit tag');\n    } else {\n      state.result = type.construct(state.result, state.tag);\n      if (state.anchor !== null) {\n        state.anchorMap[state.anchor] = state.result;\n      }\n    }\n  }\n\n  if (state.listener !== null) {\n    state.listener('close', state);\n  }\n  return state.tag !== null ||  state.anchor !== null || hasContent;\n}\n\nfunction readDocument(state) {\n  var documentStart = state.position,\n      _position,\n      directiveName,\n      directiveArgs,\n      hasDirectives = false,\n      ch;\n\n  state.version = null;\n  state.checkLineBreaks = state.legacy;\n  state.tagMap = Object.create(null);\n  state.anchorMap = Object.create(null);\n\n  while ((ch = state.input.charCodeAt(state.position)) !== 0) {\n    skipSeparationSpace(state, true, -1);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if (state.lineIndent > 0 || ch !== 0x25/* % */) {\n      break;\n    }\n\n    hasDirectives = true;\n    ch = state.input.charCodeAt(++state.position);\n    _position = state.position;\n\n    while (ch !== 0 && !is_WS_OR_EOL(ch)) {\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    directiveName = state.input.slice(_position, state.position);\n    directiveArgs = [];\n\n    if (directiveName.length < 1) {\n      throwError(state, 'directive name must not be less than one character in length');\n    }\n\n    while (ch !== 0) {\n      while (is_WHITE_SPACE(ch)) {\n        ch = state.input.charCodeAt(++state.position);\n      }\n\n      if (ch === 0x23/* # */) {\n        do { ch = state.input.charCodeAt(++state.position); }\n        while (ch !== 0 && !is_EOL(ch));\n        break;\n      }\n\n      if (is_EOL(ch)) break;\n\n      _position = state.position;\n\n      while (ch !== 0 && !is_WS_OR_EOL(ch)) {\n        ch = state.input.charCodeAt(++state.position);\n      }\n\n      directiveArgs.push(state.input.slice(_position, state.position));\n    }\n\n    if (ch !== 0) readLineBreak(state);\n\n    if (_hasOwnProperty$1.call(directiveHandlers, directiveName)) {\n      directiveHandlers[directiveName](state, directiveName, directiveArgs);\n    } else {\n      throwWarning(state, 'unknown document directive \"' + directiveName + '\"');\n    }\n  }\n\n  skipSeparationSpace(state, true, -1);\n\n  if (state.lineIndent === 0 &&\n      state.input.charCodeAt(state.position)     === 0x2D/* - */ &&\n      state.input.charCodeAt(state.position + 1) === 0x2D/* - */ &&\n      state.input.charCodeAt(state.position + 2) === 0x2D/* - */) {\n    state.position += 3;\n    skipSeparationSpace(state, true, -1);\n\n  } else if (hasDirectives) {\n    throwError(state, 'directives end mark is expected');\n  }\n\n  composeNode(state, state.lineIndent - 1, CONTEXT_BLOCK_OUT, false, true);\n  skipSeparationSpace(state, true, -1);\n\n  if (state.checkLineBreaks &&\n      PATTERN_NON_ASCII_LINE_BREAKS.test(state.input.slice(documentStart, state.position))) {\n    throwWarning(state, 'non-ASCII line breaks are interpreted as content');\n  }\n\n  state.documents.push(state.result);\n\n  if (state.position === state.lineStart && testDocumentSeparator(state)) {\n\n    if (state.input.charCodeAt(state.position) === 0x2E/* . */) {\n      state.position += 3;\n      skipSeparationSpace(state, true, -1);\n    }\n    return;\n  }\n\n  if (state.position < (state.length - 1)) {\n    throwError(state, 'end of the stream or a document separator is expected');\n  } else {\n    return;\n  }\n}\n\n\nfunction loadDocuments(input, options) {\n  input = String(input);\n  options = options || {};\n\n  if (input.length !== 0) {\n\n    // Add tailing `\\n` if not exists\n    if (input.charCodeAt(input.length - 1) !== 0x0A/* LF */ &&\n        input.charCodeAt(input.length - 1) !== 0x0D/* CR */) {\n      input += '\\n';\n    }\n\n    // Strip BOM\n    if (input.charCodeAt(0) === 0xFEFF) {\n      input = input.slice(1);\n    }\n  }\n\n  var state = new State$1(input, options);\n\n  var nullpos = input.indexOf('\\0');\n\n  if (nullpos !== -1) {\n    state.position = nullpos;\n    throwError(state, 'null byte is not allowed in input');\n  }\n\n  // Use 0 as string terminator. That significantly simplifies bounds check.\n  state.input += '\\0';\n\n  while (state.input.charCodeAt(state.position) === 0x20/* Space */) {\n    state.lineIndent += 1;\n    state.position += 1;\n  }\n\n  while (state.position < (state.length - 1)) {\n    readDocument(state);\n  }\n\n  return state.documents;\n}\n\n\nfunction loadAll$1(input, iterator, options) {\n  if (iterator !== null && typeof iterator === 'object' && typeof options === 'undefined') {\n    options = iterator;\n    iterator = null;\n  }\n\n  var documents = loadDocuments(input, options);\n\n  if (typeof iterator !== 'function') {\n    return documents;\n  }\n\n  for (var index = 0, length = documents.length; index < length; index += 1) {\n    iterator(documents[index]);\n  }\n}\n\n\nfunction load$1(input, options) {\n  var documents = loadDocuments(input, options);\n\n  if (documents.length === 0) {\n    /*eslint-disable no-undefined*/\n    return undefined;\n  } else if (documents.length === 1) {\n    return documents[0];\n  }\n  throw new exception('expected a single document in the stream, but found more');\n}\n\n\nvar loadAll_1 = loadAll$1;\nvar load_1    = load$1;\n\nvar loader = {\n\tloadAll: loadAll_1,\n\tload: load_1\n};\n\n/*eslint-disable no-use-before-define*/\n\n\n\n\n\nvar _toString       = Object.prototype.toString;\nvar _hasOwnProperty = Object.prototype.hasOwnProperty;\n\nvar CHAR_BOM                  = 0xFEFF;\nvar CHAR_TAB                  = 0x09; /* Tab */\nvar CHAR_LINE_FEED            = 0x0A; /* LF */\nvar CHAR_CARRIAGE_RETURN      = 0x0D; /* CR */\nvar CHAR_SPACE                = 0x20; /* Space */\nvar CHAR_EXCLAMATION          = 0x21; /* ! */\nvar CHAR_DOUBLE_QUOTE         = 0x22; /* \" */\nvar CHAR_SHARP                = 0x23; /* # */\nvar CHAR_PERCENT              = 0x25; /* % */\nvar CHAR_AMPERSAND            = 0x26; /* & */\nvar CHAR_SINGLE_QUOTE         = 0x27; /* ' */\nvar CHAR_ASTERISK             = 0x2A; /* * */\nvar CHAR_COMMA                = 0x2C; /* , */\nvar CHAR_MINUS                = 0x2D; /* - */\nvar CHAR_COLON                = 0x3A; /* : */\nvar CHAR_EQUALS               = 0x3D; /* = */\nvar CHAR_GREATER_THAN         = 0x3E; /* > */\nvar CHAR_QUESTION             = 0x3F; /* ? */\nvar CHAR_COMMERCIAL_AT        = 0x40; /* @ */\nvar CHAR_LEFT_SQUARE_BRACKET  = 0x5B; /* [ */\nvar CHAR_RIGHT_SQUARE_BRACKET = 0x5D; /* ] */\nvar CHAR_GRAVE_ACCENT         = 0x60; /* ` */\nvar CHAR_LEFT_CURLY_BRACKET   = 0x7B; /* { */\nvar CHAR_VERTICAL_LINE        = 0x7C; /* | */\nvar CHAR_RIGHT_CURLY_BRACKET  = 0x7D; /* } */\n\nvar ESCAPE_SEQUENCES = {};\n\nESCAPE_SEQUENCES[0x00]   = '\\\\0';\nESCAPE_SEQUENCES[0x07]   = '\\\\a';\nESCAPE_SEQUENCES[0x08]   = '\\\\b';\nESCAPE_SEQUENCES[0x09]   = '\\\\t';\nESCAPE_SEQUENCES[0x0A]   = '\\\\n';\nESCAPE_SEQUENCES[0x0B]   = '\\\\v';\nESCAPE_SEQUENCES[0x0C]   = '\\\\f';\nESCAPE_SEQUENCES[0x0D]   = '\\\\r';\nESCAPE_SEQUENCES[0x1B]   = '\\\\e';\nESCAPE_SEQUENCES[0x22]   = '\\\\\"';\nESCAPE_SEQUENCES[0x5C]   = '\\\\\\\\';\nESCAPE_SEQUENCES[0x85]   = '\\\\N';\nESCAPE_SEQUENCES[0xA0]   = '\\\\_';\nESCAPE_SEQUENCES[0x2028] = '\\\\L';\nESCAPE_SEQUENCES[0x2029] = '\\\\P';\n\nvar DEPRECATED_BOOLEANS_SYNTAX = [\n  'y', 'Y', 'yes', 'Yes', 'YES', 'on', 'On', 'ON',\n  'n', 'N', 'no', 'No', 'NO', 'off', 'Off', 'OFF'\n];\n\nvar DEPRECATED_BASE60_SYNTAX = /^[-+]?[0-9_]+(?::[0-9_]+)+(?:\\.[0-9_]*)?$/;\n\nfunction compileStyleMap(schema, map) {\n  var result, keys, index, length, tag, style, type;\n\n  if (map === null) return {};\n\n  result = {};\n  keys = Object.keys(map);\n\n  for (index = 0, length = keys.length; index < length; index += 1) {\n    tag = keys[index];\n    style = String(map[tag]);\n\n    if (tag.slice(0, 2) === '!!') {\n      tag = 'tag:yaml.org,2002:' + tag.slice(2);\n    }\n    type = schema.compiledTypeMap['fallback'][tag];\n\n    if (type && _hasOwnProperty.call(type.styleAliases, style)) {\n      style = type.styleAliases[style];\n    }\n\n    result[tag] = style;\n  }\n\n  return result;\n}\n\nfunction encodeHex(character) {\n  var string, handle, length;\n\n  string = character.toString(16).toUpperCase();\n\n  if (character <= 0xFF) {\n    handle = 'x';\n    length = 2;\n  } else if (character <= 0xFFFF) {\n    handle = 'u';\n    length = 4;\n  } else if (character <= 0xFFFFFFFF) {\n    handle = 'U';\n    length = 8;\n  } else {\n    throw new exception('code point within a string may not be greater than 0xFFFFFFFF');\n  }\n\n  return '\\\\' + handle + common.repeat('0', length - string.length) + string;\n}\n\n\nvar QUOTING_TYPE_SINGLE = 1,\n    QUOTING_TYPE_DOUBLE = 2;\n\nfunction State(options) {\n  this.schema        = options['schema'] || _default;\n  this.indent        = Math.max(1, (options['indent'] || 2));\n  this.noArrayIndent = options['noArrayIndent'] || false;\n  this.skipInvalid   = options['skipInvalid'] || false;\n  this.flowLevel     = (common.isNothing(options['flowLevel']) ? -1 : options['flowLevel']);\n  this.styleMap      = compileStyleMap(this.schema, options['styles'] || null);\n  this.sortKeys      = options['sortKeys'] || false;\n  this.lineWidth     = options['lineWidth'] || 80;\n  this.noRefs        = options['noRefs'] || false;\n  this.noCompatMode  = options['noCompatMode'] || false;\n  this.condenseFlow  = options['condenseFlow'] || false;\n  this.quotingType   = options['quotingType'] === '\"' ? QUOTING_TYPE_DOUBLE : QUOTING_TYPE_SINGLE;\n  this.forceQuotes   = options['forceQuotes'] || false;\n  this.replacer      = typeof options['replacer'] === 'function' ? options['replacer'] : null;\n\n  this.implicitTypes = this.schema.compiledImplicit;\n  this.explicitTypes = this.schema.compiledExplicit;\n\n  this.tag = null;\n  this.result = '';\n\n  this.duplicates = [];\n  this.usedDuplicates = null;\n}\n\n// Indents every line in a string. Empty lines (\\n only) are not indented.\nfunction indentString(string, spaces) {\n  var ind = common.repeat(' ', spaces),\n      position = 0,\n      next = -1,\n      result = '',\n      line,\n      length = string.length;\n\n  while (position < length) {\n    next = string.indexOf('\\n', position);\n    if (next === -1) {\n      line = string.slice(position);\n      position = length;\n    } else {\n      line = string.slice(position, next + 1);\n      position = next + 1;\n    }\n\n    if (line.length && line !== '\\n') result += ind;\n\n    result += line;\n  }\n\n  return result;\n}\n\nfunction generateNextLine(state, level) {\n  return '\\n' + common.repeat(' ', state.indent * level);\n}\n\nfunction testImplicitResolving(state, str) {\n  var index, length, type;\n\n  for (index = 0, length = state.implicitTypes.length; index < length; index += 1) {\n    type = state.implicitTypes[index];\n\n    if (type.resolve(str)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n// [33] s-white ::= s-space | s-tab\nfunction isWhitespace(c) {\n  return c === CHAR_SPACE || c === CHAR_TAB;\n}\n\n// Returns true if the character can be printed without escaping.\n// From YAML 1.2: \"any allowed characters known to be non-printable\n// should also be escaped. [However,] This isn\u2019t mandatory\"\n// Derived from nb-char - \\t - #x85 - #xA0 - #x2028 - #x2029.\nfunction isPrintable(c) {\n  return  (0x00020 <= c && c <= 0x00007E)\n      || ((0x000A1 <= c && c <= 0x00D7FF) && c !== 0x2028 && c !== 0x2029)\n      || ((0x0E000 <= c && c <= 0x00FFFD) && c !== CHAR_BOM)\n      ||  (0x10000 <= c && c <= 0x10FFFF);\n}\n\n// [34] ns-char ::= nb-char - s-white\n// [27] nb-char ::= c-printable - b-char - c-byte-order-mark\n// [26] b-char  ::= b-line-feed | b-carriage-return\n// Including s-white (for some reason, examples doesn't match specs in this aspect)\n// ns-char ::= c-printable - b-line-feed - b-carriage-return - c-byte-order-mark\nfunction isNsCharOrWhitespace(c) {\n  return isPrintable(c)\n    && c !== CHAR_BOM\n    // - b-char\n    && c !== CHAR_CARRIAGE_RETURN\n    && c !== CHAR_LINE_FEED;\n}\n\n// [127]  ns-plain-safe(c) ::= c = flow-out  \u21D2 ns-plain-safe-out\n//                             c = flow-in   \u21D2 ns-plain-safe-in\n//                             c = block-key \u21D2 ns-plain-safe-out\n//                             c = flow-key  \u21D2 ns-plain-safe-in\n// [128] ns-plain-safe-out ::= ns-char\n// [129]  ns-plain-safe-in ::= ns-char - c-flow-indicator\n// [130]  ns-plain-char(c) ::=  ( ns-plain-safe(c) - \u201C:\u201D - \u201C#\u201D )\n//                            | ( /* An ns-char preceding */ \u201C#\u201D )\n//                            | ( \u201C:\u201D /* Followed by an ns-plain-safe(c) */ )\nfunction isPlainSafe(c, prev, inblock) {\n  var cIsNsCharOrWhitespace = isNsCharOrWhitespace(c);\n  var cIsNsChar = cIsNsCharOrWhitespace && !isWhitespace(c);\n  return (\n    // ns-plain-safe\n    inblock ? // c = flow-in\n      cIsNsCharOrWhitespace\n      : cIsNsCharOrWhitespace\n        // - c-flow-indicator\n        && c !== CHAR_COMMA\n        && c !== CHAR_LEFT_SQUARE_BRACKET\n        && c !== CHAR_RIGHT_SQUARE_BRACKET\n        && c !== CHAR_LEFT_CURLY_BRACKET\n        && c !== CHAR_RIGHT_CURLY_BRACKET\n  )\n    // ns-plain-char\n    && c !== CHAR_SHARP // false on '#'\n    && !(prev === CHAR_COLON && !cIsNsChar) // false on ': '\n    || (isNsCharOrWhitespace(prev) && !isWhitespace(prev) && c === CHAR_SHARP) // change to true on '[^ ]#'\n    || (prev === CHAR_COLON && cIsNsChar); // change to true on ':[^ ]'\n}\n\n// Simplified test for values allowed as the first character in plain style.\nfunction isPlainSafeFirst(c) {\n  // Uses a subset of ns-char - c-indicator\n  // where ns-char = nb-char - s-white.\n  // No support of ( ( \u201C?\u201D | \u201C:\u201D | \u201C-\u201D ) /* Followed by an ns-plain-safe(c)) */ ) part\n  return isPrintable(c) && c !== CHAR_BOM\n    && !isWhitespace(c) // - s-white\n    // - (c-indicator ::=\n    // \u201C-\u201D | \u201C?\u201D | \u201C:\u201D | \u201C,\u201D | \u201C[\u201D | \u201C]\u201D | \u201C{\u201D | \u201C}\u201D\n    && c !== CHAR_MINUS\n    && c !== CHAR_QUESTION\n    && c !== CHAR_COLON\n    && c !== CHAR_COMMA\n    && c !== CHAR_LEFT_SQUARE_BRACKET\n    && c !== CHAR_RIGHT_SQUARE_BRACKET\n    && c !== CHAR_LEFT_CURLY_BRACKET\n    && c !== CHAR_RIGHT_CURLY_BRACKET\n    // | \u201C#\u201D | \u201C&\u201D | \u201C*\u201D | \u201C!\u201D | \u201C|\u201D | \u201C=\u201D | \u201C>\u201D | \u201C'\u201D | \u201C\"\u201D\n    && c !== CHAR_SHARP\n    && c !== CHAR_AMPERSAND\n    && c !== CHAR_ASTERISK\n    && c !== CHAR_EXCLAMATION\n    && c !== CHAR_VERTICAL_LINE\n    && c !== CHAR_EQUALS\n    && c !== CHAR_GREATER_THAN\n    && c !== CHAR_SINGLE_QUOTE\n    && c !== CHAR_DOUBLE_QUOTE\n    // | \u201C%\u201D | \u201C@\u201D | \u201C`\u201D)\n    && c !== CHAR_PERCENT\n    && c !== CHAR_COMMERCIAL_AT\n    && c !== CHAR_GRAVE_ACCENT;\n}\n\n// Simplified test for values allowed as the last character in plain style.\nfunction isPlainSafeLast(c) {\n  // just not whitespace or colon, it will be checked to be plain character later\n  return !isWhitespace(c) && c !== CHAR_COLON;\n}\n\n// Same as 'string'.codePointAt(pos), but works in older browsers.\nfunction codePointAt(string, pos) {\n  var first = string.charCodeAt(pos), second;\n  if (first >= 0xD800 && first <= 0xDBFF && pos + 1 < string.length) {\n    second = string.charCodeAt(pos + 1);\n    if (second >= 0xDC00 && second <= 0xDFFF) {\n      // https://mathiasbynens.be/notes/javascript-encoding#surrogate-formulae\n      return (first - 0xD800) * 0x400 + second - 0xDC00 + 0x10000;\n    }\n  }\n  return first;\n}\n\n// Determines whether block indentation indicator is required.\nfunction needIndentIndicator(string) {\n  var leadingSpaceRe = /^\\n* /;\n  return leadingSpaceRe.test(string);\n}\n\nvar STYLE_PLAIN   = 1,\n    STYLE_SINGLE  = 2,\n    STYLE_LITERAL = 3,\n    STYLE_FOLDED  = 4,\n    STYLE_DOUBLE  = 5;\n\n// Determines which scalar styles are possible and returns the preferred style.\n// lineWidth = -1 => no limit.\n// Pre-conditions: str.length > 0.\n// Post-conditions:\n//    STYLE_PLAIN or STYLE_SINGLE => no \\n are in the string.\n//    STYLE_LITERAL => no lines are suitable for folding (or lineWidth is -1).\n//    STYLE_FOLDED => a line > lineWidth and can be folded (and lineWidth != -1).\nfunction chooseScalarStyle(string, singleLineOnly, indentPerLevel, lineWidth,\n  testAmbiguousType, quotingType, forceQuotes, inblock) {\n\n  var i;\n  var char = 0;\n  var prevChar = null;\n  var hasLineBreak = false;\n  var hasFoldableLine = false; // only checked if shouldTrackWidth\n  var shouldTrackWidth = lineWidth !== -1;\n  var previousLineBreak = -1; // count the first line correctly\n  var plain = isPlainSafeFirst(codePointAt(string, 0))\n          && isPlainSafeLast(codePointAt(string, string.length - 1));\n\n  if (singleLineOnly || forceQuotes) {\n    // Case: no block styles.\n    // Check for disallowed characters to rule out plain and single.\n    for (i = 0; i < string.length; char >= 0x10000 ? i += 2 : i++) {\n      char = codePointAt(string, i);\n      if (!isPrintable(char)) {\n        return STYLE_DOUBLE;\n      }\n      plain = plain && isPlainSafe(char, prevChar, inblock);\n      prevChar = char;\n    }\n  } else {\n    // Case: block styles permitted.\n    for (i = 0; i < string.length; char >= 0x10000 ? i += 2 : i++) {\n      char = codePointAt(string, i);\n      if (char === CHAR_LINE_FEED) {\n        hasLineBreak = true;\n        // Check if any line can be folded.\n        if (shouldTrackWidth) {\n          hasFoldableLine = hasFoldableLine ||\n            // Foldable line = too long, and not more-indented.\n            (i - previousLineBreak - 1 > lineWidth &&\n             string[previousLineBreak + 1] !== ' ');\n          previousLineBreak = i;\n        }\n      } else if (!isPrintable(char)) {\n        return STYLE_DOUBLE;\n      }\n      plain = plain && isPlainSafe(char, prevChar, inblock);\n      prevChar = char;\n    }\n    // in case the end is missing a \\n\n    hasFoldableLine = hasFoldableLine || (shouldTrackWidth &&\n      (i - previousLineBreak - 1 > lineWidth &&\n       string[previousLineBreak + 1] !== ' '));\n  }\n  // Although every style can represent \\n without escaping, prefer block styles\n  // for multiline, since they're more readable and they don't add empty lines.\n  // Also prefer folding a super-long line.\n  if (!hasLineBreak && !hasFoldableLine) {\n    // Strings interpretable as another type have to be quoted;\n    // e.g. the string 'true' vs. the boolean true.\n    if (plain && !forceQuotes && !testAmbiguousType(string)) {\n      return STYLE_PLAIN;\n    }\n    return quotingType === QUOTING_TYPE_DOUBLE ? STYLE_DOUBLE : STYLE_SINGLE;\n  }\n  // Edge case: block indentation indicator can only have one digit.\n  if (indentPerLevel > 9 && needIndentIndicator(string)) {\n    return STYLE_DOUBLE;\n  }\n  // At this point we know block styles are valid.\n  // Prefer literal style unless we want to fold.\n  if (!forceQuotes) {\n    return hasFoldableLine ? STYLE_FOLDED : STYLE_LITERAL;\n  }\n  return quotingType === QUOTING_TYPE_DOUBLE ? STYLE_DOUBLE : STYLE_SINGLE;\n}\n\n// Note: line breaking/folding is implemented for only the folded style.\n// NB. We drop the last trailing newline (if any) of a returned block scalar\n//  since the dumper adds its own newline. This always works:\n//    \u2022 No ending newline => unaffected; already using strip \"-\" chomping.\n//    \u2022 Ending newline    => removed then restored.\n//  Importantly, this keeps the \"+\" chomp indicator from gaining an extra line.\nfunction writeScalar(state, string, level, iskey, inblock) {\n  state.dump = (function () {\n    if (string.length === 0) {\n      return state.quotingType === QUOTING_TYPE_DOUBLE ? '\"\"' : \"''\";\n    }\n    if (!state.noCompatMode) {\n      if (DEPRECATED_BOOLEANS_SYNTAX.indexOf(string) !== -1 || DEPRECATED_BASE60_SYNTAX.test(string)) {\n        return state.quotingType === QUOTING_TYPE_DOUBLE ? ('\"' + string + '\"') : (\"'\" + string + \"'\");\n      }\n    }\n\n    var indent = state.indent * Math.max(1, level); // no 0-indent scalars\n    // As indentation gets deeper, let the width decrease monotonically\n    // to the lower bound min(state.lineWidth, 40).\n    // Note that this implies\n    //  state.lineWidth \u2264 40 + state.indent: width is fixed at the lower bound.\n    //  state.lineWidth > 40 + state.indent: width decreases until the lower bound.\n    // This behaves better than a constant minimum width which disallows narrower options,\n    // or an indent threshold which causes the width to suddenly increase.\n    var lineWidth = state.lineWidth === -1\n      ? -1 : Math.max(Math.min(state.lineWidth, 40), state.lineWidth - indent);\n\n    // Without knowing if keys are implicit/explicit, assume implicit for safety.\n    var singleLineOnly = iskey\n      // No block styles in flow mode.\n      || (state.flowLevel > -1 && level >= state.flowLevel);\n    function testAmbiguity(string) {\n      return testImplicitResolving(state, string);\n    }\n\n    switch (chooseScalarStyle(string, singleLineOnly, state.indent, lineWidth,\n      testAmbiguity, state.quotingType, state.forceQuotes && !iskey, inblock)) {\n\n      case STYLE_PLAIN:\n        return string;\n      case STYLE_SINGLE:\n        return \"'\" + string.replace(/'/g, \"''\") + \"'\";\n      case STYLE_LITERAL:\n        return '|' + blockHeader(string, state.indent)\n          + dropEndingNewline(indentString(string, indent));\n      case STYLE_FOLDED:\n        return '>' + blockHeader(string, state.indent)\n          + dropEndingNewline(indentString(foldString(string, lineWidth), indent));\n      case STYLE_DOUBLE:\n        return '\"' + escapeString(string) + '\"';\n      default:\n        throw new exception('impossible error: invalid scalar style');\n    }\n  }());\n}\n\n// Pre-conditions: string is valid for a block scalar, 1 <= indentPerLevel <= 9.\nfunction blockHeader(string, indentPerLevel) {\n  var indentIndicator = needIndentIndicator(string) ? String(indentPerLevel) : '';\n\n  // note the special case: the string '\\n' counts as a \"trailing\" empty line.\n  var clip =          string[string.length - 1] === '\\n';\n  var keep = clip && (string[string.length - 2] === '\\n' || string === '\\n');\n  var chomp = keep ? '+' : (clip ? '' : '-');\n\n  return indentIndicator + chomp + '\\n';\n}\n\n// (See the note for writeScalar.)\nfunction dropEndingNewline(string) {\n  return string[string.length - 1] === '\\n' ? string.slice(0, -1) : string;\n}\n\n// Note: a long line without a suitable break point will exceed the width limit.\n// Pre-conditions: every char in str isPrintable, str.length > 0, width > 0.\nfunction foldString(string, width) {\n  // In folded style, $k$ consecutive newlines output as $k+1$ newlines\u2014\n  // unless they're before or after a more-indented line, or at the very\n  // beginning or end, in which case $k$ maps to $k$.\n  // Therefore, parse each chunk as newline(s) followed by a content line.\n  var lineRe = /(\\n+)([^\\n]*)/g;\n\n  // first line (possibly an empty line)\n  var result = (function () {\n    var nextLF = string.indexOf('\\n');\n    nextLF = nextLF !== -1 ? nextLF : string.length;\n    lineRe.lastIndex = nextLF;\n    return foldLine(string.slice(0, nextLF), width);\n  }());\n  // If we haven't reached the first content line yet, don't add an extra \\n.\n  var prevMoreIndented = string[0] === '\\n' || string[0] === ' ';\n  var moreIndented;\n\n  // rest of the lines\n  var match;\n  while ((match = lineRe.exec(string))) {\n    var prefix = match[1], line = match[2];\n    moreIndented = (line[0] === ' ');\n    result += prefix\n      + (!prevMoreIndented && !moreIndented && line !== ''\n        ? '\\n' : '')\n      + foldLine(line, width);\n    prevMoreIndented = moreIndented;\n  }\n\n  return result;\n}\n\n// Greedy line breaking.\n// Picks the longest line under the limit each time,\n// otherwise settles for the shortest line over the limit.\n// NB. More-indented lines *cannot* be folded, as that would add an extra \\n.\nfunction foldLine(line, width) {\n  if (line === '' || line[0] === ' ') return line;\n\n  // Since a more-indented line adds a \\n, breaks can't be followed by a space.\n  var breakRe = / [^ ]/g; // note: the match index will always be <= length-2.\n  var match;\n  // start is an inclusive index. end, curr, and next are exclusive.\n  var start = 0, end, curr = 0, next = 0;\n  var result = '';\n\n  // Invariants: 0 <= start <= length-1.\n  //   0 <= curr <= next <= max(0, length-2). curr - start <= width.\n  // Inside the loop:\n  //   A match implies length >= 2, so curr and next are <= length-2.\n  while ((match = breakRe.exec(line))) {\n    next = match.index;\n    // maintain invariant: curr - start <= width\n    if (next - start > width) {\n      end = (curr > start) ? curr : next; // derive end <= length-2\n      result += '\\n' + line.slice(start, end);\n      // skip the space that was output as \\n\n      start = end + 1;                    // derive start <= length-1\n    }\n    curr = next;\n  }\n\n  // By the invariants, start <= length-1, so there is something left over.\n  // It is either the whole string or a part starting from non-whitespace.\n  result += '\\n';\n  // Insert a break if the remainder is too long and there is a break available.\n  if (line.length - start > width && curr > start) {\n    result += line.slice(start, curr) + '\\n' + line.slice(curr + 1);\n  } else {\n    result += line.slice(start);\n  }\n\n  return result.slice(1); // drop extra \\n joiner\n}\n\n// Escapes a double-quoted string.\nfunction escapeString(string) {\n  var result = '';\n  var char = 0;\n  var escapeSeq;\n\n  for (var i = 0; i < string.length; char >= 0x10000 ? i += 2 : i++) {\n    char = codePointAt(string, i);\n    escapeSeq = ESCAPE_SEQUENCES[char];\n\n    if (!escapeSeq && isPrintable(char)) {\n      result += string[i];\n      if (char >= 0x10000) result += string[i + 1];\n    } else {\n      result += escapeSeq || encodeHex(char);\n    }\n  }\n\n  return result;\n}\n\nfunction writeFlowSequence(state, level, object) {\n  var _result = '',\n      _tag    = state.tag,\n      index,\n      length,\n      value;\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    value = object[index];\n\n    if (state.replacer) {\n      value = state.replacer.call(object, String(index), value);\n    }\n\n    // Write only valid elements, put null instead of invalid elements.\n    if (writeNode(state, level, value, false, false) ||\n        (typeof value === 'undefined' &&\n         writeNode(state, level, null, false, false))) {\n\n      if (_result !== '') _result += ',' + (!state.condenseFlow ? ' ' : '');\n      _result += state.dump;\n    }\n  }\n\n  state.tag = _tag;\n  state.dump = '[' + _result + ']';\n}\n\nfunction writeBlockSequence(state, level, object, compact) {\n  var _result = '',\n      _tag    = state.tag,\n      index,\n      length,\n      value;\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    value = object[index];\n\n    if (state.replacer) {\n      value = state.replacer.call(object, String(index), value);\n    }\n\n    // Write only valid elements, put null instead of invalid elements.\n    if (writeNode(state, level + 1, value, true, true, false, true) ||\n        (typeof value === 'undefined' &&\n         writeNode(state, level + 1, null, true, true, false, true))) {\n\n      if (!compact || _result !== '') {\n        _result += generateNextLine(state, level);\n      }\n\n      if (state.dump && CHAR_LINE_FEED === state.dump.charCodeAt(0)) {\n        _result += '-';\n      } else {\n        _result += '- ';\n      }\n\n      _result += state.dump;\n    }\n  }\n\n  state.tag = _tag;\n  state.dump = _result || '[]'; // Empty sequence if no valid values.\n}\n\nfunction writeFlowMapping(state, level, object) {\n  var _result       = '',\n      _tag          = state.tag,\n      objectKeyList = Object.keys(object),\n      index,\n      length,\n      objectKey,\n      objectValue,\n      pairBuffer;\n\n  for (index = 0, length = objectKeyList.length; index < length; index += 1) {\n\n    pairBuffer = '';\n    if (_result !== '') pairBuffer += ', ';\n\n    if (state.condenseFlow) pairBuffer += '\"';\n\n    objectKey = objectKeyList[index];\n    objectValue = object[objectKey];\n\n    if (state.replacer) {\n      objectValue = state.replacer.call(object, objectKey, objectValue);\n    }\n\n    if (!writeNode(state, level, objectKey, false, false)) {\n      continue; // Skip this pair because of invalid key;\n    }\n\n    if (state.dump.length > 1024) pairBuffer += '? ';\n\n    pairBuffer += state.dump + (state.condenseFlow ? '\"' : '') + ':' + (state.condenseFlow ? '' : ' ');\n\n    if (!writeNode(state, level, objectValue, false, false)) {\n      continue; // Skip this pair because of invalid value.\n    }\n\n    pairBuffer += state.dump;\n\n    // Both key and value are valid.\n    _result += pairBuffer;\n  }\n\n  state.tag = _tag;\n  state.dump = '{' + _result + '}';\n}\n\nfunction writeBlockMapping(state, level, object, compact) {\n  var _result       = '',\n      _tag          = state.tag,\n      objectKeyList = Object.keys(object),\n      index,\n      length,\n      objectKey,\n      objectValue,\n      explicitPair,\n      pairBuffer;\n\n  // Allow sorting keys so that the output file is deterministic\n  if (state.sortKeys === true) {\n    // Default sorting\n    objectKeyList.sort();\n  } else if (typeof state.sortKeys === 'function') {\n    // Custom sort function\n    objectKeyList.sort(state.sortKeys);\n  } else if (state.sortKeys) {\n    // Something is wrong\n    throw new exception('sortKeys must be a boolean or a function');\n  }\n\n  for (index = 0, length = objectKeyList.length; index < length; index += 1) {\n    pairBuffer = '';\n\n    if (!compact || _result !== '') {\n      pairBuffer += generateNextLine(state, level);\n    }\n\n    objectKey = objectKeyList[index];\n    objectValue = object[objectKey];\n\n    if (state.replacer) {\n      objectValue = state.replacer.call(object, objectKey, objectValue);\n    }\n\n    if (!writeNode(state, level + 1, objectKey, true, true, true)) {\n      continue; // Skip this pair because of invalid key.\n    }\n\n    explicitPair = (state.tag !== null && state.tag !== '?') ||\n                   (state.dump && state.dump.length > 1024);\n\n    if (explicitPair) {\n      if (state.dump && CHAR_LINE_FEED === state.dump.charCodeAt(0)) {\n        pairBuffer += '?';\n      } else {\n        pairBuffer += '? ';\n      }\n    }\n\n    pairBuffer += state.dump;\n\n    if (explicitPair) {\n      pairBuffer += generateNextLine(state, level);\n    }\n\n    if (!writeNode(state, level + 1, objectValue, true, explicitPair)) {\n      continue; // Skip this pair because of invalid value.\n    }\n\n    if (state.dump && CHAR_LINE_FEED === state.dump.charCodeAt(0)) {\n      pairBuffer += ':';\n    } else {\n      pairBuffer += ': ';\n    }\n\n    pairBuffer += state.dump;\n\n    // Both key and value are valid.\n    _result += pairBuffer;\n  }\n\n  state.tag = _tag;\n  state.dump = _result || '{}'; // Empty mapping if no valid pairs.\n}\n\nfunction detectType(state, object, explicit) {\n  var _result, typeList, index, length, type, style;\n\n  typeList = explicit ? state.explicitTypes : state.implicitTypes;\n\n  for (index = 0, length = typeList.length; index < length; index += 1) {\n    type = typeList[index];\n\n    if ((type.instanceOf  || type.predicate) &&\n        (!type.instanceOf || ((typeof object === 'object') && (object instanceof type.instanceOf))) &&\n        (!type.predicate  || type.predicate(object))) {\n\n      if (explicit) {\n        if (type.multi && type.representName) {\n          state.tag = type.representName(object);\n        } else {\n          state.tag = type.tag;\n        }\n      } else {\n        state.tag = '?';\n      }\n\n      if (type.represent) {\n        style = state.styleMap[type.tag] || type.defaultStyle;\n\n        if (_toString.call(type.represent) === '[object Function]') {\n          _result = type.represent(object, style);\n        } else if (_hasOwnProperty.call(type.represent, style)) {\n          _result = type.represent[style](object, style);\n        } else {\n          throw new exception('!<' + type.tag + '> tag resolver accepts not \"' + style + '\" style');\n        }\n\n        state.dump = _result;\n      }\n\n      return true;\n    }\n  }\n\n  return false;\n}\n\n// Serializes `object` and writes it to global `result`.\n// Returns true on success, or false on invalid object.\n//\nfunction writeNode(state, level, object, block, compact, iskey, isblockseq) {\n  state.tag = null;\n  state.dump = object;\n\n  if (!detectType(state, object, false)) {\n    detectType(state, object, true);\n  }\n\n  var type = _toString.call(state.dump);\n  var inblock = block;\n  var tagStr;\n\n  if (block) {\n    block = (state.flowLevel < 0 || state.flowLevel > level);\n  }\n\n  var objectOrArray = type === '[object Object]' || type === '[object Array]',\n      duplicateIndex,\n      duplicate;\n\n  if (objectOrArray) {\n    duplicateIndex = state.duplicates.indexOf(object);\n    duplicate = duplicateIndex !== -1;\n  }\n\n  if ((state.tag !== null && state.tag !== '?') || duplicate || (state.indent !== 2 && level > 0)) {\n    compact = false;\n  }\n\n  if (duplicate && state.usedDuplicates[duplicateIndex]) {\n    state.dump = '*ref_' + duplicateIndex;\n  } else {\n    if (objectOrArray && duplicate && !state.usedDuplicates[duplicateIndex]) {\n      state.usedDuplicates[duplicateIndex] = true;\n    }\n    if (type === '[object Object]') {\n      if (block && (Object.keys(state.dump).length !== 0)) {\n        writeBlockMapping(state, level, state.dump, compact);\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + state.dump;\n        }\n      } else {\n        writeFlowMapping(state, level, state.dump);\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + ' ' + state.dump;\n        }\n      }\n    } else if (type === '[object Array]') {\n      if (block && (state.dump.length !== 0)) {\n        if (state.noArrayIndent && !isblockseq && level > 0) {\n          writeBlockSequence(state, level - 1, state.dump, compact);\n        } else {\n          writeBlockSequence(state, level, state.dump, compact);\n        }\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + state.dump;\n        }\n      } else {\n        writeFlowSequence(state, level, state.dump);\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + ' ' + state.dump;\n        }\n      }\n    } else if (type === '[object String]') {\n      if (state.tag !== '?') {\n        writeScalar(state, state.dump, level, iskey, inblock);\n      }\n    } else if (type === '[object Undefined]') {\n      return false;\n    } else {\n      if (state.skipInvalid) return false;\n      throw new exception('unacceptable kind of an object to dump ' + type);\n    }\n\n    if (state.tag !== null && state.tag !== '?') {\n      // Need to encode all characters except those allowed by the spec:\n      //\n      // [35] ns-dec-digit    ::=  [#x30-#x39] /* 0-9 */\n      // [36] ns-hex-digit    ::=  ns-dec-digit\n      //                         | [#x41-#x46] /* A-F */ | [#x61-#x66] /* a-f */\n      // [37] ns-ascii-letter ::=  [#x41-#x5A] /* A-Z */ | [#x61-#x7A] /* a-z */\n      // [38] ns-word-char    ::=  ns-dec-digit | ns-ascii-letter | \u201C-\u201D\n      // [39] ns-uri-char     ::=  \u201C%\u201D ns-hex-digit ns-hex-digit | ns-word-char | \u201C#\u201D\n      //                         | \u201C;\u201D | \u201C/\u201D | \u201C?\u201D | \u201C:\u201D | \u201C@\u201D | \u201C&\u201D | \u201C=\u201D | \u201C+\u201D | \u201C$\u201D | \u201C,\u201D\n      //                         | \u201C_\u201D | \u201C.\u201D | \u201C!\u201D | \u201C~\u201D | \u201C*\u201D | \u201C'\u201D | \u201C(\u201D | \u201C)\u201D | \u201C[\u201D | \u201C]\u201D\n      //\n      // Also need to encode '!' because it has special meaning (end of tag prefix).\n      //\n      tagStr = encodeURI(\n        state.tag[0] === '!' ? state.tag.slice(1) : state.tag\n      ).replace(/!/g, '%21');\n\n      if (state.tag[0] === '!') {\n        tagStr = '!' + tagStr;\n      } else if (tagStr.slice(0, 18) === 'tag:yaml.org,2002:') {\n        tagStr = '!!' + tagStr.slice(18);\n      } else {\n        tagStr = '!<' + tagStr + '>';\n      }\n\n      state.dump = tagStr + ' ' + state.dump;\n    }\n  }\n\n  return true;\n}\n\nfunction getDuplicateReferences(object, state) {\n  var objects = [],\n      duplicatesIndexes = [],\n      index,\n      length;\n\n  inspectNode(object, objects, duplicatesIndexes);\n\n  for (index = 0, length = duplicatesIndexes.length; index < length; index += 1) {\n    state.duplicates.push(objects[duplicatesIndexes[index]]);\n  }\n  state.usedDuplicates = new Array(length);\n}\n\nfunction inspectNode(object, objects, duplicatesIndexes) {\n  var objectKeyList,\n      index,\n      length;\n\n  if (object !== null && typeof object === 'object') {\n    index = objects.indexOf(object);\n    if (index !== -1) {\n      if (duplicatesIndexes.indexOf(index) === -1) {\n        duplicatesIndexes.push(index);\n      }\n    } else {\n      objects.push(object);\n\n      if (Array.isArray(object)) {\n        for (index = 0, length = object.length; index < length; index += 1) {\n          inspectNode(object[index], objects, duplicatesIndexes);\n        }\n      } else {\n        objectKeyList = Object.keys(object);\n\n        for (index = 0, length = objectKeyList.length; index < length; index += 1) {\n          inspectNode(object[objectKeyList[index]], objects, duplicatesIndexes);\n        }\n      }\n    }\n  }\n}\n\nfunction dump$1(input, options) {\n  options = options || {};\n\n  var state = new State(options);\n\n  if (!state.noRefs) getDuplicateReferences(input, state);\n\n  var value = input;\n\n  if (state.replacer) {\n    value = state.replacer.call({ '': value }, '', value);\n  }\n\n  if (writeNode(state, 0, value, true, true)) return state.dump + '\\n';\n\n  return '';\n}\n\nvar dump_1 = dump$1;\n\nvar dumper = {\n\tdump: dump_1\n};\n\nfunction renamed(from, to) {\n  return function () {\n    throw new Error('Function yaml.' + from + ' is removed in js-yaml 4. ' +\n      'Use yaml.' + to + ' instead, which is now safe by default.');\n  };\n}\n\n\nvar Type                = type;\nvar Schema              = schema;\nvar FAILSAFE_SCHEMA     = failsafe;\nvar JSON_SCHEMA         = json;\nvar CORE_SCHEMA         = core;\nvar DEFAULT_SCHEMA      = _default;\nvar load                = loader.load;\nvar loadAll             = loader.loadAll;\nvar dump                = dumper.dump;\nvar YAMLException       = exception;\n\n// Re-export all types in case user wants to create custom schema\nvar types = {\n  binary:    binary,\n  float:     float,\n  map:       map,\n  null:      _null,\n  pairs:     pairs,\n  set:       set,\n  timestamp: timestamp,\n  bool:      bool,\n  int:       int,\n  merge:     merge,\n  omap:      omap,\n  seq:       seq,\n  str:       str\n};\n\n// Removed functions from JS-YAML 3.0.x\nvar safeLoad            = renamed('safeLoad', 'load');\nvar safeLoadAll         = renamed('safeLoadAll', 'loadAll');\nvar safeDump            = renamed('safeDump', 'dump');\n\nvar jsYaml = {\n\tType: Type,\n\tSchema: Schema,\n\tFAILSAFE_SCHEMA: FAILSAFE_SCHEMA,\n\tJSON_SCHEMA: JSON_SCHEMA,\n\tCORE_SCHEMA: CORE_SCHEMA,\n\tDEFAULT_SCHEMA: DEFAULT_SCHEMA,\n\tload: load,\n\tloadAll: loadAll,\n\tdump: dump,\n\tYAMLException: YAMLException,\n\ttypes: types,\n\tsafeLoad: safeLoad,\n\tsafeLoadAll: safeLoadAll,\n\tsafeDump: safeDump\n};\n\nexport default jsYaml;\nexport { CORE_SCHEMA, DEFAULT_SCHEMA, FAILSAFE_SCHEMA, JSON_SCHEMA, Schema, Type, YAMLException, dump, load, loadAll, safeDump, safeLoad, safeLoadAll, types };\n"],
  "mappings": "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AA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAsyB5B,KAAK,cAAgB,KAAK,WAAW,cAAc,gBAAgB,EACnE,GAAI,EAAEmC,EAAA,KAAK,kCAAL,MAAAA,EAAA,UAA0C,MAAQ,CAAC,CACzD,KAAK,UAAgB,KAAK,WAAW,cAAc,aAAa,EAChE,KAAK,UAAgB,KAAK,WAAW,cAAc,YAAY,EAC/D,KAAK,QAAgB,KAAK,WAAW,cAAc,UAAU,EAC7D,KAAK,YAAgB,KAAK,WAAW,cAAc,cAAc,EACjE,KAAK,WAAgB,KAAK,WAAW,cAAc,aAAa,EAChE,KAAK,UAAgB,KAAK,WAAW,cAAc,YAAY,EAC/D,KAAK,UAAgB,KAAK,WAAW,cAAc,YAAY,EAC/D,KAAK,WAAgB,KAAK,WAAW,cAAc,aAAa,EAChE,KAAK,eAAgB,KAAK,WAAW,cAAc,iBAAiB,EAEpE,KAAK,QAAe,KAAK,WAAW,cAAc,UAAU,EAC5D,KAAK,SAAe,KAAK,WAAW,cAAc,WAAW,EAC7D,KAAK,YAAe,KAAK,WAAW,cAAc,cAAc,EAChE,KAAK,QAAe,KAAK,WAAW,cAAc,UAAU,EAC5D,KAAK,OAAe,KAAK,WAAW,cAAc,WAAW,EAC7D,GAAI,CAAE,KAAK,YAAY,EAAG,KAAK,gBAAgB,CAAG,MAAQ,CAAC,CAG3D,KAAK,eAAe,EAEpB,KAAK,UAAU,iBAAiB,QAAS,IAAM,CACxC,KAAK,UAAU,KAAK,gBAAgB,EAAI,EAC7C,KAAK,iBAAiB,CACxB,CAAC,EACD,KAAK,UAAU,iBAAiB,QAAS,IAAM,KAAK,aAAa,EAAI,CAAC,EACtE,KAAK,QAAQ,iBAAiB,QAAS,IAAM,KAAK,iBAAiB,CAAC,EACpE,KAAK,YAAY,iBAAiB,QAAS,IAAM,KAAK,gBAAgB,EAAK,CAAC,EAC5E,KAAK,UAAU,iBAAiB,QAAS,IAAM,KAAK,cAAc,CAAC,EACnE,KAAK,UAAU,iBAAiB,QAAS,IAAM,KAAK,cAAc,CAAC,EACnE,KAAK,eAAe,iBAAiB,QAAS,IAAM,KAAK,YAAY,EAAK,CAAC,EAGvE,KAAK,SAAS,KAAK,QAAQ,iBAAiB,QAAS,IAAM,KAAK,eAAe,CAAC,EAChF,KAAK,UAAU,KAAK,SAAS,iBAAiB,QAAS,IAAM,KAAK,gBAAgB,CAAC,EAGnF,KAAK,aAAa,KAAK,YAAY,iBAAiB,QAAS,IAAM,KAAK,uBAAuB,CAAC,EAEnG,OAAO,iBAAiB,UAAYhK,GAAM,CAjvEjD,IAAAL,EAkvES,GAAK,KAAK,SAMf,KALUK,EAAE,SAAWA,EAAE,WAAaA,EAAE,MAAQ,KAAOA,EAAE,MAAQ,OAC1DA,EAAE,eAAe,EACjB,KAAK,YAAY,EAAK,GAGzB,CAAC,KAAK,gBAAkB,KAAK,gBAAiB,CAChD,KAAK,eAAiB,IAAI,eAAe,IAAG,CAzvElD,IAAAL,EAyvEqD,OAAAA,EAAA,KAAK,kBAAL,YAAAA,EAAA,WAAwB,EACvE,GAAI,CAAE,KAAK,eAAe,QAAQ,IAAI,CAAG,MAAQ,CAAC,CAClD,GAAI,CAAE,KAAK,eAAe,QAAQ,KAAK,aAAa,CAAG,MAAQ,CAAC,CAChE,GAAI,CAAM,KAAK,eAAe,KAAK,eAAe,QAAQ,KAAK,aAAa,CAAG,MAAQ,CAAC,CACxF,GAAI,CAAM,KAAK,cAAc,KAAK,eAAe,QAAQ,KAAK,YAAY,CAAG,MAAQ,CAAC,CACtF,OAAO,iBAAiB,SAAU,KAAK,iBAAmB,IAAG,CA9vEnE,IAAAA,EA8vEsE,OAAAA,EAAA,KAAK,kBAAL,YAAAA,EAAA,WAAwB,CAC1F,EAEAA,EAAA,KAAK,kBAAL,MAAAA,EAAA,WAEG,CAAC,EAEF,KAAK,WAAW,iBAAiB,QAAS,IACxC,OAAO,KAAK,2BAA4B,SAAU,qBAAqB,CACzE,EAGA,KAAK,gCAAgC,EAAI,GACzCsK,EAAA,KAAK,kBAAL,MAAAA,EAAA,WAEA,KAAK,6BAA6B,GAClCC,EAAA,KAAK,mBAAL,MAAAA,EAAA,WAEA,OAAO,iBAAiB,UAAYlK,GAAI,CAhxE9C,IAAAL,EAgxEoDK,EAAE,MAAQ,UAAY,KAAK,UAAU,KAAK,gBAAgB,EAAK,EAE1G,KAAK,iBACR,KAAK,eAAiB,IAAI,eAAe,IAAG,CAnxElD,IAAAL,EAmxEqD,OAAAA,EAAA,KAAK,kBAAL,YAAAA,EAAA,WAAwB,EACvE,KAAK,eAAe,QAAQ,IAAI,EAChC,KAAK,eAAe,QAAQ,KAAK,aAAa,EAC9C,OAAO,iBAAiB,SAAU,KAAK,iBAAmB,IAAG,CAtxEnE,IAAAA,EAsxEsE,OAAAA,EAAA,KAAK,kBAAL,YAAAA,EAAA,WAAwB,IAG1FA,EAAA,KAAK,kBAAL,MAAAA,EAAA,UACH,CAAC,EAGI,KAAK,yBAAyB,EAC9B,KAAK,cAAc,iBAAiB,YAAcK,GAAM,CACjD,KAAK,WACNA,EAAE,OAAO,QAAQ,eAAe,GAChC,CAACA,EAAE,UAAY,CAACA,EAAE,SAAW,CAACA,EAAE,SAAS,KAAK,gBAAgB,EACpE,CAAC,CACH,CAIA,GAAI,CAAO,KAAK,qBAAqB,GAAG,KAAK,WAAW,eAAe,CAAG,MAAQ,CAAC,CAEnF,KAAK,kBAAkB,EACnB,KAAK,eAAe,KAAK,gBAAgB,EAAK,EAKlD,KAAK,WAAa,GACdsK,GAAc,KAAK,SACrB,KAAK,aAAa,EAAI,EACb,CAAC,KAAK,UAAY,KAAK,UAChC,KAAK,SAAW,GAChB,KAAK,aAAa,IAElB,KAAK,gCAAgC,EAAI,GACzCH,EAAA,KAAK,kBAAL,MAAAA,EAAA,WACA,KAAK,iBAAiB,EAE1B,CAEA,mBAAoB,CA5zEtB,IAAAxK,EAAAsB,EA6zEI,GAAI,EAAEtB,EAAA,KAAK,4BAAL,MAAAA,EAAA,UAAoC,MAAQ,CAAC,CAgBvD,GAfS,KAAK,oBAAqB,KAAK,aAAgBK,GAAI,KAAK,YAAYA,CAAC,EAAG,OAAO,iBAAiB,UAAW,KAAK,YAAY,EAAG,KAAK,kBAAoB,IACxJ,KAAK,kBACR,KAAK,gBAAkB,IAAM,KAAK,gBAAgB,EAAK,GAEzD,OAAO,iBAAiB,WAAY,KAAK,eAAe,EACxD,OAAO,iBAAiB,eAAgB,KAAK,eAAe,EAE5D,KAAK,QAAU,IAAM,CAAM,SAAS,kBAAoB,UAAU,KAAK,gBAAgB,EAAK,CAAG,EAC/F,SAAS,iBAAiB,mBAAoB,KAAK,OAAO,EAG1D,KAAK,gBAAgB,EAAK,EAI1B,CAAC,KAAK,SAAU,CAClB,IAAMuK,EAAK,IAAI,qBAAsBC,GAAY,CAC3CA,EAAQ,KAAKxK,GAAKA,EAAE,cAAc,GACpC,sBAAsB,IAAM,KAAK,iBAAmB,KAAK,gBAAgB,CAAC,CAE9E,EAAG,CAAE,KAAM,KAAM,UAAW,CAAE,CAAC,EAC/BuK,EAAG,QAAQ,IAAI,EACf,KAAK,SAAWA,CAClB,CAGA,KAAK,iBAAmB,KAAK,mBAAqB,IAAM,KAAK,iBAAmB,KAAK,gBAAgB,GACrG,OAAO,iBAAiB,SAAU,KAAK,gBAAgB,EAEnD,GAAI,EAAEtJ,EAAA,KAAK,4BAAL,MAAAA,EAAA,UAAoC,MAAQ,CAAC,CACvD,CAEE,sBAAuB,CA91EzB,IAAAtB,EAAAsB,EAAAc,EAAAC,EAAAC,EA+1EI,GAAI,EAAEtC,EAAA,KAAK,qBAAL,MAAAA,EAAA,UAA0B,KAAOsB,EAAA,KAAK,sBAAL,MAAAA,EAAA,UAA2B,GAAO,MAAQ,CAAC,CAClF,GAAI,EAAEc,EAAA,KAAK,4BAAL,MAAAA,EAAA,UAAoC,MAAQ,CAAC,CAC/C,KAAK,mBAAqB,KAAK,eAAgB,OAAO,oBAAoB,UAAW,KAAK,YAAY,EAAG,KAAK,kBAAoB,GAAO,KAAK,aAAe,MAC5J,KAAK,oBAAqB,KAAK,aAAgB/B,GAAI,KAAK,YAAYA,CAAC,EAAG,OAAO,iBAAiB,UAAW,KAAK,YAAY,EAAG,KAAK,kBAAoB,IAC7J,OAAO,oBAAoB,WAAY,KAAK,eAAe,EAC3D,OAAO,oBAAoB,eAAgB,KAAK,eAAe,EAC/D,SAAS,oBAAoB,mBAAoB,KAAK,OAAO,EAG7D,GAAI,EAAEgC,EAAA,KAAK,iBAAL,MAAAA,EAAqB,YAAc,MAAQ,CAAC,CAalD,GAZA,KAAK,eAAiB,MAGtBC,EAAA,KAAK,kBAAL,MAAAA,EAAA,WAGI,KAAK,mBACP,OAAO,oBAAoB,SAAU,KAAK,gBAAgB,EAC1D,KAAK,iBAAmB,MAItB,KAAK,eAAiB,KAAK,aAAc,CAC3C,IAAMQ,EAAO,KAAK,cAClBA,GAAA,MAAAA,EAAM,oBAAoB,YAAa,KAAK,aAAa,WACzD,OAAO,oBAAoB,YAAa,KAAK,aAAa,SAAS,EACnE,OAAO,oBAAoB,UAAW,KAAK,aAAa,OAAO,EAC/D,OAAO,oBAAoB,cAAe,KAAK,aAAa,WAAW,EACvEA,GAAA,MAAAA,EAAM,oBAAoB,aAAc,KAAK,aAAa,YAC1D,OAAO,oBAAoB,YAAa,KAAK,aAAa,SAAS,EACnE,OAAO,oBAAoB,WAAY,KAAK,aAAa,QAAQ,EACjE,OAAO,oBAAoB,cAAe,KAAK,aAAa,WAAW,EACvE,KAAK,cAAgB,GACrB,KAAK,aAAe,IACtB,CAGJ,GAAI,CAAE,KAAK,UAAY,KAAK,SAAS,WAAW,CAAG,MAAW,CAAC,CAC/D,KAAK,SAAW,KACZ,KAAK,kBACP,OAAO,oBAAoB,SAAU,KAAK,gBAAgB,EAGxD,GAAI,CACE,KAAK,gBACP,KAAK,oBAAoB,cAAe,KAAK,kBAAkB,EAC/D,KAAK,oBAAoB,cAAe,KAAK,kBAAkB,EAC/D,OAAO,oBAAoB,YAAa,KAAK,gBAAgB,EAC7D,OAAO,oBAAoB,gBAAiB,KAAK,gBAAgB,EACjE,KAAK,cAAgB,GAEzB,MAAQ,CAAC,CACb,CAGE,IAAI,KAAKS,EAAM,CAt5EjB,IAAAvD,EAu5EI,KAAK,MAAQuD,EACbhE,GAAI,UAAU,EACV,CAAC,KAAK,UAAYgE,IACpB,KAAK,SAAW,GAChB,KAAK,cAAc,EAAE,KAAK,IAAM,CAC9B,KAAK,SAAW,GACZ,CAAC,KAAK,UAAY,KAAK,aACzB,KAAK,SAAW,GAChB,KAAK,aAAa,EAAI,EAE1B,CAAC,GAGH,IAAMc,IAAQrE,EAAA,KAAK,gBAAL,YAAAA,EAAoB,WAAY,CAAC,EAC/C,QAAWuE,KAAQF,EAAO,CACxB,IAAMrD,EAAIuD,EAAK,kBACXvD,GAAKA,EAAE,OAASuC,IAClBvC,EAAE,KAAOuC,EAGb,CAKA,GAAI,CAAE,KAAK,kBAAkB,CAAG,MAAQ,CAAC,CAC3C,CAEA,IAAI,MAAO,CAAE,OAAO,KAAK,KAAO,CAGhC,MAAM,aAAauH,EAAQ,GAAO,CAt7EpC,IAAA9K,EAAAsB,EAAAc,EAAAC,EAAAC,EAAAmC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAO,EAAAC,EAAA0E,EAAAC,EAAAC,EAAAC,EAw7EI,GAAI,MAAK,UACT,MAAK,UAAY,GAEjB,GAAI,CAEF,KAAK,SAAW,GAEZY,GAAS,KAAK,gBAChB,KAAK,cAAc,UAAY,IAGjC,KAAK,SAAS,OAAQ,qBAAsB,CAAE,MAAAA,CAAM,CAAC,EAErD,IAAMC,EAAiB,CAAC,EACpBC,EAAQ,KAGZ,GAAI,KAAK,YAAc,KAAK,WAC1B,GAAI,CACFA,EAAQ,MAAM,KAAK,uBAAuB,KAAK,UAAU,CAC3D,OAAS3K,EAAG,CACV,KAAK,SAAS,OAAQ,sBAAuB,CAAE,MAAO,OAAOA,CAAC,CAAE,CAAC,CACnE,CAIF,GAAI,CAAC2K,GAAS,KAAK,WAAY,CAC7B,IAAIC,EAAQ,KACZ,GAAI,CACFA,EAAQ,KAAK,MAAM,aAAa,QAAQ,aAAa,KAAK,UAAU,EAAE,GAAK,MAAM,CACnF,MAAQ,CAAC,CACT,GAAIA,EAGF,GAFA,KAAK,SAAS,OAAQ,uBAAwB,CAAE,MAAO,KAAK,UAAUA,CAAK,EAAE,MAAO,CAAC,EAEjF,KAAK,WACP,GAAI,CACF,MAAM,KAAK,qBAAqB,KAAK,WAAYA,CAAK,EACtD,KAAK,SAAS,OAAQ,2BAA2B,EACjDD,EAAQC,CACV,OAAS5K,EAAG,CACV,KAAK,SAAS,OAAQ,kCAAmC,CAAE,MAAO,OAAOA,CAAC,CAAE,CAAC,EAC7E2K,EAAQC,CACV,MAEAD,EAAQC,CAGd,CAGI,CAACD,KAAS1J,GAAAtB,EAAA,KAAK,UAAL,YAAAA,EAAc,QAAd,MAAAsB,EAAqB,UACjC,KAAK,SAAS,OAAQ,uBAAuB,EAC7C0J,EAAQ,CAAE,MAAO,KAAK,QAAQ,KAAM,GAItC,IAAME,EAAU,CAAE,GAAI,KAAK,SAAW,CAAC,CAAG,EAGxC,GAAIF,GAAA,MAAAA,EAAO,QAAS,CAClB,GAAM,CAAE,YAAAG,EAAa,GAAGC,CAAU,EAAIJ,EAAM,QAC5C,KAAK,sBAAsBI,EAAW,EAAI,CAC5C,MAAW,OAAOJ,GAAA,YAAAA,EAAO,OAAS,UAClC,KAAK,sBAAsB,CAAE,KAAMA,EAAM,IAAK,EAAG,EAAI,EAIvD,IAAMK,EAAe,CACnB,cAAc,OAAO,iBAAiB,YAAY,qBAClD,uBAAuB,kBAAkB,QAAQ,kBACjD,sBAAsB,wBAAwB,yBAC9C,mBAAmB,+BAA+B,OAAO,gBAAgB,cAAc,wBAAyB,mBAClH,EACMC,EAAU,CAAC,EACjB,QAAWC,KAAKF,EACVH,EAAQK,CAAC,IAAM,SAAWD,EAAQC,CAAC,EAAIL,EAAQK,CAAC,GAElD,OAAO,KAAKD,CAAO,EAAE,QACvB,KAAK,sBAAsBA,EAAS,EAAI,EAI1C,IAAIE,EAAW,GAEf,IAAIpJ,EAAA4I,GAAA,YAAAA,EAAO,QAAP,MAAA5I,EAAc,OAAQ,CACxB,QAAWqJ,KAAQT,EAAM,MAAO,CAC9B,GAAI,EAACS,GAAA,MAAAA,EAAM,OAAS,OAAOA,EAAK,MAAS,UAAY,OAAO,KAAKA,EAAK,IAAI,EAAE,SAAW,EAAI,CAEzF,IAAMlH,EAAO,KAAK,qBAChBlC,EAAAoJ,EAAK,WAAL,YAAApJ,EAAe,IAAK,IACpBC,EAAAmJ,EAAK,WAAL,YAAAnJ,EAAe,IAAK,IACpBmC,EAAAgH,EAAK,OAAL,YAAAhH,EAAW,QAAU,MACrBC,EAAA+G,EAAK,OAAL,YAAA/G,EAAW,SAAU,GACvB,EACA,KAAK,cAAc,YAAYH,CAAI,EACnC,GAAI,CAAE,KAAK,aAAaA,EAAK,iBAAiB,CAAG,MAAQ,CAAC,CAC1DiH,EAAW,GACX,QACF,CAEA,IAAME,EAAS,MAAM,KAAK,YAAYD,EAAK,IAAI,EACzClH,EAAO,KAAK,aAAamH,CAAM,EACjC,KAAK,UAAUnH,EAAK,UAAU,IAAI,SAAS,EAC/CA,EAAK,QAAQ,MAAQ,KAAK,gBAAgBkH,EAAK,OAASA,EAAK,QAAU,KAAK,UAAU,EAEtF,KAAK,iBAAiBlH,IAAMI,EAAA8G,EAAK,WAAL,YAAA9G,EAAe,IAAK,IAAGC,EAAA6G,EAAK,WAAL,YAAA7G,EAAe,IAAK,CAAC,EACxEL,EAAK,MAAM,MAAS,IAAGa,GAAAP,EAAA4G,EAAK,OAAL,YAAA5G,EAAW,QAAX,KAAAO,EAAqB,GAAK,KAAK,QAAQ,KAC9Db,EAAK,MAAM,OAAS,IAAGwF,GAAA1E,EAAAoG,EAAK,OAAL,YAAApG,EAAW,SAAX,KAAA0E,EAAqB,GAAK,KAAK,QAAQ,KAC1D0B,EAAK,GAAK,OAAMlH,EAAK,MAAM,OAAS,OAAOkH,EAAK,CAAC,GAErD,KAAK,cAAc,YAAYlH,CAAI,EAEnC,GAAI,CAAE,KAAK,aAAaA,EAAK,iBAAiB,CAAG,MAAQ,CAAC,CAC1D,KAAK,kBAAkBA,CAAI,EAC3BiH,EAAW,EACb,CAEA,KAAK,iBAAiB,GACtBxB,EAAA,KAAK,kBAAL,MAAAA,EAAA,WACA,KAAK,SAAS,OAAQ,iBAAkB,CAAE,MAAOgB,EAAM,MAAM,MAAO,CAAC,CACvE,CAEKQ,IACH,KAAK,sBAAsB,GAC3BvB,EAAA,KAAK,kBAAL,MAAAA,EAAA,WACA,KAAK,SAAS,OAAQ,4CAA4C,GAGpE,KAAK,kBAAkB,EACvB,KAAK,kBAAkB,EAGnBa,IAAO,KAAK,kBAAoB,IACpC,WAAW,IAAM,CACf,KAAK,oBAAoB,CAC3B,EAAG,GAAG,EAGN,GAAI,CACFC,EAAe,QAASxI,GAAO,CAC7B,GAAI,CACFA,EAAG,cAAc,IAAI,MAAM,aAAc,CAAE,QAAS,GAAM,SAAU,EAAK,CAAC,CAAC,CAC7E,MAAQ,CAAC,CACX,CAAC,CACH,MAAQ,CAAC,CACX,QAAE,CACA,KAAK,SAAW,GAChB,KAAK,UAAY,GACjB,KAAK,QAAU,IACf2H,EAAA,KAAK,kBAAL,MAAAA,EAAA,WACA,GAAI,CAAE,KAAK,YAAY,EAAG,KAAK,gBAAgB,CAAG,MAAQ,CAAC,CAG3D,GAAI,CAAE,KAAK,kBAAkB,CAAG,MAAQ,CAAC,CAC3C,EACF,CAKA,gBAAgByB,EAAO,CACrB,IAAMC,EAAQ,MAAM,QAAQ,KAAK,IAAI,EAAI,KAAK,KAAK,IAAItG,GAAKA,EAAE,EAAE,EAAI,CAAC,EACrE,OAAKsG,EAAM,OACHD,GAASC,EAAM,SAASD,CAAK,EAAKA,EAAS,KAAK,YAAcC,EAAM,CAAC,EADnD,KAAK,YAAc,SAE/C,CACA,aAAc,CA7lFhB,IAAA5L,EAAAsB,EAAAc,EA8lFI,IAAMnC,EAAM,KAAK,QAAS,GAAI,CAACA,EAAK,OACpC,IAAM4L,EAAO,MAAM,QAAQ,KAAK,IAAI,EAAI,KAAK,KAAO,CAAC,EACrD,GAAI,CAACA,EAAK,QAAWA,EAAK,SAAW,GAAK,KAAK,mBAAqB,CAClE5L,EAAI,MAAM,QAAU,OACpB,MACF,CACAA,EAAI,MAAM,QAAU,GACpBA,EAAI,UAAY,aAAe,KAAK,eAAiB,OAAS,gBAAkB,IAChFA,EAAI,UAAY,GAChB,QAAWqF,KAAKuG,EAAM,CACpB,IAAM3L,EAAM,SAAS,cAAc,QAAQ,EAC3CA,EAAI,UAAY,WAAaoF,EAAE,KAAO,KAAK,UAAY,UAAY,IACnEpF,EAAI,QAAQ,MAAQoF,EAAE,GACtBpF,EAAI,MAAQoF,EAAE,OAASA,EAAE,GACzBpF,EAAI,UAAY,GAAGoF,EAAE,KAAO,kBAAkBA,EAAE,IAAI,eAAiB,EAAE,gCAA+BtF,EAAAsF,EAAE,QAAF,KAAAtF,EAAWsF,EAAE,EAAE,UACrHpF,EAAI,iBAAiB,QAAS,IAAM,CAClC,GAAI,KAAK,YAAcoF,EAAE,GAAI,CAC3B,KAAK,UAAYA,EAAE,GACnB,GAAI,CAAE,aAAa,QAAQ,eAAe,KAAK,UAAU,GAAIA,EAAE,EAAE,CAAG,MAAQ,CAAC,CAC7E,KAAK,gBAAgB,EACrB,KAAK,YAAY,EAIjB,GAAI,CAAE,KAAK,kBAAkB,CAAG,MAAQ,CAAC,CAC3C,CACF,CAAC,EACDrF,EAAI,YAAYC,CAAG,CACrB,CACI,KAAK,QAAQ,KAAK,OAAO,UAAU,OAAO,uBAAwB,KAAK,eAAiB,MAAM,EAElG,GAAI,EAAEoB,EAAA,KAAK,mBAAL,MAAAA,EAAA,UAA2B,MAAQ,CAAC,CAM1C,GAAI,EAAEc,EAAA,KAAK,kBAAL,MAAAA,EAAA,UAA0B,MAAQ,CAAC,CAC3C,CACA,iBAAkB,CAroFpB,IAAApC,EAAAsB,EAAAc,EAsoFI,IAAM0G,EAAU,KAAK,gBAAgB,KAAK,SAAS,KACrCxH,GAAAtB,EAAA,KAAK,gBAAL,YAAAA,EAAoB,mBAApB,YAAAsB,EAAA,KAAAtB,EAAuC,mBAAoB,CAAC,GACpE,QAAQmF,GAAK,CAxoFvB,IAAAnF,EAyoFM,IAAM2L,EAAQxG,EAAE,QAAQ,MAAQ,KAAK,gBAAgBA,EAAE,QAAQ,KAAK,EAAI,KAAK,WAC7E,GAAI,CAAC,KAAK,MAAQ,CAAC,KAAK,KAAK,OAAQ,CACnCA,EAAE,MAAM,QAAU,GAClBA,EAAE,MAAQ,GACVA,EAAE,UAAU,OAAO,YAAY,EAC/B,MACF,CACIwG,IAAU7C,GACZ3D,EAAE,MAAM,QAAU,GAClBA,EAAE,MAAQ,GACVA,EAAE,UAAU,OAAO,YAAY,IAE/BA,EAAE,MAAM,QAAU,OAClBA,EAAE,MAAQ,GACVA,EAAE,UAAU,IAAI,YAAY,EAC5BA,EAAE,UAAU,OAAO,cAAc,GAGrCnF,EAAA,KAAK,kBAAL,MAAAA,EAAA,WAEA,CAAC,EACD,GAAI,CAAE,KAAK,gBAAgB,CAAG,MAAQ,CAAC,CAEvC,GAAI,CACE,KAAK,gBACPoC,EAAA,KAAK,gBAAL,MAAAA,EAAA,WAEJ,MAAQ,CAAC,CACX,CAUA,eAAgB,CA/qFlB,IAAApC,EAAAsB,EAgrFI,GAAI,IACYA,GAAAtB,EAAA,KAAK,gBAAL,YAAAA,EAAoB,mBAApB,YAAAsB,EAAA,KAAAtB,EAAuC,mBAAoB,CAAC,GACpE,QAASmF,GAAM,CAEnB,IAAM2G,EAAQ,OAAO,iBAAmB,OAAO,iBAAiB3G,CAAC,EAAI,KAErE,GADkBA,EAAE,MAAM,UAAY,QAAY2G,GAASA,EAAM,UAAY,QAAW3G,EAAE,UAAU,SAAS,YAAY,EAC3G,OAEd,IAAM4G,EAAW,OAAO,iBAAiB5G,CAAC,EACpC6G,EAAoBD,GAAYA,EAAS,WAAaA,EAAS,YAAc,OAAUA,EAAS,UAAY,GAI5GE,EAAS,CACb,CAAE,QAAS,EAAG,UAAW,GAAGD,CAAgB,mBAAoB,EAChE,CAAE,QAAS,EAAG,UAAW,GAAGA,CAAgB,EAAG,CACjD,EAGA,GAAI,CACF7G,EAAE,QAAQ8G,EAAQ,CAChB,SAAU,IACV,OAAQ,+BACR,KAAM,MACR,CAAC,CACH,MAAQ,CAEN9G,EAAE,MAAM,QAAU,IAClB,sBAAsB,IAAM,CAC1BA,EAAE,MAAM,WAAa,mBACrBA,EAAE,MAAM,QAAU,GACpB,CAAC,CACH,CACF,CAAC,CACH,OAAS9E,EAAG,CAEV,QAAQ,KAAK,gCAAiCA,CAAC,CACjD,CACF,CACA,sBAAsB6L,EAASC,EAAa,KAAM,CAChD,GAAI,CAAC,KAAK,MAAQ,CAAC,KAAK,KAAK,OAAQ,OACrC,IAAMC,EAAOF,EAAQ,cAAc,OAAO,EAAG,GAAI,CAACE,EAAM,OACxD,IAAIlH,EAAMkH,EAAK,cAAc,qBAAqB,EAC7ClH,IACHA,EAAM,SAAS,cAAc,QAAQ,EACrCA,EAAI,UAAY,eAChBA,EAAI,MAAM,WAAa,MACvBA,EAAI,MAAQ,gBACZkH,EAAK,YAAYlH,CAAG,GAEtBA,EAAI,UAAY,GAChB,QAAWI,KAAK,KAAK,KAAM,CACzB,IAAM+G,EAAM,SAAS,cAAc,QAAQ,EAC3CA,EAAI,MAAQ/G,EAAE,GAAI+G,EAAI,YAAc/G,EAAE,OAASA,EAAE,GACjDJ,EAAI,YAAYmH,CAAG,CACrB,CACA,IAAMC,EAAM,KAAK,gBAAgBH,GAAcD,EAAQ,QAAQ,OAAS,KAAK,WAAa,KAAK,UAAU,EACzGhH,EAAI,MAAQoH,EACZJ,EAAQ,QAAQ,MAAQI,EACxBpH,EAAI,SAAW,IAAM,CACnBgH,EAAQ,QAAQ,MAAQ,KAAK,gBAAgBhH,EAAI,KAAK,EACtD,KAAK,gBAAgB,EAErB,GAAI,CAAE,KAAK,kBAAkB,CAAG,MAAQ,CAAC,CACzC,GAAI,CAAE,KAAK,WAAW,YAAY,CAAG,MAAQ,CAAC,CAChD,CACF,CAEA,gBAAgB4F,EAAM,KAAM,CApvF9B,IAAA9K,EAAAsB,EAAAc,EAAAC,EAAAC,EAsvFI,GAAI,EAAEtC,EAAA,KAAK,oBAAL,MAAAA,EAAA,UAA4B,MAAQ,CAAC,CAC3C,IAAMuM,EAAYzB,IAAU,KAAQ,CAAC,KAAK,SAAW,CAAC,CAACA,EACjD0B,EAAS,CAAC,KAAK,UAAYD,EAyCjC,GAvCA,KAAK,SAAWA,EAEhB,KAAK,SAAWA,EAChB,KAAK,UAAU,MAAM,QAAY,KAAK,SAAW,eAAiB,OAClE,KAAK,UAAU,MAAM,QAAY,KAAK,SAAW,eAAiB,OAClE,KAAK,QAAQ,MAAM,QAAc,KAAK,SAAW,eAAiB,OAClE,KAAK,YAAY,MAAM,QAAU,KAAK,SAAW,eAAiB,OAClE,KAAK,UAAU,MAAM,QAAY,KAAK,SAAW,eAAiB,OAClE,KAAK,UAAU,MAAM,QAAY,KAAK,SAAW,eAAiB,OAClE,KAAK,WAAW,MAAM,QAAW,KAAK,SAAW,eAAiB,OAClE,KAAK,WAAW,MAAM,QAAW,KAAK,SAAW,eAAiB,OAClE,KAAK,eAAe,MAAM,QAAU,KAAK,SAAW,eAAiB,OAEjE,KAAK,UAAU,KAAK,QAAQ,MAAM,QAAW,KAAK,SAAW,eAAiB,QAC9E,KAAK,WAAU,KAAK,SAAS,MAAM,QAAU,KAAK,SAAW,eAAiB,QAC9E,KAAK,cAAa,KAAK,YAAY,MAAM,QAAU,KAAK,SAAW,eAAiB,QACxF,KAAK,kBAAkB,EAEvB,KAAK,cAAc,UAAU,OAAO,UAAW,KAAK,QAAQ,EAE9C,KAAK,cAAc,iBAAiB,eAAe,EAC3D,QAASpH,GAAM,CACnBA,EAAE,UAAU,OAAO,UAAW,KAAK,QAAQ,EAC3C,IAAMsH,EAAStH,EAAE,cAAc,gBAAgB,EAC3CsH,IAAQA,EAAO,MAAM,QAAU,KAAK,SAAW,OAAS,QACxD,CAACtH,EAAE,QAAQ,aAAe,OAAO,UACnC,OAAO,SAASA,CAAC,EAAE,UAAU,KAAK,QAAQ,EAAE,UAAU,KAAK,QAAQ,EAErEA,EAAE,MAAM,YAAc,KAAK,SAAW,OAAS,MACjD,CAAC,EACI,KAAK,UAAU,KAAK,gBAAgB,EAEpC,KAAK,WAER7D,EAAA,KAAK,gBAAL,MAAAA,EAAoB,iBAAiB,0BAClC,QAAQ6D,GAAKA,EAAE,UAAU,OAAO,UAAU,GAI3CqH,EAAQ,CAEV,IAAME,GAAKtK,EAAA,KAAK,cAAL,KAAAA,EAAoB,KACzBuK,GAAKtK,EAAA,KAAK,cAAL,KAAAA,EAAoB,KAC/B,KAAK,gBAAgBqK,EAAIC,CAAE,CAC7B,CAEA,GAAI,EAAErK,EAAA,KAAK,4BAAL,MAAAA,EAAA,UAAoC,MAAQ,CAAC,CACrD,CAEA,sBAAuB,CAErB,IAAI,EAAI,KACR,KAAO,GAAG,CACR,IAAMuE,EAAO,EAAE,WAAa,GAAK,EAAE,UAAa,EAAE,UAAU,YAAY,EAAI,GAE5E,GADIA,IAAQ,mBAAqBA,IAAQ,wBAA0BA,IAAQ,oBACvEA,IAAQ,aAAeA,IAAQ,aAAc,MAAO,GACxD,IAAMM,EAAO,EAAE,aAAe,EAAE,YAAY,EAC5C,EAAI,EAAE,eAAkBA,GAAQA,EAAK,MAAS,IAChD,CACA,MAAO,EACT,CAMF,8BAA+B,CAC7B,GAAI,KAAK,cAAe,OACxB,KAAK,cAAgB,GAErB,IAAMrE,EAAO,KAAK,cAClB,GAAI,CAACA,EAAM,OAGX,IAAM8J,EAAW,IACXC,EAAW,GAGXC,EAAU9F,GAAM,CAAC,CAACA,GAAK,OAAOA,GAAM,UAAYA,EAAE,WAAa,EAC/D+F,EAAe,CAAC5F,EAAMtF,IAAS,CACnC,GAAI,CAAE,MAAO,CAAC,EAAEsF,GAAQtF,GAAQ,OAAOsF,EAAK,UAAa,YAAc2F,EAAOjL,CAAI,GAAKsF,EAAK,SAAStF,CAAI,EAAI,MACvG,CAAE,MAAO,EAAO,CACxB,EACMmL,EAAUzK,GAAOwK,EAAa,KAAK,cAAexK,CAAE,EAEpD0K,EAAcnG,GAAO,CA/0F7B,IAAA9G,EAAAsB,EAAAc,EAi1FI,IAAMrB,GAAMO,GAAAtB,EAAA8G,EAAG,SAAH,YAAA9G,EAAW,UAAX,YAAAsB,EAAA,KAAAtB,EAAqB,iBACjC,GAAI8M,EAAO/L,CAAG,GAAKiM,EAAOjM,CAAG,GAAK,CAACA,EAAI,UAAU,SAAS,iBAAiB,EAAG,MAAO,GAGrF,IAAMgG,EAAO,OAAOD,EAAG,cAAiB,WAAaA,EAAG,aAAa,EAAI,CAAC,EAC1E,QAAWE,KAAKD,EACd,GAAK+F,EAAO9F,CAAC,GACRgG,EAAOhG,CAAC,IACT5E,EAAA4E,EAAE,YAAF,MAAA5E,EAAa,SAAS,iBAAmB,CAAC4E,EAAE,UAAU,SAAS,iBAAiB,EAAG,MAAO,GAEhG,MAAO,EACT,EAEMkG,EAAW,CAACzH,EAAGC,IAAM,CACzB,IAAMnD,EAAK,SAAS,cAAc,KAAK,EACvCA,EAAG,UAAY,iBACf,SAAS,KAAK,YAAYA,CAAE,EAC5B,OAAO,OAAOA,EAAG,MAAO,CACtB,SAAU,QAAS,KAAM,GAAGkD,CAAC,KAAM,IAAK,GAAGC,CAAC,KAC5C,OAAQ,SAAU,MAAO,OAAQ,OAAQ,OACzC,cAAe,OAAQ,WAAY,QAAS,UAAW,QACvD,OAAQ,wCACV,CAAC,EACDnD,EAAG,UAAY;AAAA;AAAA;AAAA;AAAA;AAAA,cAMf,IAAM4K,EAAK5K,EAAG,cAAc,QAAQ,EAC9B5C,EAAI,GAAIyN,EAAO,EAAI,KAAK,GAAKzN,EACnC,OAAAwN,EAAG,MAAM,gBAAkB,GAAGC,CAAI,GAClCD,EAAG,MAAM,iBAAmB,GAAGC,CAAI,GACnC,sBAAsB,IAAM,CAC1BD,EAAG,MAAM,WAAa,qBAAqBP,CAAO,YAClDO,EAAG,MAAM,iBAAmB,GAC9B,CAAC,EACM,CACL,GAAA5K,EACA,KAAK4D,EAAIC,EAAI,CAAE7D,EAAG,MAAM,KAAO,GAAG4D,CAAE,KAAM5D,EAAG,MAAM,IAAM,GAAG6D,CAAE,IAAM,EACpE,QAAS,CAAE,GAAI,CAAE7D,EAAG,OAAO,CAAG,MAAQ,CAAC,CAAE,CAC3C,CACF,EAGI8K,EAAQ,KACRC,EAAQ,KACRC,EAAS,EAAGC,EAAS,EACrBC,EAAkB,KAEhBC,EAAa,IAAM,CAAML,GAAO,aAAaA,CAAK,EAAGA,EAAQ,KAAMC,GAAA,MAAAA,EAAM,SAAUA,EAAO,IAAM,EACtG,KAAK,kBAAoBI,EAKzB,IAAMC,EAAiBtN,GAAM,CAEvBA,EAAE,cAAgB,SAAWA,EAAE,SAAW,GAC1C,KAAK,qBAAqB,GAG1B,CAAC2M,EAAO3M,EAAE,MAAM,GAAK4M,EAAW5M,CAAC,IAErCoN,EAAkBpN,EAAE,UACpBkN,EAASlN,EAAE,QAASmN,EAASnN,EAAE,QAC/B,KAAK,YAAckN,EAAQ,KAAK,YAAcC,EAG9CF,EAAOJ,EAASK,EAAQC,CAAM,EAE9BH,EAAQ,WAAW,IAAM,CAx5F7B,IAAArN,EAy5FM0N,EAAW,EACX,IAAME,EAAU,CAAC,KAAK,SACtB,KAAK,gBAAgBA,CAAO,GAC5B5N,EAAA,KAAK,SAAL,MAAAA,EAAA,UAAc,aAAa4N,EAAU,UAAY,UAAU,GAC7D,EAAGhB,CAAO,EACZ,EAEMiB,EAAiBxN,GAAM,CACvBgN,GAAS,MAAQhN,EAAE,YAAcoN,IACrCH,GAAA,MAAAA,EAAM,KAAKjN,EAAE,QAASA,EAAE,UACpB,KAAK,IAAIA,EAAE,QAAUkN,CAAM,EAAIV,GAAY,KAAK,IAAIxM,EAAE,QAAUmN,CAAM,EAAIX,IAC5Ea,EAAW,EAEf,EAEMI,EAAuBzN,GAAM,CAC7BA,EAAE,YAAcoN,IACpBC,EAAW,EACXD,EAAkB,KACpB,EAEMM,EAAiB1N,GAAM,CAE3B,GAAIgN,EAAS,OAAAhN,EAAE,eAAe,EAAGA,EAAE,gBAAgB,EAAU,EAC/D,EAEM2N,EAAc3N,GAAM,CAn7F5B,IAAAL,EAq7FI,GADI,KAAK,qBAAqB,GAC1B,CAACgN,EAAO3M,EAAE,MAAM,GAAK4M,EAAW5M,CAAC,EAAG,OACxC,IAAMuN,EAAU,CAAC,KAAK,SACtB,KAAK,gBAAgBA,CAAO,GAC5B5N,EAAA,KAAK,SAAL,MAAAA,EAAA,UAAc,aAAa4N,EAAU,UAAY,UAAU,GAC7D,EAGA9K,EAAK,iBAAiB,cAAe6K,CAAa,EAClD,OAAO,iBAAiB,cAAeE,EAAe,CAAE,QAAS,EAAK,CAAC,EACvE,OAAO,iBAAiB,YAAaC,EAAqB,CAAE,QAAS,EAAK,CAAC,EAC3E,OAAO,iBAAiB,gBAAiBA,EAAqB,CAAE,QAAS,EAAK,CAAC,EAC/E,OAAO,iBAAiB,cAAeC,CAAa,EAEpDjL,EAAK,iBAAiB,WAAYkL,CAAU,EAG5C,KAAK,aAAe,CAAE,cAAAL,EAAe,cAAAE,EAAe,oBAAAC,EAAqB,cAAAC,EAAe,WAAAC,CAAW,CACrG,CAGA,gBAAiB,CACf,IAAMhN,EAAI,KAAK,cACf,OAAKA,EACEA,EAAE,iBAAiB,qCAAqC,EAAE,SAAW,EAD7D,EAEjB,CAEA,mBAAoB,CAElB,IAAMiN,EAAQ,KAAK,eAAe,EAClC,GAAI,KAAK,UAAW,CAClB,IAAM9L,EAAO,KAAK,UAAY8L,EAC9B,KAAK,UAAU,MAAM,QAAU9L,EAAO,eAAiB,OACvD,KAAK,UAAU,UAAU,OAAO,YAAa,CAAC,KAAK,UAAY8L,CAAK,CACtE,CAGA,IAAMC,EAAU3L,GAAOA,IAAOA,EAAG,MAAM,QAAU,KAAK,SAAW,eAAiB,QAClF2L,EAAO,KAAK,SAAS,EACrBA,EAAO,KAAK,OAAO,EACnBA,EAAO,KAAK,WAAW,EACvBA,EAAO,KAAK,SAAS,EACrBA,EAAO,KAAK,SAAS,EACrBA,EAAO,KAAK,UAAU,EACtBA,EAAO,KAAK,UAAU,EACtBA,EAAO,KAAK,cAAc,CAC1B,CAEE,iBAAkB,CACd,KAAK,iBAAgB,KAAK,eAAe,SAAW,CAAC,KAAK,QAChE,CACA,WAAWC,EAAO,GAAI,CAv+FxB,IAAAnO,EAw+FI,KAAK,QAAU,GACf,KAAK,gBAAgB,GACrBA,EAAA,KAAK,WAAL,MAAAA,EAAA,UAAgB,QAAS,eAAgB,CAAE,OAAAmO,CAAO,EACpD,CAEA,gBAAgBC,EAAQ,KAAMC,EAAQ,KAAM,CAC1C,IAAMvL,EAAO,KAAK,cAClB,GAAI,CAACA,EAAM,OACX,IAAMnD,EAAImD,EAAK,sBAAsB,EAC/B2C,EAAI2I,GAAW,KAAQzO,EAAE,KAAOA,EAAE,MAAM,EAAKyO,EAC7C1I,EAAI2I,GAAW,KAAQ1O,EAAE,IAAOA,EAAE,OAAO,EAAK0O,EAC9CC,EAAS7I,EAAI9F,EAAE,KACf4O,EAAS7I,EAAI/F,EAAE,IAEf6O,EAAO,SAAS,cAAc,KAAK,EACzCA,EAAK,UAAY,kBACjBA,EAAK,MAAM,YAAY,UAAW,GAAGF,CAAM,IAAI,EAC/CE,EAAK,MAAM,YAAY,UAAW,GAAGD,CAAM,IAAI,EAC/CzL,EAAK,YAAY0L,CAAI,EACrB,WAAW,IAAKA,EAAK,OAAO,EAAG,GAAG,CACpC,CAGA,eAAgB,CACA,KAAK,cAAc,iBAAiB,eAAe,EAC3D,QAASrJ,GAAM,KAAK,kBAAkBA,CAAC,CAAC,CAChD,CACA,kBAAkBZ,EAAM,CACtB,GAAI,CAAC,OAAO,UAAYA,EAAK,QAAQ,YAAa,OAClD,IAAMO,EAAK,KAAK,SAAU2J,EAAO,CAAC,CAAC,KAAK,aAOlCC,EAAO,CAJO,OAAO,SAAS,UAAU,aAAa,CACzD,YAAa,SACb,QAAS,EACX,CAAC,CACwB,EAIzB,GAAI,KAAK,aAAc,CACrB,IAAMC,EAAW,OAAO,SAAS,SAAS,KAAK,CAAE,EAAG,KAAK,SAAU,EAAG,KAAK,QAAS,CAAC,EACrFD,EAAK,KAAK,OAAO,SAAS,UAAU,KAAK,CACvC,QAAS,CAACC,CAAQ,EAClB,MAAO,IACP,OAAQ,aACV,CAAC,CAAC,CACJ,CAEA,OAAO,SAASpK,CAAI,EAAE,UAAU,CAC9B,QAAS,KAAK,SACd,QAAS,GACT,UAAWmK,EACX,UAAW,CACT,MAAQ5H,GAAO,CAER,KAAK,WAAW,IAAIvC,CAAI,IACvB,EAACuC,GAAA,MAAAA,EAAI,WAAY,EAACA,GAAA,MAAAA,EAAI,UAAW,EAACA,GAAA,MAAAA,EAAI,UAAS,KAAK,gBAAgB,EACxE,KAAK,iBAAiBvC,EAAM,EAAI,GAElC,IAAMgE,EAAQ,MAAM,KAAK,KAAK,UAAU,EACxC,KAAK,YAAc,CACjB,OAAQhE,EACR,QAASgE,EACT,SAAU,IAAI,IAAIA,EAAM,IAAIpD,GAAK,CAACA,EAAG,CACnC,EAAG,WAAWA,EAAE,aAAa,YAAY,CAAC,GAAK,WAAWA,EAAE,aAAa,QAAQ,CAAC,GAAK,EACvF,EAAG,WAAWA,EAAE,aAAa,YAAY,CAAC,GAAK,WAAWA,EAAE,aAAa,QAAQ,CAAC,GAAK,EACvF,EAAG,WAAWA,EAAE,MAAM,KAAK,GAAMA,EAAE,sBAAsB,EAAE,MAC3D,EAAG,WAAWA,EAAE,MAAM,MAAM,GAAKA,EAAE,sBAAsB,EAAE,MAC7D,CAAC,CAAC,CAAC,CACL,EAGA,KAAK,qBAAuB,IAAI,IACV,KAAK,cAAc,iBAAiB,qCAAqC,EACjF,QAAQnE,GAAK,CACzB,IAAMgF,EAAO,WAAWhF,EAAE,aAAa,YAAY,CAAC,GAAK,WAAWA,EAAE,aAAa,QAAQ,CAAC,GAAK,EAC3FiF,EAAO,WAAWjF,EAAE,aAAa,YAAY,CAAC,GAAK,WAAWA,EAAE,aAAa,QAAQ,CAAC,GAAK,EACjG,KAAK,qBAAqB,IAAIA,EAAG,CAAE,EAAGgF,EAAMC,CAAQ,CAAC,CACvD,CAAC,EAEDsC,EAAM,QAAQpD,GAAK,CACjBA,EAAE,UAAU,IAAI,UAAU,EACtBA,EAAE,aAAa,YAAY,IAAM,MACnCA,EAAE,aAAa,aAAcA,EAAE,aAAa,QAAQ,GAAK,GAAG,EAE1DA,EAAE,aAAa,YAAY,IAAM,MACnCA,EAAE,aAAa,aAAcA,EAAE,aAAa,QAAQ,GAAK,GAAG,CAEhE,CAAC,CACH,EAEA,KAAO2B,GAAO,CACZ,GAAI,CAAC,KAAK,YAAa,OACvB,IAAMhC,EAAO,KAAK,SACZ2J,EAAO,CAAC,CAAC,KAAK,aACdG,EAAO,KAAK,YAAY,OACxBC,EAAO,KAAK,YAAY,SAAS,IAAID,CAAI,EAGzCE,GAAY,WAAWF,EAAK,aAAa,YAAY,CAAC,GAAKC,EAAI,GAAK/H,EAAG,GACvEiI,GAAY,WAAWH,EAAK,aAAa,YAAY,CAAC,GAAKC,EAAI,GAAK/H,EAAG,GACvEkI,EAAWF,EAAWD,EAAI,EAC1BI,EAAWF,EAAWF,EAAI,EAG1B9I,EAAW,KAAK,YAAY,QAAQ,IAAIvG,GAAK,CACjD,IAAM+H,EAAK,KAAK,YAAY,SAAS,IAAI/H,CAAC,EACpCwG,EAAQuB,EAAG,EAAIyH,EACf/I,EAAQsB,EAAG,EAAI0H,EACfC,EAAQT,EAAO,KAAK,MAAMzI,EAAOlB,CAAE,EAAIA,EAAKkB,EAC5CmJ,EAAQV,EAAO,KAAK,MAAMxI,EAAOnB,CAAE,EAAIA,EAAKmB,EAClD,MAAO,CAAE,GAAIzG,EAAG,KAAAwG,EAAM,KAAAC,EAAM,MAAAiJ,EAAO,MAAAC,EAAO,EAAG5H,EAAG,EAAG,EAAGA,EAAG,CAAE,CAC7D,CAAC,EAGG,KAAK,gBACP,KAAK,sBAAsBxB,EAAUiJ,EAAQC,EAAQR,EAAM3J,CAAE,EAI/D8J,EAAK,aAAa,aAAc,OAAOE,CAAQ,CAAC,EAChDF,EAAK,aAAa,aAAc,OAAOG,CAAQ,CAAC,EAChD,QAAWK,KAAMrJ,EACfqJ,EAAG,GAAG,aAAa,aAAc,OAAOA,EAAG,IAAI,CAAC,EAChDA,EAAG,GAAG,aAAa,aAAc,OAAOA,EAAG,IAAI,CAAC,EAChD,KAAK,iBAAiBA,EAAG,GAAIA,EAAG,MAAOA,EAAG,KAAK,EAEjD,KAAK,iBAAiB,CACxB,EAEA,IAAMtI,GAAO,CACX,GAAI,CAAC,KAAK,YAAa,OACvB,IAAMhC,EAAK,KAAK,SAGVuK,EAAW,KAAK,YAAY,QAAQ,IAAI,GAAK,CACjD,IAAMrJ,EAAO,WAAW,EAAE,aAAa,YAAY,CAAC,GAAK,WAAW,EAAE,aAAa,QAAQ,CAAC,GAAK,EAC3FC,EAAO,WAAW,EAAE,aAAa,YAAY,CAAC,GAAK,WAAW,EAAE,aAAa,QAAQ,CAAC,GAAK,EAC3FiJ,EAAQ,KAAK,MAAMlJ,EAAOlB,CAAE,EAAIA,EAChCqK,EAAQ,KAAK,MAAMlJ,EAAOnB,CAAE,EAAIA,EAChCK,EAAK,WAAW,EAAE,MAAM,KAAK,GAAM,EAAE,sBAAsB,EAAE,MAC7De,EAAK,WAAW,EAAE,MAAM,MAAM,GAAK,EAAE,sBAAsB,EAAE,OACnE,MAAO,CAAE,GAAI,EAAG,KAAAF,EAAM,KAAAC,EAAM,MAAAiJ,EAAO,MAAAC,EAAO,EAAAhK,EAAG,EAAAe,CAAE,CACjD,CAAC,EAGG,KAAK,gBACP,KAAK,sBAAsBmJ,EAAU,EAAG,EAAG,GAAOvK,CAAE,EAItD,QAAWsK,KAAMC,EACf,KAAK,iBAAiBD,EAAG,GAAIA,EAAG,MAAOA,EAAG,KAAK,EAC/CA,EAAG,GAAG,aAAa,aAAc,OAAOA,EAAG,KAAK,CAAC,EACjDA,EAAG,GAAG,aAAa,aAAc,OAAOA,EAAG,KAAK,CAAC,EAInD,QAAW,KAAK,KAAK,YAAY,QAAS,EAAE,UAAU,OAAO,UAAU,EACvE,KAAK,iBAAiB,EAClB,KAAK,kBAAkB,GAAG,KAAK,qBAAqB,EACxD,KAAK,WAAW,KAAK,YAAY,QAAQ,OAAS,EAAI,iBAAmB,UAAU,EACnF,KAAK,YAAc,KACnB,KAAK,qBAAuB,IAC9B,CACF,CACF,CAAC,EAKD,OAAO,SAAS7K,CAAI,EAAE,UAAU,CAC9B,QAAS,KAAK,SACd,MAAO,CAAE,MAAO,iBAAkB,OAAQ,gBAAiB,EAC3D,QAAQ,GACR,UAAU,CACR,KAAMuC,GAAK,CACT,IAAMhC,EAAO,KAAK,SACZ2J,EAAO,CAAC,CAAC,KAAK,aACda,EAAO,WAAW/K,EAAK,MAAM,KAAK,GAAMA,EAAK,sBAAsB,EAAE,MACrEgL,EAAO,WAAWhL,EAAK,MAAM,MAAM,GAAKA,EAAK,sBAAsB,EAAE,OAEvE,CAAC,MAAAkC,EAAO,OAAA+I,CAAM,EAAI1I,EAAG,KACnB2I,EAAOhB,EAAO,KAAK,IAAI3J,EAAI,KAAK,MAAM2B,EAAM3B,CAAE,EAAEA,CAAE,EAAI2B,EACtDiJ,EAAOjB,EAAO,KAAK,IAAI3J,EAAI,KAAK,MAAM0K,EAAO1K,CAAE,EAAEA,CAAE,EAAI0K,EAEvD/J,EAAI,WAAWlB,EAAK,aAAa,QAAQ,CAAC,GAAK,EAC/CmB,EAAI,WAAWnB,EAAK,aAAa,QAAQ,CAAC,GAAK,EAGjDoL,EAAQF,EACRG,EAAQF,EACZ,GAAI,KAAK,kBAAkB,EAAG,CAC5B,GAAM,CAAE,EAAGxG,EAAI,EAAGC,CAAG,EAAI,KAAK,kBAAkB,EAChDwG,EAAQ,KAAK,IAAIF,EAAM,KAAK,IAAI,KAAK,SAAUvG,EAAKzD,CAAC,CAAC,EACtDmK,EAAQ,KAAK,IAAIF,EAAM,KAAK,IAAI,KAAK,SAAUvG,EAAKzD,CAAC,CAAC,CACxD,CAEA,IAAMK,EAAW,CAAE,KAAK,SAASxB,EAAMkB,EAAGC,EAAGiK,EAAOC,CAAK,CAAE,EAEvD,KAAK,gBAAkB,KAAK,iBAAiB7J,EAAU,IAAI,IAAI,CAACxB,CAAI,CAAC,CAAC,IAG1EA,EAAK,MAAM,MAAS,GAAGoL,CAAK,KAC5BpL,EAAK,MAAM,OAAS,GAAGqL,CAAK,KAC5B,KAAK,iBAAiB,EACxB,EACA,IAAI,IAAI,CACN,IAAM9K,EAAK,KAAK,SACV+K,EAAQ,WAAWtL,EAAK,MAAM,KAAK,GAAMA,EAAK,sBAAsB,EAAE,MACtEuL,EAAQ,WAAWvL,EAAK,MAAM,MAAM,GAAKA,EAAK,sBAAsB,EAAE,OAExEwL,EAAQ,KAAK,IAAIjL,EAAI,KAAK,MAAM+K,EAAM/K,CAAE,EAAEA,CAAE,EAC5CkL,EAAQ,KAAK,IAAIlL,EAAI,KAAK,MAAMgL,EAAMhL,CAAE,EAAEA,CAAE,EAE1CW,EAAI,WAAWlB,EAAK,aAAa,QAAQ,CAAC,GAAK,EAC/CmB,EAAI,WAAWnB,EAAK,aAAa,QAAQ,CAAC,GAAK,EAGrD,GAAI,KAAK,kBAAkB,EAAG,CAC5B,GAAM,CAAE,EAAG2E,EAAI,EAAGC,CAAG,EAAI,KAAK,kBAAkB,EAChD4G,EAAQ,KAAK,IAAIA,EAAO,KAAK,IAAIjL,EAAIoE,EAAKzD,CAAC,CAAC,EAC5CuK,EAAQ,KAAK,IAAIA,EAAO,KAAK,IAAIlL,EAAIqE,EAAKzD,CAAC,CAAC,CAC9C,CAEA,IAAMK,EAAW,CAAE,KAAK,SAASxB,EAAMkB,EAAGC,EAAGqK,EAAOC,CAAK,CAAE,EAEvD,KAAK,gBAAkB,KAAK,iBAAiBjK,EAAU,IAAI,IAAI,CAACxB,CAAI,CAAC,CAAC,IAGxEA,EAAK,MAAM,MAAS,GAAGwL,CAAK,KAC5BxL,EAAK,MAAM,OAAS,GAAGyL,CAAK,MAG9B,KAAK,iBAAiB,EAClB,KAAK,kBAAkB,GAAG,KAAK,qBAAqB,EACxD,KAAK,WAAW,YAAY,CAC9B,CACF,CACF,CAAC,EAGDzL,EAAK,iBAAiB,YAAclE,GAAM,CACnC,KAAK,WAENA,EAAE,OAAO,QAAQ,gBAAgB,GAAKA,EAAE,OAAO,QAAQ,gBAAgB,GAAKA,EAAE,OAAO,QAAQ,OAAO,IACpGA,EAAE,UAAYA,EAAE,SAAWA,EAAE,SAC/BA,EAAE,gBAAgB,EAClB,KAAK,iBAAiBkE,CAAI,GAErB,KAAK,WAAW,IAAIA,CAAI,IAC3B,KAAK,gBAAgB,EACrB,KAAK,iBAAiBA,EAAM,EAAI,IAGtC,CAAC,CACH,CAGA,MAAM,YAAY3B,EAAK,CAErB,IAAML,GADW,MAAM,KAAK,iBAAoB,MAAM,OAAO,gBAAgB,GAC1D,kBAAkBK,CAAG,EAIxC,GAHAL,EAAG,KAAO,KAAK,KAGXK,EAAI,OAAS,oBAEf,MAAM,IAAI,QAAQqN,GAAW,WAAWA,EAAS,CAAC,CAAC,EAG/C1N,EAAG,WAAa,OAAOA,EAAG,WAAc,YAC1C,GAAI,CAEFA,EAAG,UAAUK,CAAG,CAClB,MAAQ,CAAC,CAIb,OAAOL,CACT,CAEA,aAAamJ,EAAQ,CACnB,IAAMnH,EAAO,SAAS,cAAc,KAAK,EACzCA,EAAK,UAAU,IAAI,cAAc,EACjCA,EAAK,QAAQ,MAAQ,KAAK,gBAAgB,KAAK,WAAa,KAAK,UAAU,EACvE,KAAK,UAAUA,EAAK,UAAU,IAAI,SAAS,EAC1CA,EAAK,MAAM,SAAQA,EAAK,MAAM,OAAS,OAAO,KAAK,UAAU,EAAI,CAAC,GAEvE,IAAM6H,EAAO,SAAS,cAAc,KAAK,EACzCA,EAAK,UAAY,OACjBA,EAAK,UAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAyBjB,IAAM8D,EAAY,SAAS,cAAc,KAAK,EAC9CA,EAAU,UAAY,gBACtBA,EAAU,UAAY,6CACtBA,EAAU,iBAAiB,QAAU7P,GAAM,CAvyG/C,IAAAL,EAAAsB,EAwyGMjB,EAAE,gBAAgB,EAGd,KAAK,WAAW,KAAO,GAAK,KAAK,WAAW,IAAIkE,CAAI,GACxC,MAAM,KAAK,KAAK,UAAU,EAClC,QAAQY,GAAKA,EAAE,OAAO,CAAC,EAC7B,KAAK,gBAAgB,EACrB,KAAK,iBAAiB,EACtB,KAAK,WAAW,cAAc,GAC9BnF,EAAA,KAAK,4BAAL,MAAAA,EAAA,aAEAuE,EAAK,OAAO,EACZ,KAAK,iBAAiB,EACtB,KAAK,WAAW,QAAQ,GACxBjD,EAAA,KAAK,4BAAL,MAAAA,EAAA,WAEJ,CAAC,EAGD,GAAI,CAAE,KAAK,sBAAsBiD,EAAMA,EAAK,QAAQ,KAAK,CAAG,MAAQ,CAAC,CAErE6H,EAAK,iBAAiB,QAAS,MAAO/L,GAAM,CA7zGhD,IAAAL,EAAAsB,EAAAc,EAAAC,EAAAC,EA8zGMjC,EAAE,gBAAgB,EAClB,IAAM8P,GAAM/N,GAAAd,GAAAtB,EAAAK,EAAE,SAAF,YAAAL,EAAU,QAAQ,YAAlB,YAAAsB,EAA6B,UAA7B,YAAAc,EAAsC,IAAK,GAAK+N,GAE5D,GAAIA,IAAQ,SACN,KAAK,WAAW,KAAO,GAAK,KAAK,WAAW,IAAI5L,CAAI,GACxC,MAAM,KAAK,KAAK,UAAU,EAClC,QAAQY,GAAKA,EAAE,OAAO,CAAC,EAC7B,KAAK,gBAAgB,EACrB,KAAK,iBAAiB,EAAG,KAAK,WAAW,cAAc,EAAG,KAAK,0BAA0B,IAEzFZ,EAAK,OAAO,EAAG,KAAK,iBAAiB,EAAG,KAAK,WAAW,QAAQ,EAAG,KAAK,0BAA0B,WAE3F4L,IAAQ,aAAeA,IAAQ,OAAQ,CAChD,IAAMC,EAAW,KAAK,WAAW,KAAO,GAAK,KAAK,WAAW,IAAI7L,CAAI,EAAK,MAAM,KAAK,KAAK,UAAU,EAAI,CAACA,CAAI,EAC7G,QAAWe,KAAK8K,EAAS,CACvB,IAAMxN,EAAM,KAAK,mBAAmB0C,EAAE,iBAAiB,GAAK,CAAC,EACvDC,EAAM,MAAM,KAAK,YAAY3C,CAAG,EAChC4C,EAAK,KAAK,aAAaD,CAAG,EAChCC,EAAG,MAAM,MAASF,EAAE,MAAM,MAC1BE,EAAG,MAAM,OAASF,EAAE,MAAM,OAC1B,IAAMG,GAAK,WAAWH,EAAE,aAAa,QAAQ,CAAC,GAAK,GAAK,KAAK,SACvDI,GAAK,WAAWJ,EAAE,aAAa,QAAQ,CAAC,GAAK,GAAK,KAAK,SAC7D,KAAK,iBAAiBE,EAAIC,EAAGC,CAAC,EAC9BF,EAAG,MAAM,OAAS,OAAO,KAAK,UAAU,EAAI,CAAC,EAI7C,GAAI,CACF,IAAMG,GAAMtD,EAAAiD,EAAE,UAAF,YAAAjD,EAAW,MACnBsD,IAAKH,EAAG,QAAQ,MAAQG,EAC9B,MAAQ,CAAC,CACT,KAAK,cAAc,YAAYH,CAAE,EAIjC,GAAI,EAAElD,EAAA,KAAK,wBAAL,MAAAA,EAAA,UAA6BkD,EAAIA,EAAG,QAAQ,MAAQ,MAAQ,CAAC,CACnE,GAAI,CAAE,KAAK,aAAaA,EAAG,iBAAiB,CAAG,MAAQ,CAAC,CACxD,KAAK,kBAAkBA,CAAE,CAC3B,CACA,KAAK,iBAAiB,EACtB,KAAK,WAAW,WAAW,CAC7B,SAAW2K,IAAQ,QAEjB,KAAK,SAAS5L,EAAM,CAAE,UACb4L,IAAQ,OAEjB,KAAK,SAAS5L,EAAM,EAAE,UACb4L,IAAQ,aAAc,CAE/B,IAAMC,EAAW,KAAK,WAAW,KAAO,GAAK,KAAK,WAAW,IAAI7L,CAAI,EAAK,MAAM,KAAK,KAAK,UAAU,EAAI,CAACA,CAAI,EAE7G6L,EAAQ,KAAK,CAAC3Q,EAAGe,IAAM,CACrB,IAAM6P,EAAK,SAAS5Q,EAAE,MAAM,QAAU,IAAK,EAAE,EACvC6Q,EAAK,SAAS9P,EAAE,MAAM,QAAU,IAAK,EAAE,EAC7C,OAAO6P,EAAKC,CACd,CAAC,EACD,IAAIzH,EAAO,KAAK,UAAU,EAC1B,QAAW1D,KAAKiL,EACdvH,GAAQ,EACR1D,EAAE,MAAM,OAAS,OAAO0D,CAAI,EAE9B,KAAK,WAAW,UAAU,CAC5B,SAAWsH,IAAQ,YAAa,CAE9B,IAAMC,EAAW,KAAK,WAAW,KAAO,GAAK,KAAK,WAAW,IAAI7L,CAAI,EAAK,MAAM,KAAK,KAAK,UAAU,EAAI,CAACA,CAAI,EAE7G6L,EAAQ,KAAK,CAAC3Q,EAAGe,IAAM,CACrB,IAAM6P,EAAK,SAAS5Q,EAAE,MAAM,QAAU,IAAK,EAAE,EAE7C,OADW,SAASe,EAAE,MAAM,QAAU,IAAK,EAAE,EACjC6P,CACd,CAAC,EAED,IAAIE,EAAO,IACX,KAAK,cAAc,iBAAiB,eAAe,EAAE,QAAQpL,GAAK,CAChE,IAAMqL,EAAI,SAASrL,EAAE,MAAM,QAAU,IAAK,EAAE,EACxCqL,EAAID,IAAMA,EAAOC,EACvB,CAAC,EACI,SAASD,CAAI,IAAGA,EAAO,GAC5B,IAAIE,EAAUF,EACd,QAAWpL,KAAKiL,EACdK,GAAW,EACXtL,EAAE,MAAM,OAAS,OAAO,KAAK,IAAI,EAAGsL,CAAO,CAAC,EAE9C,KAAK,WAAW,UAAU,CAC5B,SAAWN,IAAQ,OAAQ,CACzB,IAAMvN,EAAM,KAAK,mBAAmB2B,EAAK,iBAAiB,GAAK,CAAC,EAChE,MAAM,KAAK,iBAAiB,OAAQ3B,EAAK,MAAO8N,GAAW,CAp5GnE,IAAA1Q,EAAAsB,EAAAc,EAq5GU,IAAMuO,EAAQpM,EAAK,kBACbqM,EAAQ,MAAM,KAAK,YAAYF,CAAM,EAG3C,GAAI,CACFnM,EAAK,QAAQ,IAAM,KAAK,UAAUmM,CAAM,GACpC1Q,EAAA,KAAK,kBAAL,MAAAA,EAAA,UAAuB0Q,GAASnM,EAAK,QAAQ,aAAe,OAC3D,OAAOA,EAAK,QAAQ,YAC3B,MAAQ,CAAC,CAGTA,EAAK,aAAaqM,EAAOD,CAAK,EAG9B,MAAMjR,GAAI,EACV,GAAI,CAGF,GAFAkR,EAAM,KAAO,KAAK,MAClBtP,EAAAsP,EAAM,gBAAN,MAAAtP,EAAA,KAAAsP,GACIA,EAAM,eAAkB,GAAI,CAAE,MAAMA,EAAM,cAAgB,MAAQ,CAAC,CACzE,MAAQ,CAAC,CAET,GAAI,CAAE,KAAK,aAAaA,CAAK,CAAG,MAAQ,CAAC,CACzC,GAAI,CAAEA,EAAM,cAAc,IAAI,MAAM,aAAc,CAAE,QAAS,GAAM,SAAU,EAAK,CAAC,CAAC,CAAG,MAAQ,CAAC,EAEhGxO,EAAA,KAAK,mBAAL,MAAAA,EAAA,WAGA,GAAI,CACF,aAAa,KAAK,UAAU,EAC5B,MAAM,KAAK,YAAY,EAAI,CAC7B,OAAS/B,EAAG,CAAE,QAAQ,KAAK,4BAA6BA,CAAC,CAAG,CAE5D,OAAO,SAAS,OAAO,CACzB,CAAC,CACH,EACF,CAAC,EAGD,IAAMwQ,EAAS,SAAS,cAAc,KAAK,EAC3CA,EAAO,UAAY,SAGnB,IAAMpE,EAAS,SAAS,cAAc,KAAK,EAC3CA,EAAO,UAAU,IAAI,eAAe,EAC/B,KAAK,WAAUA,EAAO,MAAM,QAAU,QAC3CA,EAAO,MAAQ,SACfA,EAAO,UAAY,qDAGnB,GAAI,CACF,IAAM7J,EAAM8I,EAAO,SAAWA,EAAO,OACjC9I,GAAO,OAAOA,GAAQ,UAAY,OAAO,KAAKA,CAAG,EAAE,SACrD2B,EAAK,QAAQ,IAAM,KAAK,UAAU3B,CAAG,EAGjC,KAAK,gBAAgBA,CAAG,IAAK2B,EAAK,QAAQ,aAAe,QAEjE,MAAQ,CAAC,CAGTA,EAAK,OAAOmH,EAAQmF,EAAQzE,EAAM8D,EAAWzD,CAAM,EAEnD,GAAI,CAAE,KAAK,aAAaf,CAAM,CAAG,MAAQ,CAAC,CAC1C,OAAOnH,CACT,CAEA,mBAAmBkB,EAAE,EAAEC,EAAE,EAAEP,EAAE,IAAIe,EAAE,IAAK,CACtC,IAAM3B,EAAO,SAAS,cAAc,KAAK,EACzCA,EAAK,UAAU,IAAI,eAAe,iBAAiB,EACnDA,EAAK,QAAQ,YAAc,IACvB,KAAK,UAAUA,EAAK,UAAU,IAAI,SAAS,EAC/C,KAAK,iBAAiBA,EAAMkB,EAAGC,CAAC,EAChCnB,EAAK,MAAM,MAAQ,GAAGY,CAAC,KACvBZ,EAAK,MAAM,OAAS,GAAG2B,CAAC,KACxB3B,EAAK,MAAM,OAAS,OAAO,KAAK,UAAU,EAAI,CAAC,EAE/C,IAAMuM,EAAQ,SAAS,cAAc,KAAK,EAC1CA,EAAM,UAAY,wBAElBA,EAAM,aAAa,cAAc,MAAM,EAGvC,IAAMC,EAAO,SAAS,cAAc,KAAK,EACzCA,EAAK,UAAY,WAIjB,IAAMC,EAAa,KAAK,UACxB,GAAIA,EAAY,CACd,IAAMC,EAAM,SAAS,cAAc,KAAK,EACxCA,EAAI,IAAMD,EACVC,EAAI,IAAM,GACVF,EAAK,YAAYE,CAAG,CACtB,CAGA,IAAMC,EAAQ,SAAS,cAAc,KAAK,EAC1CA,EAAM,UAAY,YAClBA,EAAM,YAAc,mBACpB,IAAMlP,EAAM,SAAS,cAAc,KAAK,EACxCA,EAAI,UAAc,UAClBA,EAAI,YAAc,+CAElB+O,EAAK,OAAOG,EAAOlP,CAAG,EACtB8O,EAAM,YAAYC,CAAI,EAGtBxM,EAAK,iBAAiB,WAAalE,GAAM,CACvCA,EAAE,gBAAgB,EAClB,KAAK,gBAAgB,EAAI,CAC3B,CAAC,EAED,IAAMwQ,EAAS,SAAS,cAAc,KAAK,EAC3C,OAAAA,EAAO,UAAY,SAEnBtM,EAAK,OAAOuM,EAAOD,CAAM,EAClBtM,CACT,CAEE,qBAAsB,CA5gH1B,IAAAvE,EA8gHI,GAAI,KAAK,kBAAmB,OAC5B,KAAK,kBAAoB,MAEXA,EAAA,KAAK,gBAAL,YAAAA,EAAoB,iBAAiB,kCAAmC,CAAC,GAEjF,QAAQuE,GAAQ,CACpB,IAAM4M,EAAO5M,EAAK,kBAClB,GAAI,CAAC4M,EAAM,OAEX,IAAMhJ,EAASgJ,EAAK,SAAWA,EAAK,OACpC,GAAKhJ,GAGL,GAAIA,EAAO,OAAS,kBAElB,WAAW,IAAM,CACf,GAAIgJ,EAAK,eACPA,EAAK,eAAe,KAAK,IAAM,CAC7BA,EAAK,cAAc,CACrB,CAAC,UACQA,EAAK,UACd,GAAI,CACFA,EAAK,UAAU,CAAC,GAAGhJ,CAAM,CAAC,CAC5B,MAAQ,CAAC,CAEb,EAAG,GAAG,UACGA,EAAO,UAAYgJ,EAAK,UAEjC,GAAI,CACFA,EAAK,UAAU,CAAC,GAAGhJ,CAAM,CAAC,CAC5B,MAAQ,CAAC,EAEb,CAAC,CACH,CAEA,uBAAwB,CACtB,GAAI,KAAK,cAAc,cAAc,kBAAkB,EAAG,OAC1D,IAAM5B,EAAI,KAAK,mBAAmB,EAAE,EAAE,IAAI,GAAG,EAC7C,KAAK,cAAc,YAAYA,CAAC,EAChC,KAAK,iBAAiB,EACtB,KAAK,kBAAkB,CAEzB,CACA,uBAAwB,CAAE,KAAK,cAAc,iBAAiB,kBAAkB,EAAE,QAAQ,GAAK,EAAE,OAAO,CAAC,CAAG,CAC5G,2BAA4B,CA1jH9B,IAAAvG,EA2jHsB,KAAK,cAAc,iBAAiB,qCAAqC,EAC7E,SAAW,GAAG,KAAK,sBAAsB,GACnDA,EAAA,KAAK,kBAAL,MAAAA,EAAA,WACJ,KAAK,kBAAkB,CACzB,CAEA,SAASuE,EAAM6M,EAAO,CAEpB,IAAIC,EADQ,SAAS9M,EAAK,MAAM,QAAU,IAAK,EAAE,EAChC6M,EACjBC,EAAO,KAAK,IAAI,EAAG,KAAK,IAAI,KAAMA,CAAI,CAAC,EACvC9M,EAAK,MAAM,OAAS,OAAO8M,CAAI,EAC/B,KAAK,WAAW,UAAU,CAC5B,CAEA,WAAY,CACV,IAAIC,EAAM,EACV,YAAK,cAAc,iBAAiB,eAAe,EAAE,QAAQnM,GAAK,CAChE,IAAMqL,EAAI,SAASrL,EAAE,MAAM,QAAU,IAAK,EAAE,EACxCqL,EAAIc,IAAKA,EAAMd,EACrB,CAAC,EACMc,CACT,CAEA,iBAAiB/O,EAAIkD,EAAGC,EAAG,CAEzB,IAAMS,EAAK,KAAK,MAAMV,CAAC,EACjBW,EAAK,KAAK,MAAMV,CAAC,EACvBnD,EAAG,MAAM,UAAY,eAAe4D,CAAE,OAAOC,CAAE,SAC/C7D,EAAG,aAAa,SAAU,OAAO4D,CAAE,CAAC,EACpC5D,EAAG,aAAa,SAAU,OAAO6D,CAAE,CAAC,EACpC7D,EAAG,aAAa,aAAc,OAAO4D,CAAE,CAAC,EACxC5D,EAAG,aAAa,aAAc,OAAO6D,CAAE,CAAC,CAC1C,CAIA,oBAAqB,CACnB,IAAMpF,EAAI,KAAK,cAAe,GAAI,CAACA,EAAG,MAAO,CAAE,EAAG,EAAG,EAAG,CAAE,EAE1D,GAAI,KAAK,kBAAkB,EAAG,CAC5B,GAAM,CAAE,EAAAmE,EAAG,EAAAe,CAAE,EAAI,KAAK,kBAAkB,EACxC,MAAO,CAAE,EAAG,KAAK,IAAI,EAAGf,CAAC,EAAG,EAAG,KAAK,IAAI,EAAGe,CAAC,CAAE,CAChD,CAEA,IAAIqL,EAAO,EAAGC,EAAO,EACf1P,EAAQ,MAAM,KAAKd,EAAE,iBAAiB,eAAe,CAAC,EAC5D,GAAI,CAACc,EAAM,OAAQ,CACjB,IAAM4E,EAAO1F,EAAE,sBAAsB,EACrC,MAAO,CAAE,EAAG,KAAK,IAAI,EAAG0F,EAAK,OAAS,CAAC,EAAG,EAAG,KAAK,IAAI,EAAGA,EAAK,QAAU,CAAC,CAAE,CAC7E,CACA,QAAW+K,KAAO3P,EAAO,CACvB,IAAM2D,EAAI,WAAWgM,EAAI,aAAa,YAAY,GAAKA,EAAI,aAAa,QAAQ,GAAK,GAAG,GAAK,EACvF/L,EAAI,WAAW+L,EAAI,aAAa,YAAY,GAAKA,EAAI,aAAa,QAAQ,GAAK,GAAG,GAAK,EACvFtM,EAAI,WAAWsM,EAAI,MAAM,KAAK,GAAMA,EAAI,sBAAsB,EAAE,OAAU,EAC1EvL,EAAI,WAAWuL,EAAI,MAAM,MAAM,GAAKA,EAAI,sBAAsB,EAAE,QAAU,EAC1EC,EAASjM,EAAIN,EACbwM,EAASjM,EAAIQ,EACfwL,EAASH,IAAMA,EAAOG,GACtBC,EAASH,IAAMA,EAAOG,EAC5B,CAEA,IAAMC,EAAK,KAAK,IAAI,EAAG,KAAK,UAAY,EAAE,EAC1C,OAAAL,EAAO,KAAK,KAAKA,EAAOK,CAAE,EAAIA,EAC9BJ,EAAO,KAAK,KAAKA,EAAOI,CAAE,EAAIA,EACvB,CAAE,EAAG,KAAK,IAAI,EAAGL,CAAI,EAAG,EAAG,KAAK,IAAI,EAAGC,CAAI,CAAE,CACtD,CAIA,kBAAmB,CAEjB,GADI,CAAC,KAAK,iBACN,KAAK,WAAY,OACrB,IAAMK,EAAO,IAAM,CAnoHvB,IAAA7R,EAooHM,GAAI,CAAC,KAAK,gBAAiB,CAAE,KAAK,WAAa,KAAM,MAAQ,CAE7D,IAAM0G,EAAO,KAAK,sBAAsB,EAClCvB,EAAI,KAAK,IAAI,EAAGuB,EAAK,OAAS,CAAC,EACjCvB,IAAM,KAAK,eACb,KAAK,aAAeA,GACpBnF,EAAA,KAAK,kBAAL,MAAAA,EAAA,YAEF,KAAK,WAAa,sBAAsB6R,CAAI,CAC9C,EACA,KAAK,WAAa,sBAAsBA,CAAI,CAC9C,CAEA,iBAAkB,CAChB,GAAI,KAAK,WAAY,CACnB,GAAI,CAAE,qBAAqB,KAAK,UAAU,CAAG,MAAQ,CAAC,CACtD,KAAK,WAAa,IACpB,CACF,CACF,iBAAkB,CAvpHlB,IAAA7R,EAAAsB,EAAAc,EAAAC,EAAAC,EAAAmC,EAAAC,EAAAC,EAAAC,EAAAC,EAwpHE,IAAM7D,EAAI,KAAK,cAAe,GAAI,CAACA,EAAG,OAMtC,GAHI,OAAO,KAAK,qBAAwB,YAAY,KAAK,oBAAoB,EAGzE,CAAC,KAAK,gBAAiB,CAEzB,IAAM8Q,EAAK,OAAO,KAAK,oBAAuB,WAAc,KAAK,mBAAmB,EAAI,CAAE,EAAG9Q,EAAE,aAAe,EAAG,EAAGA,EAAE,cAAgB,CAAE,EAQxI,GAPAA,EAAE,MAAM,MAAS,GAAG8Q,EAAE,CAAC,KACvB9Q,EAAE,MAAM,OAAS,GAAG8Q,EAAE,CAAC,KACvB9Q,EAAE,MAAM,UAAY,WACpBA,EAAE,MAAM,gBAAkB,WAC1BA,EAAE,MAAM,SAAW,WACnBA,EAAE,MAAM,IAAM,IACdA,EAAE,MAAM,KAAO,IACX,KAAK,aAAc,CAErB,IAAM+Q,EAAM,KAAK,iBAAiBzQ,GAAAtB,EAAA,KAAK,eAAc,wBAAnB,YAAAsB,EAAA,KAAAtB,GAA6C,QACnE,KAAK,gBAAgBqC,GAAAD,EAAA,KAAK,cAAa,wBAAlB,YAAAC,EAAA,KAAAD,GAA4C,QACjE,KAAK,uBAAyB,KAAK,sBAAsB,EAAE,OAC5D,KAAK,aAAe0P,EAAE,EACjC,KAAK,aAAa,MAAM,MAAS,GAAG,KAAK,IAAI,EAAGC,CAAE,CAAC,KACnD,KAAK,aAAa,MAAM,OAAS,GAAG,KAAK,IAAI,EAAGD,EAAE,CAAC,CAAC,IACtD,CAGA,GAAI,EAAExP,EAAA,KAAK,kBAAL,MAAAA,EAAA,UAA0B,MAAQ,CAAC,CACzC,MACF,CAGA,IAAMwP,EAAK,OAAO,KAAK,oBAAuB,WAAc,KAAK,mBAAmB,EAAI,CAAE,EAAG9Q,EAAE,aAAe,EAAG,EAAGA,EAAE,cAAgB,CAAE,EAGlI+Q,EAAM,KAAK,iBAAiBrN,GAAAD,EAAA,KAAK,eAAc,wBAAnB,YAAAC,EAAA,KAAAD,GAA6C,QACnE,KAAK,gBAAgBG,GAAAD,EAAA,KAAK,cAAa,wBAAlB,YAAAC,EAAA,KAAAD,GAA4C,QACjE,KAAK,uBAAyB,KAAK,sBAAsB,EAAE,OAC5D,KAAK,aAAemN,EAAE,EAC3BE,EAAa,KAAK,IAAI,EAAGD,CAAE,EAG3BE,EAAQ,KAAK,IAAID,EAAa,KAAK,IAAI,EAAGF,EAAE,CAAC,EAAG,CAAC,EAGnD,KAAK,eACP,KAAK,aAAa,MAAM,MAAS,GAAGE,CAAU,KAC9C,KAAK,aAAa,MAAM,OAAS,GAAG,KAAK,IAAI,EAAGF,EAAE,EAAIG,CAAK,CAAC,MAI9DjR,EAAE,MAAM,MAAS,GAAG8Q,EAAE,CAAC,KACvB9Q,EAAE,MAAM,OAAS,GAAG8Q,EAAE,CAAC,KACvB9Q,EAAE,MAAM,UAAY,SAASiR,CAAK,IAClCjR,EAAE,MAAM,gBAAkB,WAC1BA,EAAE,MAAM,SAAW,WACnBA,EAAE,MAAM,IAAM,IACdA,EAAE,MAAM,KAAO,IAGf,GAAI,EAAE6D,EAAA,KAAK,kBAAL,MAAAA,EAAA,UAA0B,MAAQ,CAAC,CAC3C,CAKE,kBAAmB,CA1tHrB,IAAA7E,EA2tHI,IAAMgB,EAAI,KAAK,cAGf,GAHkC,CAACA,GAG/B,KAAK,kBAAkB,EAAG,OAG9B,IAAMc,EAAQ,MAAM,KAAKd,EAAE,iBAAiB,eAAe,CAAC,EACxDuQ,EAAO,EAAGC,EAAO,EACrB1P,EAAM,QAASqP,GAAS,CACtB,IAAMxR,EAAKwR,EAAK,sBAAsB,EAChCe,EAAKlR,EAAE,sBAAsB,EAC7B0Q,EAAS/R,EAAE,KAAOuS,EAAG,KAAOvS,EAAE,MAC9BgS,EAAShS,EAAE,IAAOuS,EAAG,IAAOvS,EAAE,OACpC4R,EAAO,KAAK,IAAIA,EAAMG,CAAK,EAC3BF,EAAO,KAAK,IAAIA,EAAMG,CAAM,CAC9B,CAAC,EACD3Q,EAAE,MAAM,MAAS,GAAG,KAAK,KAAKuQ,EAAK,KAAK,QAAQ,EAAE,KAAK,UAAY,GAAG,KACtEvQ,EAAE,MAAM,OAAS,GAAG,KAAK,KAAKwQ,EAAK,KAAK,QAAQ,EAAE,KAAK,UAAY,GAAG,KAKtE,GAAI,EAAExR,EAAA,KAAK,kBAAL,MAAAA,EAAA,UAA0B,MAAQ,CAAC,CAC3C,CAYA,sBAAsBmS,EAAenD,EAAQC,EAAQrJ,EAAUwM,EAAU,CACvE,GAAI,CAAC,KAAK,qBAAsB,OAEhC,IAAMC,EAAc,IAAI,IAAIF,EAAc,IAAI/C,GAAMA,EAAG,EAAE,CAAC,EACpDkD,EAAW,MAAM,KAAK,KAAK,cAAc,iBAAiB,eAAe,CAAC,EAC7E,OAAOnN,GAAK,CAACA,EAAE,QAAQ,WAAW,EAG/BoN,EAAU,KAAK,kBAAkB,EACjC,CAAE,EAAGrJ,EAAI,EAAGC,CAAG,EAAI,KAAK,kBAAkB,EAGhD,QAAWhE,KAAKmN,EAAU,CACxB,GAAID,EAAY,IAAIlN,CAAC,EAAG,SACxB,IAAMqN,EAAO,KAAK,qBAAqB,IAAIrN,CAAC,EAC5C,GAAIqN,EAAM,CACRrN,EAAE,aAAa,aAAc,OAAOqN,EAAK,CAAC,CAAC,EAC3CrN,EAAE,aAAa,aAAc,OAAOqN,EAAK,CAAC,CAAC,EAC3C,IAAMC,EAAM7M,EAAW,KAAK,MAAM4M,EAAK,EAAIJ,CAAQ,EAAIA,EAAWI,EAAK,EACjEE,EAAM9M,EAAW,KAAK,MAAM4M,EAAK,EAAIJ,CAAQ,EAAIA,EAAWI,EAAK,EACvE,KAAK,iBAAiBrN,EAAGsN,EAAKC,CAAG,CACnC,CACF,CAGA,IAAMC,EAAgBR,EAAc,IAAI/C,IAAO,CAC7C,EAAGA,EAAG,MACN,EAAGA,EAAG,MACN,EAAGA,EAAG,EACN,EAAGA,EAAG,CACR,EAAE,EAGIwD,EAAW,IAAI,IAGfC,EAAY,IAAI,IACtB,QAAW1N,KAAKmN,EAAU,CACxB,IAAM7L,EAAS,WAAWtB,EAAE,MAAM,KAAK,GAAMA,EAAE,sBAAsB,EAAE,MACjEqK,EAAS,WAAWrK,EAAE,MAAM,MAAM,GAAKA,EAAE,sBAAsB,EAAE,OACvE0N,EAAU,IAAI1N,EAAG,CAAE,EAAGsB,EAAO,EAAG+I,CAAO,CAAC,CAC1C,CAGA,IAAMsD,EAAS9D,EAAS,EAAK,EAAKA,EAAS,EAAI,GAAK,EAC9C+D,EAAS9D,EAAS,EAAK,EAAKA,EAAS,EAAI,GAAK,EAC9C+D,EAAa,KAAK,IAAIhE,CAAM,GAAK,KAAK,IAAIC,CAAM,EAGtD,QAAWgE,KAASX,EAAU,CAC5B,GAAID,EAAY,IAAIY,CAAK,EAAG,SAC5B,IAAMT,EAAO,KAAK,qBAAqB,IAAIS,CAAK,EAChD,GAAI,CAACT,EAAM,SAEX,GAAI,CAAE,EAAGU,EAAY,EAAGC,CAAW,EAAIX,EACjC,CAAE,EAAGY,EAAI,EAAGC,CAAG,EAAIR,EAAU,IAAII,CAAK,EAGxCK,EAAW,GACf,QAAW/L,KAAMoL,EACf,GAAI,KAAK,cAAc,CAAE,EAAGpL,EAAG,EAAG,EAAGA,EAAG,EAAG,EAAGA,EAAG,EAAG,EAAGA,EAAG,CAAE,EACtC,CAAE,EAAG2L,EAAY,EAAGC,EAAY,EAAGC,EAAI,EAAGC,CAAG,CAAC,EAAG,CACrEC,EAAW,GAEPN,GAAcF,IAAU,EAC1BI,EAAaJ,EAAQ,EAAIvL,EAAG,EAAIA,EAAG,EAAIA,EAAG,EAAI6L,EACrC,CAACJ,GAAcD,IAAU,EAClCI,EAAaJ,EAAQ,EAAIxL,EAAG,EAAIA,EAAG,EAAIA,EAAG,EAAI8L,EAG9CH,EAAa3L,EAAG,EAAIA,EAAG,EAEzB,KACF,CAIF,GAAI+L,EAAU,CACZ,IAAIC,EAAQ,EACNvO,EAAKgO,EAAcF,IAAU,EAAIA,EAAQV,EAAWA,EAAY,EAChEnN,EAAM+N,EAA2D,EAA7CD,IAAU,EAAIA,EAAQX,EAAWA,EAC3D,KAAOmB,EAAQ,KAAK,CAClB,IAAMC,EAAgB,CAAE,EAAGN,EAAY,EAAGC,EAAY,EAAGC,EAAI,EAAGC,CAAG,EAC/DI,EAAY,GAGhB,QAAWlM,MAAMoL,EACf,GAAI,KAAK,cAAca,EAAejM,EAAE,EAAG,CACzCkM,EAAY,GACZ,KACF,CAGF,GAAI,CAACA,GACH,OAAW,CAAC,CAAEC,EAAE,IAAKd,EACnB,GAAI,KAAK,cAAcY,EAAeE,EAAE,EAAG,CACzCD,EAAY,GACZ,KACF,EAWJ,GAPI,CAACA,GAAalB,IACZW,EAAa,GAAKC,EAAa,GAC/BD,EAAaE,EAAKlK,GAAMiK,EAAaE,EAAKlK,KAC5CsK,EAAY,IAIZ,CAACA,EAAW,MAEhBP,GAAclO,EACdmO,GAAclO,EACdsO,GACF,CAGIhB,IACFW,EAAa,KAAK,IAAI,EAAG,KAAK,IAAIA,EAAY,KAAK,IAAI,EAAGhK,EAAKkK,CAAE,CAAC,CAAC,EACnED,EAAa,KAAK,IAAI,EAAG,KAAK,IAAIA,EAAY,KAAK,IAAI,EAAGhK,EAAKkK,CAAE,CAAC,CAAC,EAEvE,CAEAT,EAAS,IAAIK,EAAO,CAAE,EAAGC,EAAY,EAAGC,EAAY,EAAGC,EAAI,EAAGC,CAAG,CAAC,EAClEV,EAAc,KAAK,CAAE,EAAGO,EAAY,EAAGC,EAAY,EAAGC,EAAI,EAAGC,CAAG,CAAC,CACnE,CAGA,OAAW,CAAClC,EAAMwC,CAAG,IAAKf,EAAU,CAClCzB,EAAK,aAAa,aAAc,OAAOwC,EAAI,CAAC,CAAC,EAC7CxC,EAAK,aAAa,aAAc,OAAOwC,EAAI,CAAC,CAAC,EAC7C,IAAMlB,EAAM7M,EAAW,KAAK,MAAM+N,EAAI,EAAIvB,CAAQ,EAAIA,EAAWuB,EAAI,EAC/DjB,EAAM9M,EAAW,KAAK,MAAM+N,EAAI,EAAIvB,CAAQ,EAAIA,EAAWuB,EAAI,EACrE,KAAK,iBAAiBxC,EAAMsB,EAAKC,CAAG,CACtC,CACF,CAEA,SAASnQ,EAAIkD,EAAI,KAAMC,EAAI,KAAMkO,EAAM,KAAMC,EAAM,KAAM,CACvD,IAAMC,EAAKrO,GAAA,KAAAA,EAAM,WAAWlD,EAAG,aAAa,QAAQ,CAAC,GAAK,EACpDwR,EAAKrO,GAAA,KAAAA,EAAM,WAAWnD,EAAG,aAAa,QAAQ,CAAC,GAAK,EACpD4C,EAAKyO,GAAA,KAAAA,EAAQ,WAAWrR,EAAG,MAAM,KAAK,GAAMA,EAAG,sBAAsB,EAAE,OAAU,EACjF2D,EAAK2N,GAAA,KAAAA,EAAQ,WAAWtR,EAAG,MAAM,MAAM,GAAKA,EAAG,sBAAsB,EAAE,QAAU,EACvF,MAAO,CAAE,EAAGuR,EAAI,EAAGC,EAAI,EAAA5O,EAAG,EAAAe,EAAG,GAAA3D,CAAG,CAClC,CACA,cAAc9C,EAAGe,EAAGwT,EAAM,GAAK,CAC7B,MAAO,EAAEvU,EAAE,EAAIA,EAAE,GAAKe,EAAE,EAAIwT,GAAOxT,EAAE,EAAIA,EAAE,GAAKf,EAAE,EAAIuU,GAC7CvU,EAAE,EAAIA,EAAE,GAAKe,EAAE,EAAIwT,GAAOxT,EAAE,EAAIA,EAAE,GAAKf,EAAE,EAAIuU,EACxD,CACA,iBAAiB7B,EAAe8B,EAAW,CACzC,IAAMC,EAAS,MAAM,KAAK,KAAK,cAAc,iBAAiB,eAAe,CAAC,EAC3E,OAAO/O,GAAK,CAAC8O,EAAU,IAAI9O,CAAC,GAAK,CAACA,EAAE,QAAQ,WAAW,EAC1D,GAAI,CAAC+O,EAAO,OAAQ,MAAO,GAC3B,IAAMC,EAAaD,EAAO,IAAI/O,GAAK,KAAK,SAASA,CAAC,CAAC,EACnD,QAAWiK,KAAM+C,EAAe,QAAWiC,KAAMD,EAC/C,GAAI,KAAK,cAAc/E,EAAIgF,CAAE,EAAG,MAAO,GAEzC,MAAO,EACT,CACA,mBAAmB1I,EAAO,CA55H5B,IAAA1L,EA65HI,GAAI,CAAC0L,EAAQ,MAAO,CAAC,EAErB,IAAM9I,EAAM8I,EAAO,SAAWA,EAAO,OACrC,GAAI9I,GAAO,OAAOA,GAAQ,UAAY,OAAO,KAAKA,CAAG,EAAE,OACrD,OAAOA,EAGT,GAAI,CAEF,IAAM2B,EAAOmH,EAAO,QAAUA,EAAO,QAAQ,eAAe,EAAI,KAC1D2I,GAAOrU,EAAAuE,GAAA,YAAAA,EAAM,UAAN,YAAAvE,EAAe,IAC5B,GAAIqU,EAAK,CACP,IAAMC,EAAS,KAAK,MAAMD,CAAG,EAC7B,GAAIC,GAAU,OAAOA,GAAW,SAAU,OAAOA,CACnD,CACF,MAAQ,CAAC,CACT,MAAO,CAAC,CACV,CAGA,MAAM,kBAAmB,CAAE,MAAM,KAAK,iBAAiB,KAAK,CAAG,CAE/D,UAAW,CACT,MAAO,CACL,CAAE,GAAG,YAAa,KAAK,YAAa,MAAM,CAAC,CAAE,EAC7C,CAAE,GAAG,SAAa,KAAK,SAAa,MAAM,CAAC,CAAE,EAC7C,CAAE,GAAG,SAAa,KAAK,SAAU,MAAM,CACrC,CAAC,KAAK,WAAqB,KAAK,WAAqB,KAAK,0BAA0B,EACpF,CAAC,KAAK,SAAqB,KAAK,SAAqB,KAAK,mCAAmC,EAC7F,CAAC,KAAK,OAAqB,KAAK,OAAqB,KAAK,uBAAuB,EACjF,CAAC,KAAK,SAAqB,KAAK,SAAqB,KAAK,wBAAwB,EAClF,CAAC,KAAK,SAAqB,KAAK,SAAqB,KAAK,iBAAiB,EAC3E,CAAC,KAAK,WAAqB,KAAK,WAAqB,KAAK,uBAAuB,EAEjF,CAAC,KAAK,cAAqB,KAAK,cAAqB,KAAK,oBAAoB,CAChF,CAAC,EAED,CAAE,GAAG,UAAa,KAAK,UAAW,MAAM,CACtC,CAAC,KAAK,SAAqB,KAAK,SAAqB,KAAK,aAAa,EACvE,CAAC,KAAK,QAAqB,KAAK,QAAqB,KAAK,WAAW,EACrE,CAAC,KAAK,gBAAqB,KAAK,gBAAqB,KAAK,gBAAgB,EAC1E,CAAC,KAAK,mBAAqB,KAAK,mBAAqB,KAAK,eAAe,CAC3E,CAAC,EACD,CAAE,GAAG,SAAU,KAAK,SAAU,MAAM,CAClC,CAAC,KAAK,iBAAqB,KAAK,iBAAqB,KAAK,mBAAmB,EAC7E,CAAC,KAAK,iBAAqB,KAAK,iBAAqB,KAAK,4BAA4B,EACtF,CAAC,KAAK,mBAAqB,KAAK,UAAqB,KAAK,2BAA2B,EACrF,CAAC,KAAK,MAAqB,KAAK,MAAqB,KAAK,SAAS,EACnE,CAAC,KAAK,SAAqB,KAAK,SAAqB,KAAK,iBAAiB,CAC7E,CAAC,EACD,CAAE,GAAG,WAAY,KAAK,WAAY,MAAM,CACtC,CAAC,KAAK,QAAqB,KAAK,QAAqB,KAAK,uBAAuB,EACjF,CAAC,KAAK,aAAqB,KAAK,aAAqB,KAAK,gBAAgB,EAC1E,CAAC,KAAK,gBAAqB,KAAK,gBAAqB,KAAK,yBAAyB,EACnF,CAAC,KAAK,cAAqB,KAAK,cAAqB,KAAK,yBAAyB,EACnF,CAAC,KAAK,OAAqB,KAAK,OAAqB,KAAK,gBAAgB,CAC5E,CAAC,CACH,CACF,CAGA,MAAM,yBAAyB5Q,EAAMd,EAAK,CAExC,GAAI,CAAE,QAAQ,KAAK,yCAA0C,CAAE,KAAAc,EAAM,IAAAd,CAAI,CAAC,CAAG,MAAQ,CAAC,CACtF,IAAM2R,EAAW,MAAM,KAAK,iBAAoB,MAAM,OAAO,gBAAgB,EAI7E,GAAI,CACE,OAAO7Q,GAAS,UAAYA,GAAQ,CAACA,EAAK,WAAW,SAAS,GAAKA,IAAS,eAC9E,MAAM,KAAK,wBAAwBA,EAAMd,CAAG,CAEhD,MAAQ,CAAC,CAQT,GAAI,OAAOc,GAAS,UAAYA,IAAS,SACvC,GAAI,CACF,OAAO,MAAM,KAAK,qBAAqBd,GAAO,CAAC,CAAC,CAClD,OAAS4R,EAAK,CAEZ,QAAQ,KAAK,2CAA4CA,CAAG,CAC9D,CAIF,IAAMC,EAAe,SAAY,CAC/B,GAAI,CACF,GAAIF,EAAQ,oBAEV,OAAO,MAAMA,EAAQ,oBAAoB7Q,CAAI,EAG/C,IAAIgR,EACJ,GAAI9R,GAAO,OAAOA,GAAQ,SAExB8R,EAAU,CAAE,KAAAhR,EAAM,GAAGd,CAAI,MACpB,CACL,IAAI+R,EACJ,GAAI,CAAEA,EAAU,MAAM,KAAK,sBAAsBjR,CAAI,CAAG,MAAQ,CAAC,CACjEgR,EAAUC,GAAW,OAAOA,GAAY,SAAW,CAAE,GAAGA,CAAQ,EAAI,CAAE,KAAAjR,CAAK,CAC7E,CACA,IAAMkR,EAAOL,EAAQ,kBAAkBG,CAAO,EAC9C,OAAOE,GAAA,YAAAA,EAAM,cAAe,IAC9B,MAAQ,CACN,OAAO,IACT,CACF,EAIA,GAAI,CACF,IAAMC,EAAY,MAAMJ,EAAa,EACrC,GAAII,EAAW,CAEb,GAAI,OAAOA,EAAU,kBAAqB,WAAY,CACpD,IAAMtS,EAAK,MAAMsS,EAAU,iBAAiB,EAC5C,GAAItS,EAAI,CACN,GAAI,CAAE,QAAQ,KAAK,yCAA0C,CAAE,KAAAmB,CAAK,CAAC,CAAG,MAAQ,CAAC,CACjF,OAAOnB,CACT,CACF,CAEA,GAAI,OAAOsS,EAAU,eAAkB,WACrC,GAAI,CACF,IAAMC,EAAW,MAAMD,EAAU,cAAc,EAC/C,GAAIC,GAAYA,EAAS,OAAQ,CAE/B,GAAI,CAAE,MAAM,eAAe,YAAY,SAAS,CAAG,MAAQ,CAAC,CAC5D,IAAMC,EAAS,SAAS,cAAc,SAAS,EAC/CA,EAAO,KAAO,KAAK,KAEnBA,EAAO,OAAS,MAAM,QAAQD,EAAS,MAAM,EAAIA,EAAS,OAAO,IAAK5M,IAAO,CAAE,GAAGA,CAAE,EAAE,EAAI4M,EAAS,OAE/F,OAAOA,EAAS,cAAiB,aACnCC,EAAO,aAAeD,EAAS,aAAa,KAAKD,CAAS,GAExD,OAAOC,EAAS,eAAkB,aACpCC,EAAO,cAAgBD,EAAS,cAAc,KAAKD,CAAS,GAG9DE,EAAO,KAAO,CAAE,GAAGnS,CAAI,EAEvBmS,EAAO,iBAAiB,gBAAkBjO,GAAO,CAEjD,CAAC,EACD,GAAI,CAAE,QAAQ,KAAK,uDAAwD,CAAE,KAAApD,CAAK,CAAC,CAAG,MAAQ,CAAC,CAC/F,OAAOqR,CACT,CACF,MAAQ,CAAC,CAEb,CACF,MAAQ,CAAC,CAST,GAAI,OAAOrR,GAAS,WAAaA,EAAK,WAAW,SAAS,GAAKA,IAAS,eACtE,GAAI,CACF,IAAIiR,EACJ,GAAI,CAAEA,EAAU,MAAM,KAAK,sBAAsBjR,CAAI,CAAG,MAAQ,CAAC,CACjE,IAAMgR,EAAUC,GAAW,OAAOA,GAAY,SAAW,CAAE,GAAGA,CAAQ,EAAI,CAAE,KAAAjR,CAAK,EAC3EkR,EAAOL,EAAQ,kBAAkBG,CAAO,EAE9C,GADAE,EAAK,KAAO,KAAK,KACb,OAAOA,EAAK,kBAAqB,WAAY,CAC/C,IAAMrS,EAAK,MAAMqS,EAAK,iBAAiB,EACvC,GAAIrS,EAAI,CACN,GAAI,CAAE,QAAQ,KAAK,2CAA4C,CAAE,KAAAmB,CAAK,CAAC,CAAG,MAAQ,CAAC,CACnF,OAAOnB,CACT,CACF,CACF,MAAQ,CAAC,CAMX,IAAMsG,EAAO,OAAOnF,CAAI,EAAE,QAAQ,WAAY,EAAE,EAE1CsR,GADM,MAAM,QAAQ,OAAO,WAAW,EAAI,OAAO,YAAc,CAAC,GACpD,KAAKhU,IACrBA,GAAA,YAAAA,EAAG,QAAS6H,IAAQ7H,GAAA,YAAAA,EAAG,QAAS0C,IAAQ1C,GAAA,YAAAA,EAAG,QAAS,UAAU6H,CAAI,EACpE,EAKMoM,EAAa,CAAC,EAChBD,GAAA,MAAAA,EAAO,QAAQC,EAAW,KAAKD,EAAM,MAAM,EAC/CC,EAAW,KAAK,GAAGpM,CAAI,UAAW,GAAGA,CAAI,gBAAgB,EAGrDA,GAAQ,OAAOA,GAAS,UAC1BoM,EAAW,KAAK,OAAOpM,CAAI,cAAc,EAI3C,QAAWhC,KAAOoO,EAChB,GAAI,GAACpO,GAAO,OAAOA,GAAQ,UAE3B,QAAWqO,IAAS,CAAC,EAAG,IAAK,IAAK,IAAK,KAAM,GAAI,EAC/C,GAAI,CAOF,GANK,eAAe,IAAIrO,CAAG,GACzB,MAAM,QAAQ,KAAK,CACjB,eAAe,YAAYA,CAAG,EAC9B,IAAI,QAAQlH,GAAK,WAAWA,EAAGuV,CAAK,CAAC,CACvC,CAAC,EAEC,eAAe,IAAIrO,CAAG,EAAG,CAC3B,GAAI,CAAE,QAAQ,KAAK,mCAAoC,CAAE,KAAAnD,EAAM,IAAAmD,CAAI,CAAC,CAAG,MAAQ,CAAC,CAChF,OAAO,SAAS,cAAcA,CAAG,CACnC,CACF,MAAQ,CAAC,CAKb,OAAO,IACT,CAGA,MAAM,wBAAwBnD,EAAMd,EAAK,CACvC,GAAI,CACF,IAAM2R,EAAW,MAAM,KAAK,iBAAoB,MAAM,OAAO,gBAAgB,EAQzEG,EACJ,GAAI9R,GAAO,OAAOA,GAAQ,SACxB8R,EAAU,CAAE,KAAAhR,EAAM,GAAGd,CAAI,MACpB,CACL,IAAI+R,EACJ,GAAI,CAAEA,EAAU,MAAM,KAAK,sBAAsBjR,CAAI,CAAG,MAAQ,CAAC,CACjEgR,EAAUC,GAAW,OAAOA,GAAY,SAAW,CAAE,GAAGA,CAAQ,EAAI,CAAE,KAAAjR,CAAK,CAC7E,CACA,IAAMnB,EAAKgS,EAAQ,kBAAkBG,CAAO,EAC5CnS,EAAG,KAAO,KAAK,KACf,IAAM4S,EAAM,SAAS,cAAc,KAAK,EACxCA,EAAI,MAAM,QAAU,yEACpBA,EAAI,YAAY5S,CAAE,EAClB,SAAS,KAAK,YAAY4S,CAAG,EAC7B,MAAM,IAAI,QAAQxV,GAAK,sBAAsBA,CAAC,CAAC,EAC/CwV,EAAI,OAAO,EACX,GAAI,CAAE,QAAQ,KAAK,kCAAmC,CAAE,KAAAzR,CAAK,CAAC,CAAG,MAAQ,CAAC,CAC5E,MAAQ,CAER,CACF,CAEA,oBAAqB,CACnB,GAAI,SAAS,cAAc,6BAA6B,EAAG,OAC3D,IAAMwE,EAAI,SAAS,cAAc,OAAO,EACxCA,EAAE,aAAa,uBAAwB,EAAE,EACzCA,EAAE,YAAc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAShB,SAAS,KAAK,YAAYA,CAAC,CAC7B,CAGA,0BAA2B,CAEzB,OADY,MAAM,QAAQ,OAAO,WAAW,EAAI,OAAO,YAAc,CAAC,GAEnE,IAAKxF,GAAI,CArrIhB,IAAA1C,EAqrIoB,OACZ,MAAMA,EAAA0C,GAAA,YAAAA,EAAI,OAAJ,MAAA1C,EAAU,WAAW,WAAa0C,EAAG,KAAO,UAAUA,GAAA,YAAAA,EAAI,IAAI,GACpE,MAAMA,GAAA,YAAAA,EAAI,QAAQA,GAAA,YAAAA,EAAI,OAAQ,cAC9B,KAAM,qBACN,aAAaA,GAAA,YAAAA,EAAI,cAAe,GAChC,WAAWA,GAAA,YAAAA,EAAI,SAAU,IAC3B,EAAE,EACD,OAAQ0S,GAAO,OAAOA,EAAG,MAAS,UAAYA,EAAG,KAAK,WAAW,SAAS,CAAC,CAChF,CAEA,eAAe1R,EAAM,CACnB,IAAM2R,EAAKC,GAAMA,EAASC,EAAM,CAAC,EACjC,MAAQ,CACN,SAAYF,EAAE,CAAE,OAAO,CAAE,CAAC,IAAI,WAAY,KAAK,WAAY,MAAM,GAAM,QAAQE,EAAK,MAAM,UAAU,CAAE,CAAC,CAAC,EACxG,OAAYF,EAAE,CAAE,OAAO,CAAE,CAAC,IAAI,SAAU,KAAK,SAAU,MAAM,GAAO,QAAQE,EAAK,MAAM,QAAQ,CAAE,CAAC,CAAC,EACnG,OAAYF,EAAE,CAAE,OAAO,CAAE,CAAC,IAAI,SAAU,KAAK,SAAU,MAAM,GAAO,QAAQ,CAAC,QAAQ,EAAG,MAAM,QAAQ,EAAG,CAAC,IAAI,OAAQ,KAAK,OAAQ,MAAM,iBAAiB,CAAE,CAAC,CAAC,EAC9J,MAAYA,EAAE,CAAE,OAAO,CAAE,CAAC,IAAI,SAAU,KAAK,SAAU,MAAM,GAAO,QAAQ,CAAC,SAAS,SAAS,cAAc,EAAG,MAAM,gBAAgB,EAAG,CAAC,IAAI,MAAO,KAAK,SAAU,MAAM,MAAO,KAAK,KAAK,EAAG,CAAC,IAAI,MAAO,KAAK,SAAU,MAAM,MAAO,KAAK,KAAK,CAAE,CAAC,CAAC,EACpP,gBAAiBA,EAAE,CAAE,OAAO,CAAE,CAAC,IAAI,WAAY,KAAK,WAAY,MAAM,GAAM,QAAQE,EAAK,MAAM,wBAAwB,EAAG,CAAC,IAAI,gBAAiB,KAAK,SAAU,MAAM,gBAAiB,QAAQ,EAAE,CAAE,CAAC,CAAC,EACpM,mBAAoBF,EAAE,CAAE,OAAO,CAAE,CAAC,IAAI,WAAY,KAAK,WAAY,MAAM,GAAM,QAAQ,CAAC,SAAS,SAAS,cAAc,EAAG,MAAM,wBAAwB,EAAG,CAAC,IAAI,aAAc,KAAK,SAAU,QAAQ,CAAC,OAAO,KAAK,EAAG,MAAM,aAAc,QAAQ,MAAM,EAAG,CAAC,IAAI,YAAa,KAAK,SAAU,QAAQ,CAAC,OAAO,MAAM,MAAM,KAAK,EAAG,MAAM,YAAa,QAAQ,MAAM,CAAE,CAAC,CAAC,EACrW,OAAYA,EAAE,CAAE,OAAO,CAAE,CAAC,IAAI,WAAY,KAAK,WAAY,MAAM,GAAM,QAAQE,EAAK,MAAM,wBAAwB,CAAE,CAAC,CAAC,EACtH,iBAAkBF,EAAE,CAAE,OAAO,CAAE,CAAC,IAAI,WAAY,KAAK,WAAY,MAAM,GAAM,QAAQE,EAAK,MAAM,wBAAwB,EAAG,CAAC,IAAI,QAAS,KAAK,OAAQ,MAAM,sBAAsB,CAAE,CAAC,CAAC,EACtL,iBAAkBF,EAAE,CAAE,OAAO,CAAE,CAAC,IAAI,SAAU,KAAK,SAAU,MAAM,GAAO,QAAQE,EAAK,MAAM,QAAQ,EAAG,CAAC,IAAI,QAAS,KAAK,OAAQ,MAAM,sBAAsB,CAAE,CAAC,CAAC,EACnK,mBAAoBF,EAAE,CAAE,OAAO,CAAE,CAAC,IAAI,SAAU,KAAK,SAAU,MAAM,GAAO,QAAQ,CAAC,SAAS,EAAG,MAAM,gBAAgB,CAAE,CAAC,CAAC,EAC3H,IAAOA,EAAE,CAAE,OAAO,CAAE,CAAC,IAAI,WAAY,KAAK,WAAY,MAAM,GAAM,QAAQ,CAAC,iBAAiB,QAAQ,EAAG,MAAM,iCAAiC,EAAG,CAAC,IAAI,eAAgB,KAAK,SAAU,MAAM,eAAgB,QAAQ,EAAE,CAAE,CAAC,CAAC,EACzN,gBAAiBA,EAAE,CAAE,OAAO,CAAE,CAAC,IAAI,SAAU,KAAK,SAAU,MAAM,GAAO,QAAQ,CAAC,cAAc,EAAG,MAAM,cAAc,CAAE,CAAC,CAAC,EAC3H,MAASA,EAAE,CAAE,OAAO,CAAE,CAAC,IAAI,SAAU,KAAK,SAAU,MAAM,GAAO,QAAQ,CAAC,OAAO,EAAG,MAAM,OAAO,CAAE,CAAC,CAAC,EACrG,WAAcA,EAAE,CAAE,OAAO,CAAE,CAAC,IAAI,SAAU,KAAK,SAAU,MAAM,GAAO,QAAQ,CAAC,SAAS,EAAG,MAAM,SAAS,CAAE,CAAC,CAAC,EAC9G,cAAeA,EAAE,CAAE,OAAO,CAAE,CAAC,IAAI,SAAU,KAAK,SAAU,MAAM,GAAO,QAAQ,CAAC,qBAAqB,EAAG,MAAM,OAAO,CAAE,CAAC,CAAC,EACzH,SAAYA,EAAE,CAAE,OAAO,CAAE,CAAC,IAAI,UAAW,KAAK,WAAY,MAAM,UAAU,CAAE,CAAC,CAAC,EAC9E,KAAQA,EAAE,CAAE,OAAO,CAAE,CAAC,IAAI,SAAU,KAAK,SAAU,MAAM,GAAO,QAAQE,EAAK,MAAM,QAAQ,CAAE,CAAC,CAAC,EAC/F,OAAUF,EAAE,CAAE,OAAO,CAAE,CAAC,IAAI,SAAU,KAAK,SAAU,MAAM,GAAO,QAAQE,EAAK,MAAM,mBAAmB,CAAE,CAAC,CAAC,EAC5G,OAAUF,EAAE,CAAE,OAAO,CAAE,CAAC,IAAI,MAAO,KAAK,OAAQ,MAAM,KAAK,CAAE,CAAC,CAAC,EAC/D,KAAQA,EAAE,CAAE,OAAO,CAAE,CAAC,IAAI,OAAQ,KAAK,OAAQ,MAAM,SAAS,CAAE,CAAC,CAAC,CACpE,EAAG3R,CAAI,GAAK,CAAE,OAAQ,CAAC,CAAE,CAC3B,CAcA,MAAM,qBAAqBd,EAAM,CAAC,EAAG,CAEnC,IAAMsJ,EAAU,SAAS,cAAc,KAAK,EAE5CA,EAAQ,MAAM,QAAU,OACxBA,EAAQ,MAAM,cAAgB,SAC9BA,EAAQ,MAAM,IAAM,OACpBA,EAAQ,MAAM,QAAU,QAIxBA,EAAQ,MAAM,SAAW,UAGzBA,EAAQ,KAAO,CAAE,KAAM,SAAU,GAAItJ,GAAO,CAAC,CAAG,EAGhD,IAAM4S,EAAa,IAAM,CAGvB,IAAMC,EAAQ,CAAE,KAAM,QAAS,EAG/B,CAAC,SAAU,OAAQ,OAAQ,YAAa,OAAQ,cAAe,OAAO,EAAE,QAASlK,GAAM,CACrF,IAAMvH,EAAIkI,EAAQ,KAAKX,CAAC,EACpBvH,IAAM,QAAaA,IAAM,IAAMA,IAAM,OACvCyR,EAAMlK,CAAC,EAAIvH,EAEf,CAAC,EACDkI,EAAQ,cAAc,IAAI,YAAY,iBAAkB,CAAE,OAAQ,CAAE,OAAQuJ,CAAM,CAAE,CAAC,CAAC,CACxF,EAGMC,EAAS,SAAS,cAAc,KAAK,EAC3CA,EAAO,MAAM,QAAU,OACvBA,EAAO,MAAM,cAAgB,SAC7BA,EAAO,MAAM,IAAM,MACnB,IAAMC,EAAW,SAAS,cAAc,MAAM,EAC9CA,EAAS,YAAc,SACvBA,EAAS,MAAM,SAAW,QAC1BA,EAAS,MAAM,QAAU,MAEzB,IAAIC,EAAW,SAAS,cAAc,kBAAkB,EAExDA,EAAS,aAAa,QAAS,eAAe,EAG9CA,EAAS,iBAAiB,gBAAkB9O,GAAO,CApxIvD,IAAA9G,EAAAsB,EAAAc,EAuxIM0E,EAAG,gBAAgB,EAGnB,IAAM+O,GAAUzT,EAAA0E,EAAG,UAAW9G,EAAA8G,EAAG,OAAO,QAAV,KAAA9G,EAAmB8G,EAAG,UAApC,KAAA1E,GAAgDd,EAAAwF,EAAG,SAAH,YAAAxF,EAAW,MAC3E4K,EAAQ,KAAK,OAAS2J,GAAU,GAEhC,GAAI,CAAEC,EAAuB,CAAG,MAAQ,CAAC,CACzCN,EAAW,CACb,CAAC,EACDE,EAAO,YAAYC,CAAQ,EAC3BD,EAAO,YAAYE,CAAQ,EAC3B1J,EAAQ,YAAYwJ,CAAM,EAK1B,IAAII,EAAyB,IAAM,CAAC,EAG9BC,EAAO,SAAS,cAAc,KAAK,EACzCA,EAAK,MAAM,QAAU,OACrBA,EAAK,MAAM,oBAAsB,UACjCA,EAAK,MAAM,UAAY,OACvBA,EAAK,MAAM,OAAS,OAGpB,IAAMC,EAAY,CAACC,EAAWC,IAAY,CACxC,IAAMvW,EAAI,SAAS,cAAc,KAAK,EACtCA,EAAE,MAAM,QAAU,OAClBA,EAAE,MAAM,cAAgB,SACxBA,EAAE,MAAM,IAAM,MACd,IAAMwW,EAAM,SAAS,cAAc,MAAM,EACzCA,EAAI,YAAcF,EAClBE,EAAI,MAAM,SAAW,QACrBA,EAAI,MAAM,QAAU,MACpBxW,EAAE,YAAYwW,CAAG,EACjBxW,EAAE,YAAYuW,CAAO,EACrBH,EAAK,YAAYpW,CAAC,CACpB,EAGIyW,EACA,eAAe,IAAI,cAAc,GACnCA,EAAY,SAAS,cAAc,cAAc,EACjDA,EAAU,aAAa,QAAS,MAAM,EACtCA,EAAU,iBAAiB,QAAS,IAAM,CACxClK,EAAQ,KAAK,KAAOkK,EAAU,OAAS,OACvCZ,EAAW,CACb,CAAC,IAEDY,EAAY,SAAS,cAAc,OAAO,EAC1CA,EAAU,KAAO,OACjBA,EAAU,YAAc,OACxBA,EAAU,iBAAiB,QAAS,IAAM,CACxClK,EAAQ,KAAK,KAAOkK,EAAU,OAAS,OACvCZ,EAAW,CACb,CAAC,EACD,OAAO,OAAOY,EAAU,MAAO,CAC7B,QAAS,WACT,aAAc,MACd,WAAY,6FACZ,OAAQ,iCACR,MAAO,qCACP,MAAO,OACP,UAAW,YACb,CAAC,GAEHJ,EAAU,OAAQI,CAAS,EAI3B,IAAIC,EACA,eAAe,IAAI,gBAAgB,GACrCA,EAAY,SAAS,cAAc,gBAAgB,EACnDA,EAAU,aAAa,QAAS,MAAM,EAEtCA,EAAU,iBAAiB,gBAAkBvP,GAAO,CAn2I1D,IAAA9G,EAo2IQ8G,EAAG,gBAAgB,EACnBoF,EAAQ,KAAK,OAAOlM,EAAA8G,EAAG,SAAH,YAAA9G,EAAW,QAAS,OACxCwV,EAAW,CACb,CAAC,EAED,OAAO,OAAOa,EAAU,MAAO,CAAE,SAAU,WAAY,OAAQ,MAAO,CAAC,GAC9D,eAAe,IAAI,cAAc,GAC1CA,EAAY,SAAS,cAAc,cAAc,EACjDA,EAAU,aAAa,QAAS,MAAM,EACtCA,EAAU,iBAAiB,QAAS,IAAM,CACxCnK,EAAQ,KAAK,KAAOmK,EAAU,OAAS,OACvCb,EAAW,CACb,CAAC,IAEDa,EAAY,SAAS,cAAc,OAAO,EAC1CA,EAAU,KAAO,OACjBA,EAAU,YAAc,WACxBA,EAAU,iBAAiB,QAAS,IAAM,CACxCnK,EAAQ,KAAK,KAAOmK,EAAU,OAAS,OACvCb,EAAW,CACb,CAAC,EACD,OAAO,OAAOa,EAAU,MAAO,CAC7B,QAAS,WACT,aAAc,MACd,WAAY,6FACZ,OAAQ,iCACR,MAAO,qCACP,MAAO,OACP,UAAW,YACb,CAAC,GAEHL,EAAU,OAAQK,CAAS,EAG3B,IAAIC,EAyGJ,GAvGAR,EAAyB,IAAM,CAx4InC,IAAA9V,EAAAsB,EA04IM,IAAIiV,EAAQ,CAAC,EACPC,GAAMxW,EAAAkM,EAAQ,OAAR,YAAAlM,EAAc,OACpBkG,EAAIgG,EAAQ,MAClB,GAAIsK,GAAOtQ,GAAKA,EAAE,QAAUA,EAAE,OAAOsQ,CAAG,GAAKtQ,EAAE,OAAOsQ,CAAG,EAAE,WACzD,GAAI,CACFD,EAAQ,OAAO,KAAKrQ,EAAE,OAAOsQ,CAAG,EAAE,YAAc,CAAC,CAAC,EAAE,OAAQjL,GAAMA,GAAK,OAAOA,GAAM,QAAQ,EAC5FgL,EAAM,KAAK,CACb,MAAQ,CAAC,CAEX,IAAM9T,EAAO6T,GAAa,OAAOA,EAAU,OAAU,YAAcA,EAAU,MAAQ,OAC/EzP,IAAOyP,GAAA,YAAAA,EAAW,UAAW,IAAI,YAAY,EAK7CG,EAAsB,CAC1B,sBAAuB,qCACvB,sBAAuB,qCACvB,sBAAuB,qCACvB,sBAAuB,qCACvB,WAAY,qCACZ,WAAY,qCACZ,YAAa,oBACb,WAAY,aACZ,WAAY,aACZ,SAAU,WACV,UAAW,YACX,SAAU,WACV,UAAW,YACX,cAAe,gBACf,KAAM,MACR,EAEMC,EAAaC,GACbF,EAAoBE,CAAG,EAAUF,EAAoBE,CAAG,EACrDA,EACJ,MAAM,GAAG,EACT,IAAKC,GACCA,IAEDA,EAAK,YAAY,IAAM,SAAiB,SACxCA,EAAK,YAAY,IAAM,SAAiB,SACrCA,EAAK,OAAO,CAAC,EAAE,YAAY,EAAIA,EAAK,MAAM,CAAC,EACnD,EACA,KAAK,GAAG,EAEb,GAAI/P,IAAQ,eAAgB,CAE1B,IAAM2B,EAAQ+N,EAAM,IAAKM,IAAU,CAAE,MAAOA,EAAM,MAAOH,EAAUG,CAAI,CAAE,EAAE,EAE3ErO,EAAM,QAAQ,CAAE,MAAO,GAAI,MAAO,EAAG,CAAC,EACtC8N,EAAU,MAAQ9N,EAEd/F,GAAQ8T,EAAM,SAAS9T,CAAI,EAC7B6T,EAAU,MAAQ7T,EAElB6T,EAAU,MAAQ,EAEtB,SAAWzP,IAAQ,YAAa,CAE9ByP,EAAU,UAAY,GAEtB,IAAMQ,EAAY,SAAS,cAAc,eAAe,EACxDA,EAAU,aAAa,QAAS,EAAE,EAClCA,EAAU,YAAc,GACxBR,EAAU,YAAYQ,CAAS,EAC/B,QAAWD,KAAQN,EAAO,CACxB,IAAM5N,GAAO,SAAS,cAAc,eAAe,EACnDA,GAAK,aAAa,QAASkO,CAAI,EAC/BlO,GAAK,YAAc+N,EAAUG,CAAI,EACjCP,EAAU,YAAY3N,EAAI,CAC5B,CAEIlG,GAAQ8T,EAAM,SAAS9T,CAAI,EAC7B6T,EAAU,MAAQ7T,EAElB6T,EAAU,MAAQ,IAEpBhV,EAAAgV,EAAU,gBAAV,MAAAhV,EAAA,KAAAgV,EACF,SAAWzP,IAAQ,SAAU,CAC3ByP,EAAU,UAAY,GACtB,IAAMS,EAAW,SAAS,cAAc,QAAQ,EAChDA,EAAS,MAAQ,GACjBA,EAAS,YAAc,GACvBT,EAAU,YAAYS,CAAQ,EAC9B,QAAWF,KAAQN,EAAO,CACxB,IAAMlK,GAAM,SAAS,cAAc,QAAQ,EAC3CA,GAAI,MAAQwK,EACZxK,GAAI,YAAcqK,EAAUG,CAAI,EAChCP,EAAU,YAAYjK,EAAG,CAC3B,CACI5J,GAAQ8T,EAAM,SAAS9T,CAAI,IAC7B6T,EAAU,MAAQ7T,EAEtB,CACF,EAMI,eAAe,IAAI,cAAc,EACnC6T,EAAY,SAAS,cAAc,cAAc,EACjDA,EAAU,aAAa,QAAS,WAAW,EAE3CA,EAAU,aAAa,kBAAmB,OAAO,EACjDA,EAAU,aAAa,kBAAmB,OAAO,EACjDA,EAAU,aAAa,qBAAsB,OAAO,EACpDA,EAAU,iBAAiB,gBAAkBxP,GAAO,CAt/I1D,IAAA9G,EAAAsB,EAw/IQwF,EAAG,gBAAgB,EACnB,IAAM7C,GAAM3C,GAAAtB,EAAA8G,EAAG,SAAH,YAAA9G,EAAW,QAAX,KAAAsB,EAAoBgV,EAAU,MAC1CpK,EAAQ,KAAK,UAAYjI,GAAO,OAChCuR,EAAW,CACb,CAAC,UACQ,eAAe,IAAI,WAAW,EACvCc,EAAY,SAAS,cAAc,WAAW,EAC9CA,EAAU,aAAa,QAAS,WAAW,EAC3CA,EAAU,iBAAiB,WAAaxP,GAAO,CAC7CA,EAAG,gBAAgB,EAEnBoF,EAAQ,KAAK,UAAYoK,EAAU,OAAS,OAC5Cd,EAAW,CACb,CAAC,EAED,OAAO,OAAOc,EAAU,MAAO,CAAE,SAAU,WAAY,OAAQ,MAAO,CAAC,MAClE,CACLA,EAAY,SAAS,cAAc,QAAQ,EAE3C,IAAMS,EAAW,SAAS,cAAc,QAAQ,EAChDA,EAAS,MAAQ,GACjBA,EAAS,YAAc,GACvBT,EAAU,YAAYS,CAAQ,EAC9BT,EAAU,iBAAiB,SAAWxP,GAAO,CAC3CA,EAAG,gBAAgB,EACnBoF,EAAQ,KAAK,UAAYoK,EAAU,OAAS,OAC5Cd,EAAW,CACb,CAAC,EAED,OAAO,OAAOc,EAAU,MAAO,CAC7B,QAAS,WACT,aAAc,MACd,WAAY,6FACZ,OAAQ,iCACR,MAAO,qCACP,MAAO,OACP,UAAW,YACb,CAAC,EAED,OAAO,OAAOA,EAAU,MAAO,CAAE,SAAU,WAAY,OAAQ,MAAO,CAAC,CACzE,CAGAR,EAAuB,EACvBE,EAAU,YAAaM,CAAS,EAGhC,IAAIU,EACA,eAAe,IAAI,cAAc,GACnCA,EAAY,SAAS,cAAc,cAAc,EACjDA,EAAU,aAAa,QAAS,MAAM,EACtCA,EAAU,iBAAiB,QAAS,IAAM,CACxC9K,EAAQ,KAAK,KAAO8K,EAAU,OAAS,OACvCxB,EAAW,CACb,CAAC,IAEDwB,EAAY,SAAS,cAAc,OAAO,EAC1CA,EAAU,KAAO,OACjBA,EAAU,YAAc,OACxBA,EAAU,iBAAiB,QAAS,IAAM,CACxC9K,EAAQ,KAAK,KAAO8K,EAAU,OAAS,OACvCxB,EAAW,CACb,CAAC,EACD,OAAO,OAAOwB,EAAU,MAAO,CAC7B,QAAS,WACT,aAAc,MACd,WAAY,6FACZ,OAAQ,iCACR,MAAO,qCACP,MAAO,OACP,UAAW,YACb,CAAC,GAEHhB,EAAU,OAAQgB,CAAS,EAG3B,IAAIC,EAIJ,GAAI,eAAe,IAAI,WAAW,EAChCA,EAAa,SAAS,cAAc,WAAW,EAC/CA,EAAW,aAAa,QAAS,kBAAkB,EAEnDA,EAAW,iBAAiB,WAAanQ,GAAO,CAE9CA,EAAG,gBAAgB,EACnBoF,EAAQ,KAAK,MAAQ+K,EAAW,OAAS,OACzCzB,EAAW,CACb,CAAC,MACI,CACLyB,EAAa,SAAS,cAAc,QAAQ,EAG5C,IAAMF,EAAW,SAAS,cAAc,QAAQ,EAChDA,EAAS,MAAQ,GACjBA,EAAS,YAAc,GACvBE,EAAW,YAAYF,CAAQ,EAC/BE,EAAW,iBAAiB,SAAWnQ,GAAO,CAC5CA,EAAG,gBAAgB,EACnBoF,EAAQ,KAAK,MAAQ+K,EAAW,OAAS,OACzCzB,EAAW,CACb,CAAC,EAED,OAAO,OAAOyB,EAAW,MAAO,CAC9B,QAAS,WACT,aAAc,MACd,WAAY,6FACZ,OAAQ,iCACR,MAAO,qCACP,MAAO,OACP,UAAW,YACb,CAAC,CACH,CACAjB,EAAU,mBAAoBiB,CAAU,EAGxC,IAAIC,EACA,eAAe,IAAI,WAAW,GAChCA,EAAa,SAAS,cAAc,WAAW,EAC/CA,EAAW,iBAAiB,SAAU,IAAM,CAC1ChL,EAAQ,KAAK,YAAc,CAAC,CAACgL,EAAW,QACxC1B,EAAW,CACb,CAAC,IAED0B,EAAa,SAAS,cAAc,OAAO,EAC3CA,EAAW,KAAO,WAClBA,EAAW,iBAAiB,SAAU,IAAM,CAC1ChL,EAAQ,KAAK,YAAc,CAAC,CAACgL,EAAW,QACxC1B,EAAW,CACb,CAAC,GAGH,IAAM2B,EAAU,SAAS,cAAc,KAAK,EAC5CA,EAAQ,MAAM,QAAU,OACxBA,EAAQ,MAAM,WAAa,SAC3BA,EAAQ,MAAM,IAAM,MACpB,IAAMC,EAAa,SAAS,cAAc,MAAM,EAChD,OAAAA,EAAW,YAAc,mBACzBA,EAAW,MAAM,SAAW,QAC5BA,EAAW,MAAM,QAAU,MAC3BD,EAAQ,YAAYC,CAAU,EAC9BD,EAAQ,YAAYD,CAAU,EAC9BnB,EAAK,YAAYoB,CAAO,EAGxBjL,EAAQ,YAAY6J,CAAI,EAGxB7J,EAAQ,UAAY,CAACmL,EAAO,CAAC,IAAM,CACjCnL,EAAQ,KAAO,CAAE,KAAM,SAAU,GAAImL,GAAQ,CAAC,CAAG,EACjD,IAAMrW,EAAIkL,EAAQ,KAYlB,GAVI0J,IACE,UAAWA,IAAUA,EAAS,MAAQ5U,EAAE,QAAU,IAClD4U,EAAS,cAAcA,EAAS,aAAa,QAAS5U,EAAE,QAAU,EAAE,GAEtEoV,IACFA,EAAU,MAAQpV,EAAE,MAAQ,IAE1BqV,IACFA,EAAU,MAAQrV,EAAE,MAAQ,IAE1BsV,EAAW,CACb,GAAI,CAAER,EAAuB,CAAG,MAAQ,CAAC,CAEzCQ,EAAU,MAAQtV,EAAE,WAAa,EACnC,CACIgW,IACFA,EAAU,MAAQhW,EAAE,MAAQ,IAE1BiW,IACFA,EAAW,MAAQjW,EAAE,OAAS,IAE5BkW,GACE,YAAaA,IAAYA,EAAW,QAAU,CAAC,CAAClW,EAAE,YAE1D,EAGA,OAAO,eAAekL,EAAS,OAAQ,CACrC,KAAM,CACJ,OAAO,KAAK,KACd,EACA,IAAIlI,EAAG,CAhrJb,IAAAhE,EAurJQ,GANA,KAAK,MAAQgE,EAMT4R,EAAU,CACZ,GAAI,CAAEA,EAAS,KAAO5R,CAAG,MAAQ,CAAC,CAI7B,eAAe,IAAI,kBAAkB,GACxC,eAAe,YAAY,kBAAkB,EAAE,KAAK,IAAM,CA7rJtE,IAAAhE,EA8rJc,GAAI,CAAE4V,EAAS,KAAO,KAAK,OAAO5V,EAAA4V,EAAS,gBAAT,MAAA5V,EAAA,KAAA4V,EAA4B,MAAQ,CAAC,CACzE,CAAC,EAAE,MAAM,IAAM,CAAC,CAAC,CAErB,CAGA,GAAIS,EAAW,CACb,GAAI,CAAEA,EAAU,KAAOrS,CAAG,MAAQ,CAAC,CAC9B,eAAe,IAAI,gBAAgB,GACtC,eAAe,YAAY,gBAAgB,EAAE,KAAK,IAAM,CAvsJpE,IAAAhE,EAwsJc,GAAI,CAAEqW,EAAU,KAAO,KAAK,OAAOrW,EAAAqW,EAAU,gBAAV,MAAArW,EAAA,KAAAqW,EAA6B,MAAQ,CAAC,CAC3E,CAAC,EAAE,MAAM,IAAM,CAAC,CAAC,CAErB,CAIA,GAAIY,EAAY,CAEd,IAAIK,EAAa,CAAC,EACdtT,GAAKA,EAAE,SACLA,EAAE,OAAO,OACXsT,EAAa,OAAO,KAAKtT,EAAE,OAAO,MAAM,EAC/B,OAAOA,EAAE,QAAW,WAC7BsT,EAAa,OAAO,KAAKtT,EAAE,MAAM,EAAE,OAAQuH,GAAMA,IAAM,eAAe,IAI1E,IAAMgM,EAAUN,EAAW,MACrBpQ,GAAOoQ,EAAW,SAAW,IAAI,YAAY,EACnD,GAAIpQ,IAAQ,YAAa,CAEvBoQ,EAAW,UAAY,GAEvB,IAAMH,EAAY,SAAS,cAAc,eAAe,EACxDA,EAAU,aAAa,QAAS,EAAE,EAClCA,EAAU,YAAc,GACxBG,EAAW,YAAYH,CAAS,EAChC,QAAWD,KAAQS,EAAY,CAC7B,IAAM3O,EAAO,SAAS,cAAc,eAAe,EACnDA,EAAK,aAAa,QAASkO,CAAI,EAC/BlO,EAAK,YAAckO,EACnBI,EAAW,YAAYtO,CAAI,CAC7B,CAEI4O,GAAWD,EAAW,SAASC,CAAO,EACxCN,EAAW,MAAQM,EACTA,IACVN,EAAW,MAAQ,KAGrBjX,EAAAiX,EAAW,gBAAX,MAAAjX,EAAA,KAAAiX,EACF,SAAWpQ,IAAQ,SAAU,CAE3BoQ,EAAW,UAAY,GACvB,IAAMF,EAAW,SAAS,cAAc,QAAQ,EAChDA,EAAS,MAAQ,GACjBA,EAAS,YAAc,GACvBE,EAAW,YAAYF,CAAQ,EAC/B,QAAWF,KAAQS,EAAY,CAC7B,IAAMhC,EAAI,SAAS,cAAc,QAAQ,EACzCA,EAAE,MAAQuB,EACVvB,EAAE,YAAcuB,EAChBI,EAAW,YAAY3B,CAAC,CAC1B,CACIiC,GAAW,MAAM,KAAKN,EAAW,OAAO,EAAE,KAAK3B,GAAKA,EAAE,QAAUiC,CAAO,IACzEN,EAAW,MAAQM,EAEvB,CACF,CAMA,GAAI,CAAEzB,EAAuB,CAAG,MAAQ,CAAC,CAC3C,CACF,CAAC,EAGD5J,EAAQ,UAAUtJ,GAAO,CAAC,CAAC,EAEpBsJ,CACT,CAEA,eAAexI,EAAMd,EAAM,CAAC,EAAG,CAC7B,IAAM4U,EAAK,KAAK,eAAe9T,CAAI,GAAK,CAAE,OAAQ,CAAC,CAAE,EAC/C+T,EAAM,CAAE,GAAG7U,EAAK,KAAAc,CAAK,EAE3B,QAAWgU,KAAKF,EAAG,OAAQ,CACzB,IAAIxT,EAAIyT,EAAIC,EAAE,GAAG,EAEjB,GAAIA,EAAE,OAAS,WAAY,CAEzB,IAAMjC,GADM,MAAM,QAAQzR,CAAC,EAAIA,EAAKA,GAAK,MAAQA,IAAM,GAAK,CAACA,CAAC,EAAI,CAAC,GACjD,OAAO,OAAO,EAC5ByR,EAAM,OAAQgC,EAAIC,EAAE,GAAG,EAAIjC,EAC1B,OAAOgC,EAAIC,EAAE,GAAG,CACvB,SACSA,EAAE,OAAS,SACd,MAAM,QAAQ1T,CAAC,IAAGA,EAAIA,EAAE,CAAC,GACzBA,GAAK,MAAQA,IAAM,GAAI,OAAOyT,EAAIC,EAAE,GAAG,EACtCD,EAAIC,EAAE,GAAG,EAAI,OAAO1T,CAAC,UAEnB0T,EAAE,OAAS,SAClB,GAAI1T,GAAK,MAAQA,IAAM,GAAM,OAAOyT,EAAIC,EAAE,GAAG,MACxC,CACH,IAAM1Q,EAAI,OAAOhD,CAAC,EACd,OAAO,SAASgD,CAAC,EAAGyQ,EAAIC,EAAE,GAAG,EAAI1Q,EAChC,OAAOyQ,EAAIC,EAAE,GAAG,CACvB,MAEOA,EAAE,OAAS,UAAYA,EAAE,OAAS,QAAUA,EAAE,OAAS,cAC1D1T,GAAK,MAAQA,IAAM,GAAI,OAAOyT,EAAIC,EAAE,GAAG,EACtCD,EAAIC,EAAE,GAAG,EAAI1T,EAEtB,CACA,OAAOyT,CACT,CAEA,YAAYE,EAAS,CArzJvB,IAAA3X,EAszJI,IAAM4X,EAAM,OAAO,OAAK5X,EAAA,KAAK,OAAL,YAAAA,EAAW,SAAU,CAAC,CAAC,EAC/C,GAAI,CAAC2X,GAAW,CAACA,EAAQ,OAAQ,OAAOC,EAExC,GAAI,CAAC,KAAK,eAAiB,KAAK,cAAc,OAASA,EAAI,OAAQ,CACjE,IAAMC,EAAM,CAAC,EACb,QAAWjX,KAAMgX,EAAK,CACpB,IAAM9F,EAAIlR,EAAG,MAAM,GAAG,EAAE,CAAC,GACxBiX,EAAA/F,KAAA+F,EAAA/F,GAAW,CAAC,IAAG,KAAKlR,CAAE,CACzB,CACA,KAAK,cAAgB,CAAE,KAAMgX,EAAI,OAAQ,IAAAC,CAAI,CAC/C,CACA,IAAMJ,EAAM,CAAC,EACb,QAAW3F,KAAK6F,EAAa,KAAK,cAAc,IAAI7F,CAAC,GAAG2F,EAAI,KAAK,GAAG,KAAK,cAAc,IAAI3F,CAAC,CAAC,EAC7F,OAAO2F,CACT,CACA,iBAAiBjB,EAAK,CAr0JxB,IAAAxW,EAAAsB,EAs0JI,IAAMyC,GAAKzC,GAAAtB,EAAA,KAAK,OAAL,YAAAA,EAAW,SAAX,YAAAsB,EAAoBkV,GAAM,GAAI,CAACzS,EAAI,MAAO,GACrD,IAAMC,EAAI,OAAOD,EAAG,KAAK,EAAG,OAAO,OAAO,SAASC,CAAC,CACtD,CAEA,WAAW,CAAE,GAAI,CAAE,OAAO,IAAI,IAAI,KAAK,MAAM,aAAa,QAAQ,WAAW,GAAG,IAAI,CAAC,CAAG,MAAQ,CAAE,OAAO,IAAI,GAAO,CAAE,CACtH,UAAU8T,EAAI,CAAE,GAAI,CAAE,aAAa,QAAQ,YAAa,KAAK,UAAU,MAAM,KAAKA,CAAG,CAAC,CAAC,CAAG,MAAQ,CAAC,CAAE,CACrG,YAAY,CAAE,GAAI,CAAE,OAAO,KAAK,MAAM,aAAa,QAAQ,kBAAkB,GAAG,IAAI,CAAG,MAAQ,CAAE,MAAO,CAAC,CAAG,CAAE,CAC9G,YAAYpU,EAAK,CAAE,GAAI,CAAE,IAAM/D,EAAI,KAAK,WAAW,EAAE,OAAO2F,GAAGA,IAAI5B,CAAI,EAAG/D,EAAE,QAAQ+D,CAAI,EAAO/D,EAAE,OAAO,KAAIA,EAAE,OAAO,IAAI,aAAa,QAAQ,mBAAoB,KAAK,UAAUA,CAAC,CAAC,CAAG,MAAO,CAAC,CAAE,CAGhM,MAAM,mBAAoB,CACxB,GAAI,MAAK,UACT,IAAI,CAAC,SAAS,cAAc,oBAAoB,EAAG,CACjD,IAAMoY,EAAI,SAAS,cAAc,MAAM,EACvCA,EAAE,IAAM,aACRA,EAAE,KAAO,+EACTA,EAAE,aAAa,eAAe,EAAE,EAChC,SAAS,KAAK,YAAYA,CAAC,CAC7B,CACA,MAAM,IAAI,QAAS9H,GAAY,CAC7B,GAAI,OAAO,WAAY,OAAOA,EAAQ,EACtC,IAAM/H,EAAI,SAAS,cAAc,QAAQ,EACzCA,EAAE,IAAM,8EACRA,EAAE,OAAS+H,EACX,SAAS,KAAK,YAAY/H,CAAC,CAC7B,CAAC,EACD,MAAM,IAAI,QAAS+H,GAAY,CAh2JnC,IAAAjQ,EAAAsB,EAi2JM,IAAIA,GAAAtB,EAAA,OAAO,aAAP,YAAAA,EAAmB,YAAnB,MAAAsB,EAA8B,KAAM,OAAO2O,EAAQ,EACvD,IAAM/H,EAAI,SAAS,cAAc,QAAQ,EACzCA,EAAE,IAAM,kFACRA,EAAE,OAAS+H,EACX,SAAS,KAAK,YAAY/H,CAAC,CAC7B,CAAC,EACD,KAAK,UAAY,GACnB,CAEA,MAAM,iBAAiB8P,EAAQC,EAAYC,EAAeC,EAAiB,CACzE,IAAMC,EAAQ9C,GAAO,OAAO,OAAS,OAAO,OAAO,KAAKA,CAAC,EAAI,KAAK,UAAUA,EAAG,KAAM,CAAC,EAChF+C,EAAS/S,GAAO,OAAO,OAAS,OAAO,OAAO,KAAKA,CAAC,EAAI,KAAK,MAAMA,CAAC,EAC1E0S,EAAO,UAAY,GACnB,IAAMM,EAAcF,EAAKH,CAAU,EAEnC,GAAI,eAAe,IAAI,gBAAgB,EAAG,CACxC,IAAMM,EAAK,SAAS,cAAc,gBAAgB,EAClDA,EAAG,KAAO,OACVA,EAAG,KAAO,KAAK,KACfA,EAAG,MAAQD,EACXC,EAAG,MAAM,QAAU,QACnBA,EAAG,MAAM,OAAS,QAClBP,EAAO,YAAYO,CAAE,EAErB,IAAIC,EAAe,GACnB,OAAAD,EAAG,iBAAiB,gBAAkBlY,GAAM,CA13JlD,IAAAL,EAAAsB,EAAAc,EA23JQ,GAAIoW,EAAc,OAClB,IAAMC,GAAMrW,GAAAd,GAAAtB,EAAAK,EAAE,SAAF,YAAAL,EAAU,QAAV,KAAAsB,EAAmBiX,EAAG,QAAtB,KAAAnW,EAA+B,GAC3C,GAAI,CAAE8V,EAAcG,EAAMI,CAAG,CAAC,CAAG,OAC1BjE,EAAK,CAAE2D,GAAA,MAAAA,EAAkB3D,EAAM,CACxC,CAAC,EACM,CACL,SAAW5R,GAAQ,CAj4J3B,IAAA5C,EAk4JU,IAAMyY,EAAML,EAAKxV,CAAG,IACf5C,EAAAuY,EAAG,QAAH,KAAAvY,EAAY,MAAQyY,IAAOD,EAAe,GAAMD,EAAG,MAAQE,EAAKD,EAAe,GACtF,CACF,CACF,CAEA,GAAI,CACF,MAAM,KAAK,kBAAkB,EAC7B,IAAME,EAAK,OAAO,WAAWV,EAAQ,CACnC,MAAOM,EACP,KAAM,OACN,YAAa,GACb,aAAc,GACd,WAAY,EACZ,QAAS,CACX,CAAC,EACGE,EAAe,GACnB,OAAAE,EAAG,GAAG,SAAU,IAAM,CACpB,GAAIF,EAAc,OAClB,IAAMG,EAAOD,EAAG,SAAS,EACzB,GAAI,CAAER,EAAcG,EAAMM,CAAI,CAAC,CAAG,OAC3BtY,EAAG,CAAE8X,GAAA,MAAAA,EAAkB9X,EAAI,CACpC,CAAC,EACM,CACL,SAAWuC,GAAQ,CACjB,IAAM6V,EAAML,EAAKxV,CAAG,EAChB8V,EAAG,SAAS,IAAMD,IAAOD,EAAe,GAAME,EAAG,SAASD,CAAG,EAAGD,EAAe,GACrF,CACF,CACF,MAAQ,CACN,IAAMI,EAAK,SAAS,cAAc,UAAU,EAC5C,OAAAA,EAAG,MAAM,MAAQ,OACjBA,EAAG,MAAM,OAAS,QAClBA,EAAG,MAAQN,EACXM,EAAG,iBAAiB,QAAS,IAAM,CACjC,GAAI,CAAEV,EAAcG,EAAMO,EAAG,KAAK,CAAC,CAAG,OAC/BvY,EAAG,CAAE8X,GAAA,MAAAA,EAAkB9X,EAAI,CACpC,CAAC,EACD2X,EAAO,YAAYY,CAAE,EACd,CAAE,SAAWhW,GAAQ,CAAE,IAAM6V,EAAML,EAAKxV,CAAG,EAAOgW,EAAG,QAAUH,IAAKG,EAAG,MAAQH,EAAK,CAAE,CAC/F,CACF,CAIE,mBAAmB,CAAE,UAAAxW,EAAW,MAAAuG,EAAO,UAAAqQ,EAAY,GAAI,UAAAC,CAAU,EAAG,CACpE7W,EAAU,MAAM,SAAW,WAC3BA,EAAU,MAAM,SAAW,OAC3B,IAAM8W,EAAS,SAAS,cAAc,KAAK,EAC3CA,EAAO,MAAM,OAAS,GAAGvQ,EAAM,OAASqQ,CAAS,KACjD5W,EAAU,UAAY,GACtBA,EAAU,YAAY8W,CAAM,EAE5B,IAAMC,EAAQ,IAAI,IACZC,EAAS,IAAM,CACnB,IAAMC,EAAYjX,EAAU,UACtBiE,EAAIjE,EAAU,aACdtB,EAAQ,KAAK,IAAI,EAAG,KAAK,MAAMuY,EAAYL,CAAS,EAAI,CAAC,EACzDM,EAAQ,KAAK,IAAI3Q,EAAM,OAAS,EAAG,KAAK,MAAM0Q,EAAYhT,GAAK2S,CAAS,EAAI,CAAC,EAGnF,OAAW,CAACO,EAAG7W,CAAE,IAAKyW,GAChBI,EAAIzY,GAASyY,EAAID,KAAQ5W,EAAG,OAAO,EAAGyW,EAAM,OAAOI,CAAC,GAG1D,QAASA,EAAIzY,EAAOyY,GAAKD,EAAMC,IAAK,CAClC,GAAIJ,EAAM,IAAII,CAAC,EAAG,SAClB,IAAM7W,EAAKuW,EAAUtQ,EAAM4Q,CAAC,EAAGA,CAAC,EAChC7W,EAAG,MAAM,SAAW,WACpBA,EAAG,MAAM,KAAO,IAChBA,EAAG,MAAM,MAAQ,IACjBA,EAAG,MAAM,IAAM,GAAG6W,EAAIP,CAAS,KAC/BG,EAAM,IAAII,EAAG7W,CAAE,EACfN,EAAU,YAAYM,CAAE,CAC1B,CACF,EAEA,OAAAN,EAAU,iBAAiB,SAAUgX,EAAQ,CAAE,QAAS,EAAK,CAAC,EAC9D,IAAI,eAAeA,CAAM,EAAE,QAAQhX,CAAS,EAC5CgX,EAAO,EAEA,CACL,QAAQI,EAAU,CAChB,GAAIA,EAAU,CACZ7Q,EAAQ6Q,EACRN,EAAO,MAAM,OAAS,GAAGvQ,EAAM,OAASqQ,CAAS,KACjD,OAAW,CAAC,CAAEtW,CAAE,IAAKyW,EAAOzW,EAAG,OAAO,EACtCyW,EAAM,MAAM,CACd,CACAC,EAAO,CACT,CACF,CACF,CAEA,MAAM,iBAAiBjR,EAAK,MAAOiQ,EAAW,KAAMqB,EAAS,KAAM,CAGjE,IAAMC,EAAQ,IAAMC,EAAM,OAAO,EAC3BA,EAAQ,SAAS,cAAc,KAAK,EAAGA,EAAM,UAAU,QAC7DA,EAAM,UAAY;AAAA;AAAA;AAAA,gBAGNxR,IAAO,OAAO,YAAY,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA,qDAKDA,IAAO,OAC9C,yFACA,6EAA6E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sDA6DrCA,IAAO,OAC/C,yFACA,6EAA6E;AAAA;AAAA;AAAA,cAIvF,KAAK,WAAW,YAAYwR,CAAK,EAEjC,IAAMC,EAAOD,EAAM,cAAc,WAAW,EACtCE,EAASF,EAAM,cAAc,SAAS,EACtCG,EAAYH,EAAM,cAAc,UAAU,EAC1CI,EAAYJ,EAAM,cAAc,YAAY,EAC5CK,EAAYL,EAAM,cAAc,aAAa,EAC7CM,EAASN,EAAM,cAAc,SAAS,EACtCO,EAAWP,EAAM,cAAc,WAAW,EAC1CQ,EAAaR,EAAM,cAAc,aAAa,EAC9CS,EAAaT,EAAM,cAAc,aAAa,EAC9CU,EAAYV,EAAM,cAAc,YAAY,EAC5CW,EAAWX,EAAM,cAAc,WAAW,EAC1CY,EAAUZ,EAAM,cAAc,UAAU,EACxCa,EAAUb,EAAM,cAAc,UAAU,EACxCc,EAAYd,EAAM,cAAc,YAAY,EAC5Ce,EAAUf,EAAM,cAAc,UAAU,EAExCgB,EAAShB,EAAM,cAAc,SAAS,EACtCiB,EAASjB,EAAM,cAAc,SAAS,EACtCkB,EAAUlB,EAAM,cAAc,UAAU,EACxChF,EAAMgF,EAAM,cAAc,MAAM,EAChCmB,EAAcnB,EAAM,cAAc,cAAc,EAChDoB,EAAgB5R,GAAO,CAAE0Q,EAAO,SAAWC,EAAU,SAAW,CAAC3Q,CAAI,EACrE6R,EAAYjR,GAAQ,CAAOA,GAAoD4K,EAAI,OAAO,GAAOA,EAAI,YAAY5K,IAAhF4K,EAAI,OAAO,GAAMA,EAAI,YAAY,GAAsD,EAExHsG,EAAQ,KAAK,UAAU,EACvBC,GAAS,KAAK,WAAW,EACzBC,GAAU,KAAK,SAAS,EACxBC,GAAaD,GAAQ,KAAKha,GAAGA,EAAE,KAAK,WAAW,EAC/Cka,GAAaF,GAAQ,KAAKha,GAAGA,EAAE,KAAK,QAAQ,EAC5Cma,GAAWH,GAAQ,QAAQha,GAAKA,EAAE,OAAS,CAAC,CAAC,EACnDia,GAAW,MAAQE,GAAS,OAAO/B,GAAK0B,EAAM,IAAI1B,EAAE,IAAI,CAAC,EACzD8B,GAAW,MAAQH,GAAO,IAAIzV,GAAK6V,GAAS,KAAK/B,GAAKA,EAAE,OAAO9T,CAAC,CAAC,EAAE,OAAO,OAAO,EAEjF,IAAM8V,GAAc,KAAK,yBAAyB,EAC9CA,GAAY,QACdJ,GAAQ,KAAK,CACX,GAAI,SACJ,KAAM,qBACN,MAAOI,EACT,CAAC,EAMH,IAAMC,GAAkB7B,EAAM,cAAc,eAAe,EACvD6B,KAAiBA,GAAgB,MAAM,QAAU,QASrD,IAAMC,GAAY9B,EAAM,cAAc,iBAAiB,EAEnD+B,GACAC,GAGEC,GAAgB,IAAM,CAC1B,GAAI,CAACD,GAAQ,OACb,IAAMxS,EAAK0S,IAAeZ,EAAM,IAAIY,EAAW,EACzCC,EAAOH,GAAO,cAAc,SAAS,EACvCG,GAAMA,EAAK,aAAa,OAAQ3S,EAAK,WAAa,kBAAkB,CAC1E,EAEM4S,GAAgBlY,GAAS,CAC7B,GAAI6X,GAAS,CACX,IAAM5S,EAAOwS,GAAS,KAAK/B,IAAKA,GAAE,OAAS1V,CAAI,EACzCmY,GAAKlT,EAAOA,EAAK,KAAQjF,GAAQ,GACvC6X,GAAQ,YAAcM,EACxB,CACAJ,GAAc,CAChB,EAEA,GAAIH,IAAa,CAACA,GAAU,cAAc,WAAW,EAAG,CAEtD,IAAMQ,EAAYR,GAAU,cAAc,MAAM,EAC5CQ,IACFA,EAAU,MAAM,QAAU,QAG5BP,GAAU,SAAS,cAAc,MAAM,EACvCA,GAAQ,UAAY,WAEpBA,GAAQ,MAAM,KAAO,IACrBA,GAAQ,MAAM,WAAa,OAC3BA,GAAQ,MAAM,aAAe,MAC7BD,GAAU,aAAaC,GAASD,GAAU,UAAU,EAEpDE,GAAS,SAAS,cAAc,QAAQ,EACxCA,GAAO,UAAY,WACnBA,GAAO,aAAa,QAAQ,UAAU,EACtC,OAAO,OAAOA,GAAO,MAAO,CAC1B,QAAS,cACT,WAAY,SACZ,eAAgB,SAChB,MAAO,OACP,OAAQ,OACR,aAAc,MACd,OAAQ,iCACR,WAAY,kCACZ,QAAS,IACT,WAAY,MACZ,OAAQ,SACV,CAAC,EACDA,GAAO,UAAY,8CACnBF,GAAU,YAAYE,EAAM,EAE5BA,GAAO,iBAAiB,QAAUnb,GAAM,CACtCA,EAAE,gBAAgB,EACbqb,KACDZ,EAAM,IAAIY,EAAW,EACvBZ,EAAM,OAAOY,EAAW,EAExBZ,EAAM,IAAIY,EAAW,EAEvB,KAAK,UAAUZ,CAAK,EACpBW,GAAc,EAEdM,GAAW,EACb,CAAC,CACH,CAGA,IAAIC,GAAc,SAEZC,GAAWpF,GAAS,CAExB,IAAMqF,EAAWrF,IAAS,OACpBsF,GAAWtF,IAAS,MACpBuF,GAAa,CAACF,GAAY,CAACC,GAGjC7B,EAAU,UAAU,OAAO,SAAU8B,EAAU,EAC/C9B,EAAU,aAAa,gBAAiB,OAAO8B,EAAU,CAAC,EAC1D7B,EAAQ,UAAU,OAAO,SAAU2B,CAAQ,EAC3C3B,EAAQ,aAAa,gBAAiB,OAAO2B,CAAQ,CAAC,EAClD1B,IACFA,EAAO,UAAU,OAAO,SAAU2B,EAAO,EACzC3B,EAAO,aAAa,gBAAiB,OAAO2B,EAAO,CAAC,GAKtDnC,EAAW,cAAc,MAAM,QAAUoC,GAAa,GAAK,OAC3D/B,EAAQ,MAAM,QAAY6B,EAAY,GAAK,OACvCzB,IAAQA,EAAO,MAAM,QAAU0B,GAAU,GAAK,QAE9CD,EACF7B,EAAQ,eAAe,CAAE,SAAS,SAAU,MAAM,OAAQ,CAAC,EAClD8B,IAAW1B,GACpBA,EAAO,eAAe,CAAE,SAAS,SAAU,MAAM,OAAQ,CAAC,EAG5DuB,GAAcE,EAAW,OAAUC,GAAU,MAAQ,QACvD,EAEA7B,EAAU,iBAAiB,QAAS,SAAY,CAptKpD,IAAAta,EAwtKM,GAHAic,GAAQ,QAAQ,EAGZ,CAACI,GACH,MAAMC,GAAkBC,CAAa,MAErC,IAAI,EAAEvc,EAAAqc,GAAa,YAAb,MAAArc,EAAA,KAAAqc,GAAyBE,EAAgB,MAAQ,CAAC,CAE5D,CAAC,EAEDhC,EAAQ,iBAAiB,QAAS,IAAM0B,GAAQ,MAAM,CAAC,EAGnDzB,GACFA,EAAO,iBAAiB,QAAS,IAAM,CACrCyB,GAAQ,KAAK,EAEb,GAAI,CAAEO,GAAWD,CAAa,CAAG,MAAQ,CAAC,CAC5C,CAAC,EAIHN,GAAQ,QAAQ,EAEhB,IAAMQ,GAAkB,IAAM,CAC5B,IAAMC,EAAI5C,EAAO,MAAM,KAAK,EAAE,YAAY,EAC1C,OAAOkB,GACJ,IAAI2B,IAAY,CACf,GAAGA,EACH,OAAQA,EAAQ,OAAS,CAAC,GAAG,OAC3BvH,IAAM,CAACsH,GAAKtH,GAAG,KAAK,YAAY,EAAE,SAASsH,CAAC,GAAKtH,GAAG,KAAK,YAAY,EAAE,SAASsH,CAAC,CACnF,CACF,EAAE,EACD,OAAOE,GAAQA,EAAI,OAASA,EAAI,MAAM,QAAWA,EAAI,KAAO,aAAeA,EAAI,KAAO,QAAQ,CACnG,EAEMb,GAAa,IAAM,CACvB,IAAM3a,EAAOqb,GAAgB,EAC7BhD,EAAK,UAAY,GACjBrY,EAAK,QAAQyb,GAAO,CAClB,IAAMC,GAAM,SAAS,cAAc,KAAK,EACxCA,GAAI,MAAM,QAAU,OACpBA,GAAI,MAAM,aAAe,iCACzB,IAAM5W,GAAI,SAAS,cAAc,IAAI,EAGrC,GAHwCA,GAAE,YAAc2W,EAAI,KAAM3W,GAAE,MAAM,OAAO,aAAcA,GAAE,MAAM,SAAS,SAAUA,GAAE,MAAM,QAAQ,MAC1I4W,GAAI,YAAY5W,EAAC,EAEb,CAAC2W,EAAI,MAAM,SAAWA,EAAI,KAAK,aAAeA,EAAI,KAAK,UAAW,CACpE,IAAMtW,GAAI,SAAS,cAAc,KAAK,EAAGA,GAAE,MAAM,QAAQ,KAAMA,GAAE,MAAM,SAAS,SAAUA,GAAE,YAAcsW,EAAI,KAAK,YAAc,oBAAsB,uBAAwBC,GAAI,YAAYvW,EAAC,CAClM,MACEsW,EAAI,MAAM,QAAQlU,IAAQ,CACxB,IAAMnI,GAAI,SAAS,cAAc,QAAQ,EACzCA,GAAE,UAAY;AAAA,+BACKmI,GAAK,IAAI,qBAAqBA,GAAK,IAAI;AAAA,qBAE1D,OAAO,OAAOnI,GAAE,MAAM,CAAC,QAAQ,QAAQ,MAAM,OAAO,UAAU,OAAO,OAAO,OAAO,WAAW,cAAc,QAAQ,MAAM,aAAa,OAAO,OAAO,SAAS,CAAC,EAC/JA,GAAE,iBAAiB,QAAS,SAAY,CAAEuc,GAAUvc,EAAC,EAAG,MAAMwc,GAAWrU,GAAK,IAAI,CAAG,CAAC,EACtFmU,GAAI,YAAYtc,EAAC,CACnB,CAAC,EAEHiZ,EAAK,YAAYqD,EAAG,CACtB,CAAC,CACH,EAEMC,GAAa7c,GAAQ,CAEzBuZ,EAAK,iBAAiB,QAAQ,EAAE,QAAQjZ,GAAK,CAC3CA,EAAE,UAAU,OAAO,QAAQ,EAC3BA,EAAE,MAAM,WAAa,cACrBA,EAAE,MAAM,MAAQ,EAClB,CAAC,EAEGN,IACFA,EAAI,UAAU,IAAI,QAAQ,EAE1BA,EAAI,MAAM,WAAa,sBACvBA,EAAI,MAAM,MAAQ,uBAEtB,EAEIqc,EAAgB,KAChBb,GAAc,KACduB,GAAgB,KAChBZ,GAAe,KACfa,GAAS,KACTC,GAAU,EACVC,GAAiB,KACjBC,GAAuB,GAErBC,GAAiB,CAAC5Z,EAAMd,IAAQ,CA7yK1C,IAAA5C,EA8yKM,IAAMwX,GAAK,KAAK,eAAe9T,CAAI,EAEnC,GADAwW,EAAU,UAAY,GAClB,CAAC1C,GAAG,OAAO,OAAQ,CACrB0C,EAAU,UAAY,0GACtB,MACF,CACA,IAAMtC,GAAM,OAAO,OAAK5X,EAAA,KAAK,OAAL,YAAAA,EAAW,SAAU,CAAC,CAAC,EACzCud,GAAY,SAAS,cAAc,KAAK,EAExCC,GAAgB,CAAChH,GAAKiH,GAAKxb,EAAWyb,KAAgB,CAC1D,IAAMZ,GAAM,SAAS,cAAc,KAAK,EACxC,OAAO,OAAOA,GAAI,MAAM,CAAC,QAAQ,WAAW,OAAO,iCAAiC,aAAa,OAAO,OAAO,UAAU,WAAW,OAAO,QAAQ,OAAO,WAAW,SAAS,IAAI,KAAK,CAAC,EACxLA,GAAI,UAAY,8DAA8DtG,EAAG,UAC7EiH,GAAI,SAASjH,EAAG,IAClBsG,GAAI,MAAM,WAAW,sBAAuBA,GAAI,MAAM,YAAY,uBAClEA,GAAI,cAAc,SAAS,EAAE,aAAa,OAAO,qBAAqB,GAExEA,GAAI,iBAAiB,QAAS,SAAY,CACxC,IAAM3c,GAAMsd,GAAI,QAAQjH,EAAG,EACvBrW,IAAK,EAAGsd,GAAI,OAAOtd,GAAI,CAAC,EAAQsd,GAAI,KAAKjH,EAAG,EAChD,IAAMxN,GAAKyU,GAAI,SAASjH,EAAG,EAC3BsG,GAAI,MAAM,WAAa9T,GAAK,sBAAwB,GACpD8T,GAAI,MAAM,YAAc9T,GAAK,uBAAyB,uBACtD8T,GAAI,cAAc,SAAS,EAAE,aAAa,OAAQ9T,GAAK,sBAAwB,4BAA4B,EAC3GuT,EAAgB,KAAK,eAAe7Y,EAAM,CAAC,GAAG6Y,EAAe,CAACmB,EAAW,EAAG,CAAC,GAAGD,EAAG,CAAC,CAAC,EACrFE,GAAapB,CAAa,EAC1BU,IAAA,MAAAA,GAAe,SAASV,EAC1B,CAAC,EACDta,EAAU,YAAY6a,EAAG,CAC3B,EAEAtF,GAAG,OAAO,QAAQE,IAAK,CA70K7B,IAAA1X,GAAAsB,GAAAc,GAAAC,GAAAC,GAAAmC,GAAAC,GAAAC,GAAAC,GA80KQ,IAAMgZ,GAAM,SAAS,cAAc,KAAK,EAAG,OAAO,OAAOA,GAAI,MAAM,CAAC,QAAQ,OAAO,IAAI,MAAM,WAAW,SAAS,aAAa,KAAK,CAAC,EACpI,IAAMC,EAAQ,SAAS,cAAc,OAAO,EAE5C,GAF+CA,EAAM,YAAcnG,GAAE,OAASA,GAAE,IAAKmG,EAAM,MAAM,SAAS,QAEtGnG,GAAE,OAAS,WAAY,CACzB,IAAMnT,GAAO,SAAS,cAAc,KAAK,EAAGA,GAAK,MAAM,KAAK,IAC5D,IAAMlB,GAAS,SAAS,cAAc,OAAO,EAC7C,OAAO,OAAOA,GAAQ,CAAE,YAAY,uBAAmB,CAAC,EACxD,OAAO,OAAOA,GAAO,MAAO,CAC1B,MAAM,OAAQ,QAAQ,WAAY,aAAa,OAC/C,OAAO,iCACP,WAAW,+BAAgC,MAAM,2BACnD,CAAC,EACD,IAAM/C,GAAO,SAAS,cAAc,KAAK,EACzC,OAAO,OAAOA,GAAK,MAAO,CACxB,UAAU,QAAS,SAAS,OAAQ,UAAU,MAC9C,OAAO,iCAAkC,aAAa,OAAQ,QAAQ,KACxE,CAAC,EACD,IAAMwd,GAAQpG,GAAE,SAAWA,GAAE,QAAQ,OAAU,KAAK,YAAYA,GAAE,OAAO,EAAIE,GACvExX,GAAW,MAAM,QAAQwC,EAAI8U,GAAE,GAAG,CAAC,EAAI,CAAC,GAAG9U,EAAI8U,GAAE,GAAG,CAAC,EAAK9U,EAAI8U,GAAE,GAAG,EAAI,CAAC9U,EAAI8U,GAAE,GAAG,CAAC,EAAI,CAAC,EAGvFoB,GAAatC,GAAQ,CACzB,IAAMsG,EAAM,SAAS,cAAc,KAAK,EACxC,OAAO,OAAOA,EAAI,MAAO,CACvB,QAAQ,WAAY,OAAO,QAC3B,OAAO,iCAAkC,aAAa,OACtD,OAAO,UAAW,QAAQ,OAAQ,WAAW,SAAU,IAAI,MAAO,WAAW,EAC/E,CAAC,EACD,IAAMnB,EAAO,SAAS,cAAc,SAAS,EAC7CA,EAAK,aAAa,OAAO,4BAA4B,EACrDA,EAAK,MAAM,YAAY,kBAAkB,MAAM,EAC/C,IAAMhD,GAAO,SAAS,cAAc,MAAM,EAC1CA,GAAK,YAAcnC,EACnBmC,GAAK,MAAM,WAAa,SACxBA,GAAK,MAAM,SAAW,SACtBA,GAAK,MAAM,aAAe,WAC1BmE,EAAI,OAAOnB,EAAMhD,EAAI,EAErB,IAAMoF,GAAQ,IAAM,CAClB,IAAM/U,GAAK5I,GAAS,SAASoW,CAAG,EAChCsG,EAAI,MAAM,WAAa9T,GAAK,sBAAwB,GACpD8T,EAAI,MAAM,YAAc9T,GAAK,uBAAyB,uBACtD2S,EAAK,aAAa,OAAQ3S,GAAK,sBAAwB,4BAA4B,CACrF,EACA,OAAA+U,GAAM,EAENjB,EAAI,iBAAiB,QAAS,IAAM,CAClC,IAAM3c,GAAMC,GAAS,QAAQoW,CAAG,EAC5BrW,IAAO,EAAGC,GAAS,OAAOD,GAAK,CAAC,EAAQC,GAAS,KAAKoW,CAAG,EAC7D+F,EAAgB,KAAK,eAAe7Y,EAAM,CAAC,GAAG6Y,EAAe,CAAC7E,GAAE,GAAG,EAAG,CAAC,GAAGtX,EAAQ,CAAC,CAAC,EACpFud,GAAapB,CAAa,EAC1BU,IAAA,MAAAA,GAAe,SAASV,GACxBwB,GAAM,CACR,CAAC,EAEMjB,CACT,EAEIkB,GAAWF,GACf,KAAK,mBAAmB,CAAE,UAAWxd,GAAM,MAAO0d,GAAU,UAAW,GAAI,UAAAlF,EAAU,CAAC,EAEtFzV,GAAO,iBAAiB,QAAS,IAAM,CACrC,IAAMqZ,EAAIrZ,GAAO,MAAM,KAAK,EAAE,YAAY,EAC1C2a,GAAWF,GAAK,OAAOtH,GAAO,CAACkG,GAAKlG,EAAI,YAAY,EAAE,SAASkG,CAAC,CAAC,EACjE,KAAK,mBAAmB,CAAE,UAAWpc,GAAM,MAAO0d,GAAU,UAAW,GAAI,UAAAlF,EAAU,CAAC,CACxF,CAAC,EAEDvU,GAAK,OAAOlB,GAAQ/C,EAAI,EACxBsd,GAAI,OAAOC,EAAOtZ,EAAI,EACtBgY,EAAgB,KAAK,eAAe7Y,EAAM,CAAC,GAAGd,EAAK,CAAC8U,GAAE,GAAG,EAAGtX,EAAQ,CAAC,CACvE,CAEA,GAAIsX,GAAE,OAAS,SAAU,CACvB,IAAMuG,GAAS,SAAS,cAAc,KAAK,EAAGA,GAAO,MAAM,KAAK,IAAKA,GAAO,MAAM,SAAS,WAC3F,IAAMC,GAAK,SAAS,cAAc,OAAO,EAAGA,GAAG,aAAa,OAAQ,eAAexG,GAAE,GAAG,EACxF,OAAO,OAAOwG,GAAG,MAAM,CAAC,MAAM,OAAO,QAAQ,oBAAoB,aAAa,OAAO,OAAO,gCAAgC,CAAC,EAC7HA,GAAG,YAAc,YAAUle,GAAA0X,GAAE,QAAF,YAAA1X,GAAS,gBAAiB,QAAQ,SAC7D,IAAMme,GAAW,SAAS,cAAc,SAAS,EAAGA,GAAS,aAAa,OAAO,aAAa,EAC9F,OAAO,OAAOA,GAAS,MAAM,CAAC,SAAS,WAAW,KAAK,OAAO,IAAI,MAAM,MAAM,OAAO,OAAO,OAAO,kBAAkB,OAAO,QAAQ,IAAI,CAAC,EACzI,IAAMC,GAAK,SAAS,cAAc,UAAU,EAAGA,GAAG,GAAK,eAAe1G,GAAE,IACxE,IAAMoG,GAAQpG,GAAE,SAAWA,GAAE,QAAQ,OAAU,KAAK,YAAYA,GAAE,OAAO,EAAI,OAAO,OAAKpW,GAAA,KAAK,OAAL,YAAAA,GAAW,SAAU,CAAC,CAAC,EAChH8c,GAAG,UAAYN,GAAK,IAAIzd,IAAK,kBAAkBA,EAAC,IAAI,EAAE,KAAK,EAAE,EAC7D6d,GAAG,MAAQ,MAAM,QAAQtb,EAAI8U,GAAE,GAAG,CAAC,EAAK9U,EAAI8U,GAAE,GAAG,EAAE,CAAC,GAAK,GAAO9U,EAAI8U,GAAE,GAAG,GAAK,GAC9EwG,GAAG,iBAAiB,SAAU,SAAY,CACxC3B,EAAgB,KAAK,eAAe7Y,EAAM,CAAC,GAAG6Y,EAAe,CAAC7E,GAAE,GAAG,EAAGwG,GAAG,OAAS,MAAS,CAAC,EAC5FP,GAAapB,CAAa,EAC1BU,IAAA,MAAAA,GAAe,SAASV,EAC1B,CAAC,EACD0B,GAAO,OAAOE,GAAUD,GAAIE,EAAE,EAC9BR,GAAI,OAAOC,EAAOI,EAAM,CAC1B,CAEA,GAAIvG,GAAE,OAAS,SAAU,CACvB,IAAM2G,GAAU,SAAS,cAAc,KAAK,EAAGA,GAAQ,MAAM,KAAK,IAAKA,GAAQ,MAAM,SAAS,WAC9F,IAAM7W,GAAM,SAAS,cAAc,OAAO,EAAGA,GAAI,KAAK,SAAckQ,GAAE,OAAMlQ,GAAI,KAAKkQ,GAAE,MACvF,OAAO,OAAOlQ,GAAI,MAAM,CAAC,MAAM,OAAO,QAAQ,oBAAoB,aAAa,OAAO,OAAO,gCAAgC,CAAC,EAC9H,IAAM8W,GAAU,SAAS,cAAc,SAAS,EAAGA,GAAQ,aAAa,OAAO,aAAa,EAAG,OAAO,OAAOA,GAAQ,MAAM,CAAC,SAAS,WAAW,KAAK,OAAO,IAAI,MAAM,kBAAkB,OAAO,MAAM,OAAO,OAAO,OAAO,QAAQ,IAAI,CAAC,EACvO9W,GAAI,OAAQnF,IAAAD,GAAAQ,EAAI8U,GAAE,GAAG,IAAT,KAAAtV,GAAcsV,GAAE,UAAhB,KAAArV,GAA2B,GACvCmF,GAAI,iBAAiB,QAAS,SAAY,CACxC,IAAMxD,GAAIwD,GAAI,QAAQ,GAAK,OAAY,OAAOA,GAAI,KAAK,EACvD+U,EAAgB,KAAK,eAAe7Y,EAAM,CAAC,GAAG6Y,EAAe,CAAC7E,GAAE,GAAG,EAAG,MAAM1T,EAAC,EAAG,OAAYA,EAAC,CAAC,EAC9F2Z,GAAapB,CAAa,EAC1BU,IAAA,MAAAA,GAAe,SAASV,EAC1B,CAAC,EACD8B,GAAQ,OAAOC,GAAS9W,EAAG,EAC3BoW,GAAI,OAAOC,EAAOQ,EAAO,CAC3B,CAEA,GAAI3G,GAAE,OAAS,SAAU,CACvB,IAAM6G,GAAU,SAAS,cAAc,KAAK,EAAGA,GAAQ,MAAM,KAAK,IAAKA,GAAQ,MAAM,SAAS,WAC9F,IAAMrZ,GAAM,SAAS,cAAc,QAAQ,EAAG,OAAO,OAAOA,GAAI,MAAM,CAAC,MAAM,OAAO,QAAQ,oBAAoB,aAAa,OAAO,OAAO,gCAAgC,CAAC,EAC5K,IAAMsZ,GAAU,SAAS,cAAc,SAAS,EAAGA,GAAQ,aAAa,OAAO,0BAA0B,EAAG,OAAO,OAAOA,GAAQ,MAAM,CAAC,SAAS,WAAW,KAAK,OAAO,IAAI,MAAM,kBAAkB,OAAO,MAAM,OAAO,OAAO,OAAO,QAAQ,IAAI,CAAC,GACnP9G,GAAE,SAAS,CAAC,GAAG,QAAQpC,IAAK,CAAE,IAAMjJ,GAAM,SAAS,cAAc,QAAQ,EAAGA,GAAI,MAAQiJ,GAAGpQ,GAAI,YAAYmH,EAAG,CAAG,CAAC,EACnHnH,GAAI,OAAQR,IAAApC,GAAAM,EAAI8U,GAAE,GAAG,IAAT,KAAApV,GAAcoV,GAAE,UAAhB,KAAAhT,KAA4BD,GAAAiT,GAAE,UAAF,YAAAjT,GAAY,KAAM,GAC1DS,GAAI,iBAAiB,SAAU,SAAY,CACzCqX,EAAgB,KAAK,eAAe7Y,EAAM,CAAC,GAAG6Y,EAAe,CAAC7E,GAAE,GAAG,EAAGxS,GAAI,KAAK,CAAC,EAChFyY,GAAapB,CAAa,EAC1BU,IAAA,MAAAA,GAAe,SAASV,EAC1B,CAAC,EACDgC,GAAQ,OAAOC,GAAStZ,EAAG,EAC3B0Y,GAAI,OAAOC,EAAOU,EAAO,CAC3B,CAEA,GAAI7G,GAAE,OAAS,OAAQ,CACrB,IAAM2G,GAAU,SAAS,cAAc,KAAK,EAAGA,GAAQ,MAAM,KAAK,IAAKA,GAAQ,MAAM,SAAS,WAC9F,IAAM7W,GAAM,SAAS,cAAc,OAAO,EAAGA,GAAI,KAAK,OACtD,OAAO,OAAOA,GAAI,MAAM,CAAC,MAAM,OAAO,QAAQ,oBAAoB,aAAa,OAAO,OAAO,gCAAgC,CAAC,EAC9H,IAAMiX,GAAQ,SAAS,cAAc,SAAS,EAAGA,GAAM,aAAa,OAAO,UAAU,EAAG,OAAO,OAAOA,GAAM,MAAM,CAAC,SAAS,WAAW,KAAK,OAAO,IAAI,MAAM,kBAAkB,OAAO,MAAM,OAAO,OAAO,OAAO,QAAQ,IAAI,CAAC,EAC9NjX,GAAI,OAAQ7C,GAAA/B,EAAI8U,GAAE,GAAG,IAAT,KAAA/S,GAAc,GAC1B6C,GAAI,iBAAiB,QAAS,SAAY,CACxC+U,EAAgB,KAAK,eAAe7Y,EAAM,CAAC,GAAG6Y,EAAe,CAAC7E,GAAE,GAAG,EAAGlQ,GAAI,OAAS,MAAS,CAAC,EAC7FmW,GAAapB,CAAa,EAC1BU,IAAA,MAAAA,GAAe,SAASV,EAC1B,CAAC,EACD8B,GAAQ,OAAOI,GAAOjX,EAAG,EACzBoW,GAAI,OAAOC,EAAOQ,EAAO,CAC3B,CAEA,GAAI3G,GAAE,OAAS,WAAY,CACzB,IAAMkB,GAAK,SAAS,cAAc,UAAU,EAC5C,OAAO,OAAOA,GAAG,MAAM,CAAC,KAAK,IAAI,UAAU,QAAQ,QAAQ,WAAW,aAAa,OAAO,OAAO,gCAAgC,CAAC,EAClIA,GAAG,OAAQhU,GAAAhC,EAAI8U,GAAE,GAAG,IAAT,KAAA9S,GAAc,GACzBgU,GAAG,iBAAiB,QAAS,SAAY,CACvC2D,EAAgB,KAAK,eAAe7Y,EAAM,CAAC,GAAG6Y,EAAe,CAAC7E,GAAE,GAAG,EAAGkB,GAAG,OAAS,EAAE,CAAC,EACrF+E,GAAapB,CAAa,EAC1BU,IAAA,MAAAA,GAAe,SAASV,EAC1B,CAAC,EACDqB,GAAI,OAAOC,EAAOjF,EAAE,CACtB,CAEA2E,GAAU,YAAYK,EAAG,CAC3B,CAAC,EAED1D,EAAU,UAAY,GACtBA,EAAU,YAAYqD,EAAS,CACjC,EAmBMmB,GAAqB,IAAI,QAEzBC,GAAiB/b,GAAQ,CAC7B,GAAI,CAAC8X,EAAS,OAEd,IAAIpX,EAAU,MAAM,QAAQV,GAAA,YAAAA,EAAK,UAAU,EAAIA,EAAI,WAAW,IAAI5B,KAAM,CAAE,GAAGA,EAAE,EAAE,EAAI,CAAC,EAChF4d,GAAW,IAAMpC,GAAWD,CAAa,EACzCsC,GAAe,IAAM,CAngLjC,IAAA7e,GAqgLQsD,EAAUA,EAAQ,OAAQtC,GAAMA,GAAK,OAAOA,GAAM,UAAYA,EAAE,SAAS,EACzEub,EAAgB,CAAE,GAAGA,EAAe,WAAYjZ,CAAQ,EACxD,GAAI,CAAE2Z,IAAA,MAAAA,GAAe,SAASV,EAAgB,MAAQ,CAAC,CACvD,GAAI,EAAEvc,GAAAqc,IAAA,YAAAA,GAAc,YAAd,MAAArc,GAAA,KAAAqc,GAA0BE,EAAgB,MAAQ,CAAC,CACzDoB,GAAapB,CAAa,CAC5B,EACMtD,GAAS,IAAM,CAGnB,GAFAyB,EAAQ,UAAY,GAEhB,CAACpX,GAAW,CAACA,EAAQ,OAAQ,CAC/B,IAAMiD,EAAI,SAAS,cAAc,KAAK,EACtCA,EAAE,MAAM,QAAU,KAClBA,EAAE,MAAM,SAAW,QACnBA,EAAE,MAAM,aAAe,MACvBA,EAAE,YAAc,4DAChBmU,EAAQ,YAAYnU,CAAC,CACvB,CACAjD,EAAQ,QAAQ,CAACG,EAAMtD,KAAQ,CAE7B,IAAMyd,GAAM,SAAS,cAAc,KAAK,EACxC,OAAO,OAAOA,GAAI,MAAO,CAAE,QAAQ,OAAQ,cAAc,SAAU,IAAI,MAAO,aAAa,OAAQ,OAAO,iCAAkC,aAAa,MAAO,QAAQ,KAAM,CAAC,EAE/K,IAAMkB,EAAY,SAAS,cAAc,KAAK,EAC9C,OAAO,OAAOA,EAAU,MAAO,CAAE,QAAQ,OAAQ,WAAW,SAAU,eAAe,gBAAiB,aAAa,KAAM,CAAC,EAC1H,IAAMC,GAAW,SAAS,cAAc,KAAK,EAC7CA,GAAS,MAAM,QAAU,OACzBA,GAAS,MAAM,WAAa,SAC5BA,GAAS,MAAM,IAAM,MACrB,IAAMpD,GAAO,SAAS,cAAc,SAAS,EACzCqD,GAAW,aACTtb,GAAOD,EAAK,WAAa,QAC3BC,KAAS,gBAAiBsb,GAAW,cAChCtb,KAAS,SAAUsb,GAAW,cAC9Btb,KAAS,OAAQsb,GAAW,cAC5Btb,KAAS,UAASsb,GAAW,qBACtCrD,GAAK,aAAa,OAAQqD,EAAQ,EAClC,IAAMC,GAAY,SAAS,cAAc,MAAM,EAC/CA,GAAU,MAAM,WAAa,OAC7BA,GAAU,MAAM,cAAgB,aAChCA,GAAU,YAAevb,KAAS,gBAAmB,uBAA0BA,KAAS,QAAU,eAAkBA,KAAS,SAAW,SAAW,OACnJqb,GAAS,YAAYpD,EAAI,EACzBoD,GAAS,YAAYE,EAAS,EAC9BH,EAAU,YAAYC,EAAQ,EAE9B,IAAMG,GAAM,SAAS,cAAc,QAAQ,EAC3CA,GAAI,aAAa,QAAQ,kBAAkB,EAC3CA,GAAI,UAAY,mDAChB,OAAO,OAAOA,GAAI,MAAO,CAAE,OAAO,OAAQ,WAAW,cAAe,OAAO,UAAW,QAAQ,MAAO,QAAQ,cAAe,WAAW,QAAS,CAAC,EAEjJA,GAAI,MAAM,SAAW,WACrBA,GAAI,MAAM,OAAS,OACnBA,GAAI,iBAAiB,QAAUpY,IAAO,CAEpCA,GAAG,eAAe,EAClBA,GAAG,gBAAgB,EAGnB,IAAMqY,GAAQ7b,EAAQ,QAAQG,CAAI,EAC9B0b,GAAQ,IACV7b,EAAQ,OAAO6b,GAAO,CAAC,EAEzB5C,EAAc,WAAajZ,EAC3B2V,GAAO,EACP4F,GAAa,CACf,CAAC,EACDC,EAAU,YAAYI,EAAG,EACzBtB,GAAI,YAAYkB,CAAS,EAEzB,IAAMM,GAAU,SAAS,cAAc,KAAK,EAC5CA,GAAQ,MAAM,QAAU,OACxBA,GAAQ,MAAM,IAAM,MACpB,IAAMC,GAAY,SAAS,cAAc,OAAO,EAChDA,GAAU,YAAc,OACxBA,GAAU,MAAM,SAAW,SAC3BA,GAAU,MAAM,YAAc,MAC9B,IAAMC,GAAU,SAAS,cAAc,QAAQ,EAC/C,CAAC,QAAQ,gBAAgB,SAAS,MAAM,EAAE,QAASjT,IAAQ,CACzD,IAAMiJ,GAAI,SAAS,cAAc,QAAQ,EACzCA,GAAE,MAAQjJ,GACViJ,GAAE,YAAcjJ,GAAI,QAAQ,IAAI,GAAG,EACnCiT,GAAQ,YAAYhK,EAAC,CACvB,CAAC,EACDgK,GAAQ,MAAQ5b,GAChB4b,GAAQ,iBAAiB,SAAU,IAAM,CACvC7b,EAAK,UAAY6b,GAAQ,MACzB,OAAO7b,EAAK,OAAQ,OAAOA,EAAK,MAAO,OAAOA,EAAK,UACnD,OAAOA,EAAK,MAAO,OAAOA,EAAK,MAC/B,OAAOA,EAAK,YAAa,OAAOA,EAAK,MACrCwV,GAAO,EACP4F,GAAa,CACf,CAAC,EACDO,GAAQ,YAAYC,EAAS,EAC7BD,GAAQ,YAAYE,EAAO,EAC3B1B,GAAI,YAAYwB,EAAO,EAEvB,IAAMG,GAAS,SAAS,cAAc,KAAK,EAC3C,OAAO,OAAOA,GAAO,MAAO,CAAE,QAAQ,OAAQ,SAAS,OAAQ,IAAI,MAAO,WAAW,QAAS,CAAC,EAC/F,IAAMC,GAAW,CAACvJ,GAAWC,KAAY,CACvC,IAAMqH,GAAY,SAAS,cAAc,KAAK,EAC9CA,GAAU,MAAM,QAAU,OAC1BA,GAAU,MAAM,cAAgB,SAChCA,GAAU,MAAM,IAAM,MACtBA,GAAU,MAAM,SAAW,QAC3B,IAAMkC,GAAM,SAAS,cAAc,MAAM,EACzCA,GAAI,YAAcxJ,GAClBwJ,GAAI,MAAM,SAAW,SACrBlC,GAAU,YAAYkC,EAAG,EACzBlC,GAAU,YAAYrH,EAAO,EAC7BqJ,GAAO,YAAYhC,EAAS,CAC9B,GAEqB,IAAM,CApnLrC,IAAAvd,GAAAsB,GAsnLY,GADAie,GAAO,UAAY,GACf9b,EAAK,YAAc,QAAS,CAE9B,IAAIic,GACA,eAAe,IAAI,kBAAkB,GACvCA,GAAY,SAAS,cAAc,kBAAkB,EACrDA,GAAU,KAAO,KAAK,KACtBA,GAAU,aAAa,QAAQ,eAAe,EAE9CA,GAAU,gBAAgB,iBAAiB,EAC3CA,GAAU,MAAQjc,EAAK,QAAU,GACjCic,GAAU,iBAAiB,gBAAkB5Y,GAAO,CAGlDA,EAAG,gBAAgB,EACnBrD,EAAK,OAASqD,EAAG,OAAO,OAAS,GACjC+X,GAAa,CACf,CAAC,IAEDa,GAAY,SAAS,cAAc,OAAO,EAC1CA,GAAU,MAAQjc,EAAK,QAAU,GACjCic,GAAU,iBAAiB,QAAS,IAAM,CACxCjc,EAAK,OAASic,GAAU,MAAM,KAAK,EACnCb,GAAa,CACf,CAAC,EAED,OAAO,OAAOa,GAAU,MAAO,CAC7B,QAAS,WACT,aAAc,MACd,WAAY,6FACZ,OAAQ,iCACR,MAAO,qCACP,MAAO,OACP,UAAW,YACb,CAAC,GAEHF,GAAS,SAAUE,EAAS,EAE5B,IAAIC,GACJ,GAAI,eAAe,IAAI,WAAW,EAAG,CACnCA,GAAQ,SAAS,cAAc,WAAW,EAE1C,IAAMC,EAAQ,SAAS,cAAc,eAAe,EACpDA,EAAM,aAAa,QAAS,OAAO,EACnCA,EAAM,YAAc,oBACpB,IAAMC,EAAS,SAAS,cAAc,eAAe,EACrDA,EAAO,aAAa,QAAS,WAAW,EACxCA,EAAO,YAAc,wBACrBF,GAAM,YAAYC,CAAK,EACvBD,GAAM,YAAYE,CAAM,EACxBF,GAAM,MAAQlc,EAAK,WAAa,KAAO,YAAc,QAErDkc,GAAM,iBAAiB,WAAa7Y,IAAO,CAEzCA,GAAG,gBAAgB,EACnB,IAAM9C,GAAIP,EAAK,WAAa,KAAOA,EAAK,UAAYA,EAAK,MACrDkc,GAAM,QAAU,aAClBlc,EAAK,UAAYO,GACjB,OAAOP,EAAK,QAEZA,EAAK,MAAQO,GACb,OAAOP,EAAK,WAEdob,GAAa,CACf,CAAC,CACH,MAEEc,GAAQ,SAAS,cAAc,QAAQ,EACvCA,GAAM,UAAY,2GAClBA,GAAM,MAAQlc,EAAK,WAAa,KAAO,YAAc,QAErD,OAAO,OAAOkc,GAAM,MAAO,CACzB,QAAS,WACT,aAAc,MACd,WAAY,6FACZ,OAAQ,iCACR,MAAO,qCACP,MAAO,OACP,UAAW,YACb,CAAC,EACDA,GAAM,iBAAiB,SAAW7Y,GAAO,CACvCA,EAAG,gBAAgB,EACnB,IAAM9C,EAAIP,EAAK,WAAa,KAAOA,EAAK,UAAYA,EAAK,MACrDkc,GAAM,QAAU,aAClBlc,EAAK,UAAYO,EACjB,OAAOP,EAAK,QAEZA,EAAK,MAAQO,EACb,OAAOP,EAAK,WAEdob,GAAa,CACf,CAAC,EAEHW,GAAS,aAAcG,EAAK,EAE5B,IAAIG,EACA,eAAe,IAAI,cAAc,GACnCA,EAAU,SAAS,cAAc,cAAc,EAC/CA,EAAQ,OAASrc,EAAK,WAAa,KAAOA,EAAK,UAAYA,EAAK,QAAU,GAC1Eqc,EAAQ,aAAa,QAAS,EAAE,EAChCA,EAAQ,iBAAiB,QAAUhZ,GAAO,CAKxCA,EAAG,gBAAgB,EACnB,IAAM6P,EAAMgJ,GAAM,MAClBlc,EAAKkT,CAAG,EAAImJ,EAAQ,MACpB,IAAM7M,GAAQ0D,IAAQ,QAAU,YAAc,QAC9C,OAAOlT,EAAKwP,EAAK,EACjB4L,GAAa,CACf,CAAC,IAEDiB,EAAU,SAAS,cAAc,OAAO,EACxCA,EAAQ,OAASrc,EAAK,WAAa,KAAOA,EAAK,UAAYA,EAAK,QAAU,GAE1E,OAAO,OAAOqc,EAAQ,MAAO,CAC3B,QAAS,WACT,aAAc,MACd,WAAY,6FACZ,OAAQ,iCACR,MAAO,qCACP,MAAO,OACP,UAAW,YACb,CAAC,EACDA,EAAQ,iBAAiB,QAAUhZ,GAAO,CAIxCA,EAAG,gBAAgB,EACnB,IAAM6P,EAAMgJ,GAAM,MAClBlc,EAAKkT,CAAG,EAAImJ,EAAQ,MACpB,IAAM7M,GAAQ0D,IAAQ,QAAU,YAAc,QAC9C,OAAOlT,EAAKwP,EAAK,EACjB4L,GAAa,CACf,CAAC,GAEHW,GAAS,QAASM,CAAO,CAC3B,SAAWrc,EAAK,YAAc,gBAAiB,CAC7C,IAAIic,GACA,eAAe,IAAI,kBAAkB,GACvCA,GAAY,SAAS,cAAc,kBAAkB,EACrDA,GAAU,KAAO,KAAK,KACxBA,GAAU,aAAa,QAAQ,eAAe,EAC9CA,GAAU,gBAAgB,iBAAiB,EACzCA,GAAU,MAAQjc,EAAK,QAAU,GACnCic,GAAU,iBAAiB,gBAAkB5Y,GAAO,CAChDA,EAAG,gBAAgB,EACnBrD,EAAK,OAASqD,EAAG,OAAO,OAAS,GACjC+X,GAAa,CACf,CAAC,IAEDa,GAAY,SAAS,cAAc,OAAO,EAC1CA,GAAU,MAAQjc,EAAK,QAAU,GACjCic,GAAU,iBAAiB,QAAS,IAAM,CACxCjc,EAAK,OAASic,GAAU,MAAM,KAAK,EACnCb,GAAa,CACf,CAAC,EAED,OAAO,OAAOa,GAAU,MAAO,CAC7B,QAAS,WACT,aAAc,MACd,WAAY,6FACZ,OAAQ,iCACR,MAAO,qCACP,MAAO,OACP,UAAW,YACb,CAAC,GAEHF,GAAS,SAAUE,EAAS,EAE5B,IAAIK,GACA,eAAe,IAAI,cAAc,GACnCA,GAAa,SAAS,cAAc,cAAc,EAClDA,GAAW,aAAa,OAAQ,QAAQ,EACxCA,GAAW,MAAQtc,EAAK,OAAS,KAAOA,EAAK,MAAQ,GACrDsc,GAAW,iBAAiB,QAAUjZ,GAAO,CAC3CA,EAAG,gBAAgB,EACnB,IAAM9C,EAAI+b,GAAW,MACjB/b,IAAM,IAAM,MAAM,OAAOA,CAAC,CAAC,EAAG,OAAOP,EAAK,MACzCA,EAAK,MAAQ,OAAOO,CAAC,EAC1B6a,GAAa,CACf,CAAC,IAEDkB,GAAa,SAAS,cAAc,OAAO,EAC3CA,GAAW,KAAO,SAClBA,GAAW,MAAQtc,EAAK,OAAS,KAAOA,EAAK,MAAQ,GACrD,OAAO,OAAOsc,GAAW,MAAO,CAC9B,QAAS,WACT,aAAc,MACd,WAAY,6FACZ,OAAQ,iCACR,MAAO,qCACP,MAAO,OACP,UAAW,YACb,CAAC,EACDA,GAAW,iBAAiB,QAAS,IAAM,CACzC,IAAM/b,EAAI+b,GAAW,MACjB/b,IAAM,IAAM,MAAM,OAAOA,CAAC,CAAC,EAAG,OAAOP,EAAK,MACzCA,EAAK,MAAQ,OAAOO,CAAC,EAC1B6a,GAAa,CACf,CAAC,GAEHW,GAAS,QAASO,EAAU,EAE5B,IAAIC,EACA,eAAe,IAAI,cAAc,GACnCA,EAAa,SAAS,cAAc,cAAc,EAClDA,EAAW,aAAa,OAAQ,QAAQ,EACxCA,EAAW,MAAQvc,EAAK,OAAS,KAAOA,EAAK,MAAQ,GACrDuc,EAAW,iBAAiB,QAAUlZ,GAAO,CAC3CA,EAAG,gBAAgB,EACnB,IAAM9C,EAAIgc,EAAW,MACjBhc,IAAM,IAAM,MAAM,OAAOA,CAAC,CAAC,EAAG,OAAOP,EAAK,MACzCA,EAAK,MAAQ,OAAOO,CAAC,EAC1B6a,GAAa,CACf,CAAC,IAEDmB,EAAa,SAAS,cAAc,OAAO,EAC3CA,EAAW,KAAO,SAClBA,EAAW,MAAQvc,EAAK,OAAS,KAAOA,EAAK,MAAQ,GACrD,OAAO,OAAOuc,EAAW,MAAO,CAC9B,QAAS,WACT,aAAc,MACd,WAAY,6FACZ,OAAQ,iCACR,MAAO,qCACP,MAAO,OACP,UAAW,YACb,CAAC,EACDA,EAAW,iBAAiB,QAAS,IAAM,CACzC,IAAMhc,EAAIgc,EAAW,MACjBhc,IAAM,IAAM,MAAM,OAAOA,CAAC,CAAC,EAAG,OAAOP,EAAK,MACzCA,EAAK,MAAQ,OAAOO,CAAC,EAC1B6a,GAAa,CACf,CAAC,GAEHW,GAAS,QAASQ,CAAU,CAC9B,SAAWvc,EAAK,YAAc,SAAU,CAEtC,IAAMwc,GAAY,SAAS,cAAc,QAAQ,EAC3CC,GAAU,CACd,CAAE,MAAM,SAAU,MAAM,EAAG,EAC3B,CAAE,MAAM,4BAA6B,MAAM,oBAAqB,EAChE,CAAE,MAAM,yBAA0B,MAAM,2CAA4C,EACpF,CAAE,MAAM,6BAA8B,MAAM,oBAAqB,CACnE,EAcA,GAbAA,GAAQ,QAAQ3Z,GAAK,CACnB,IAAM+O,EAAI,SAAS,cAAc,QAAQ,EACzCA,EAAE,MAAQ/O,EAAE,MACZ+O,EAAE,YAAc/O,EAAE,MAClB0Z,GAAU,YAAY3K,CAAC,CACzB,CAAC,EACD2K,GAAU,OAAQ3e,IAAAtB,GAAAkgB,GAAQ,KAAK3Z,GAAKA,EAAE,SAAW9C,EAAK,aAAe,GAAG,IAAtD,YAAAzD,GAAyD,QAAzD,KAAAsB,GAAkE,GACpF2e,GAAU,iBAAiB,SAAU,IAAM,CACzCxc,EAAK,YAAcwc,GAAU,MAC7BpB,GAAa,CACf,CAAC,EACDW,GAAS,cAAeS,EAAS,EAE7BA,GAAU,QAAU,GAAI,CAC1B,IAAME,EAAY,SAAS,cAAc,OAAO,EAChDA,EAAU,YAAc,2BACxBA,EAAU,MAAQ1c,EAAK,aAAe,GACtC0c,EAAU,iBAAiB,QAAS,IAAM,CACxC1c,EAAK,YAAc0c,EAAU,MAC7BtB,GAAa,CACf,CAAC,EACDW,GAAS,eAAgBW,CAAS,CACpC,CACF,SAAW1c,EAAK,YAAc,OAAQ,CACpC,IAAI2c,GACA,eAAe,IAAI,gBAAgB,GACrCA,GAAa,SAAS,cAAc,gBAAgB,EACpDA,GAAW,KAAO,KAAK,KACvBA,GAAW,MAAQ,MAAM,QAAQ3c,EAAK,KAAK,EAAIA,EAAK,MAAQ,CAAC,EAC7D2c,GAAW,iBAAiB,gBAAkBtZ,IAAO,CACnDrD,EAAK,MAAQ,MAAM,QAAQqD,GAAG,OAAO,KAAK,EAAIA,GAAG,OAAO,MAAQ,CAACA,GAAG,OAAO,KAAK,EAChF+X,GAAa,CACf,CAAC,IAEDuB,GAAa,SAAS,cAAc,OAAO,EAC3CA,GAAW,MAAQ,MAAM,QAAQ3c,EAAK,KAAK,EAAIA,EAAK,MAAM,KAAK,GAAG,EAAI,GACtE2c,GAAW,iBAAiB,QAAS,IAAM,CACzC3c,EAAK,MAAQ2c,GAAW,MAAM,MAAM,GAAG,EAAE,IAAIlY,IAAKA,GAAE,KAAK,CAAC,EAAE,OAAO,OAAO,EAC1E2W,GAAa,CACf,CAAC,GAEHW,GAAS,QAASY,EAAU,CAC9B,CACF,GACa,EACbxC,GAAI,YAAY2B,EAAM,EACtB7E,EAAQ,YAAYkD,EAAG,CACzB,CAAC,EAED,IAAMyC,GAAS,SAAS,cAAc,QAAQ,EAC9CA,GAAO,UAAY,MACnBA,GAAO,UAAY,wFACnB,OAAO,OAAOA,GAAO,MAAO,CAAE,UAAU,KAAM,CAAC,EAC/CA,GAAO,iBAAiB,QAAS,IAAM,CACrC/c,EAAQ,KAAK,CAAE,UAAU,QAAS,OAAO,GAAI,MAAM,EAAG,CAAC,EACvDiZ,EAAc,WAAajZ,EAC3B2V,GAAO,EACP4F,GAAa,CACf,CAAC,EACDnE,EAAQ,YAAY2F,EAAM,CAC5B,EAEApH,GAAO,CACT,EAWMuD,GAAc5Z,GAAQ,CAC1B,GAAI,CAAC8X,EAAS,OAEd,IAAIpX,EAAU,MAAM,QAAQV,GAAA,YAAAA,EAAK,UAAU,EAAIA,EAAI,WAAa,CAAC,EAG7D0d,GAAmB,KACjBC,GAAa,SAAY,CAE7B,GAAID,GAAkB,OAAOA,GAC7B,GAAI,CAEF,GAAI,KAAK,MAAQ,OAAO,KAAK,KAAK,QAAW,WAC3C,GAAI,CACF,IAAME,GAAO,MAAM,KAAK,KAAK,OAAO,CAAE,KAAM,kBAAmB,CAAC,EAChE,GAAI,MAAM,QAAQA,EAAI,EACpB,OAAAF,GAAmBE,GACZA,EAEX,MAAQ,CAAC,CAGX,GAAI,KAAK,MAAQ,OAAO,KAAK,KAAK,SAAY,WAC5C,GAAI,CACF,IAAMA,GAAO,MAAM,KAAK,KAAK,QAAQ,MAAO,OAAO,EACnD,GAAI,MAAM,QAAQA,EAAI,EACpB,OAAAF,GAAmBE,GACZA,EAEX,MAAQ,CAAC,CAGX,IAAMC,EAAgB,CAAC,EAavB,GAVI,KAAK,MAAQ,KAAK,KAAK,OAAS,MAAM,QAAQ,KAAK,KAAK,KAAK,GAC/DA,EAAc,KAAK,GAAG,KAAK,KAAK,KAAK,EAEnC,KAAK,MAAQ,KAAK,KAAK,UAAY,MAAM,QAAQ,KAAK,KAAK,SAAS,KAAK,GAC3EA,EAAc,KAAK,GAAG,KAAK,KAAK,SAAS,KAAK,EAE5C,KAAK,MAAQ,KAAK,KAAK,iBAAmB,MAAM,QAAQ,KAAK,KAAK,eAAe,GACnFA,EAAc,KAAK,GAAG,KAAK,KAAK,eAAe,EAG7CA,EAAc,OAAQ,CACxB,IAAM5I,GAAM,IAAI,IAChB4I,EAAc,QAASC,GAAM,CAC3B,IAAMtc,GAAMsc,EAAE,IAAMA,EAAE,SAAWA,EAAE,KAAOA,EAAE,MAAQ,GAC/C7I,GAAI,IAAIzT,EAAG,GAAGyT,GAAI,IAAIzT,GAAKsc,CAAC,CACnC,CAAC,EACD,IAAMjD,GAAM,MAAM,KAAK5F,GAAI,OAAO,CAAC,EACnC,OAAAyI,GAAmB7C,GACZA,EACT,CACF,MAAQ,CAAC,CAET,OAAA6C,GAAmB,CAAC,EACb,CAAC,CACV,EAEMzB,GAAe,IAAM,CAn/LjC,IAAA7e,EAq/LQsD,EAAUA,EAAQ,OAAQtC,IAAMA,IAAK,OAAOA,IAAM,UAAYA,GAAE,SAAS,EACzEub,EAAc,WAAajZ,EAC3B,GAAI,CAAE2Z,IAAA,MAAAA,GAAe,SAASV,EAAgB,MAAQ,CAAC,CACvD,GAAI,EAAEvc,EAAAqc,IAAA,YAAAA,GAAc,YAAd,MAAArc,EAAA,KAAAqc,GAA0BE,EAAgB,MAAQ,CAAC,CACzDoB,GAAapB,CAAa,CAC5B,EACMtD,GAAS,IAAM,CACnByB,EAAQ,UAAY,GAEpB,IAAMiG,EAAQ,SAAS,cAAc,KAAK,EAC1CA,EAAM,MAAM,QAAU,MACtBA,EAAM,MAAM,SAAW,SACvBA,EAAM,MAAM,aAAe,OAC3BA,EAAM,YAAc,2HACpBjG,EAAQ,YAAYiG,CAAK,EAEzB,IAAMC,GAAa,CAACtgB,EAAM2B,KAAc,CACtC3B,EAAK,QAAQ,CAACmD,GAAMtD,KAAQ,CAC1B0gB,GAAgBpd,GAAMnD,EAAMH,GAAK8B,EAAS,CAC5C,CAAC,EAED,IAAM6e,GAAU,SAAS,cAAc,KAAK,EAC5CA,GAAQ,MAAM,UAAY,MAC1B,IAAM5gB,GAAM,SAAS,cAAc,QAAQ,EAC3CA,GAAI,UAAY,MAChBA,GAAI,UAAY,wFAEhB,OAAO,OAAOA,GAAI,MAAO,CACvB,QAAS,OACT,WAAY,SACZ,IAAK,MACL,QAAS,WACT,OAAQ,OACR,aAAc,OACd,WAAY,uBACZ,MAAO,kCACP,OAAQ,UACR,WAAY,KACd,CAAC,EACDA,GAAI,iBAAiB,QAAU4G,IAAO,CACpCA,GAAG,gBAAgB,EAEnB,IAAMia,GAAWD,GAAQ,cAAc,WAAW,EAClD,GAAIC,GAAU,CACZA,GAAS,OAAO,EAChB,MACF,CACA,IAAMC,GAAO,SAAS,cAAc,KAAK,EACzCA,GAAK,UAAY,WACjB,OAAO,OAAOA,GAAK,MAAO,CACxB,SAAU,WACV,UAAW,MACX,OAAQ,iCACR,aAAc,MACd,WAAY,kEACZ,UAAW,2BACb,CAAC,EACe,CACd,CAAE,KAAM,gBAAiB,MAAO,uBAAwB,KAAM,aAAc,EAC5E,CAAE,KAAM,QAAS,MAAO,eAAgB,KAAM,mBAAoB,EAClE,CAAE,KAAM,SAAU,MAAO,SAAU,KAAM,aAAc,EACvD,CAAE,KAAM,OAAQ,MAAO,OAAQ,KAAM,aAAc,EACnD,CAAE,KAAM,MAAO,MAAO,MAAO,KAAM,eAAgB,EACnD,CAAE,KAAM,KAAM,MAAO,KAAM,KAAM,cAAe,CAClD,EACQ,QAAS3U,IAAQ,CACvB,IAAM1D,GAAO,SAAS,cAAc,KAAK,EACzCA,GAAK,MAAM,QAAU,OACrBA,GAAK,MAAM,WAAa,SACxBA,GAAK,MAAM,IAAM,MACjBA,GAAK,MAAM,QAAU,WACrBA,GAAK,MAAM,OAAS,UACpBA,GAAK,iBAAiB,aAAc,IAAMA,GAAK,MAAM,WAAa,0BAA0B,EAC5FA,GAAK,iBAAiB,aAAc,IAAMA,GAAK,MAAM,WAAa,EAAE,EACpEA,GAAK,iBAAiB,QAAS,IAAM,CACnCqY,GAAK,OAAO,EACZ,IAAIC,GACA5U,GAAI,OAAS,OAASA,GAAI,OAAS,KACrC4U,GAAU,CAAE,UAAW5U,GAAI,KAAM,WAAY,CAAC,CAAE,EACvCA,GAAI,OAAS,QACtB4U,GAAU,CAAE,UAAW,QAAS,OAAQ,GAAI,MAAO,EAAG,EAC7C5U,GAAI,OAAS,gBACtB4U,GAAU,CAAE,UAAW,gBAAiB,OAAQ,EAAG,EAC1C5U,GAAI,OAAS,SACtB4U,GAAU,CAAE,UAAW,SAAU,YAAa,EAAG,EACxC5U,GAAI,OAAS,SACtB4U,GAAU,CAAE,UAAW,OAAQ,MAAO,CAAC,CAAE,GAE3C3gB,EAAK,KAAK2gB,EAAO,EACjBvC,GAAmB,IAAIuC,GAAS,EAAI,EACpCpC,GAAa,EACb5F,GAAO,CACT,CAAC,EACD,IAAMiI,GAAK,SAAS,cAAc,SAAS,EAC3CA,GAAG,aAAa,OAAQ7U,GAAI,IAAI,EAChC1D,GAAK,YAAYuY,EAAE,EACnB,IAAMC,GAAK,SAAS,cAAc,MAAM,EACxCA,GAAG,YAAc9U,GAAI,MACrB1D,GAAK,YAAYwY,EAAE,EACnBH,GAAK,YAAYrY,EAAI,CACvB,CAAC,EACDmY,GAAQ,YAAYE,EAAI,CAC1B,CAAC,EACDF,GAAQ,YAAY5gB,EAAG,EACvB+B,GAAU,YAAY6e,EAAO,CAC/B,EACMD,GAAkB,CAACpd,EAAM2d,GAAYjhB,GAAK8B,KAAc,CAC5D,IAAMyB,GAAOD,EAAK,WAAa,QAC3B4d,GAAW3C,GAAmB,IAAIjb,CAAI,EACtC4d,KAAa,SAAWA,GAAW/d,EAAQ,SAAW,GAC1D,IAAMsa,GAAM,SAAS,cAAc,KAAK,EAExC,OAAO,OAAOA,GAAI,MAAO,CACvB,QAAS,OACT,cAAe,SACf,OAAQ,iCACR,WAAY,iCACZ,aAAc,OACd,QAAS,OACT,aAAc,OACd,WAAY,6FACZ,UAAW,0DACb,CAAC,EAED,IAAMhV,GAAS,SAAS,cAAc,KAAK,EAC3CA,GAAO,MAAM,QAAU,OACvBA,GAAO,MAAM,WAAa,SAC1BA,GAAO,MAAM,eAAiB,gBAC9BA,GAAO,MAAM,aAAe,MAE5BA,GAAO,MAAM,aAAe,iCAC5BA,GAAO,MAAM,cAAgB,MAE7BA,GAAO,MAAM,SAAW,WACxB,IAAM6Q,GAAO,SAAS,cAAc,KAAK,EACzCA,GAAK,MAAM,QAAU,OACrBA,GAAK,MAAM,WAAa,SACxBA,GAAK,MAAM,IAAM,MACjB,IAAMvL,GAAS,SAAS,cAAc,QAAQ,EAC9CA,GAAO,UAAY,kBAAkBmT,GAAW,mBAAqB,mBAAmB,eACxF,OAAO,OAAOnT,GAAO,MAAO,CAC1B,OAAQ,OACR,WAAY,cACZ,OAAQ,UACR,QAAS,MACT,QAAS,cACT,WAAY,QACd,CAAC,EACDA,GAAO,iBAAiB,QAAUpH,IAAO,CACvCA,GAAG,gBAAgB,EACnB4X,GAAmB,IAAIjb,EAAM,CAAC4d,EAAQ,EACtCpI,GAAO,CACT,CAAC,EACDQ,GAAK,YAAYvL,EAAM,EAEvB,IAAMgT,GAAK,SAAS,cAAc,SAAS,EACvClC,GAAW,aACXtb,KAAS,gBAAiBsb,GAAW,cAChCtb,KAAS,SAAUsb,GAAW,cAC9Btb,KAAS,OAAQsb,GAAW,cAC5Btb,KAAS,QAASsb,GAAW,oBAC7Btb,KAAS,MAAOsb,GAAW,gBAC3Btb,KAAS,OAAMsb,GAAW,gBACnCkC,GAAG,aAAa,OAAQlC,EAAQ,EAChCvF,GAAK,YAAYyH,EAAE,EACnB,IAAM/K,GAAM,SAAS,cAAc,MAAM,EACzCA,GAAI,MAAM,WAAa,MACvBA,GAAI,MAAM,SAAW,UACrBA,GAAI,MAAM,cAAgB,aAC1BA,GAAI,YAAezS,KAAS,gBACxB,uBACCA,KAAS,QACN,eACCA,KAAS,SACN,SACCA,KAAS,OACN,OACCA,KAAS,MAAQ,MAAQ,KAC1C+V,GAAK,YAAYtD,EAAG,EACpBvN,GAAO,YAAY6Q,EAAI,EAEvB,IAAM6H,GAAK,SAAS,cAAc,QAAQ,EA+B1C,GA9BAA,GAAG,aAAa,QAAS,kBAAkB,EAC3CA,GAAG,UAAY,mDACf,OAAO,OAAOA,GAAG,MAAO,CACtB,OAAQ,OACR,WAAY,cACZ,OAAQ,UACR,QAAS,MACT,QAAS,cACT,WAAY,QACd,CAAC,EAEDA,GAAG,MAAM,SAAW,WACpBA,GAAG,MAAM,OAAS,OAClBA,GAAG,iBAAiB,QAAUxa,IAAO,CAEnCA,GAAG,eAAe,EAClBA,GAAG,gBAAgB,EAInB,IAAMqY,GAAQiC,GAAW,QAAQ3d,CAAI,EACjC0b,GAAQ,IACViC,GAAW,OAAOjC,GAAO,CAAC,EAE5BN,GAAa,EACb5F,GAAO,CACT,CAAC,EACDrQ,GAAO,YAAY0Y,EAAE,EACrB1D,GAAI,YAAYhV,EAAM,EAElBlF,KAAS,OAASA,KAAS,MAC7B,GAAI2d,GAAU,CAMZ,IAAM9B,GAAS,SAAS,cAAc,KAAK,EAI3C,OAAO,OAAOA,GAAO,MAAO,CAC1B,QAAS,OACT,cAAe,SACf,IAAK,OACL,WAAY,SACd,CAAC,EACD,IAAMC,GAAW,CAACC,GAAKvJ,IAAY,CACjC,IAAM3R,EAAO,SAAS,cAAc,KAAK,EACzCA,EAAK,MAAM,QAAU,OACrBA,EAAK,MAAM,cAAgB,SAC3BA,EAAK,MAAM,IAAM,MACjB,IAAMwT,EAAI,SAAS,cAAc,MAAM,EACvCA,EAAE,YAAc0H,GAChB1H,EAAE,MAAM,SAAW,SACnBxT,EAAK,YAAYwT,CAAC,EAClBxT,EAAK,YAAY2R,CAAO,EACxBqJ,GAAO,YAAYhb,CAAI,EAEvB,IAAMgd,IAAMrL,EAAQ,SAAW,IAAI,YAAY,GAC3CqL,KAAO,SAAWA,KAAO,WAC3B,OAAO,OAAOrL,EAAQ,MAAO,CAC3B,QAAS,WACT,aAAc,MACd,WAAY,6FACZ,OAAQ,iCACR,MAAO,qCACP,MAAO,OACP,UAAW,YACb,CAAC,CAEL,EACA,GAAIzS,EAAK,YAAc,QAAS,CAE9B,IAAI+d,GAAM,SAAS,cAAc,kBAAkB,EAEnDA,GAAI,MAAQ/d,EAAK,QAAU,GAI3B+d,GAAI,KAAO,KAAK,KAChBA,GAAI,aAAa,QAAS,eAAe,EAGzCA,GAAI,iBAAiB,gBAAkB1a,GAAO,CAI5CrD,EAAK,OAASqD,EAAG,OAAO,OAAS,GACjC+X,GAAa,CACf,CAAC,EAEI,eAAe,IAAI,kBAAkB,GACxC,eAAe,YAAY,kBAAkB,EAAE,KAAK,IAAM,CAGxD5F,GAAO,CACT,CAAC,EAAE,MAAM,IAAM,CAAC,CAAC,EAEnBuG,GAAS,SAAUgC,EAAG,EAEtB,IAAIC,EACJ,GAAI,eAAe,IAAI,WAAW,EAAG,CACnCA,EAAK,SAAS,cAAc,WAAW,EACvC,IAAM7B,EAAQ,SAAS,cAAc,eAAe,EACpDA,EAAM,aAAa,QAAS,OAAO,EACnCA,EAAM,YAAc,oBACpB,IAAMC,GAAS,SAAS,cAAc,eAAe,EACrDA,GAAO,aAAa,QAAS,WAAW,EACxCA,GAAO,YAAc,wBACrB4B,EAAG,YAAY7B,CAAK,EACpB6B,EAAG,YAAY5B,EAAM,EACrB4B,EAAG,MAAQhe,EAAK,WAAa,KAAO,YAAc,QAClDge,EAAG,iBAAiB,WAAa3a,IAAO,CACtCA,GAAG,gBAAgB,EACnB,IAAM9C,GAAIP,EAAK,WAAa,KAAOA,EAAK,UAAYA,EAAK,MACrDge,EAAG,QAAU,aACfhe,EAAK,UAAYO,GACjB,OAAOP,EAAK,QAEZA,EAAK,MAAQO,GACb,OAAOP,EAAK,WAEdob,GAAa,CACf,CAAC,CACH,MACE4C,EAAK,SAAS,cAAc,QAAQ,EACpCA,EAAG,UAAY,2GACfA,EAAG,MAAQhe,EAAK,WAAa,KAAO,YAAc,QAClDge,EAAG,iBAAiB,SAAW3a,GAAO,CACpCA,EAAG,gBAAgB,EACnB,IAAM9C,GAAIP,EAAK,WAAa,KAAOA,EAAK,UAAYA,EAAK,MACrDge,EAAG,QAAU,aACfhe,EAAK,UAAYO,GACjB,OAAOP,EAAK,QAEZA,EAAK,MAAQO,GACb,OAAOP,EAAK,WAEdob,GAAa,CACf,CAAC,EAED,OAAO,OAAO4C,EAAG,MAAO,CACtB,QAAS,WACT,aAAc,MACd,WAAY,6FACZ,OAAQ,iCACR,MAAO,qCACP,MAAO,OACP,UAAW,YACb,CAAC,EAEHjC,GAAS,aAAciC,CAAE,EAEzB,IAAI1d,EACA,eAAe,IAAI,cAAc,GACrCA,EAAK,SAAS,cAAc,cAAc,EACxCA,EAAG,OAASN,EAAK,WAAa,KAAOA,EAAK,UAAYA,EAAK,QAAU,GACrEM,EAAG,aAAa,QAAS,EAAE,EAC7BA,EAAG,iBAAiB,QAAU+C,GAAO,CAIjCA,EAAG,gBAAgB,EACnB,IAAM6P,GAAM8K,EAAG,MACfhe,EAAKkT,EAAG,EAAI5S,EAAG,MACf,IAAMkP,GAAQ0D,KAAQ,QAAU,YAAc,QAC9C,OAAOlT,EAAKwP,EAAK,EACjB4L,GAAa,CACf,CAAC,IAEH9a,EAAK,SAAS,cAAc,OAAO,EACjCA,EAAG,OAASN,EAAK,WAAa,KAAOA,EAAK,UAAYA,EAAK,QAAU,GAErE,OAAO,OAAOM,EAAG,MAAO,CACtB,QAAS,WACT,aAAc,MACd,WAAY,6FACZ,OAAQ,iCACR,MAAO,qCACP,MAAO,OACP,UAAW,YACb,CAAC,EACDA,EAAG,iBAAiB,QAAU+C,GAAO,CAInCA,EAAG,gBAAgB,EACnB,IAAM6P,GAAM8K,EAAG,MACfhe,EAAKkT,EAAG,EAAI5S,EAAG,MACf,IAAMkP,GAAQ0D,KAAQ,QAAU,YAAc,QAC9C,OAAOlT,EAAKwP,EAAK,EACjB4L,GAAa,CACf,CAAC,GAEHW,GAAS,QAASzb,CAAE,CACtB,SAAWN,EAAK,YAAc,gBAAiB,CAE7C,IAAI+d,GAAM,SAAS,cAAc,kBAAkB,EAEnDA,GAAI,MAAQ/d,EAAK,QAAU,GAC3B+d,GAAI,KAAO,KAAK,KAChBA,GAAI,aAAa,QAAS,eAAe,EAEzCA,GAAI,gBAAgB,iBAAiB,EACrCA,GAAI,iBAAiB,gBAAkB1a,GAAO,CAC5CrD,EAAK,OAASqD,EAAG,OAAO,OAAS,GACjC+X,GAAa,CACf,CAAC,EAEI,eAAe,IAAI,kBAAkB,GACxC,eAAe,YAAY,kBAAkB,EAAE,KAAK,IAAM,CACxD5F,GAAO,CACT,CAAC,EAAE,MAAM,IAAM,CAAC,CAAC,EAEnBuG,GAAS,SAAUgC,EAAG,EAEtB,IAAIE,EACA,eAAe,IAAI,cAAc,GACnCA,EAAQ,SAAS,cAAc,cAAc,EAC7CA,EAAM,aAAa,OAAQ,QAAQ,EACnCA,EAAM,MAAQje,EAAK,OAAS,KAAOA,EAAK,MAAQ,GAClDie,EAAM,iBAAiB,QAAU5a,GAAO,CACpCA,EAAG,gBAAgB,EACnB,IAAM9C,GAAI0d,EAAM,MACZ1d,KAAM,IAAM,MAAM,OAAOA,EAAC,CAAC,EAAG,OAAOP,EAAK,MACzCA,EAAK,MAAQ,OAAOO,EAAC,EAC1B6a,GAAa,CACf,CAAC,IAED6C,EAAQ,SAAS,cAAc,OAAO,EACtCA,EAAM,KAAO,SACbA,EAAM,MAAQje,EAAK,OAAS,KAAOA,EAAK,MAAQ,GAEhD,OAAO,OAAOie,EAAM,MAAO,CACzB,QAAS,WACT,aAAc,MACd,WAAY,6FACZ,OAAQ,iCACR,MAAO,qCACP,MAAO,OACP,UAAW,YACb,CAAC,EACDA,EAAM,iBAAiB,QAAS,IAAM,CACpC,IAAM1d,EAAI0d,EAAM,MACZ1d,IAAM,IAAM,MAAM,OAAOA,CAAC,CAAC,EAAG,OAAOP,EAAK,MACzCA,EAAK,MAAQ,OAAOO,CAAC,EAC1B6a,GAAa,CACf,CAAC,GAEHW,GAAS,QAASkC,CAAK,EAEvB,IAAIC,EACA,eAAe,IAAI,cAAc,GACnCA,EAAQ,SAAS,cAAc,cAAc,EAC7CA,EAAM,aAAa,OAAQ,QAAQ,EACnCA,EAAM,MAAQle,EAAK,OAAS,KAAOA,EAAK,MAAQ,GAClDke,EAAM,iBAAiB,QAAU7a,GAAO,CACpCA,EAAG,gBAAgB,EACnB,IAAM9C,GAAI2d,EAAM,MACZ3d,KAAM,IAAM,MAAM,OAAOA,EAAC,CAAC,EAAG,OAAOP,EAAK,MACzCA,EAAK,MAAQ,OAAOO,EAAC,EAC1B6a,GAAa,CACf,CAAC,IAED8C,EAAQ,SAAS,cAAc,OAAO,EACtCA,EAAM,KAAO,SACbA,EAAM,MAAQle,EAAK,OAAS,KAAOA,EAAK,MAAQ,GAEhD,OAAO,OAAOke,EAAM,MAAO,CACzB,QAAS,WACT,aAAc,MACd,WAAY,6FACZ,OAAQ,iCACR,MAAO,qCACP,MAAO,OACP,UAAW,YACb,CAAC,EACDA,EAAM,iBAAiB,QAAS,IAAM,CACpC,IAAM3d,EAAI2d,EAAM,MACZ3d,IAAM,IAAM,MAAM,OAAOA,CAAC,CAAC,EAAG,OAAOP,EAAK,MACzCA,EAAK,MAAQ,OAAOO,CAAC,EAC1B6a,GAAa,CACf,CAAC,GAEHW,GAAS,QAASmC,CAAK,CACzB,SAAWle,EAAK,YAAc,SAAU,CACtC,IAAMme,GAAO,CACX,CAAE,MAAO,SAAU,MAAO,oBAAqB,EAC/C,CAAE,MAAO,sBAAuB,MAAO,oBAAqB,EAC5D,CAAE,MAAO,wBAAyB,MAAO,qBAAsB,EAC/D,CAAE,MAAO,qBAAsB,MAAO,qBAAsB,CAC9D,EACK,MAAM,QAAQne,EAAK,gBAAgB,IAAGA,EAAK,iBAAmB,CAAC,GACpE,IAAMqC,EAAM,SAAS,cAAc,KAAK,EACxCA,EAAI,MAAM,QAAU,OACpBA,EAAI,MAAM,cAAgB,SAC1BA,EAAI,MAAM,IAAM,MAChB8b,GAAK,QAASvV,GAAQ,CACpB,IAAMwV,EAAQ,SAAS,cAAc,OAAO,EAC5CA,EAAM,MAAM,QAAU,OACtBA,EAAM,MAAM,WAAa,SACzBA,EAAM,MAAM,IAAM,MAClB,IAAMC,GAAK,SAAS,cAAc,OAAO,EACzCA,GAAG,KAAO,WACVA,GAAG,QAAUre,EAAK,iBAAiB,SAAS4I,EAAI,KAAK,EACrDyV,GAAG,iBAAiB,SAAU,IAAM,CAC9BA,GAAG,QACLre,EAAK,iBAAiB,KAAK4I,EAAI,KAAK,EAEpC5I,EAAK,iBAAmBA,EAAK,iBAAiB,OAAQiZ,IAAMA,KAAMrQ,EAAI,KAAK,EAE7E5I,EAAK,YAAcA,EAAK,iBAAiB,KAAK,GAAG,EACjDob,GAAa,CACf,CAAC,EACD,IAAMkD,GAAK,SAAS,cAAc,MAAM,EACxCA,GAAG,YAAc1V,EAAI,MACrBwV,EAAM,YAAYC,EAAE,EACpBD,EAAM,YAAYE,EAAE,EACpBjc,EAAI,YAAY+b,CAAK,CACvB,CAAC,EACDrC,GAAS,eAAgB1Z,CAAG,CAC9B,SAAWrC,EAAK,YAAc,OAAQ,CACpC,IAAIue,GACJ,GAAI,eAAe,IAAI,gBAAgB,EAErCA,GAAK,SAAS,cAAc,gBAAgB,EAC5CA,GAAG,KAAO,KAAK,KACfA,GAAG,aAAa,QAAS,aAAa,EACtCA,GAAG,MAAQ,MAAM,QAAQve,EAAK,KAAK,EAAIA,EAAK,MAAQ,CAAC,EACrDue,GAAG,iBAAiB,gBAAkBlb,GAAO,CAC3C,IAAM7C,EAAM6C,EAAG,OAAO,MACtBrD,EAAK,MAAQ,MAAM,QAAQQ,CAAG,EAAIA,EAAM,CAACA,CAAG,EAC5C4a,GAAa,CACf,CAAC,MACI,CAELmD,GAAK,SAAS,cAAc,KAAK,EACjCA,GAAG,MAAM,QAAU,OACnBA,GAAG,MAAM,cAAgB,SACzBA,GAAG,MAAM,IAAM,MAEf,IAAMC,EAAU,SAAS,cAAc,MAAM,EAC7CA,EAAQ,MAAM,QAAU,MACxBA,EAAQ,MAAM,SAAW,SACzBA,EAAQ,YAAc,sBACtBD,GAAG,YAAYC,CAAO,EAEtB,IAAMC,EAAW,MAAM,QAAQze,EAAK,KAAK,EAAIA,EAAK,MAAQ,CAAC,EAC3D8c,GAAW,EAAE,KAAM4B,GAAU,CAE3B,GADAH,GAAG,UAAY,GACX,MAAM,QAAQG,CAAK,GAAKA,EAAM,OAEhCA,EAAM,QAASzB,IAAM,CACnB,IAAMtc,GAAMsc,GAAE,IAAMA,GAAE,SAAWA,GAAE,KAAOA,GAAE,MAAQ,GAC9C0B,GAAQ1B,GAAE,MAAQtc,GAClBqb,GAAM,SAAS,cAAc,OAAO,EAC1CA,GAAI,MAAM,QAAU,OACpBA,GAAI,MAAM,WAAa,SACvBA,GAAI,MAAM,IAAM,MAChBA,GAAI,MAAM,QAAU,QACpB,IAAMqC,GAAK,SAAS,cAAc,OAAO,EACzCA,GAAG,KAAO,WACVA,GAAG,QAAUI,EAAS,SAAS9d,EAAG,GAAK8d,EAAS,SAASE,EAAK,EAC9DN,GAAG,iBAAiB,SAAU,IAAM,CAClC,IAAIrE,GAAM,MAAM,QAAQha,EAAK,KAAK,EAAIA,EAAK,MAAM,MAAM,EAAI,CAAC,EACxDqe,GAAG,QACArE,GAAI,SAASrZ,EAAG,GAAGqZ,GAAI,KAAKrZ,EAAG,EAEpCqZ,GAAMA,GAAI,OAAQhY,IAAMA,KAAMrB,IAAOqB,KAAM2c,EAAK,EAElD3e,EAAK,MAAQga,GACboB,GAAa,CACf,CAAC,EACD,IAAMkD,GAAK,SAAS,cAAc,MAAM,EACxCA,GAAG,YAAcK,GACjB3C,GAAI,YAAYqC,EAAE,EAClBrC,GAAI,YAAYsC,EAAE,EAClBC,GAAG,YAAYvC,EAAG,CACpB,CAAC,MACI,CAEL,IAAMjY,GAAM,SAAS,cAAc,OAAO,EAC1CA,GAAI,MAAQ,MAAM,QAAQ/D,EAAK,KAAK,EAAIA,EAAK,MAAM,KAAK,GAAG,EAAI,GAE/D,OAAO,OAAO+D,GAAI,MAAO,CACvB,QAAS,WACT,aAAc,MACd,OAAQ,iCACR,WAAY,kEACZ,MAAO,oCACT,CAAC,EACD,IAAM6a,GAAS,IAAM,CACnB5e,EAAK,MAAQ+D,GAAI,MAAM,MAAM,GAAG,EAAE,IAAKU,IAAMA,GAAE,KAAK,CAAC,EAAE,OAAO,OAAO,EACrE2W,GAAa,CACf,EACArX,GAAI,iBAAiB,SAAU6a,EAAM,EACrC7a,GAAI,iBAAiB,OAAQ6a,EAAM,EACnCL,GAAG,YAAYxa,EAAG,CACpB,CACF,CAAC,CACH,CACAgY,GAAS,QAASwC,EAAE,CACtB,CACApE,GAAI,YAAY2B,EAAM,CACxB,UAGI8B,GAAU,CACP,MAAM,QAAQ5d,EAAK,UAAU,IAAGA,EAAK,WAAa,CAAC,GACxD,IAAM6e,GAAiB,SAAS,cAAc,KAAK,EACnDA,GAAe,MAAM,WAAa,OAClC1B,GAAWnd,EAAK,WAAY6e,EAAc,EAC1C1E,GAAI,YAAY0E,EAAc,CAChC,CAEFrgB,GAAU,YAAY2b,EAAG,CAC3B,EAEAgD,GAAWtd,EAASoX,CAAO,CAC7B,EACAzB,GAAO,CACT,EAEM0E,GAAgB/a,GAAQ,CAC5B,KAAKA,GAAA,YAAAA,EAAK,OAAQ,MAAQ,cAAe,CACvCya,GAAuB,KAAK,UAAUza,GAAO,CAAC,CAAC,EAC/CmX,EAAS,UAAY,wIACrBY,EAAY,OAAS,GACrB,MACF,CACA,IAAM4H,EAAU,KAAK,UAAU3f,GAAO,CAAC,CAAC,EACpC2f,IAAYlF,KAChBA,GAAuBkF,EACnBnF,IAAgB,aAAaA,EAAc,EAC/CA,GAAiB,WAAW,SAAY,CACtC,IAAMoF,GAAM,EAAErF,GACdxC,EAAY,OAAS,GACrBZ,EAAS,UAAY,GACrB,MAAMra,GAAI,EACV,GAAI,CACF,IAAM6U,GAAW,MAAM,KAAK,iBAAoB,MAAM,OAAO,gBAAgB,EAC7E,GAAIiO,KAAQrF,GAAS,OACrB,IAAMsF,GAAOlO,GAAQ,kBAAkB3R,CAAG,EAC1C,GAD6C6f,GAAK,KAAO,KAAK,KAC1DD,KAAQrF,GAAS,OACrBpD,EAAS,YAAY0I,EAAI,CAC3B,MAAQ,CAAC,QACT,CAAcD,KAAQrF,KAASxC,EAAY,OAAS,GAAM,CAC5D,EAAG,GAAG,EACR,EAEQ2B,GAAoB,MAAO1Z,GAAQ,CA9mN/C,IAAA5C,GA+mNQ,IAAMwiB,EAAM,EAAErF,GACdlD,EAAW,OAAS,GACpBD,EAAW,UAAY,GACvB,MAAMpa,GAAK,EAEX,IAAM8iB,GAAW9f,EAAI,MAAQ8Y,GAM7B,GAJAwB,GAAS,MAAM,KAAK,yBAAyBwF,GAAU9f,CAAG,EAItD8f,KAAa,cAAe,CAE9B,IAAMnc,GAAI,SAAS,cAAc,KAAK,EACtC,OAAAA,GAAE,MAAM,QAAU,KAClBA,GAAE,MAAM,SAAW,QACnBA,GAAE,YAAc,mFAChByT,EAAW,YAAYzT,EAAC,EAExB8V,GAAe,KACXL,KAAgB,QAAQC,GAAQ,MAAM,EAC1CrB,EAAa,EAAI,EACjBX,EAAW,OAAS,GACb,EACT,CAEF,GAAI,CAACiD,GAAQ,CAEX,IAAM3W,GAAI,SAAS,cAAc,KAAK,EACtC,OAAAA,GAAE,MAAM,QAAU,KAAMA,GAAE,MAAM,SAAW,QAC3CA,GAAE,YAAc,uFACZic,IAAQrF,KACVnD,EAAW,YAAYzT,EAAC,EACxB0T,EAAW,OAAS,IAEtBoC,GAAe,KACfzB,EAAa,EAAI,EACboB,KAAgB,UAAUC,GAAQ,MAAM,EACrC,EACf,CAEM,GAAI,CACFiB,GAAO,KAAO,KAAK,KACdA,GAAO,aAAalD,EAAW,YAAYkD,EAAM,EAGtD,MAAM,QAAQ,QAAQ,EACtB,GAAI,CAAEA,GAAO,UAAUta,CAAG,CAAG,MAAY,CAAyB,CAGlE,GAAI,CACF,IAAM2R,GAAW,MAAM,KAAK,iBAAoB,MAAM,OAAO,gBAAgB,EACvEM,EAAYN,GAAQ,oBAAsB,MAAMA,GAAQ,oBAAoB3R,EAAI,MAAQ8Y,EAAW,EAAI,KAC7G,GAAI7G,GAAA,MAAAA,EAAW,cAAe,CAC5B,IAAM+C,GAAM,OAAO,OAAK5X,GAAA,KAAK,OAAL,YAAAA,GAAW,SAAU,CAAC,CAAC,EACzC2iB,GAAY7Q,IAAI8F,GAAI,OAAQvX,IAAIA,GAAE,WAAWyR,GAAE,GAAG,CAAC,EACnD8Q,EAAS,MAAM/N,EAAU,cAAc,KAAK,KAAM+C,GAAK+K,EAAQ,EACjEC,IAAQhgB,EAAM,KAAK,eAAeA,EAAI,MAAQ8Y,GAAa,CAAE,GAAGkH,CAAO,CAAC,EAC9E,CACF,MAAQ,CAAC,CAGT,MAAM,QAAQ,QAAQ,EACtB,GAAI,CAAE1F,GAAO,UAAUta,CAAG,CAAG,MAAY,CAAyB,CAG9DyZ,IAAgB,KAAK,mBACvBA,GAAa,oBAAoB,iBAAkB,KAAK,gBAAgB,EACxEA,GAAa,oBAAoB,gBAAiB,KAAK,gBAAgB,GAGzE,IAAMwG,GAAW,MAAOxiB,IAAM,CAtrNtC,IAAAL,GAAAsB,EAAAc,GAurNU,IAAMiP,GAAOjP,IAAApC,GAAAK,GAAE,SAAF,YAAAL,GAAU,SAAV,KAAAoC,IAAoBd,EAAAjB,GAAE,SAAF,YAAAiB,EAAU,MAC3C,GAAI,CAAC+P,EAAM,OACX,IAAMyR,GAAWzR,EAAK,MAAQqK,GAC9BA,GAAcoH,GACdvG,EAAgB,KAAK,eAAeuG,GAAUzR,CAAI,EAElDwJ,EAAS,EAAE,EACXD,EAAa,EAAI,EACjB0C,GAAe5B,GAAaa,CAAa,EACzCoB,GAAapB,CAAa,EAC1BU,IAAA,MAAAA,GAAe,SAASV,EAC1B,EAEA,YAAK,iBAAmBsG,GACxB3F,GAAO,iBAAiB,iBAAkB2F,EAAQ,EAClD3F,GAAO,iBAAiB,gBAAiB2F,EAAQ,EAEjDxG,GAAea,GAGXlB,KAAgB,QAAQC,GAAQ,QAAQ,EAE5CrB,EAAa,EAAI,EACV,EACT,QAAE,CACI4H,IAAQrF,KAASlD,EAAW,OAAS,GAC3C,CACF,EAGM8I,GAAY,MAAOngB,GAAQ,CAC/Bqa,GAAgB,MAAM,KAAK,iBACzB9C,EACAvX,EACA,MAAO0R,GAAW,CAztN1B,IAAAtU,GAAAsB,GA0tNU,GAAI,CACF,IAAMwhB,IAAWxO,GAAA,YAAAA,EAAQ,OAAQoH,GAC3BsH,GAAS,KAAK,eAAeF,GAAUxO,GAAU,CAAC,CAAC,EACnD2O,EAAcH,KAAapH,GAQjC,GANAA,GAAcoH,GACdvG,EAAgByG,GAEhB5I,EAAQ,OAAS,GAAMA,EAAQ,YAAc,GAC7CQ,EAAa,EAAI,EAEbqI,EAAa,CAGf,GAFA3F,GAAe5B,GAAaa,CAAa,EAErCF,GAAc,CAChB,GAAI,EAAErc,GAAAqc,GAAa,YAAb,MAAArc,GAAA,KAAAqc,GAAyBE,EAAgB,MAAQ,CAAC,CACpDP,KAAgB,QAAQC,GAAQ,QAAQ,CAC9C,CAEA,GAAI,CAAEO,GAAWD,CAAa,CAAG,MAAQ,CAAC,CAC5C,KAAO,CACL,GAAI,EAAEjb,GAAA+a,IAAA,YAAAA,GAAc,YAAd,MAAA/a,GAAA,KAAA+a,GAA0BE,EAAgB,MAAQ,CAAC,CACzDoB,GAAapB,CAAa,EAE1B,GAAI,CAAEC,GAAWD,CAAa,CAAG,MAAQ,CAAC,CAC5C,CAEF,OAASlc,GAAG,CACV+Z,EAAQ,OAAS,GACjBA,EAAQ,YAAc,mBAAmB,QAAO/Z,IAAA,YAAAA,GAAG,UAAWA,EAAC,CAAC,GAChEua,EAAa,EAAK,CACpB,CACF,EACCva,GAAM,CACL+Z,EAAQ,OAAS,GACjBA,EAAQ,YAAc,iBAAiB,QAAO/Z,GAAA,YAAAA,EAAG,UAAWA,CAAC,CAAC,GAC9Dua,EAAa,EAAK,CACpB,CACF,CACF,EAGMsI,GAAU,MAAOxf,GAAS,CAC9B,GAAI,KAAK,YAAY,IAAIA,CAAI,EAAG,MAAO,CAAE,GAAG,KAAK,YAAY,IAAIA,CAAI,CAAE,EAEvE,IAAId,EAAM,MAAM,KAAK,sBAAsBc,CAAI,EAC/C,YAAK,YAAY,IAAIA,EAAM,CAAE,GAAGd,CAAI,CAAC,EAC9B,CAAE,GAAGA,CAAI,CAClB,EAEMoa,GAAa,MAAOtZ,GAAS,CACjC0W,EAAQ,OAAS,GAAMA,EAAQ,YAAc,GAC7CS,EAAS,EAAE,EACXa,GAAchY,EAEd,GAAI,CACE,OAAOkY,IAAiB,YAAYA,GAAalY,CAAI,CAC3D,MAAQ,CAER,CAEA,IAAMd,EAAOoF,IAAO,QAAUiQ,GAAcA,EAAW,OAAOvU,EAC1D,CAAE,GAAGuU,CAAW,EAChB,MAAMiL,GAAQxf,CAAI,EAEtB6Y,EAAgB,KAAK,eAAe7Y,EAAMd,CAAG,EAG7CyZ,GAAe,KAEfiB,GAAe5Z,EAAM6Y,CAAa,EAClC,MAAMwG,GAAUxG,CAAa,EAC7B,MAAM7c,GAAI,EACVie,GAAapB,CAAa,EAK1B,GAAI,CAAEC,GAAWD,CAAa,CAAG,MAAQ,CAAC,CAM1C,GAAI,CAGF,IAAM4G,GAAW,MAAM7G,GAAkBC,CAAa,EACtDN,GAAQkH,GAAW,SAAW,MAAM,CACtC,MAAQ,CAENlH,GAAQ,MAAM,CAChB,CACArB,EAAa,EAAI,CAEnB,EACMyH,GAAS,SAAY,CACzB,GAAI,CAAC9F,EAAe,OACpB,IAAM6G,EAAW,KAAK,eAAe1H,GAAaa,CAAa,EAC3DvU,IAAS,QAAU,OAAOsR,GAAa,WACzC,MAAMA,EAAS8J,CAAQ,GAEvB,MAAM,KAAK,uBAAuBA,CAAQ,EAC1C,KAAK,aAAaA,GAAU,CAAC,GAAG,IAAI,GAEtC7J,EAAM,CACR,EAEAK,EAAU,iBAAiB,QAASL,CAAK,EACzCM,EAAU,iBAAiB,QAASN,CAAK,EACzCG,EAAO,iBAAiB,QAAS2I,EAAM,EACvC1I,EAAU,iBAAiB,QAAS0I,EAAM,EAC1C7I,EAAM,iBAAiB,UAAYnZ,GAAM,CAAMA,EAAE,MAAQ,UAAUkZ,EAAM,EAAOlZ,EAAE,MAAQ,SAAW,CAACqZ,EAAO,UAAU2I,GAAO,CAAG,CAAC,EAElI,IAAIgB,GAAgB,KACpBvJ,EAAO,iBAAiB,QAAS,IAAM,CACjCuJ,IAAe,aAAaA,EAAa,EAC7CA,GAAgB,WAAWtH,GAAY,GAAG,CAC5C,CAAC,EAGDA,GAAW,EASX,MAAMiB,IAPkB,IAAM,CAr1NlC,IAAAhd,GAy1NM,SAFUA,GAAA,KAAK,aAAL,YAAAA,GAAA,aAAuB,CAAC,GACZ,KAAK,OAAO,GACZ,UACxB,GAEiC,CAAC,EAClC4a,EAAa,EAAI,EAGb5S,IAAS,QAAUiQ,IACrB,MAAM+E,GAAW/E,EAAW,MAAQ,UAAU,EAC9C2C,EAAa,EAAI,EAErB,CAGF,MAAM,sBAAsBlX,EAAM,CAv2NlC,IAAA1D,EAw2NI,IAAMuU,EAAW,MAAM,KAAK,iBAAoB,MAAM,OAAO,gBAAgB,EACzEM,EAAY,KAIhB,GAAInR,IAAS,cAAe,OAAO,KAEnC,GAAI,CAAM6Q,EAAQ,sBAAqBM,EAAY,MAAMN,EAAQ,oBAAoB7Q,CAAI,EAAG,MAAQ,CAAC,CACrG,IAAMkU,EAAM,OAAO,OAAK5X,EAAA,KAAK,OAAL,YAAAA,EAAW,SAAU,CAAC,CAAC,EACzC2iB,EAAY7Q,GAAI8F,EAAI,OAAQvX,GAAIA,EAAE,WAAWyR,EAAE,GAAG,CAAC,EACrDjJ,EAAO,CAAE,KAAAnF,CAAK,EAClB,GAAImR,GAAA,MAAAA,EAAW,cACb,GAAI,CACF,IAAMyO,EAAO,MAAMzO,EAAU,cAAc,KAAK,KAAM+C,EAAK+K,CAAQ,EACnE,GAAIjf,IAAS,SAEX,OAAO4f,EAGLA,GAAQ,OAAOA,GAAS,WAAUza,EAAO,CAAE,GAAGA,EAAM,GAAGya,CAAK,EAClE,MAAQ,CAAC,CAEX,IAAM3iB,EAAQiX,EAAI,CAAC,EACb2L,EAAcZ,EAAS,QAAQ,EAAE,CAAC,GAAKhiB,EAE7C,GAAI,CAAC,SAAS,SAAS,SAAS,QAAQ,OAAO,QAAQ,aAAa,gBAAgB,cAAc,iBAAiB,mBAAmB,KAAK,EAAE,SAAS+C,CAAI,EAAG,CAE3J,IAAM8f,EAAiB,CACrB,OAAUD,EACV,MAAWZ,EAAS,QAAQ,EAAE,KAAK,KAAK,iBAAiB,KAAK,IAAI,CAAC,GAAKY,EACxE,gBAAiBZ,EAAS,cAAc,EAAE,CAAC,GAAKhiB,EAChD,MAASgiB,EAAS,OAAO,EAAE,CAAC,GAAKhiB,EACjC,WAAcgiB,EAAS,SAAS,EAAE,CAAC,GAAKhiB,EACxC,cAAegiB,EAAS,qBAAqB,EAAE,CAAC,GAAKhiB,EACrD,mBAAoBgiB,EAAS,SAAS,EAAE,CAAC,GAAKhiB,EAC9C,IAAOgiB,EAAS,gBAAgB,EAAE,CAAC,GAAKA,EAAS,QAAQ,EAAE,CAAC,GAAKhiB,CACnE,EAAG+C,CAAI,GAAK6f,GAAe5iB,EACvB,CAAC,SAAS,SAAS,SAAS,QAAQ,OAAO,QAAQ,aAAa,gBAAgB,cAAc,gBAAgB,EAAE,SAAS+C,CAAI,EAC/HmF,EAAK,OAAS2a,EACL9f,IAAS,oBAClBmF,EAAK,OAAS2a,EACd3a,EAAK,aAAe,GACpBA,EAAK,cAAgB,GACrBA,EAAK,cAAgB,SACZnF,IAAS,QAClBmF,EAAK,SAAW,CAAC2a,CAAa,EAAE,OAAO,OAAO,EAC9C3a,EAAK,WAAa,OAEtB,CACA,GAAI,CAAC,WAAW,SAAS,iBAAiB,gBAAgB,kBAAkB,EAAE,SAASnF,CAAI,EAAG,CAC5F,IAAM+f,EAAQ9L,IAAaA,GAAA,MAAAA,EAAS,OAASC,EAAI,OAAOvX,GAAKsX,EAAQ,SAAStX,EAAE,MAAM,GAAG,EAAE,CAAC,CAAC,CAAC,EAAIuX,GAAK,MAAM,EAAE,CAAC,EAC5GlU,IAAS,mBAAoBmF,EAAK,SAAW4a,EAAK,CAAC,SAAS,SAAS,cAAc,CAAC,EACnF5a,EAAK,SAAW4a,EAAK,CAC5B,CAqCA,GApCI/f,IAAS,aAEXmF,EAAK,QAAU,iBAEbnF,IAAS,WACXmF,EAAK,MAAQ,QAEXnF,IAAS,WACXmF,EAAK,UAAY,GACjBA,EAAK,UAAY,IAEfnF,IAAS,SACXmF,EAAK,kBAAoB,SACzBA,EAAK,SAAW,IAEdnF,IAAS,mBACXmF,EAAK,MAAQA,EAAK,OAAS,SAE3BA,EAAK,MAAQA,EAAK,OAAS,0DAEzBnF,IAAS,mBACXmF,EAAK,MAAQA,EAAK,OAAS,0DAEzBnF,IAAS,WACXmF,EAAK,IAAMA,EAAK,KAAO,gCACvBA,EAAK,aAAeA,EAAK,cAAgB,OAQvCnF,IAAS,gBACXmF,EAAK,OAASA,EAAK,QAAU,CAAC,WAAW,UAAU,GAEjDnF,IAAS,OAEX,GAAI,CACF,IAAMggB,EAAS,KAAK,MAAQ,KAAK,KAAK,MAAS,OAAO,OAAO,KAAK,KAAK,KAAK,EAAI,CAAC,EAC7EA,EAAM,OACR7a,EAAK,KAAO6a,EAAM,CAAC,EAAE,SAAWA,EAAM,CAAC,EAAE,MAAQA,EAAM,CAAC,EAAE,GAG1D7a,EAAK,KAAOlI,EAAQA,EAAM,MAAM,GAAG,EAAE,CAAC,EAAI,eAG5CkI,EAAK,aAAe,UACpBA,EAAK,cAAgBA,EAAK,eAAiB,CAAC,WAAW,QAAQ,EAC/DA,EAAK,eAAiBA,EAAK,gBAAkB,CAAC,cAAc,UAAU,EACtEA,EAAK,kBAAoB,QAC3B,MAAQ,CAAC,CAGX,OAAOA,CACT,CAEA,2BAA4B,CAC1B,IAAMxE,EAAQ,MAAM,KAAK,KAAK,cAAc,iBAAiB,qCAAqC,CAAC,EAC7Fsf,EAAW,IAAI,IACf7e,EAAK,KAAK,SAChBT,EAAM,QAASc,GAAM,CACnB,IAAMM,EAAK,WAAWN,EAAE,aAAa,QAAQ,CAAC,GAAK,EAC7CO,EAAK,WAAWP,EAAE,aAAa,QAAQ,CAAC,GAAK,EAC7CsB,EAAS,WAAW,iBAAiBtB,CAAC,EAAE,KAAK,GAAM,IACnDqK,EAAS,WAAW,iBAAiBrK,CAAC,EAAE,MAAM,GAAK,IACnDye,EAAS,KAAK,MAAMne,EAAEX,CAAE,EAAG+e,EAAS,KAAK,MAAMne,EAAEZ,CAAE,EACnDgf,EAAS,KAAK,OAAOre,EAAEgB,GAAO3B,CAAE,EAAGif,EAAO,KAAK,OAAOre,EAAE8J,GAAQ1K,CAAE,EACxE,QAASkf,EAAGJ,EAAQI,EAAGF,EAAME,IAAM,QAASC,EAAGJ,EAAQI,EAAGF,EAAME,IAAMN,EAAS,IAAI,GAAGK,CAAE,IAAIC,CAAE,EAAE,CAClG,CAAC,EACD,IAAID,EAAG,EAAGC,EAAG,EACb,KAAON,EAAS,IAAI,GAAGK,CAAE,IAAIC,CAAE,EAAE,GAAKD,GAAI,EAAOA,EAAG,KAAMA,EAAG,EAAGC,GAAI,GACpE,MAAO,CAAE,EAAGD,EAAGlf,EAAI,EAAGmf,EAAGnf,CAAG,CAC9B,CAEA,MAAM,uBAAuBof,EAAY,CACvC,KAAK,sBAAsB,EAC3B,IAAMxY,EAAS,MAAM,KAAK,YAAYwY,CAAU,EAC1C3f,EAAO,KAAK,aAAamH,CAAM,EAC/B2F,EAAO,KAAK,0BAA0B,EAC5C,KAAK,iBAAiB9M,EAAM8M,EAAK,EAAGA,EAAK,CAAC,EAC1C9M,EAAK,MAAM,MAAS,GAAG,GAAG,KAAK,QAAQ,KACvCA,EAAK,MAAM,OAAS,GAAG,GAAG,KAAK,QAAQ,KACvCA,EAAK,MAAM,OAAS,OAAO,KAAK,UAAU,EAAI,CAAC,EAC/C,KAAK,cAAc,YAAYA,CAAI,EAErC,GAAI,CAAE,KAAK,aAAaA,EAAK,iBAAiB,CAAG,MAAQ,CAAC,CACxD,KAAK,kBAAkBA,CAAI,EAC3B,KAAK,iBAAiB,EACtB,KAAK,WAAW,KAAK,EACrB,KAAK,OAAO,uBAAuB,EACnC,KAAK,kBAAkB,EAIvB,GAAI,CAAE,KAAK,kBAAkB,CAAG,MAAQ,CAAC,CAC3C,CAGA,iBAAiBA,EAAMuG,EAAM,KAAM,CACjC,IAAM9B,EAAK8B,GAAO,KAAO,CAAC,KAAK,WAAW,IAAIvG,CAAI,EAAI,CAAC,CAACuG,EACpD9B,EAAI,KAAK,WAAW,IAAIzE,CAAI,EAAQ,KAAK,WAAW,OAAOA,CAAI,EACnEA,EAAK,UAAU,OAAO,WAAYyE,CAAE,CACtC,CACA,iBAAkB,CAChB,QAAW7D,KAAK,KAAK,WAAYA,EAAE,UAAU,OAAO,UAAU,EAC9D,KAAK,WAAW,MAAM,CACxB,CAUA,gBAAiB,CAnhOnB,IAAAnF,EAAAsB,EAAAc,EAohOI,GAAI,CAEF,IAAM+hB,EAAW,KAAK,WAAa,MAAM,KAAK,KAAK,UAAU,EAAI,CAAC,EAClE,GAAI,CAACA,EAAS,OAAQ,EACpBnkB,EAAA,KAAK,SAAL,MAAAA,EAAA,UAAc,6BACd,MACF,CAEA,IAAIokB,EAAO,IAAUC,EAAO,IACtB7b,EAAQ,CAAC,EACf,QAAWrD,KAAKgf,EAAU,CAExB,GAAIhf,EAAE,QAAQ,YAAa,SAC3B,IAAMM,EAAI,WAAWN,EAAE,aAAa,QAAQ,CAAC,GAAK,EAC5CO,EAAI,WAAWP,EAAE,aAAa,QAAQ,CAAC,GAAK,EAC9CM,EAAI2e,IAAMA,EAAO3e,GACjBC,EAAI2e,IAAMA,EAAO3e,EACvB,CACA,QAAWP,KAAKgf,EAAU,CACxB,GAAIhf,EAAE,QAAQ,YAAa,SAC3B,IAAMvC,EAAM,KAAK,mBAAmBuC,EAAE,iBAAiB,GAAK,CAAC,EACvDM,EAAI,WAAWN,EAAE,aAAa,QAAQ,CAAC,GAAK,EAC5C,EAAI,WAAWA,EAAE,aAAa,QAAQ,CAAC,GAAK,EAC5CsB,EAAStB,EAAE,MAAM,OAAU,GAAGA,EAAE,sBAAsB,EAAE,KAAK,KAC7DqK,EAASrK,EAAE,MAAM,QAAU,GAAGA,EAAE,sBAAsB,EAAE,MAAM,KACpEqD,EAAM,KAAK,CAAE,IAAA5F,EAAK,GAAI6C,EAAI2e,EAAM,GAAI,EAAIC,EAAM,MAAA5d,EAAO,OAAA+I,CAAO,CAAC,CAC/D,CAEA,OAAO,kBAAoB,CAAE,MAAAhH,CAAM,GACnClH,EAAA,KAAK,SAAL,MAAAA,EAAA,UAAc,UAAUkH,EAAM,MAAM,QAAQA,EAAM,SAAW,EAAI,GAAK,GAAG,IAC3E,OAASgM,EAAK,CACZ,QAAQ,KAAK,mCAAoCA,CAAG,GACpDpS,EAAA,KAAK,SAAL,MAAAA,EAAA,UAAc,eAChB,CACF,CAUA,MAAM,iBAAkB,CAhkO1B,IAAApC,EAAAsB,EAAAc,EAAAC,EAikOI,GAAI,CACF,IAAMiiB,EAAO,OAAO,kBACpB,GAAI,CAACA,GAAQ,CAAC,MAAM,QAAQA,EAAK,KAAK,GAAK,CAACA,EAAK,MAAM,OAAQ,EAC7DtkB,EAAA,KAAK,SAAL,MAAAA,EAAA,UAAc,uBACd,MACF,CACA,IAAMwI,EAAQ8b,EAAK,MAIfC,EAAQ,EACRpS,EACJ,EAAG,CACD,IAAMqS,EAAQ,KAAK,SAAWD,EACxBE,EAAQ,KAAK,SAAWF,EAC9BpS,EAAgB3J,EAAM,IAAK4M,GAAO,CAChC,IAAMjQ,EAAI,WAAWiQ,EAAG,KAAK,GAAK,EAC5BlP,EAAI,WAAWkP,EAAG,MAAM,GAAK,EACnC,MAAO,CAAE,EAAGoP,GAASpP,EAAG,IAAM,GAAI,EAAGqP,GAASrP,EAAG,IAAM,GAAI,EAAAjQ,EAAG,EAAAe,CAAE,CAClE,CAAC,EACDqe,GAAS,CAEX,OAAS,KAAK,iBAAiBpS,EAAe,IAAI,GAAK,GAEvD,IAAMqS,EAAQ,KAAK,UAAYD,EAAQ,GACjCE,EAAQ,KAAK,UAAYF,EAAQ,GAEvC,QAAWnP,KAAM5M,EAAO,CACtB,IAAM5F,EAAMwS,EAAG,KAAO,CAAC,EACjB1J,EAAS,MAAM,KAAK,YAAY9I,CAAG,EACnC2B,EAAO,KAAK,aAAamH,CAAM,EAErCnH,EAAK,MAAM,MAAS6Q,EAAG,MACvB7Q,EAAK,MAAM,OAAS6Q,EAAG,OAEvB,IAAM3P,EAAI+e,GAASpP,EAAG,IAAM,GACtB1P,EAAI+e,GAASrP,EAAG,IAAM,GAC5B,KAAK,iBAAiB7Q,EAAMkB,EAAGC,CAAC,EAEhCnB,EAAK,MAAM,OAAS,OAAO,KAAK,UAAU,EAAI,CAAC,EAE/C,GAAI,CACF,IAAMoB,EAAM,KAAK,gBAAgB,KAAK,WAAa,KAAK,UAAU,EAC9DA,IAAKpB,EAAK,QAAQ,MAAQoB,EAChC,MAAQ,CAAC,CAET,KAAK,cAAc,YAAYpB,CAAI,EAInC,GAAI,CAAE,KAAK,aAAaA,EAAK,iBAAiB,CAAG,MAAQ,CAAC,CAC1D,KAAK,kBAAkBA,CAAI,CAC7B,CAEA,KAAK,iBAAiB,EACtB,KAAK,gBAAgB,GAErBjD,EAAA,KAAK,aAAL,MAAAA,EAAA,UAAkB,UAClBc,EAAA,KAAK,SAAL,MAAAA,EAAA,UAAc,UAAUoG,EAAM,MAAM,QAAQA,EAAM,SAAW,EAAI,GAAK,GAAG,IAC3E,OAASgM,EAAK,CACZ,QAAQ,KAAK,oCAAqCA,CAAG,GACrDnS,EAAA,KAAK,SAAL,MAAAA,EAAA,UAAc,gBAChB,CACF,CAEA,0BAA2B,CACzB,IAAMS,EAAO,KAAK,cACdyK,EAAO,EAAGC,EAAO,EAAGkX,EAAQ,KAAMC,EAAO,GAEvCC,EAAW9d,GAAO,CACtB,IAAMnH,EAAImD,EAAK,sBAAsB,EAC/B2C,EAAK,YAAaqB,GAAMA,EAAG,QAAQ,CAAC,EAAKA,EAAG,QAAQ,CAAC,EAAE,QAAUA,EAAG,QACpEpB,EAAK,YAAaoB,GAAMA,EAAG,QAAQ,CAAC,EAAKA,EAAG,QAAQ,CAAC,EAAE,QAAUA,EAAG,QAC1E,MAAO,CAAE,EAAGrB,EAAI9F,EAAE,KAAM,EAAG+F,EAAI/F,EAAE,GAAI,CACvC,EAEMklB,EAAY,CAACpf,EAAEC,IAAM,CACzB,IAAM0e,EAAO,KAAK,IAAI3e,EAAG8H,CAAM,EAAGgE,EAAO,KAAK,IAAI9L,EAAG8H,CAAM,EACrD8W,EAAO,KAAK,IAAI3e,EAAG8H,CAAM,EAAGgE,EAAO,KAAK,IAAI9L,EAAG8H,CAAM,EAC3DkX,EAAQ,MAAM,KAAO,GAAGN,CAAI,KAC5BM,EAAQ,MAAM,IAAM,GAAGL,CAAI,KAC3BK,EAAQ,MAAM,MAAQ,GAAGnT,EAAK6S,CAAI,KAClCM,EAAQ,MAAM,OAAQ,GAAGlT,EAAK6S,CAAI,KAElC,IAAMS,EAAQJ,EAAQ,sBAAsB,EACtCrgB,EAAQvB,EAAK,iBAAiB,qCAAqC,EACzE,KAAK,gBAAgB,EACrBuB,EAAM,QAAQc,GAAK,CACjB,IAAM4f,EAAK5f,EAAE,sBAAsB,EACnB,EAAE4f,EAAG,MAAQD,EAAM,MAAQC,EAAG,KAAOD,EAAM,OAASC,EAAG,OAASD,EAAM,KAAOC,EAAG,IAAMD,EAAM,SAC/F,KAAK,iBAAiB3f,EAAG,EAAI,CAC5C,CAAC,CACH,EAEM6f,EAAQ3kB,GAAM,CAElB,GADI,CAAC,KAAK,UACNA,EAAE,OAAO,QAAQ,eAAe,EAAG,OACvCskB,EAAS,GACT,IAAMpe,EAAIqe,EAAQvkB,CAAC,EACnBkN,EAAShH,EAAE,EAAGiH,EAASjH,EAAE,EACzBme,EAAU,SAAS,cAAc,KAAK,EACtCA,EAAQ,UAAY,UACpBA,EAAQ,MAAM,KAAO,GAAGnX,CAAM,KAC9BmX,EAAQ,MAAM,IAAO,GAAGlX,CAAM,KAC9B1K,EAAK,YAAY4hB,CAAO,EACxBrkB,EAAE,eAAe,CACnB,EACM4kB,EAAQ5kB,GAAM,CAAM,CAACskB,GAAU,CAACD,GAAiBG,EAAUD,EAAQvkB,CAAC,EAAE,EAAGukB,EAAQvkB,CAAC,EAAE,CAAC,CAAG,EACxF2hB,EAAK,IAAM,CAAO2C,IAAgBA,EAAS,GAAWD,GAASA,EAAQ,OAAO,EAAGA,EAAU,KAAM,EAEvG5hB,EAAK,iBAAiB,YAAakiB,CAAI,EACvC,OAAO,iBAAiB,YAAaC,CAAI,EACzC,OAAO,iBAAiB,UAAWjD,CAAE,EACrClf,EAAK,iBAAiB,aAAezC,GAAI,CAAO,KAAK,WAAsBA,EAAE,OAAO,QAAQ,eAAe,GAAW2kB,EAAK3kB,CAAC,EAAG,EAAG,CAAC,QAAQ,EAAK,CAAC,EACjJ,OAAO,iBAAiB,YAAcA,GAAI,CAAE4kB,EAAK5kB,CAAC,CAAG,EAAG,CAAC,QAAQ,EAAK,CAAC,EACvE,OAAO,iBAAiB,WAAY2hB,CAAE,EACtC,OAAO,iBAAiB,cAAeA,CAAE,CAC3C,CAGA,MAAM,kBAAmB,CAzrO3B,IAAAhiB,EAAAsB,EA0rOI,IAAMkY,EAAQ,SAAS,cAAc,KAAK,EAC1CA,EAAM,UAAY,QAClB,IAAM0L,EAAK,KAAK,YAAc,SACxBC,EAAY,KAAK,YAAc,CAAC,CAAC,KAAK,WAEtCC,EAAcC,GAASA,EAAK,MAAM,IAAI,EAAE,IAAI1lB,GAChD;AAAA,mCAC6BA,EAAE,CAAC;AAAA,oDACcA,EAAE,IAAI;AAAA,wCAClB,KAAK,MAAMA,EAAE,GAAG,CAAC;AAAA,UAC/CA,EAAE,MAAQ,iMAAiM,KAAK,MAAM,KAAK,UAAUA,EAAE,MAAO,KAAM,CAAC,CAAC,CAAC,SAAW,EAAE;AAAA,aAE1Q,EAAE,KAAK,EAAE,EAET6Z,EAAM,UAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qEAW0C,KAAK,QAAMxZ,EAAA,KAAK,UAAL,YAAAA,EAAc,cAAe,EAAE,CAAC,wBAAmB,KAAK,MAAMklB,CAAE,CAAC;AAAA,sDACtF,KAAK,WAAa,MAAQ,IAAI;AAAA,mDACjCC,EAAY,iBAAmB,wBAAwB;AAAA,2CAC/D,KAAK,SAAW,OAAO,KAAK,gBAAgB,OAAS,KAAK;AAAA,iDACtD7jB,EAAA,KAAK,gBAAL,YAAAA,EAAoB,iBAAiB,uCAAuC,SAAU,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+FAavC8jB,EAAW,KAAK,SAAS,CAAC,CAAC;AAAA;AAAA;AAAA,cAKtH,IAAM7L,EAAQ,IAAMC,EAAM,OAAO,EACjCA,EAAM,cAAc,YAAY,EAAE,iBAAiB,QAASD,CAAK,EACjE,KAAK,WAAW,YAAYC,CAAK,EAEjC,IAAM8L,EAAc,IAAM,CACxB,IAAMC,EAAU/L,EAAM,cAAc,UAAU,EACxCgM,EAAmBH,GAASA,EAAK,MAAM,IAAI,EAAE,IAAI1lB,GACrD;AAAA,qCAC6BA,EAAE,CAAC;AAAA,sDACcA,EAAE,IAAI;AAAA,0CAClB,KAAK,MAAMA,EAAE,GAAG,CAAC;AAAA,YAC/CA,EAAE,MAAQ,iMAAiM,KAAK,MAAM,KAAK,UAAUA,EAAE,MAAO,KAAM,CAAC,CAAC,CAAC,SAAW,EAAE;AAAA,eAE1Q,EAAE,KAAK,EAAE,EACT4lB,EAAQ,UAAYC,EAAgB,KAAK,SAAS,CAAC,EACnDD,EAAQ,UAAYA,EAAQ,YAC9B,EAEA/L,EAAM,cAAc,cAAc,EAAE,iBAAiB,QAAS,SAAY,CACxE,GAAI,CAAE,KAAK,SAAS,QAAS,gBAAgB,EAAG,MAAM,KAAK,cAAc,CAAG,QAC5E,CAAU8L,EAAY,CAAG,CAC3B,CAAC,EAED9L,EAAM,cAAc,YAAY,EAAE,iBAAiB,QAAS,SAAY,CACtE,MAAM,KAAK,YAAY,EAAK,EAC5B8L,EAAY,CACd,CAAC,EAED9L,EAAM,cAAc,aAAa,EAAE,iBAAiB,QAAS,IAAM,CAEjE,IAAMxO,EADQ,MAAM,KAAK,KAAK,cAAc,iBAAiB,qCAAqC,CAAC,EAC/E,IAAK7F,GAAI,CAC3B,IAAMM,EAAI,WAAWN,EAAE,aAAa,QAAQ,CAAC,GAAK,EAC5CO,EAAI,WAAWP,EAAE,aAAa,QAAQ,CAAC,GAAK,EAC5CsB,EAAS,WAAWtB,EAAE,MAAM,KAAK,GAAMA,EAAE,sBAAsB,EAAE,MACjEqK,EAAS,WAAWrK,EAAE,MAAM,MAAM,GAAKA,EAAE,sBAAsB,EAAE,OACjEqL,EAAI,SAASrL,EAAE,MAAM,QAAU,IAAK,EAAE,EACtCsgB,EAAU,KAAK,mBAAmBtgB,EAAE,iBAAiB,EACrDwG,EAAQxG,EAAE,QAAQ,OAAS,KAAK,WACtC,MAAO,CAAE,KAAMsgB,EAAS,SAAS,CAAC,EAAAhgB,EAAE,EAAAC,CAAC,EAAG,KAAK,CAAC,MAAAe,EAAM,OAAA+I,CAAM,EAAG,EAAAgB,EAAG,MAAA7E,CAAM,CACxE,CAAC,EACO+Z,EAAU,CACZ,QAAS,EACT,QAAS,KAAK,mBAAmB,EACjC,MAAO1a,CACX,EACI2a,EAAO,IAAI,KAAK,CAAC,KAAK,UAAUD,EAAQ,KAAK,CAAC,CAAC,EAAG,CAAC,KAAK,kBAAkB,CAAC,EAC3EjmB,EAAI,SAAS,cAAc,GAAG,EACpCA,EAAE,KAAO,IAAI,gBAAgBkmB,CAAI,EACjClmB,EAAE,SAAW,OAAO,KAAK,YAAc,QAAQ,QAC/CA,EAAE,MAAM,EACR,IAAI,gBAAgBA,EAAE,IAAI,CAC5B,CAAC,EAED+Z,EAAM,cAAc,aAAa,EAAE,iBAAiB,QAAS,SAAY,CACvE,IAAMhS,EAAM,SAAS,cAAc,OAAO,EAC1CA,EAAI,KAAO,OAAQA,EAAI,OAAS,mBAChCA,EAAI,SAAW,SAAY,CAjyOjC,IAAAxH,EAAAsB,EAAAc,EAAAC,EAAAC,EAAAmC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAO,EAAAC,EAAA0E,EAkyOQ,IAAM6b,GAAO5lB,EAAAwH,EAAI,QAAJ,YAAAxH,EAAY,GAAI,GAAI,CAAC4lB,EAAM,OACxC,IAAMnN,EAAM,MAAMmN,EAAK,KAAK,EAC5B,GAAI,CACF,IAAMC,EAAO,KAAK,MAAMpN,CAAG,EAG3B,GAFA,KAAK,SAAS,SAAU,cAAe,CAAE,MAAOA,EAAI,MAAO,CAAC,EAC5D,KAAK,cAAc,UAAY,IAC3BnX,EAAAukB,EAAK,QAAL,MAAAvkB,EAAY,OACd,QAAWmK,KAAQoa,EAAK,MACtB,GAAI,EAACpa,GAAA,MAAAA,EAAM,OAAS,OAAOA,EAAK,MAAS,UAAY,OAAO,KAAKA,EAAK,IAAI,EAAE,SAAW,EAAI,CACzF,IAAMlF,EAAI,KAAK,qBAAmBnE,EAAAqJ,EAAK,WAAL,YAAArJ,EAAe,IAAG,IAAGC,EAAAoJ,EAAK,WAAL,YAAApJ,EAAe,IAAG,IAAGC,EAAAmJ,EAAK,OAAL,YAAAnJ,EAAW,QAAO,MAAKmC,EAAAgH,EAAK,OAAL,YAAAhH,EAAW,SAAQ,GAAG,EACzH,KAAK,cAAc,YAAY8B,CAAC,CAClC,KAAO,CACL,IAAMhE,EAAK,MAAM,KAAK,YAAYkJ,EAAK,IAAI,EACrClH,GAAO,KAAK,aAAahC,CAAE,EACjC,KAAK,iBAAiBgC,KAAMG,EAAA+G,EAAK,WAAL,YAAA/G,EAAe,IAAG,IAAGC,EAAA8G,EAAK,WAAL,YAAA9G,EAAe,IAAG,CAAC,EACxEJ,GAAK,QAAQ,MAAQ,KAAK,gBAAgBkH,EAAK,OAASA,EAAK,QAAU,KAAK,UAAU,EACtF,KAAK,iBAAiBlH,KAAMK,EAAA6G,EAAK,WAAL,YAAA7G,EAAe,IAAG,IAAGC,EAAA4G,EAAK,WAAL,YAAA5G,EAAe,IAAG,CAAC,EAChEN,GAAK,MAAM,MAAQ,KAAGa,EAAAqG,EAAK,OAAL,YAAArG,EAAW,QAAO,GAAG,KAC3Cb,GAAK,MAAM,OAAQ,KAAGc,EAAAoG,EAAK,OAAL,YAAApG,EAAW,SAAQ,GAAG,KAC5C,KAAK,cAAc,YAAYd,EAAI,EAE3C,GAAI,CAAE,KAAK,aAAaA,GAAK,iBAAiB,CAAG,MAAQ,CAAC,CAClE,KAAK,kBAAkBA,EAAI,CACb,MAGF,KAAK,sBAAsB,GAC/BwF,EAAA,KAAK,kBAAL,MAAAA,EAAA,WAEE,KAAK,iBAAiB,EACtB,MAAM,KAAK,YAAY,EAAK,CAC9B,OAAS1J,EAAG,CACV,KAAK,SAAS,SAAU,eAAgB,CAAE,MAAO,OAAOA,CAAC,CAAE,CAAC,CAC9D,CACA,IAAMyG,EAAK,IAAI,MAAM,gBAAgB,EAAG,OAAO,cAAcA,CAAE,CACjE,EACAU,EAAI,MAAM,CACZ,CAAC,EAEDgS,EAAM,cAAc,gBAAgB,EAAE,iBAAiB,QAAS,SAAY,CAC1E,GAAI,CAAC,KAAK,WACR,YAAK,SAAS,OAAQ,iCAAiC,EAChD8L,EAAY,EAErB,IAAM3O,GAAO,KAAK,YAAc,YAAc,YACxC+O,EAAU,CAAE,EAAG,KAAK,IAAI,EAAG,IAAK,WAAY,EAClD,GAAI,CACF,MAAM,KAAK,qBAAqB/O,EAAK+O,CAAO,EAC5C,IAAMI,EAAO,MAAM,KAAK,uBAAuBnP,CAAG,EAClD,KAAK,SAAS,OAAQ,oBAAqB,CAAE,MAAO+O,EAAS,KAAMI,CAAK,CAAC,CAC3E,OAASzlB,EAAG,CACV,KAAK,SAAS,OAAQ,oBAAqB,CAAE,MAAO,OAAOA,CAAC,CAAE,CAAC,CACjE,CACAilB,EAAY,CACd,CAAC,EAEDA,EAAY,CACd,CASA,wBAAyB,CAp2O3B,IAAAtlB,EAAAsB,EAAAc,EAAAC,EAAAC,EAAAmC,EAAAC,EAs2OI,IAAM8U,EAAQ,SAAS,cAAc,KAAK,EAC1CA,EAAM,UAAY,QAGlBA,EAAM,UAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAwGlB,IAAMuM,EAAgB,KAAK,WAAW,cAAc,QAAQ,EAC5D,GAAIA,EAAe,CACjB,GAAI,CAAEA,EAAc,OAAO,CAAG,MAAQ,CAAC,CAEnC,KAAK,kBAAoBA,IAAe,KAAK,gBAAkB,KACrE,CAGA,GAAI,KAAK,gBAAiB,CACxB,GAAI,CAAE,KAAK,gBAAgB,OAAO,CAAG,MAAQ,CAAC,CAC9C,KAAK,gBAAkB,IACzB,CAEA,KAAK,gBAAkBvM,EACvB,KAAK,WAAW,YAAYA,CAAK,EAGjC,IAAMwM,EAAaxM,EAAM,cAAc,yBAAyB,EAC1DyM,EAAazM,EAAM,cAAc,uBAAuB,EACxD0M,EAAa1M,EAAM,cAAc,sBAAsB,EACvD2M,EAAa3M,EAAM,cAAc,sBAAsB,EACvD4M,EAAa5M,EAAM,cAAc,uBAAuB,EACxD6M,EAAa7M,EAAM,cAAc,uBAAuB,EACxD8M,EAAa9M,EAAM,cAAc,uBAAuB,EACxD+M,EAAa/M,EAAM,cAAc,+BAA+B,EAChEgN,EAAahN,EAAM,cAAc,uBAAuB,EACxDiN,EAAajN,EAAM,cAAc,qBAAqB,EACtDkN,EAAalN,EAAM,cAAc,6BAA6B,EAC9DmN,EAAanN,EAAM,cAAc,0BAA0B,EAC3DoN,EAAapN,EAAM,cAAc,qBAAqB,EACtDqN,EAAarN,EAAM,cAAc,oBAAoB,EACrDsN,EAAatN,EAAM,cAAc,oBAAoB,EAgB3D,GAbIwM,IAAYA,EAAQ,QAAa,CAAC,CAAC,KAAK,iBACxCC,IAAYA,EAAQ,MAAa,OAAO,KAAK,UAAY,GAAG,GAC5DC,IAAYA,EAAQ,QAAa,CAAC,CAAC,KAAK,cACxCC,IAAYA,EAAO,QAAc,CAAC,CAAC,KAAK,cACxCC,IAAYA,EAAO,QAAc,CAAC,CAAC,KAAK,eACxCC,IAAYA,EAAQ,QAAa,CAAC,CAAC,KAAK,cACxCC,IAAYA,EAAS,QAAY,CAAC,CAAC,KAAK,UACxCC,IAAYA,EAAO,MAAc,QAAOvmB,EAAA,KAAK,mBAAL,KAAAA,EAAyB,GAAG,GACpEwmB,IAAYA,EAAQ,MAAa,OAAO,KAAK,mBAAqB,SAAS,GAC3EC,IAAYA,EAAU,MAAW,OAAO,KAAK,uBAAyB,MAAM,GAC5EC,IAAYA,EAAW,QAAU,CAAC,CAAC,KAAK,gBACxCC,IAAYA,EAAO,MAAc,OAAO,KAAK,qBAAuB,EAAE,GACtEC,IAAYA,EAAU,MAAW,OAAO,KAAK,gBAAkB,EAAE,GACjEC,EAAY,CACd,IAAME,IAAS1kB,GAAAf,EAAA,KAAK,UAAL,YAAAA,EAAc,mBAAd,KAAAe,GAAkCD,EAAA,KAAK,UAAL,YAAAA,EAAc,WAAa,CAAC,EAC7EykB,EAAS,MAAQE,EAAM,IAAM,OAAOA,EAAM,GAAG,EAAI,EACnD,CACID,IAAYA,EAAS,QAAY,CAAC,CAAC,KAAK,OAG5C,GAAI,CACF,IAAME,EAAYxN,EAAM,cAAc,yBAAyB,EACzDyN,EAAmB,IAAM,CA1gPrC,IAAAjnB,GAAAsB,GA2gPQ,GAAI,CAAC0lB,EAAW,OAChBA,EAAU,UAAY,GACtB,IAAME,GAAUV,GAAA,YAAAA,EAAS,QAAS,UAClC,GAAIU,IAAY,eAAgB,CAE9B,IAAMC,GAAQ,SAAS,cAAc,OAAO,EAC5CA,GAAM,MAAM,QAAU,OACtBA,GAAM,MAAM,cAAgB,SAC5BA,GAAM,MAAM,SAAW,SACvBA,GAAM,MAAM,aAAe,OAC3B,IAAMC,GAAQ,SAAS,cAAc,MAAM,EAC3CA,GAAM,YAAc,oBACpBA,GAAM,MAAM,aAAe,MAC3B,IAAMC,GAAO,SAAS,cAAc,OAAO,EAC3CA,GAAK,KAAO,SACZA,GAAK,GAAK,oBACVA,GAAK,IAAM,MACXA,GAAK,IAAM,QACXA,GAAK,KAAO,KACZA,GAAK,MAAM,QAAU,MACrBA,GAAK,MAAM,OAAS,gDACpBA,GAAK,MAAM,aAAe,MAC1BA,GAAK,MAAQ,QAAOrnB,GAAA,KAAK,sBAAL,KAAAA,GAA4B,GAAG,EACnDmnB,GAAM,YAAYC,EAAK,EACvBD,GAAM,YAAYE,EAAI,EACtB,IAAMC,GAAQ,SAAS,cAAc,OAAO,EAC5CA,GAAM,MAAM,QAAU,OACtBA,GAAM,MAAM,cAAgB,SAC5BA,GAAM,MAAM,SAAW,SACvBA,GAAM,MAAM,aAAe,OAC3B,IAAMC,GAAQ,SAAS,cAAc,MAAM,EAC3CA,GAAM,YAAc,qBACpBA,GAAM,MAAM,aAAe,MAC3B,IAAMC,GAAO,SAAS,cAAc,OAAO,EAC3CA,GAAK,KAAO,SACZA,GAAK,GAAK,oBACVA,GAAK,IAAM,MACXA,GAAK,IAAM,QACXA,GAAK,KAAO,KACZA,GAAK,MAAM,QAAU,MACrBA,GAAK,MAAM,OAAS,gDACpBA,GAAK,MAAM,aAAe,MAC1BA,GAAK,MAAQ,QAAOlmB,GAAA,KAAK,uBAAL,KAAAA,GAA6B,GAAG,EACpDgmB,GAAM,YAAYC,EAAK,EACvBD,GAAM,YAAYE,EAAI,EACtBR,EAAU,YAAYG,EAAK,EAC3BH,EAAU,YAAYM,EAAK,CAC7B,SAAWJ,IAAY,SAAU,CAE/B,IAAM3iB,GAAO,SAAS,cAAc,OAAO,EAC3CA,GAAK,MAAM,QAAU,OACrBA,GAAK,MAAM,cAAgB,SAC3BA,GAAK,MAAM,SAAW,SACtBA,GAAK,MAAM,aAAe,OAC1B,IAAMkjB,GAAO,SAAS,cAAc,MAAM,EAC1CA,GAAK,YAAc,cACnBA,GAAK,MAAM,aAAe,MAC1B,IAAMC,GAAS,SAAS,cAAc,QAAQ,EAC9CA,GAAO,GAAK,qBACZA,GAAO,MAAM,QAAU,MACvBA,GAAO,MAAM,OAAS,gDACtBA,GAAO,MAAM,aAAe,OAEX,OAAO5nB,GAAoB,aAAeA,EAAgB,aAAgBA,EAAgB,aAAa,EAAI,CAAC,GACrH,QAAQyG,IAAK,CACnB,IAAM8F,GAAM,SAAS,cAAc,QAAQ,EAC3CA,GAAI,MAAQ9F,GAAE,IACd8F,GAAI,YAAc,GAAG9F,GAAE,OAASA,GAAE,GAAG,KAAKA,GAAE,CAAC,OAAIA,GAAE,CAAC,IACpDmhB,GAAO,YAAYrb,EAAG,CACxB,CAAC,EAEDqb,GAAO,MAAQ,OAAO,KAAK,iBAAmB,KAAK,EACnDnjB,GAAK,YAAYkjB,EAAI,EACrBljB,GAAK,YAAYmjB,EAAM,EACvBV,EAAU,YAAYziB,EAAI,CAC5B,CACF,EAEA0iB,EAAiB,EAEjBT,GAAA,MAAAA,EAAS,iBAAiB,SAAUS,EACtC,OAASzS,EAAK,CACZ,QAAQ,KAAK,6DAA8DA,CAAG,CAChF,CAGA,IAAMmT,EAAa,IAAM,CACvB,GAAI,CAAEnO,EAAM,OAAO,CAAG,MAAQ,CAAC,CAC3B,KAAK,kBAAoBA,IAAO,KAAK,gBAAkB,KAC7D,GAEAlX,EAAAkX,EAAM,cAAc,qBAAqB,IAAzC,MAAAlX,EAA4C,iBAAiB,QAAUjC,GAAM,CAAEA,EAAE,gBAAgB,EAAGsnB,EAAW,CAAG,IAClHljB,EAAA+U,EAAM,cAAc,sBAAsB,IAA1C,MAAA/U,EAA6C,iBAAiB,QAAUpE,GAAM,CAAEA,EAAE,gBAAgB,EAAGsnB,EAAW,CAAG,IAEnHjjB,EAAA8U,EAAM,cAAc,oBAAoB,IAAxC,MAAA9U,EAA2C,iBAAiB,QAAUrE,GAAM,CAzmPhF,IAAAL,GAAAsB,GAAAc,GAAAC,GAAAC,EAAAmC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAO,GAAAC,GAAA0E,GA0mPM1J,EAAE,gBAAgB,EAElB,IAAMunB,EAAe,CAAC,EAAC5B,GAAA,MAAAA,EAAS,SAC1B6B,EAAe,UAAS5B,GAAA,YAAAA,EAAS,QAAS,IAAK,EAAE,EACjD6B,GAAe,CAAC,EAAC5B,GAAA,MAAAA,EAAS,SAC1B6B,GAAe,CAAC,EAAC5B,GAAA,MAAAA,EAAQ,SACzB6B,GAAe,CAAC,EAAC5B,GAAA,MAAAA,EAAQ,SACzB6B,GAAe,CAAC,EAAC5B,GAAA,MAAAA,EAAS,SAC1B6B,GAAe,CAAC,EAAC5B,GAAA,MAAAA,EAAU,SAC3B6B,GAAe,UAAS5B,GAAA,YAAAA,EAAQ,QAAS,IAAK,EAAE,EAChD6B,IAAe5B,GAAA,YAAAA,EAAS,QAAS,UACjC6B,IAAe5B,GAAA,YAAAA,EAAW,QAAS,OACnC6B,GAAe,CAAC,EAAC5B,GAAA,MAAAA,EAAY,SAC7B6B,KAAgB5B,GAAA,YAAAA,EAAQ,QAAS,IAAI,KAAK,EAC1C6B,KAAgB5B,GAAA,YAAAA,EAAW,QAAS,IAAI,KAAK,EAC7C6B,KAAgB5B,GAAA,YAAAA,EAAU,QAAS,IAAI,KAAK,EAC5C6B,GAAe,CAAC,EAAC5B,GAAA,MAAAA,EAAU,SAEjC,GAAI,CAEF,KAAK,gBAAkBc,EACnB,KAAK,iBAAiB5nB,GAAA,KAAK,mBAAL,MAAAA,GAAA,YACrBsB,GAAA,KAAK,kBAAL,MAAAA,GAAA,WAED,CAAC,MAAMumB,CAAO,GAAKA,EAAU,GAAKA,IAAY,KAAK,WACrD,KAAK,SAAWA,GAChBzlB,GAAA,KAAK,iBAAL,MAAAA,GAAA,YACAC,GAAA,KAAK,mBAAL,MAAAA,GAAA,YAGF,IAAMsmB,GAAcV,KAAY,KAAK,aACrC,KAAK,aAAeA,GAChBU,MAEFrmB,EAAA,KAAK,gBAAL,MAAAA,EAAA,YAGF,KAAK,SAAW4lB,GAEZ,CAAC,MAAMC,EAAM,GAAKA,GAAS,IAAG,KAAK,iBAAmBA,IAE1D,IAAMS,GAAcR,KAAY,KAAK,kBACrC,KAAK,kBAAoBA,GAEzB,IAAMS,GAAgBR,KAAc,KAAK,sBAQzC,GAPA,KAAK,sBAAwBA,IACzBO,IAAeC,OAEjBpkB,GAAA,KAAK,mBAAL,MAAAA,GAAA,YAIE2jB,KAAY,eAAgB,CAE9B,IAAMU,GAAO,WAASpkB,GAAA8U,EAAM,cAAc,oBAAoB,IAAxC,YAAA9U,GAA2C,QAAS,IAAK,EAAE,EAC3EqkB,GAAO,WAASpkB,GAAA6U,EAAM,cAAc,oBAAoB,IAAxC,YAAA7U,GAA2C,QAAS,IAAK,EAAE,EAC7E,CAAC,MAAMmkB,EAAI,GAAKA,GAAO,IAAG,KAAK,oBAAuBA,IACtD,CAAC,MAAMC,EAAI,GAAKA,GAAO,IAAG,KAAK,qBAAuBA,KAE1DnkB,GAAA,KAAK,mBAAL,MAAAA,GAAA,UACF,SAAWwjB,KAAY,SAAU,CAC/B,IAAMY,IAAYnkB,GAAA2U,EAAM,cAAc,qBAAqB,IAAzC,YAAA3U,GAA4C,MAC1DmkB,KAAW,KAAK,gBAAkBA,KAEtC5jB,GAAA,KAAK,mBAAL,MAAAA,GAAA,UACF,CAeA,GAbA,KAAK,eAAiBkjB,GAElBC,KACF,KAAK,oBAAsBA,GAC3B,KAAK,MAAM,YAAY,WAAY,KAAK,mBAAmB,GAGzDC,KACF,KAAK,eAAiBA,GACtB,KAAK,MAAM,YAAY,gBAAiB,KAAK,cAAc,GAIzDC,GAAU,CACZ,IAAMQ,GAAU,KAAK,SAAW,KAAK,QAAQ,kBAAqB,CAAC,EACnE,KAAK,QAAU,CAAE,GAAG,KAAK,QAAS,iBAAkB,CAAE,GAAGA,GAAQ,IAAKR,EAAS,CAAE,CACnF,KAAO,CACL,GAAM,CAAE,iBAAAS,GAAkB,GAAGC,EAAK,EAAI,KAAK,SAAW,CAAC,EACvD,KAAK,QAAUA,EACjB,CAEA,KAAK,MAAQT,GAEb,KAAK,aAAeZ,GAEpB,KAAK,aAAgBC,GACrB,KAAK,cAAgBC,IACrB3iB,GAAA,KAAK,4BAAL,MAAAA,GAAA,WAEIojB,MACF1e,GAAA,KAAK,kCAAL,MAAAA,GAAA,YAGF,GAAI,CACG,KAAK,UAAS,KAAK,QAAU,CAAC,GACnC,KAAK,QAAQ,KAA0B,KAAK,SAC5C,KAAK,QAAQ,kBAA0B,CAAC,CAAC,KAAK,gBAC9C,KAAK,QAAQ,eAA0B,CAAC,CAAC,KAAK,aAC9C,KAAK,QAAQ,UAA0B,CAAC,CAAC,KAAK,SAC9C,KAAK,QAAQ,mBAA0B,KAAK,iBAC5C,KAAK,QAAQ,oBAA0B,KAAK,kBAC5C,KAAK,QAAQ,6BAA+B,KAAK,sBACjD,KAAK,QAAQ,sBAA0B,KAAK,oBAC5C,KAAK,QAAQ,uBAA0B,KAAK,qBAC5C,KAAK,QAAQ,iBAA0B,KAAK,gBAC5C,KAAK,QAAQ,gBAA0B,CAAC,CAAC,KAAK,eAC9C,KAAK,QAAQ,qBAA0B,KAAK,oBAC5C,KAAK,QAAQ,gBAA0B,KAAK,eAC5C,KAAK,QAAQ,MAA0B,CAAC,CAAC,KAAK,MAC9C,KAAK,QAAQ,cAA0B,CAAC,CAAC,KAAK,aAC9C,KAAK,QAAQ,eAA0B,CAAC,CAAC,KAAK,aAC9C,KAAK,QAAQ,gBAA0B,CAAC,CAAC,KAAK,aAEhD,OAASqf,GAAQ,CACf,QAAQ,KAAK,+CAAgDA,EAAM,CACrE,CAGA,KAAK,iCAAiC,EACnC,MAAO/oB,IAAM,CACZ,QAAQ,KAAK,uEAAwEA,EAAC,CAGxF,CAAC,CACL,OAASmU,GAAK,CACZ,QAAQ,KAAK,gDAAiDA,EAAG,CACnE,CACAmT,EAAW,CACb,EACF,CASA,oBAAqB,CA3vPvB,IAAA3nB,EAAAsB,EA4vPI,IAAM+K,EAAM,CACV,YAAa,KAAK,YAAc,OAChC,KAAM,KAAK,SACX,qBAAsB,KAAK,oBAC3B,gBAAiB,KAAK,eACtB,gBAAiB,CAAC,CAAC,KAAK,eACxB,eAAgB,CAAC,CAAC,KAAK,aACvB,UAAW,CAAC,CAAC,KAAK,SAClB,mBAAoB,KAAK,iBACzB,MAAO,CAAC,CAAC,KAAK,MACd,oBAAqB,KAAK,kBAC1B,6BAA8B,KAAK,sBACnC,uBAAuBrM,EAAA,KAAK,sBAAL,KAAAA,EAA4B,OACnD,wBAAwBsB,EAAA,KAAK,uBAAL,KAAAA,EAA6B,OACrD,iBAAkB,KAAK,gBACvB,KAAM,KAAK,KACX,cAAe,KAAK,aACpB,YAAa,KAAK,WAClB,sBAAuB,CAAC,CAAC,KAAK,mBAC1B,kBAAmB,CAAC,CAAC,KAAK,eACpC,EAEI,cAAO,KAAK+K,CAAG,EAAE,QAAQd,GAAKc,EAAId,CAAC,IAAM,QAAa,OAAOc,EAAId,CAAC,CAAC,EAC5Dc,CACT,CAGA,sBAAsBuV,EAAO,CAAC,EAAGyH,EAAS,GAAM,CAvxPlD,IAAArpB,EAAAsB,EAAAc,EAAAC,EAAAC,EAAAmC,EAAAC,EAAAC,EAwxPI,GAAIid,GAAQ,OAAO,UAAU,eAAe,KAAKA,EAAM,aAAa,GAE/D,KAAK,qBAAqB,EAC5B,GAAI,CACF,IAAM0H,EAAa,CAAE,KAAM,4BAA6B,GAAI,KAAK,SAAW,CAAC,CAAG,EAChF,KAAK,cAAc,IAAI,YAAY,iBAAkB,CACnD,OAAQ,CAAE,OAAQA,CAAW,EAC7B,QAAS,GACT,SAAU,EACZ,CAAC,CAAC,CACJ,MAAQ,CAAC,CAKZ,KAAK,QAAU,CAAE,GAAI,KAAK,SAAW,CAAC,EAAI,GAAG1H,CAAK,EAE9C,gBAAiBA,IAAa,KAAK,WAAaA,EAAK,aAAe,QACxE,KAAK,uBAAuB,EACxB,SAAUA,IAAoB,KAAK,SAAW,OAAOA,EAAK,IAAI,GAAK,IACnE,mBAAoBA,IAAU,KAAK,aAAe,CAAC,CAACA,EAAK,gBACzD,cAAeA,IAAe,KAAK,SAAW,CAAC,CAACA,EAAK,WACrD,uBAAwBA,IAAM,KAAK,iBAAmB,OAAOA,EAAK,kBAAkB,GAAK,KACzF,yBAA0BA,IAAM,KAAK,qBAAsB5hB,EAAA4hB,EAAK,uBAAL,KAAA5hB,EAA6B,eACxF,oBAAqB4hB,IAAW,KAAK,gBAAiBtgB,EAAAsgB,EAAK,kBAAL,KAAAtgB,EAAwB,2DAC9E,UAAWsgB,IAAmB,KAAK,MAAQ,CAAC,CAACA,EAAK,OAClD,oBAAqBA,IAAS,KAAK,eAAiB,CAAC,CAACA,EAAK,iBAE3D,wBAAyBA,IAAa,KAAK,kBAAoBA,EAAK,qBAAuB,WAC3F,0BAA2BA,IAAW,KAAK,oBAAuB,OAAOA,EAAK,qBAAqB,GAAM,MACzG,2BAA4BA,IAAU,KAAK,qBAAuB,OAAOA,EAAK,sBAAsB,GAAK,MACzG,qBAAsBA,IAAgB,KAAK,gBAAkBA,EAAK,kBAAoB,OACtF,iCAAkCA,IAAM,KAAK,sBAAwBA,EAAK,8BAAgC,QAE1G,sBAAuBA,IACzB,KAAK,gBAAkB,CAAC,CAACA,EAAK,kBAC1B,KAAK,iBAAiBxf,EAAA,KAAK,mBAAL,MAAAA,EAAA,YAAgCC,EAAA,KAAK,kBAAL,MAAAA,EAAA,YAC1DC,EAAA,KAAK,kBAAL,MAAAA,EAAA,YAMF,KAAK,MAAM,YAAY,WAAY,KAAK,mBAAmB,EAC3D,KAAK,MAAM,YAAY,gBAAiB,KAAK,cAAc,EAC3D,KAAK,eAAe,EAEhB+mB,IACF,KAAK,gCAAgC,EAAI,GACzC5kB,EAAA,KAAK,kBAAL,MAAAA,EAAA,WACA,KAAK,iBAAiB,GACtBC,EAAA,KAAK,oBAAL,MAAAA,EAAA,YACAC,EAAA,KAAK,kBAAL,MAAAA,EAAA,WAGJ,CAEA,eAAgB,CAId,IAAMqG,EAHQ,MAAM,KAClB,KAAK,cAAc,iBAAiB,qCAAqC,CAC3E,EACoB,IAAK7F,GAAM,CAE7B,IAAM,EAAI,WAAWA,EAAE,aAAa,QAAQ,CAAC,GAAK,EAC5CO,EAAI,WAAWP,EAAE,aAAa,QAAQ,CAAC,GAAK,EAC5CsB,EAAS,WAAWtB,EAAE,MAAM,KAAK,GAAMA,EAAE,sBAAsB,EAAE,MACjEqK,EAAS,WAAWrK,EAAE,MAAM,MAAM,GAAKA,EAAE,sBAAsB,EAAE,OACjEqL,EAAI,SAASrL,EAAE,MAAM,QAAU,IAAK,EAAE,EACtCsgB,EAAU,KAAK,mBAAmBtgB,EAAE,iBAAiB,EACrDwG,EAAQxG,EAAE,QAAQ,OAAS,KAAK,WACpC,MAAO,CAAE,KAAMsgB,EAAS,SAAS,CAAC,EAAE,EAAA/f,CAAC,EAAG,KAAK,CAAC,MAAAe,EAAM,OAAA+I,CAAM,EAAG,EAAAgB,EAAG,MAAA7E,CAAM,CAC1E,CAAC,EAEK+Z,EAAU,CACd,QAAS,EACT,QAAS,KAAK,mBAAmB,EACjC,MAAO1a,CACT,EAGI,KAAK,SAAW,KAAK,QAAQ,WAC/B0a,EAAQ,QAAUA,EAAQ,SAAW,CAAC,EACtCA,EAAQ,QAAQ,SAAW,KAAK,QAAQ,UAG1C,IAAM7O,EAAO,sBAAsB,KAAK,YAAc,QAAQ,QACxD8O,EAAO,IAAI,KAAK,CAAC,KAAK,UAAUD,EAAS,KAAM,CAAC,CAAC,EAAG,CAAE,KAAK,kBAAmB,CAAC,EAC/EjmB,EAAI,SAAS,cAAc,GAAG,EACpCA,EAAE,KAAO,IAAI,gBAAgBkmB,CAAI,EACjClmB,EAAE,SAAWoX,EACbpX,EAAE,MAAM,EACR,IAAI,gBAAgBA,EAAE,IAAI,EAC1B,KAAK,OAAO,kBAAkB,CAChC,CAEF,eAAgB,CACd,IAAM+H,EAAM,SAAS,cAAc,OAAO,EAC1CA,EAAI,KAAO,OACXA,EAAI,OAAS,mBAGb,IAAM+hB,EAAe,GACfC,EAA6B,GAC7BC,EAAiB,CACrB,OAAO,iBAAiB,YAAY,qBACpC,uBAAuB,kBAAkB,QAAQ,kBACjD,sBAAsB,wBAAwB,yBAC9C,mBAAmB,+BACnB,OAAO,gBAAgB,cAAc,wBACrC,WAAW,aACb,EAGAjiB,EAAI,SAAW,SAAY,CAz4P7B,IAAAxH,EAAAsB,EAAAc,EAAAC,EAAAC,EAAAmC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAO,EAAAC,EAAA0E,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAkf,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,EAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GA04PI,IAAMvF,GAAO5lB,EAAAwH,EAAI,QAAJ,YAAAxH,EAAY,GAAI,GAAI,CAAC4lB,EAAM,OACxC,IAAMnN,EAAM,MAAMmN,EAAK,KAAK,EAE5B,GAAI,CACF,IAAMC,GAAO,KAAK,MAAMpN,CAAG,EACrB2S,GAAiB,KAAK,cAAc9pB,EAAA,KAAK,UAAL,YAAAA,EAAc,cAAe,KAGjE+pB,GAAiB,CAAC,EAAExF,GAAK,SAAW,MAAM,QAAQA,GAAK,QAAQ,IAAI,GACnEyF,GAAiB,MAAM,QAAQzF,GAAK,KAAK,GAAKA,GAAK,MAAM,KAAK7kB,KAAKA,IAAA,YAAAA,GAAG,SAASA,IAAA,YAAAA,GAAG,OAAM,EAM1FuqB,GAAa,CAAC,EACdF,GACFE,GAAa1F,GAAK,QAAQ,KACjByF,GAETC,GADa,MAAM,KAAK,IAAI,IAAI1F,GAAK,MAAM,IAAI7kB,KAAKA,IAAA,YAAAA,GAAG,SAASA,IAAA,YAAAA,GAAG,OAAM,EAAE,OAAO,OAAO,CAAC,CAAC,EACzE,IAAIJ,KAAO,CAAE,GAAAA,GAAI,MAAOA,EAAG,EAAE,EAE/C2qB,GAAa,CAAC,CAAE,GAAI,UAAW,MAAO,QAAS,CAAC,EAGlD,IAAMC,KAAsBppB,EAAAyjB,GAAK,UAAL,YAAAzjB,EAAc,iBAAkB,OACxD,OACC,KAAK,cAAgB,MAEpBqpB,KACJppB,EAAAwjB,GAAK,UAAL,YAAAxjB,EAAc,gBACVC,EAAAipB,GAAW,CAAC,IAAZ,YAAAjpB,EAAe,KAAM,UAErBopB,KACHjnB,EAAAohB,GAAK,UAAL,YAAAphB,EAAc,yBAA0B,OACrC,CAAC,CAACohB,GAAK,QAAQ,sBACf,GAIN,GAAIA,GAAK,QAAS,CAChB,IAAM8F,GAAW,CAAE,GAAG9F,GAAK,OAAQ,EAGnC,GAFK2D,GAA4B,OAAOmC,GAAS,YAE7CpC,EAAc,CAChB,IAAM3mB,GAAM,KAAK,SAAW,CAAE,KAAM,2BAA4B,EAGhE,QAAW2I,MAAKke,EACVle,KAAM,eAAiB,CAACie,GACxB,EAAEje,MAAKogB,KAAapgB,MAAK3I,IAAK,OAAOA,GAAI2I,EAAC,EAIhD,GAAI,CACE,KAAK,gBACP,KAAK,cAAc,MAAM,WAAa,GACtC,KAAK,cAAc,MAAM,MAAQ,GACjC,KAAK,cAAc,MAAM,OAAS,KAEpC5G,GAAAD,EAAA,KAAK,QAAL,YAAAA,EAAY,iBAAZ,MAAAC,EAAA,KAAAD,EAA6B,uBAC7BG,GAAAD,EAAA,KAAK,QAAL,YAAAA,EAAY,iBAAZ,MAAAC,EAAA,KAAAD,EAA6B,gBAC/B,MAAQ,CAAC,CAUT,GAPA,KAAK,QAAU,CAAE,GAAGhC,GAAK,GAAG+oB,EAAS,EAC/B,aAAcA,IAAW,OAAO,KAAK,QAAQ,SAE/CnC,GAA8BmC,GAAS,cACzC,KAAK,WAAaA,GAAS,aAGzB,KAAK,MAAO,CACd,KAAK,MAAQ,CAAE,GAAG,KAAK,MAAO,GAAGA,EAAS,EAC1C,QAAWpgB,MAAKke,EACRle,MAAKogB,IAAW,OAAO,KAAK,MAAMpgB,EAAC,CAE7C,EAEAnG,EAAA,KAAK,qBAAL,MAAAA,EAAA,UAA0B,KAAK,UAC/BC,EAAA,KAAK,gBAAL,MAAAA,EAAA,UACF,MACE,KAAK,sBAAsBsmB,GAAU,EAAI,EACrCA,GAAS,WAAa,SACxB,KAAK,QAAU,KAAK,SAAW,CAAC,EAChC,KAAK,QAAQ,SAAWA,GAAS,UACjC5hB,EAAA,KAAK,gBAAL,MAAAA,EAAA,WAGN,SAAW,OAAO8b,GAAK,MAAS,SAAU,CAExC,IAAM8F,GAAW,CAAE,KAAM9F,GAAK,IAAK,EACnC0D,EACK,KAAK,QAAU,CAAE,GAAI,KAAK,SAAS,CAAC,EAAI,GAAGoC,EAAS,EACrD,KAAK,sBAAsBA,GAAU,EAAI,GAC7C3hB,EAAA,KAAK,gBAAL,MAAAA,EAAA,UACF,EAGI,CAAC,MAAM,QAAQ,KAAK,IAAI,GAAK,CAAC,KAAK,KAAK,UAAQ,KAAK,KAAOuhB,IAC3D,KAAK,eAAc,KAAK,aAAeC,IACvC,KAAK,aAAY,KAAK,WAAaC,IACpC,KAAK,qBAAuB,SAAW,KAAK,mBAAqBC,KACrEvhB,GAAAD,GAAAD,EAAA,KAAK,SAAL,YAAAA,EAAa,YAAb,YAAAC,EAAwB,SAAxB,MAAAC,EAAA,KAAAD,EAAiC,uBAAwB,KAAK,eAAiB,QAG/E,GAAI,CACF,IAAM0hB,KAAYxhB,EAAA,KAAK,UAAL,YAAAA,EAAc,cAAe,KAAK,YAAc,KAG5DyhB,IAAkBxhB,EAAAwb,GAAK,UAAL,KAAAxb,EAClB,OAAOwb,GAAK,MAAS,SAAW,CAAE,KAAMA,GAAK,IAAK,EAAI,CAAC,EAGvDiG,GAAiB,CACrB,GAAGD,GACH,MAAMthB,GAAAD,EAAAuhB,GAAgB,OAAhB,KAAAvhB,EAAwB,KAAK,OAA7B,KAAAC,EAAqC,CAAC,EAC5C,eAAemf,IAAAlf,EAAAqhB,GAAgB,gBAAhB,KAAArhB,EAAiC,KAAK,eAAtC,KAAAkf,GAAsD,MACrE,aAAaM,IAAAL,GAAAkC,GAAgB,cAAhB,KAAAlC,GACR,KAAK,aADG,KAAAK,KAENH,IAAAD,GAAAiC,GAAgB,OAAhB,YAAAjC,GAAuB,KAAvB,YAAAC,GAA2B,OAAQE,IAAAD,GAAA,KAAK,OAAL,YAAAA,GAAY,KAAZ,YAAAC,GAAgB,KAAO,UACjE,uBACEG,GAAA2B,GAAgB,wBAAhB,KAAA3B,IAA0CD,GAAA,KAAK,qBAAL,KAAAA,GAA2B,EACzE,EAKA,GAFKT,GAA4B,OAAOsC,GAAe,YAEnD,CAACF,GACH,QAAQ,KAAK,kEAAkE,MAC1E,CACL,IAAMG,EAAS,OAAM5B,GAAA,KAAK,wBAAL,YAAAA,GAAA,UAA6B2B,GAAgB,CAChE,eAAgB,OAAOF,EAAS,EAChC,WAAY,GACZ,QAAS,GACT,gBAAiB,EACnB,IACMI,EAAS,CAAC,EAAED,GAAUA,EAAO,YACnC3B,GAAA,QAAQ,QAAR,MAAAA,GAAA,aAAgB,oCAAqC4B,EACvD,CAGA,GAAI,CACF,IAAMppB,EAAM,CAAE,KAAM,4BAA6B,GAAI,KAAK,SAAW,CAAC,CAAG,EACzEA,EAAI,KAAOkpB,GAAe,KAC1BlpB,EAAI,cAAgBkpB,GAAe,cACnClpB,EAAI,YAAckpB,GAAe,YACjClpB,EAAI,sBAAwB,CAAC,CAACkpB,GAAe,sBAE7C,KAAK,cAAc,IAAI,YAAY,iBAAkB,CACnD,OAAQ,CAAE,OAAQlpB,CAAI,EACtB,QAAS,GACT,SAAU,EACZ,CAAC,CAAC,CACJ,MAAQ,CAAC,CACX,OAASvC,GAAG,CACV,QAAQ,KAAK,oCAAqCA,EAAC,CACrD,CAIA,GADA,KAAK,cAAc,UAAY,GAC3B,MAAM,QAAQwlB,GAAK,KAAK,GAAKA,GAAK,MAAM,OAC1C,QAAWpa,MAAQoa,GAAK,MAAO,CAC7B,IAAMpgB,KAAI4kB,GAAA5e,GAAK,WAAL,YAAA4e,GAAe,IAAK,EACxB3kB,KAAI4kB,GAAA7e,GAAK,WAAL,YAAA6e,GAAe,IAAK,EACxBnlB,IAAIolB,GAAA9e,GAAK,OAAL,YAAA8e,GAAW,QAAU,IACzBrkB,IAAIskB,GAAA/e,GAAK,OAAL,YAAA+e,GAAW,SAAU,IACzBha,GAAI/E,GAAK,EACTE,GAAQ,KAAK,gBAAgBF,GAAK,OAASA,GAAK,QAAU,KAAK,UAAU,EAE/E,GAAI,EAACA,IAAA,MAAAA,GAAM,OAAS,OAAOA,GAAK,MAAS,UAAY,CAAC,OAAO,KAAKA,GAAK,IAAI,EAAE,OAAS,CAEpF,IAAMlF,EAAI,KAAK,mBAAmBd,GAAGC,GAAGP,EAAGe,CAAC,EAC5CK,EAAE,QAAQ,MAAQoF,GAClB,KAAK,cAAc,YAAYpF,CAAC,EAChC,QACF,CAEA,IAAMhE,GAAK,MAAM,KAAK,YAAYkJ,GAAK,IAAI,EACrClH,GAAO,KAAK,aAAahC,EAAE,EACjCgC,GAAK,QAAQ,MAAQoH,GACrB,KAAK,iBAAiBpH,GAAMkB,GAAGC,EAAC,EAChCnB,GAAK,MAAM,MAAS,GAAGY,CAAC,KACxBZ,GAAK,MAAM,OAAS,GAAG2B,CAAC,KACpBsK,IAAK,OAAMjM,GAAK,MAAM,OAAS,OAAOiM,EAAC,GAC3C,KAAK,cAAc,YAAYjM,EAAI,EAEnC,GAAI,CAAE,KAAK,aAAaA,GAAK,iBAAiB,CAAG,MAAQ,CAAC,CAC1D,KAAK,kBAAkBA,EAAI,CAC7B,MAEA,KAAK,sBAAsB,GAC3BkmB,GAAA,KAAK,kBAAL,MAAAA,GAAA,YAIFC,GAAA,KAAK,qBAAL,MAAAA,GAAA,UAA0B,KAAK,SAC/B,KAAK,iBAAiB,EACtB,GAAI,EACFG,IAAAD,IAAAD,EAAA,KAAK,SAAL,YAAAA,EAAa,YAAb,YAAAC,GAAwB,SAAxB,MAAAC,GAAA,KAAAD,GAAiC,uBAAwB,KAAK,eAAiB,SAC/EE,GAAA,KAAK,cAAL,MAAAA,GAAA,YACAC,GAAA,KAAK,kBAAL,MAAAA,GAAA,UACF,MAAQ,CAAC,CAGT,GAAI,CACE,KAAK,YAAY,aAAa,KAAK,UAAU,EACjD,MAAM,KAAK,YAAY,EAAI,GAC3BC,GAAA,KAAK,SAAL,MAAAA,GAAA,UAAc,yCACd,OAAO,SAAS,OAAO,CACzB,OAAS3qB,GAAG,CACV,QAAQ,KAAK,iCAAkCA,EAAC,GAChD4qB,GAAA,KAAK,aAAL,MAAAA,GAAA,UAAkB,WAClBC,GAAA,KAAK,SAAL,MAAAA,GAAA,UAAc,8CAChB,CACF,OAAS7qB,GAAG,CACV,QAAQ,MAAM,gBAAiBA,EAAC,GAChC8qB,GAAA,KAAK,SAAL,MAAAA,GAAA,UAAc,qCAChB,CACF,EAEA3jB,EAAI,MAAM,CACZ,CAKE,cAAe,CA7mQjB,IAAAxH,EAAAsB,EA+mQI,IAAI2qB,EAAM,EAAGzpB,EAAO,KACpB,KAAOA,GAAQypB,IAAQ,IAAI,CACzB,IAAM9kB,GAAOnH,EAAAwC,EAAK,cAAL,YAAAxC,EAAA,KAAAwC,GACP0pB,EAAQ/kB,GAAA,YAAAA,EAAM,KACpB,IAAI+kB,GAAA,YAAAA,EAAO,WAAY,WAAY,OAAOA,EAAM,SAChD1pB,EAAO0pB,GAAS1pB,EAAK,aACvB,CAEA,IAAM2pB,EAAO,IAAI,IAAOzP,EAAI,CAAC,QAAQ,EACrC,KAAOA,EAAE,QAAQ,CACf,IAAM1V,EAAI0V,EAAE,MAAM,EAClB,GAAI,GAAC1V,GAAKmlB,EAAK,IAAInlB,CAAC,GAEpB,IADAmlB,EAAK,IAAInlB,CAAC,IACN1F,EAAA0F,EAAE,OAAF,YAAA1F,EAAQ,WAAY,WAAY,OAAO0F,EAAE,KAAK,SAClD,GAAIA,EAAE,UAAY,WAAY,OAAOA,EAAE,SAEvC,GADIA,EAAE,YAAY0V,EAAE,KAAK1V,EAAE,UAAU,EACjCA,EAAE,SAAU,QAAWhG,KAAKgG,EAAE,SAAU0V,EAAE,KAAK1b,CAAC,EACtD,CAEF,CAEA,cAAc4B,EAAK,CACjB,IAAMwpB,EAAO,CAAC,EACRC,EAAO,CAACjrB,EAAM2F,EAAMulB,IAAQ,EAC5BA,GAAA,YAAAA,EAAK,QAAS,6BAA6BF,EAAK,KAAK,CAAE,KAAAhrB,EAAM,KAAM,CAAC,GAAG2F,CAAI,EAAG,KAAMulB,CAAI,CAAC,CAC/F,EACMjlB,EAAQ,CAACxF,EAAM0qB,EAASxlB,IAAS,CACrC,GAAKlF,EACL,IAAI,MAAM,QAAQA,CAAI,EAAG,CAAEA,EAAK,QAAQ,CAACmF,EAAGoS,IAAM/R,EAAML,EAAGulB,EAASxlB,EAAK,OAAOqS,CAAC,CAAC,CAAC,EAAG,MAAQ,CAC9F,GAAI,OAAOvX,GAAS,SAEpB,CAAI,SAAUA,GAAMwqB,EAAKE,EAASxlB,EAAMlF,CAAI,EAE5C,OAAW,CAAC0J,EAAGvH,CAAC,IAAK,OAAO,QAAQnC,CAAI,EAClC0J,IAAM,SAAW,MAAM,QAAQvH,CAAC,EAAGA,EAAE,QAAQ,CAACwoB,EAAIpT,IAAM/R,EAAMmlB,EAAIpT,EAAG,CAAC,QAASA,CAAC,CAAC,CAAC,GAC7E,MAAM,QAAQpV,CAAC,GACfA,GAAK,OAAOA,GAAM,WAAUqD,EAAMrD,EAAGuoB,EAASxlB,EAAK,OAAOwE,CAAC,CAAC,GAEzE,EACA,OAAAlE,EAAMzE,EAAK,GAAI,CAAC,CAAC,EACVwpB,CACT,CAEA,MAAM,sBAAsBxK,EAAM,CAAE,QAAAnX,EAAU,KAAM,6BAAAgiB,EAA+B,EAAM,EAAI,CAAC,EAAG,CA1pQnG,IAAAzsB,EAAAsB,EAAAc,EAAAC,EAAAC,EAAAmC,EAAAC,EAAAC,EAAAC,EA2pQI,GAAI,CACF,IAAM9D,EAAK,KAAK,aAAa,EAC7B,GAAI,CAACA,EAAM,eAAQ,MAAM,wCAAwC,EAAU,GAC3E,GAAI,OAAOA,EAAG,YAAe,WAAc,eAAQ,MAAM,qDAAqD,EAAU,GAGxH,IAAM8B,EAAM,KAAK,MAAM,KAAK,UAAU9B,EAAG,MAAM,CAAC,EAC1CsrB,EAAO,KAAK,cAAcxpB,CAAG,EAC7B8pB,GAAU1sB,EAAAc,EAAG,eAAH,KAAAd,EAAmB,EAEnC,QAAQ,MAAM,wCAAyCosB,EAAK,IAAIlmB,IAAM,CAAE,KAAMA,EAAE,KAAM,KAAMA,EAAE,KAAK,KAAK,GAAG,EAAG,YAAaA,EAAE,KAAK,aAAe,IAAK,EAAE,CAAC,EAEzJ,IAAMymB,GAASrrB,EAAAsgB,GAAA,YAAAA,EAAM,cAAN,KAAAtgB,EAAqB,KAC9BsrB,EAAO,CAAC,EACVniB,GAASmiB,EAAK,KAAKniB,CAAO,EAC1BkiB,GAAQC,EAAK,KAAKD,CAAM,EACxB,KAAK,YAAYC,EAAK,KAAK,KAAK,UAAU,GAC1CxqB,EAAA,KAAK,UAAL,MAAAA,EAAc,aAAawqB,EAAK,KAAK,KAAK,QAAQ,WAAW,EAGjE,IAAIxc,EAAUgc,EAAK,OAAOlmB,GAAKA,EAAE,KAAK,aAAe0mB,EAAK,SAAS1mB,EAAE,KAAK,WAAW,CAAC,EAGrF,GAAI,CAACkK,EAAQ,OAAQ,CACpB,IAAMyc,EAAQT,EAAK,OAAOlmB,GAAKA,EAAE,OAASwmB,CAAO,EAC5CG,EAAM,SAAW,IAAGzc,EAAUyc,EAEpC,CAKD,GAFI,CAACzc,EAAQ,QAAUgc,EAAK,SAAW,IAAGhc,EAAUgc,GAEhD,CAAChc,EAAQ,OACX,eAAQ,MAAM,+FAAgG,CAAE,QAAA3F,EAAS,OAAAkiB,EAAQ,WAAY,KAAK,UAAW,CAAC,EACvJ,GAIR,IAAMG,EAAY,CAAE,KAAM,4BAA6B,GAAGlL,CAAK,EAE3D,gBAAiBkL,GAAW,OAAOA,EAAU,YAC7C,eAAgBA,GAAY,OAAOA,EAAU,WAEjD,QAAWxnB,KAAK8K,EAAS,CAEvB,IAAI5J,EAAM5D,EACV,QAAWmqB,KAAOznB,EAAE,KAAMkB,EAAMA,EAAIumB,CAAG,EAGvC,IAAMC,GACJpoB,GAAAD,GAAAF,GAAApC,EAAAmE,GAAA,YAAAA,EAAK,cAAL,KAAAnE,EAAoBmE,GAAA,YAAAA,EAAK,aAAzB,KAAA/B,GAAuCnC,EAAAkE,GAAA,YAAAA,EAAK,UAAL,YAAAlE,EAAc,cAArD,KAAAqC,GAAoED,EAAA8B,GAAA,YAAAA,EAAK,UAAL,YAAA9B,EAAc,aAAlF,KAAAE,EAAgG,KAG5FqoB,EAAe,CAAC,EAAExiB,GAAWkiB,GAAUK,IAAgBviB,GAAWkiB,IAAWliB,GAGnF,OAAO,OAAOjE,EAAKsmB,CAAS,EAGxBG,EACFzmB,EAAI,YAAc,OAAOmmB,CAAM,EACtBK,IACTxmB,EAAI,YAAc,OAAOwmB,CAAW,GAGlC,eAAgBxmB,GAAK,OAAOA,EAAI,UACtC,CAED,eAAQ,MAAM,qCAAiC,CAAE,QAAS4J,EAAQ,OAAQ,UAAWwc,EAAM,KAAM,CAAC,EAClG,MAAM9rB,EAAG,WAAW8B,CAAG,EAChB,EACT,OAASvC,EAAG,CACV,eAAQ,KAAK,6BAA8BA,CAAC,EACrC,EACT,CACF,CAEA,WAAW8N,EAAO,OAAQ,CAExB,KAAK,WAAWA,CAAM,EAEjB,KAAK,WAEN,KAAK,UAEJ,KAAK,WACV,KAAK,SAAS,WAAY,SAAU,CAAE,OAAAA,EAAQ,SAAU,KAAK,gBAAiB,CAAC,EAC/E,aAAa,KAAK,UAAU,EAC5B,KAAK,WAAa,WAAW,IAAM,KAAK,YAAY,EAAI,EAAG,KAAK,gBAAgB,GAClF,CAEA,MAAM,YAAY+e,EAAS,GAAM,CAE/B,IAAMliB,EADQ,MAAM,KAAK,KAAK,cAAc,iBAAiB,qCAAqC,CAAC,EAC/E,IAAK7F,GAAI,CAC3B,IAAMM,EAAI,WAAWN,EAAE,aAAa,QAAQ,CAAC,GAAK,EAC5CO,EAAI,WAAWP,EAAE,aAAa,QAAQ,CAAC,GAAK,EAC5CsB,EAAS,WAAWtB,EAAE,MAAM,KAAK,GAAMA,EAAE,sBAAsB,EAAE,MACjEqK,EAAS,WAAWrK,EAAE,MAAM,MAAM,GAAKA,EAAE,sBAAsB,EAAE,OACjEqL,EAAI,SAASrL,EAAE,MAAM,QAAU,IAAK,EAAE,EACtCsgB,EAAU,KAAK,mBAAmBtgB,EAAE,iBAAiB,EACrDwG,EAAQxG,EAAE,QAAQ,OAAS,KAAK,WACpC,MAAO,CAAE,KAAMsgB,EAAS,SAAS,CAAC,EAAAhgB,EAAE,EAAAC,CAAC,EAAG,KAAK,CAAC,MAAAe,EAAM,OAAA+I,CAAM,EAAG,EAAAgB,EAAG,MAAA7E,CAAM,CAC1E,CAAC,EACK+Z,EAAU,CACb,QAAS,EACT,QAAS,KAAK,mBAAmB,EACjC,MAAO1a,CACT,EAED,GAAI,CAAE,aAAa,QAAQ,aAAa,KAAK,YAAc,SAAS,GAAI,KAAK,UAAU0a,CAAO,CAAC,CAAG,MAAQ,CAAC,CAE3G,GAAI,CAAC,KAAK,WAAY,CAAOwH,GAAQ,KAAK,OAAO,qCAAqC,EACpF,KAAK,QAAU,GAAO,KAAK,gBAAgB,EAC3C,MAAQ,CAEV,GAAI,CACF,MAAM,KAAK,qBAAqB,KAAK,WAAYxH,CAAO,EACnDwH,GAAQ,KAAK,OAAO,eAAe,EACxC,KAAK,QAAU,GAAO,KAAK,gBAAgB,CAC7C,OAAS7sB,EAAG,CACV,QAAQ,MAAM,sBAAuBA,CAAC,EACtC,KAAK,SAAS,OAAQ,sBAAuB,CAAE,MAAO,OAAOA,CAAC,CAAE,CAAC,EAC5D6sB,GAAQ,KAAK,OAAO,6CAAwC,CACnE,CACF,CAEA,MAAM,eAAgB,CACpB,KAAK,WAAa,GAClB,IAAMC,EAAK,YAAY,IAAI,EAC3B,GAAI,CACF,KAAK,SAAS,QAAS,uCAAuC,EAC9D,IAAMxtB,EAAI,MAAM,KAAK,KAAK,QAAQ,MAAO,kBAAkB,EACrDytB,EAAK,KAAK,MAAM,YAAY,IAAI,EAAID,CAAE,EAC5C,KAAK,SAAS,QAAS,OAAOC,CAAE,OAAQztB,CAAC,EACzC,KAAK,WAAa,CAAC,CAACA,CACtB,OAASU,EAAG,CACV,IAAM+sB,EAAK,KAAK,MAAM,YAAY,IAAI,EAAID,CAAE,EAC5C,KAAK,SAAS,QAAS,WAAWC,CAAE,OAAQ,CAAE,MAAO,OAAO/sB,CAAC,CAAE,CAAC,EAChE,KAAK,WAAa,EACpB,CACA,KAAK,kBAAkB,CACzB,CAEA,MAAM,uBAAuBsW,EAAK,CAChC,IAAM5T,EAAM,oBAAoB,mBAAmB4T,CAAG,CAAC,GACjDwW,EAAK,YAAY,IAAI,EAC3B,GAAI,CACF,KAAK,SAAS,OAAQ,YAAYpqB,CAAG,EAAE,EACvC,IAAMsqB,EAAO,MAAM,KAAK,KAAK,QAAQ,MAAOtqB,CAAG,EACzCqqB,EAAK,KAAK,MAAM,YAAY,IAAI,EAAID,CAAE,EAC5C,YAAK,SAAS,OAAQ,OAAOC,CAAE,OAAQ,CAAE,MAAO,KAAK,UAAUC,GAAM,EAAE,EAAE,MAAO,CAAC,EAC1EA,CACT,OAAShtB,EAAG,CACV,IAAM+sB,EAAK,KAAK,MAAM,YAAY,IAAI,EAAID,CAAE,EAC5C,YAAK,SAAS,OAAQ,WAAWC,CAAE,OAAQ,CAAE,MAAO,OAAO/sB,CAAC,CAAE,CAAC,EACxD,IACT,CACF,CAEA,MAAM,qBAAqBsW,EAAK0W,EAAM,CACpC,IAAMtqB,EAAM,oBAAoB,mBAAmB4T,CAAG,CAAC,GACjDzT,EAAO,KAAK,UAAUmqB,CAAI,EAAE,OAC5BF,EAAK,YAAY,IAAI,EAC3B,GAAI,CACF,KAAK,SAAS,OAAQ,aAAapqB,CAAG,GAAI,CAAE,MAAOG,CAAK,CAAC,EACzD,IAAMoqB,EAAM,MAAM,KAAK,KAAK,QAAQ,OAAQvqB,EAAKsqB,CAAI,EAC/CD,EAAK,KAAK,MAAM,YAAY,IAAI,EAAID,CAAE,EAC5C,YAAK,SAAS,OAAQ,OAAOC,CAAE,OAAQE,CAAG,EACnCA,CACT,OAASjtB,EAAG,CACV,IAAM+sB,EAAK,KAAK,MAAM,YAAY,IAAI,EAAID,CAAE,EAC5C,WAAK,SAAS,OAAQ,WAAWC,CAAE,OAAQ,CAAE,MAAO,OAAO/sB,CAAC,EAAG,MAAO6C,CAAK,CAAC,EACtE7C,CACR,CACF,CAEA,mBAAoB,CAClB,IAAMkC,EAAK,KAAK,WAAY,GAAI,CAACA,EAAI,OACrC,IAAM4iB,EAAY,KAAK,YAAc,CAAC,CAAC,KAAK,WAC5C5iB,EAAG,YAAc4iB,EAAY,wBAA0B,oHACvD5iB,EAAG,MAAM,WAAa4iB,EAAY,sBAAwB,sBAC1D5iB,EAAG,MAAM,YAAc4iB,EAAY,sBAAwB,qBAC7D,CAGA,OAAOoI,EAAS,CACd,IAAMzmB,EAAK,IAAI,MAAM,mBAAmB,EACxCA,EAAG,OAAS,CAAE,QAAAymB,CAAQ,EACtB,OAAO,cAAczmB,CAAE,CACzB,CACA,UAAW,CAz1Qb,IAAA9G,EAAAsB,EAAAc,EAAAC,EAAAC,EAAAmC,EA01QI,GAAI,CACF,IAAM+oB,EAAO,SAAS,cAAc,gBAAgB,EAC9CC,GAAOztB,EAAAwtB,GAAA,YAAAA,EAAI,aAAJ,YAAAxtB,EAAgB,cAAc,uBACrC0tB,IAASpsB,EAAAmsB,GAAA,YAAAA,EAAM,aAAN,YAAAnsB,EAAkB,cAAc,eAAgBmsB,EACzDE,IAAMvrB,EAAAsrB,GAAA,YAAAA,EAAQ,aAAR,YAAAtrB,EAAoB,cAAc,4BAA6BsrB,EACrEE,IAAQvrB,EAAAsrB,GAAA,YAAAA,EAAK,aAAL,YAAAtrB,EAAiB,cAAc,yBAAwBC,EAAAorB,GAAA,YAAAA,EAAQ,aAAR,YAAAprB,EAAoB,cAAc,sBACvG,QAAOmC,EAAAmpB,GAAA,YAAAA,EAAO,aAAP,YAAAnpB,EAAmB,cAAc,cAAe,IACzD,MAAQ,CAAE,OAAO,IAAM,CACzB,CACA,aAAa,CAAE,MAAO,EAAG,CAC3B,EAEK,eAAe,IAAI,oBAAoB,GAC1C,eAAe,OAAO,qBAAsB5E,EAAe,GAI5D,IAAM,CACL,GAAI,CACF,IAAMS,EAAQ,OAAO,YAAc,OAAO,aAAe,CAAC,EACrDA,EAAK,KAAKU,GAAKA,EAAE,OAAS,oBAAoB,GACjDV,EAAK,KAAK,CACR,KAAM,qBACN,KAAM,mBACN,YAAa,+DACb,QAAS,EACX,CAAC,CAEL,MAAY,CAAc,CAC5B,GAAG,GASF,IAAM,CACL,IAAMutB,EAAO,IAAI,QAEXC,EAAgBvrB,GAAO,CAC3B,GAAI,CACF,GAAI,EAAEA,aAAc,SAAU,MAAO,GACrC,IAAMyE,EAAIzE,EAAG,WAAa,GAC1B,OAAKyE,EACD,GAAAA,IAAM,WACNA,EAAE,SAAS,OAAO,GAFP,EAIjB,MAAQ,CAAE,MAAO,EAAO,CAC1B,EAEM+mB,EAAexrB,GAAO,CAC1B,GAAI,CACF,GAAI,CAACA,GAAMsrB,EAAK,IAAItrB,CAAE,EAAG,OACzBsrB,EAAK,IAAItrB,CAAE,EACXA,EAAG,cAAc,IAAI,MAAM,aAAc,CAAE,QAAS,GAAM,SAAU,EAAK,CAAC,CAAC,CAC7E,MAAQ,CAAC,CACX,EAEMyrB,EAAY7mB,GAAS,CAt5Q7B,IAAAnH,EAAAsB,EAu5QI,GAAI,CACF,GAAI,CAAC6F,EAAM,OACPA,aAAgB,SAAW2mB,EAAa3mB,CAAI,GAAG4mB,EAAY5mB,CAAI,EACnE,IAAMyQ,GAAOtW,GAAAtB,GAAAmH,aAAgB,WAAaA,IAAa,mBAA1C,YAAA7F,EAAA,KAAAtB,EAA6D,KAC1E,GAAI,CAAC4X,EAAK,OACV,QAAWrV,KAAMqV,EAAK,CAChBkW,EAAavrB,CAAE,GAAGwrB,EAAYxrB,CAAE,EACpC,IAAMgF,EAAKhF,EAAG,WACd,GAAIgF,EAAM,GAAI,CAAEymB,EAASzmB,CAAE,CAAG,MAAQ,CAAC,CACzC,CACF,MAAQ,CAAC,CACX,EAEM0mB,EAAqBzrB,GAAS,CAClC,GAAI,CACF,GAAI,CAACA,GAAQA,EAAK,uBAAwB,OAC1CA,EAAK,uBAAyB,GAC9B,IAAM2E,EAAO3E,EAAK,YAAcA,EAGhCwrB,EAAS7mB,CAAI,EAGb,IAAM+mB,EAAK,IAAI,iBAAkBC,GAAS,CACxC,QAAW,KAAKA,EACd,GAAI,GAAC,EAAE,YAAc,CAAC,EAAE,WAAW,QACnC,QAAWnnB,KAAK,EAAE,YACZA,aAAa,SAAWA,aAAa,aACvCgnB,EAAShnB,CAAC,CAIlB,CAAC,EACDknB,EAAG,QAAQ/mB,EAAM,CAAE,UAAW,GAAM,QAAS,EAAK,CAAC,EACnD3E,EAAK,+BAAiC0rB,EAGtC,WAAW,IAAM,CAAE,GAAI,CAAEF,EAAS7mB,CAAI,CAAG,MAAQ,CAAC,CAAE,EAAG,GAAG,EAC1D,WAAW,IAAM,CAAE,GAAI,CAAE6mB,EAAS7mB,CAAI,CAAG,MAAQ,CAAC,CAAE,EAAG,GAAI,CAC7D,MAAQ,CAAC,CACX,EAEMinB,EAAe,IAAM,CACzB,GAAI,CACF,SAAS,iBAAiB,oBAAoB,EAAE,QAAQH,CAAiB,CAC3E,MAAQ,CAAC,CACX,EAEA,GAAI,OAAO,gBAAkB,OAAO,eAAe,YACjD,OAAO,eAAe,YAAY,oBAAoB,EAAE,KAAK,IAAM,CAEjEG,EAAa,EAEb,IAAMC,EAAO,OAAO,eAAe,IAAI,oBAAoB,EAC3D,GAAIA,GAAQA,EAAK,UAAW,CAC1B,IAAMC,EAAgBD,EAAK,UAAU,kBACrCA,EAAK,UAAU,kBAAoB,UAAW,CAC5C,GAAI,CAAEC,GAAiBA,EAAc,KAAK,IAAI,CAAG,QAAE,CACjDL,EAAkB,IAAI,CACxB,CACF,CACF,CAEoB,IAAI,iBAAiB,IAAMG,EAAa,CAAC,EACjD,QAAQ,SAAS,gBAAiB,CAAE,UAAW,GAAM,QAAS,EAAK,CAAC,CAClF,CAAC,MACI,CAEL,IAAMG,EAAK,YAAYH,EAAc,GAAI,EACzC,WAAW,IAAM,cAAcG,CAAE,EAAG,GAAK,CAC3C,CACF,GAAG,GAGF,UAAU,CACT,IAAM1nB,EAAM,qBACN2nB,EAAM,eAAe,IAAI3nB,CAAG,EAClC,GAAI,CAAC2nB,EAAK,CAAE,QAAQ,KAAK,8CAA+C3nB,CAAG,EAAG,MAAQ,CAEtF,SAAS4nB,GAAe,CAt+Q1B,IAAAzuB,EAAAsB,EAu+QI,GAAI,CACF,IAAI2qB,EAAM,EAAGzpB,EAAO,KACpB,KAAOA,GAAQypB,IAAQ,IAAI,CACzB,IAAM9kB,GAAOnH,EAAAwC,EAAK,cAAL,YAAAxC,EAAA,KAAAwC,GACP0pB,EAAQ/kB,GAAA,YAAAA,EAAM,KACpB,IAAI+kB,GAAA,YAAAA,EAAO,WAAY,WAAY,OAAOA,EAAM,SAChD1pB,EAAO0pB,GAAS1pB,EAAK,aACvB,CACA,IAAM2pB,EAAO,IAAI,IAAOzP,EAAI,CAAC,QAAQ,EACrC,KAAOA,EAAE,QAAQ,CACf,IAAM1V,EAAI0V,EAAE,MAAM,EAClB,GAAI,GAAC1V,GAAKmlB,EAAK,IAAInlB,CAAC,GAEpB,IADAmlB,EAAK,IAAInlB,CAAC,IACN1F,EAAA0F,EAAE,OAAF,YAAA1F,EAAQ,WAAY,WAAY,OAAO0F,EAAE,KAAK,SAClD,GAAIA,EAAE,UAAY,WAAY,OAAOA,EAAE,SAEvC,GADIA,EAAE,YAAY0V,EAAE,KAAK1V,EAAE,UAAU,EACjCA,EAAE,SAAU,QAAWhG,KAAKgG,EAAE,SAAU0V,EAAE,KAAK1b,CAAC,EACtD,CACF,MAAW,CAAC,CAEd,CACA,SAAS0tB,EAAc9rB,EAAK,CAC1B,IAAMwpB,EAAO,CAAC,EACRC,EAAO,CAACjrB,EAAM2F,EAAMulB,IAAQ,EAAMA,GAAA,YAAAA,EAAK,QAAS,6BAA6BF,EAAK,KAAK,CAAE,KAAAhrB,EAAM,KAAM,CAAC,GAAG2F,CAAI,EAAG,KAAMulB,CAAI,CAAC,CAAG,EAC9HjlB,EAAQ,CAACxF,EAAM0qB,EAASxlB,IAAS,CACrC,GAAKlF,EACL,IAAI,MAAM,QAAQA,CAAI,EAAG,CAAEA,EAAK,QAAQ,CAACmF,EAAGoS,IAAM/R,EAAML,EAAGulB,EAASxlB,EAAK,OAAOqS,CAAC,CAAC,CAAC,EAAG,MAAQ,CAC9F,GAAI,OAAOvX,GAAS,SACpB,CAAI,SAAUA,GAAMwqB,EAAKE,EAASxlB,EAAMlF,CAAI,EAC5C,OAAW,CAAC0J,EAAGvH,CAAC,IAAK,OAAO,QAAQnC,CAAI,EAClC0J,IAAM,SAAW,MAAM,QAAQvH,CAAC,EAAGA,EAAE,QAAQ,CAACwoB,EAAIpT,IAAM/R,EAAMmlB,EAAIpT,EAAG,CAAC,QAASA,CAAC,CAAC,CAAC,GAC7E,MAAM,QAAQpV,CAAC,GACfA,GAAK,OAAOA,GAAM,WAAUqD,EAAMrD,EAAGuoB,EAASxlB,EAAK,OAAOwE,CAAC,CAAC,GAEzE,EACA,OAAAlE,EAAMzE,EAAK,GAAI,CAAC,CAAC,EACVwpB,CACT,CACA,SAASuC,EAAgBltB,EAAU2O,EAASwe,EAAO,CACjD,IAAMC,EAAO,IAAI,KAAK,EAAE,YAAY,EAAE,QAAQ,QAAQ,GAAG,EACnDrmB,EAAQ4H,EAAQ,IAAI9K,GAAK,CAC7B,IAAIkB,EAAM/E,EACV,QAAWsrB,KAAOznB,EAAE,KAAMkB,EAAMA,EAAIumB,CAAG,EACvC,MAAO,CAAE,KAAMznB,EAAE,KAAM,KAAMA,EAAE,KAAM,YAAckB,GAAOA,EAAI,aAAgB,KAAM,OAAQA,EAAK,MAAAooB,CAAM,CACzG,CAAC,EACKE,EAAS,CAAE,KAAM,oBAAqB,WAAYD,EAAM,MAAOrmB,EAAM,OAAQ,MAAAA,CAAM,EACzF,GAAI,CACF,IAAMmO,EAAM,cAAckY,CAAI,GAC9B,aAAa,QAAQlY,EAAK,KAAK,UAAUmY,CAAM,CAAC,EAChD,IAAMlX,EAAM,OAAO,KAAK,YAAY,EAAE,OAAOrM,GAAKA,EAAE,WAAW,aAAa,CAAC,EAAE,KAAK,EAAE,QAAQ,EAC9F,QAAWA,KAAKqM,EAAI,MAAM,EAAE,EAAG,aAAa,WAAWrM,CAAC,CAC1D,MAAU,CAAC,CACX,MAAO,CAAE,KAAM,cAAcsjB,CAAI,QAAS,KAAMC,CAAO,CACzD,CACA,SAASC,EAAqBlY,EAAMyV,EAAK,CACvC,GAAI,CACF,IAAM3G,EAAO,IAAI,KAAK,CAAC,KAAK,UAAU2G,EAAK,KAAM,CAAC,CAAC,EAAG,CAAE,KAAM,kBAAmB,CAAC,EAC5EvpB,EAAO,IAAI,gBAAgB4iB,CAAI,EAC/BlmB,EAAO,SAAS,cAAc,GAAG,EACvCA,EAAE,KAAOsD,EAAKtD,EAAE,SAAWoX,EAC3B,SAAS,KAAK,YAAYpX,CAAC,EAAGA,EAAE,MAAM,EAAGA,EAAE,OAAO,EAClD,WAAW,IAAM,IAAI,gBAAgBsD,CAAG,EAAG,IAAI,CACjD,OAAQ1C,EAAE,CAAE,QAAQ,KAAK,+BAAgCA,CAAC,CAAG,CAC/D,CACA,SAAS2uB,EAAiBrY,EAAK,CAC7B,GAAKA,EACL,GAAI,CACF,IAAMsY,EAAI,kBACJxR,EAAM,KAAK,MAAM,aAAa,QAAQwR,CAAC,GAAK,IAAI,EACjDxR,EAAI,SAAS9G,CAAG,GAAG8G,EAAI,QAAQ9G,CAAG,EACvC,aAAa,QAAQsY,EAAG,KAAK,UAAUxR,EAAI,MAAM,EAAG,EAAE,CAAC,CAAC,CAC1D,MAAQ,CAAC,CACX,CACA,SAASyR,GAAiB,CACxB,GAAI,CAAE,OAAO,KAAK,MAAM,aAAa,QAAQ,iBAAiB,GAAK,IAAI,CAAG,MAAQ,CAAE,MAAO,CAAC,CAAG,CACjG,CACA,SAASC,GAAqB,CAnjRhC,IAAAnvB,EAAAsB,EAojRI,IAAMsrB,EAAO,IAAI,IACjB,GAAI,CACF,IAAMwC,EAAQ,OAAO,KAAK,YAAY,EAAE,OAAO7jB,GAAKA,EAAE,WAAW,aAAa,CAAC,EAAE,KAAK,EAAE,QAAQ,EAChG,QAAWsL,KAAQuY,EACjB,GAAI,CACF,IAAM9C,EAAM,KAAK,MAAM,aAAa,QAAQzV,CAAI,GAAK,MAAM,EAC3D,GAAIyV,GAAOA,EAAI,MACb,QAAWlX,KAAMkX,EAAI,MAAO,CAC1B,IAAMpH,IAAKllB,EAAAoV,GAAA,YAAAA,EAAI,SAAJ,YAAApV,EAAY,gBAAesB,EAAA8T,GAAA,YAAAA,EAAI,QAAJ,YAAA9T,EAAW,aAC7C4jB,GAAI0H,EAAK,IAAI1H,CAAE,CACrB,CAEJ,MAAQ,CAAC,CAEb,MAAQ,CAAC,CACT,OAAO,MAAM,KAAK0H,CAAI,CACxB,CACF,eAAeyC,EAAsBzN,EAAM,CACzC,eAAA0N,EAAiB,KACjB,aAAAC,EAAiB,GACjB,QAAA9kB,EACA,WAAA+kB,CACF,EAAI,CAAC,EAAG,CA1kRR,IAAAxvB,GAAAsB,GAAAc,GAAAC,GAAAC,GA2kRE,IAAMxB,IAAKd,GAAA,KAAK,eAAL,YAAAA,GAAA,aAAyByuB,EAAa,KAAK,IAAI,EAC1D,GAAI,CAAC3tB,EAAM,eAAQ,MAAM,wCAAwC,EAAU,GAC3E,GAAI,OAAOA,EAAG,YAAe,WAAc,eAAQ,MAAM,qDAAqD,EAAU,GAGxH,IAAM2uB,EAAQvnB,IAAO,OAAOA,IAAM,SAAWA,GAAE,KAAK,EAAI,KAClDwnB,EACJD,EAAKH,CAAc,GACnBG,GAAKnuB,GAAA,uBAAM,UAAN,YAAAA,GAAe,WAAW,GAC/BmuB,EAAK,uBAAM,UAAU,GACrBA,EAAKhlB,CAAO,EAEd,GAAI,CAACilB,EACH,eAAQ,KAAK,yEAAyE,EAC/E,GAIT,IAAM9sB,EAAO,KAAK,MAAM,KAAK,UAAU9B,EAAG,MAAM,CAAC,EAC3CsrB,GAAQ,KAAK,eAAiBsC,GAAe9rB,CAAG,EAEtD,QAAQ,MAAM,wCACZwpB,EAAK,IAAIlmB,KAAM,CACb,KAAMA,GAAE,KACR,KAAMA,GAAE,KAAK,KAAK,GAAG,EACrB,YAAcA,GAAE,OAASA,GAAE,KAAK,aAAeA,GAAE,KAAK,aAAgB,IACxE,EAAE,CACJ,EAGA,IAAIkK,EAAUgc,EAAK,OAAOlmB,IAAK,CAzmRjC,IAAAlG,GAAAsB,GAAAc,GAAAC,GAAAC,GAAAmC,GAAAC,GAAAC,GAAAC,GA+mRI,QAJEA,IAAAH,IAAArC,GAAAqtB,GAAKzvB,GAAAkG,GAAE,OAAF,YAAAlG,GAAQ,WAAW,IAAxB,KAAAoC,GACAqtB,GAAKnuB,GAAA4E,GAAE,OAAF,YAAA5E,GAAQ,UAAU,IADvB,KAAAmD,GAEAgrB,GAAKntB,IAAAD,GAAA6D,GAAE,OAAF,YAAA7D,GAAQ,UAAR,YAAAC,GAAiB,WAAW,IAFjC,KAAAsC,GAGA6qB,GAAK9qB,IAAAD,GAAAwB,GAAE,OAAF,YAAAxB,GAAQ,UAAR,YAAAC,GAAiB,UAAU,KACpB+qB,CAChB,CAAC,EAED,GAAItf,EAAQ,SAAW,EACrB,eAAQ,KAAK,kEAAmEA,EAAQ,OAAQ,CAAE,MAAAsf,CAAM,CAAC,EAClG,GAIT,IAAMd,EAAQ,CAAE,KAAM,4BAA6B,GAAIhN,GAAQ,CAAC,CAAG,EAC/D,gBAAiBgN,GAAQ,OAAOA,EAAM,YACtC,eAAiBA,GAAQ,OAAOA,EAAM,WACtCA,GAAA,MAAAA,EAAO,UACL,gBAAiBA,EAAM,SAAS,OAAOA,EAAM,QAAQ,YACrD,eAAiBA,EAAM,SAAS,OAAOA,EAAM,QAAQ,YAG1D,IAAMe,EAAkB,MAAM,QAAQf,EAAM,KAAK,EAAIA,EAAM,MAAQ,KACnE,OAAOA,EAAM,MAGd,GAAI,CACF,IAAME,GAASH,GAAA,YAAAA,EAAkB7tB,EAAG,OAAQsP,EAASwe,GACjDE,KACF,QAAQ,MAAM,8BAA+B,CAAE,KAAMA,GAAO,KAAM,OAAO1sB,GAAA0sB,GAAO,OAAP,YAAA1sB,GAAa,KAAM,CAAC,EACzF,CAACotB,GAAc,OAAOT,GAAyB,YAAYA,EAAqBD,GAAO,KAAMA,GAAO,IAAI,EAEhH,OAASzuB,GAAG,CACV,QAAQ,MAAM,sCAAsCA,IAAA,YAAAA,GAAG,UAAWA,EAAC,CACrE,CAGA,IAAMiF,EAAI8K,EAAQ,CAAC,EACf5J,EAAM5D,EACV,QAAWmqB,MAAOznB,EAAE,KAAMkB,EAAMA,EAAIumB,EAAG,EAEvC,IAAMC,IACJ1qB,IAAAD,GAAAotB,EAAKjpB,GAAA,YAAAA,EAAK,WAAW,IAArB,KAAAnE,GACAotB,EAAKjpB,GAAA,YAAAA,EAAK,UAAU,IADpB,KAAAlE,GACyB,KAE3B,cAAO,OAAOkE,EAAKooB,CAAK,EAGpB5B,GACFxmB,EAAI,YAAcwmB,GAElBxmB,EAAI,YAAckpB,EAEhB,eAAgBlpB,GAAK,OAAOA,EAAI,WAEpC,QAAQ,MAAM,qCAAiC,CAC7C,QAAS,EACT,SAAUA,EAAI,YACd,iBAAkBipB,EAAK7N,GAAA,YAAAA,EAAM,WAAW,GAAK6N,EAAK7N,GAAA,YAAAA,EAAM,UAAU,GAAK,IACzE,CAAC,EAED,MAAM9gB,EAAG,WAAW8B,CAAG,EAEhB,CAAE,UAAW,GAAM,gBAAA+sB,CAAgB,CAC5C,CAEE,eAAeC,GAAoB,CA5qRrC,IAAA5vB,EA6qRI,IAAM6vB,EAAaxC,GAAS,CAC1B,GAAI,CAACA,EAAM,MAAO,CAAC,EACnB,GAAI,MAAM,QAAQA,CAAI,EAAG,OAAOA,EAChC,GAAI,MAAM,QAAQA,GAAA,YAAAA,EAAM,IAAI,EAAG,OAAOA,EAAK,KAC3C,GAAI,MAAM,QAAQA,GAAA,YAAAA,EAAM,UAAU,EAAG,OAAOA,EAAK,WACjD,GAAI,MAAM,QAAQA,GAAA,YAAAA,EAAM,OAAO,EAAG,OAAOA,EAAK,QAAQ,IAAIhtB,GAAKA,EAAE,KAAOA,EAAE,IAAMA,EAAE,IAAI,EAAE,OAAO,OAAO,EACtG,GAAI,MAAM,QAAQgtB,GAAA,YAAAA,EAAM,KAAK,EAAG,OAAOA,EAAK,MAAM,IAAIhtB,GAAKA,EAAE,KAAOA,EAAE,IAAMA,EAAE,IAAI,EAAE,OAAO,OAAO,EAClG,GAAI,OAAOgtB,GAAS,UAClB,QAAWrpB,KAAK,OAAO,OAAOqpB,CAAI,EAChC,GAAI,MAAM,QAAQrpB,CAAC,GAAKA,EAAE,MAAMyB,GAAK,OAAOA,GAAM,QAAQ,EAAG,OAAOzB,EAGxE,MAAO,CAAC,CACV,EACA,GAAI,CACF,IAAIhE,EAAA,uBAAM,OAAN,MAAAA,EAAY,QAAS,CACvB,IAAML,EAAI,MAAM,KAAK,KAAK,QAAQ,MAAO,kBAAkB,EACrD4L,EAAIskB,EAAUlwB,CAAC,EACrB,GAAI4L,EAAE,OAAQ,OAAOA,CACvB,CACF,OAAQlL,EAAG,CAAE,QAAQ,MAAM,sDAAuDA,CAAC,CAAG,CACtF,IAAMyvB,EAAO,CAAC,wBAAyB,6BAA8B,6BAA8B,6BAA6B,EAChI,QAAW/sB,KAAO+sB,EAChB,GAAI,CAEF,IAAMjK,EAAO,MADA,MAAM,MAAM9iB,EAAK,CAAE,MAAO,UAAW,CAAC,GAC3B,KAAK,EACvBwI,EAAIskB,EAAUhK,CAAI,EACxB,GAAIta,EAAE,OAAQ,OAAOA,CACvB,MAAW,CAAC,CAEd,MAAO,CAAC,CACV,CACA,eAAewkB,EAAkBpZ,EAAK,CACpC,IAAMqZ,EAAe3C,GAAS,CAC5B,GAAI,CAACA,EAAM,OAAO,KAClB,GAAIA,EAAK,SAAWA,EAAK,MAAO,OAAOA,EACvC,GAAI,OAAOA,EAAK,QAAW,SAAU,OAAOA,EAAK,OACjD,GAAI,OAAOA,EAAK,SAAY,SAAU,OAAOA,EAAK,QAClD,GAAI,CAAE,GAAI,OAAOA,GAAS,SAAU,OAAO,KAAK,MAAMA,CAAI,CAAG,MAAQ,CAAC,CACtE,OAAO,IACT,EACM4C,EAAU,MAAOC,EAAQnpB,EAAMopB,IAAW,CAttRpD,IAAAnwB,EAutRM,GAAI,CACF,IAAIA,EAAA,uBAAM,OAAN,MAAAA,EAAY,QAAS,CACvB,IAAML,EAAI,MAAM,KAAK,KAAK,QAAQuwB,EAAQnpB,EAAMopB,CAAM,EAChDre,EAAIke,EAAYrwB,CAAC,EACvB,GAAImS,EAAG,OAAOA,CAChB,CACF,MAAW,CAAC,CACZ,OAAO,IACT,EACMse,EAAW,MAAOrtB,GAAQ,CAC9B,GAAI,CACF,IAAMyd,EAAO,MAAM,MAAMzd,EAAK,CAAE,MAAO,UAAW,CAAC,EAC7CstB,EAAK7P,EAAK,QAAQ,IAAI,cAAc,GAAK,GAC/C,GAAI6P,EAAG,SAAS,kBAAkB,GAAKA,EAAG,SAAS,YAAY,EAAG,CAChE,IAAMC,EAAI,MAAM9P,EAAK,KAAK,EAAE,MAAM,IAAI,IAAI,GAAK,MAAMA,EAAK,KAAK,EAAE,MAAM,IAAI,IAAI,EACzE1O,EAAIke,EAAYM,CAAC,EACvB,GAAIxe,EAAG,OAAOA,CAChB,CACF,MAAW,CAAC,CACZ,OAAO,IACT,EACMye,EAAM,mBAAmB5Z,CAAG,EAClC,OAAO,MAAOsZ,EAAQ,MAAO,oBAAoBM,CAAG,EAAE,GACjDH,EAAS,yBAAyBG,CAAG,EAAE,GACvCH,EAAS,6BAA6BG,CAAG,EAAE,GAC3CN,EAAQ,OAAQ,uBAAwB,CAAE,IAAAtZ,CAAI,CAAC,GAC/C,KACP,CACA,eAAe6Z,EAAmB3K,EAAM,CAAE,OAAA4K,EAAO,WAAY,OAAA9D,EAAO,IAAK,EAAI,CAAC,EAAG,CAnvRnF,IAAA3sB,EAAAsB,EAAAc,EAAAC,EAAAC,EAAAmC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAO,GAAAC,GAAA0E,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAkf,GAAAC,GAAAC,GAAAC,GAovRI,GAAI,CAAChE,GAAQ,OAAOA,GAAS,SAAU,MAAM,IAAI,MAAM,wBAAwB,EAC/E,IAAMpb,EAAU,KAAK,cAAczK,EAAA,KAAK,UAAL,YAAAA,EAAc,cAAe,KAChE,GAAI,EAAEsB,EAAA,KAAK,WAAL,MAAAA,EAAA,YAAmBc,EAAA,KAAK,WAAL,MAAAA,EAAA,UAAgB,SAAU,8BAA+B,CAAE,OAAAquB,EAAQ,OAAA9D,CAAO,EAAI,MAAQ,CAAC,CAChH,GAAI9G,EAAK,QAAS,CAChB,GAAM,CAAE,YAAA1a,GAAa,GAAGC,CAAU,EAAIya,EAAK,SAC3CxjB,EAAA,KAAK,wBAAL,MAAAA,EAAA,UAA6B+I,EAAW,GAC1C,MAAW,OAAOya,EAAK,MAAS,YAC9BvjB,EAAA,KAAK,wBAAL,MAAAA,EAAA,UAA6B,CAAE,KAAMujB,EAAK,IAAK,EAAG,KAEpD,IAAMlP,EAAMgW,KAAUloB,EAAAohB,GAAA,YAAAA,EAAM,UAAN,YAAAphB,EAAe,cAAegG,EACpD,GAAIkM,EAAK,CACP,KAAK,WAAaA,EAClB,KAAK,QAAU,CAAE,GAAI,KAAK,SAAW,CAAC,EAAI,YAAaA,CAAI,EAC3D,GAAI,EAAEjS,EAAA,KAAK,yBAAL,MAAAA,EAAA,UAAiC,MAAQ,CAAC,CAClD,CACA,GAAI,CACF,IAAMgsB,IAAY/rB,EAAAkhB,EAAK,UAAL,KAAAlhB,EAAiB,OAAOkhB,EAAK,MAAS,SAAW,CAAE,KAAMA,EAAK,IAAK,EAAI,CAAC,EAC1F,OAAOjhB,EAAA,KAAK,wBAAL,YAAAA,EAA4B,KAAK,KAAM,CAAE,GAAG8rB,GAAW,YAAa/Z,CAAI,EAAG,CAAE,QAAAlM,EAAS,WAAagmB,IAAS,UAAY,GACjI,OAAQpwB,GAAG,CAAE,QAAQ,KAAK,6BAA8BA,EAAC,CAAG,CAC5D,GAAI,CAEF,GADA,KAAK,cAAc,UAAY,GAC3B,MAAM,QAAQwlB,EAAK,KAAK,GAAKA,EAAK,MAAM,OAC1C,QAAWpa,MAAQoa,EAAK,MACtB,GAAI,EAACpa,IAAA,MAAAA,GAAM,OAAS,OAAOA,GAAK,MAAS,UAAY,OAAO,KAAKA,GAAK,IAAI,EAAE,SAAW,EAAI,CACzF,IAAMlF,GAAIyD,GAAA,KAAK,qBAAL,YAAAA,GAAA,YAA0BnF,EAAA4G,GAAK,WAAL,YAAA5G,EAAe,IAAG,IAAGO,GAAAqG,GAAK,WAAL,YAAArG,GAAe,IAAG,IAAGC,GAAAoG,GAAK,OAAL,YAAApG,GAAW,QAAO,MAAK0E,GAAA0B,GAAK,OAAL,YAAA1B,GAAW,SAAQ,KACpHxD,GAAG,KAAK,cAAc,YAAYA,CAAC,CACzC,KAAO,CACL,IAAMhE,EAAK,MAAM,KAAK,YAAYkJ,GAAK,IAAI,EACrClH,GAAO,KAAK,aAAahC,CAAE,GACjC4H,GAAA,KAAK,mBAAL,MAAAA,GAAA,UAAwB5F,KAAM0F,GAAAwB,GAAK,WAAL,YAAAxB,GAAe,IAAG,IAAGC,GAAAuB,GAAK,WAAL,YAAAvB,GAAe,IAAG,GACrE3F,GAAK,MAAM,MAAS,KAAG6F,GAAAqB,GAAK,OAAL,YAAArB,GAAW,QAAO,GAAG,KAC5C7F,GAAK,MAAM,OAAS,KAAG8F,GAAAoB,GAAK,OAAL,YAAApB,GAAW,SAAQ,GAAG,KACzCoB,GAAK,GAAK,OAAMlH,GAAK,MAAM,OAAS,OAAOkH,GAAK,CAAC,GACrD,KAAK,cAAc,YAAYlH,EAAI,EACnC,GAAI,EAAE+F,GAAA,KAAK,eAAL,MAAAA,GAAA,UAAoB/F,GAAK,kBAAoB,MAAQ,CAAC,EAC5DgG,GAAA,KAAK,oBAAL,MAAAA,GAAA,UAAyBhG,GAC3B,MAGFiG,GAAA,KAAK,wBAAL,MAAAA,GAAA,YAEFkf,GAAA,KAAK,mBAAL,MAAAA,GAAA,YACAC,GAAA,KAAK,aAAL,MAAAA,GAAA,UAAkB,WAClBC,GAAA,KAAK,SAAL,MAAAA,GAAA,UAAc6G,IAAS,WAAa,kBAAkB9Z,CAAG,IAAM,kBACjE,OAAQtW,GAAG,CACT,QAAQ,MAAM,6BAA8BA,EAAC,GAC7CwpB,GAAA,KAAK,SAAL,MAAAA,GAAA,UAAc,gCAChB,CACF,CACA,SAAS8G,GAA4B,CAryRvC,IAAA3wB,EAAAsB,EAsyRI,GAAI,CACF,IAAMkB,EAAO,KAAK,YAAc,KAAK,YAAc,KAC7CD,EAAKC,EAAK,cAAc,sBAAsB,EACpD,GAAI,CAACD,EAAI,OACT,IAAMzB,IAAKd,EAAA,KAAK,eAAL,YAAAA,EAAA,aAAyByuB,EAAa,KAAK,IAAI,EACtDmC,EAAO,GACX,GAAI,CACF,IAAMC,GAAOvvB,EAAAkB,EAAK,aAAeA,EAAK,YAAY,IAArC,YAAAlB,EAAyC,KACtDsvB,EAAO,CAAC,EAAE9vB,IAAOA,EAAG,WAAa,IAAS+vB,GAAOA,EAAI,WAAa,IACpE,MAAQ,CAAC,CACTtuB,EAAG,MAAM,QAAUquB,EAAO,cAAgB,MAC5C,MAAQ,CAAC,CACX,CACA,SAASE,GAAwB,CAC/B,GAAI,CACF,GAAI,KAAK,sBAAuB,OAEhC,IAAMC,GADO,KAAK,YAAc,KAAK,YAAc,MAC9B,cAAc,UAAU,EAC7C,GAAI,CAACA,EAAS,OACd,IAAMxsB,EAAO,SAAS,cAAc,KAAK,EACzCA,EAAK,UAAY,sBACjB,OAAO,OAAOA,EAAK,MAAO,CAAE,QAAS,cAAe,IAAK,MAAO,WAAY,SAAU,WAAY,MAAO,CAAC,EAC1G,IAAMsZ,EAAQ,SAAS,cAAc,MAAM,EAC3CA,EAAM,YAAc,UACpBA,EAAM,MAAM,SAAW,OACvBA,EAAM,MAAM,QAAU,MACtB,IAAM6J,EAAS,SAAS,cAAc,QAAQ,EAC9C,OAAO,OAAOA,EAAO,MAAO,CAC1B,SAAU,OAAQ,QAAS,UAAW,aAAc,MACpD,OAAQ,uCACR,WAAY,oCACd,CAAC,EACDA,EAAO,MAAQ,qCACfA,EAAO,GAAK,eACZ,IAAMxnB,EAAM,SAAS,cAAc,QAAQ,EAC3CA,EAAI,UAAY,gBAChBA,EAAI,KAAO,SACXA,EAAI,MAAM,QAAU,WACpBA,EAAI,UAAY,qFAChBqE,EAAK,YAAYsZ,CAAK,EACtBtZ,EAAK,YAAYmjB,CAAM,EACvBnjB,EAAK,YAAYrE,CAAG,EACpB6wB,EAAQ,YAAYxsB,CAAI,EACxB,KAAK,sBAAwB,GAC7B,IAAMysB,EAAO,SAAY,CACvB,IAAMloB,EAAU,KAAK,YAAe,KAAK,SAAW,KAAK,QAAQ,aAAgB,GAC3EmoB,EAAa,MAAMrB,EAAkB,KAAK,IAAI,EAC9CsB,EAAa/B,EAAmB,EAChCgC,EAAajC,EAAe,EAC5BkC,EAAY3T,IAAQ,MAAM,KAAK,IAAI,IAAIA,GAAI,OAAO,OAAO,CAAC,CAAC,EAC3D4T,EAASD,EAASH,CAAU,EAC5BK,EAAUF,EAASF,CAAU,EAC7BnW,EAASqW,EAASD,CAAU,EAElC,GADAzJ,EAAO,UAAY,GACf5e,GAAW,CAACuoB,EAAO,SAASvoB,CAAO,GAAK,CAACwoB,EAAQ,SAASxoB,CAAO,GAAK,CAACiS,EAAO,SAASjS,CAAO,EAAG,CACnG,IAAMuD,GAAM,SAAS,cAAc,QAAQ,EAC3CA,GAAI,MAAQvD,EACZuD,GAAI,YAAc,GAAGvD,CAAO,aAC5BuD,GAAI,SAAW,GACfqb,EAAO,YAAYrb,EAAG,CACxB,CACA,IAAMklB,GAAY,CAAC1T,GAAOvd,KAAS,CACjC,GAAI,CAACA,GAAK,OAAQ,OAClB,IAAMkxB,GAAK,SAAS,cAAc,UAAU,EAAGA,GAAG,MAAQ3T,GAC1Dvd,GAAK,QAAQiL,IAAK,CAChB,IAAM+J,GAAI,SAAS,cAAc,QAAQ,EAAGA,GAAE,MAAQ/J,GAAG+J,GAAE,YAAc/J,GAAOA,KAAIzC,IAASwM,GAAE,SAAW,IAC1Gkc,GAAG,YAAYlc,EAAC,CAClB,CAAC,EACDoS,EAAO,YAAY8J,EAAE,CACvB,EAIA,GAHAD,GAAU,SAAUF,CAAM,EAC1BE,GAAU,UAAWD,CAAO,EAC5BC,GAAU,SAAUxW,CAAM,EACtB,CAAC2M,EAAO,SAAS,OAAQ,CAC3B,IAAM+J,GAAO,SAAS,cAAc,QAAQ,EAAGA,GAAK,MAAM,GAAIA,GAAK,YAAY,qBAAYA,GAAK,SAAW,GAC3G/J,EAAO,YAAY+J,EAAI,CACzB,CACAd,EAA0B,KAAK,IAAI,CACrC,EACAK,EAAK,EACL9wB,EAAI,iBAAiB,QAAS8wB,CAAI,EAElCtJ,EAAO,iBAAiB,SAAU,MAAOrnB,GAAM,CAx3RrD,IAAAL,EAAAsB,EAAAc,EAAAC,EAAAC,EAAAmC,EAAAC,GAAAC,GAy3RQ,IAAMgoB,EAAS,OAAOtsB,EAAE,OAAO,OAAS,EAAE,EAC1C,GAAKssB,GACD,MAAK,mBACT,MAAK,mBAAqB,GAE1B,GAAI,CACF,IAAM+E,GAAS,MAAM3B,EAAkB,KAAK,KAAMpD,CAAM,EACxD,GAAI,CAAC+E,GAAQ,EACX1xB,EAAA,KAAK,SAAL,MAAAA,EAAA,UAAc,wBAAwB2sB,CAAM,KAC5C,MACF,CAGA,MAAM6D,EAAmB,KAAK,KAAMkB,GAAQ,CAAE,OAAQ,WAAY,OAAA/E,CAAO,CAAC,GAC1ErrB,EAAA,KAAK,mBAAL,MAAAA,EAAA,YACAc,EAAA,KAAK,SAAL,MAAAA,EAAA,UAAc,kBAAkBuqB,CAAM,KAItC,IAAMgF,GAAS,SAAOtvB,EAAA,KAAK,UAAL,YAAAA,EAAc,cAAe,KAAK,YAAc,EAAE,EAEpEuvB,GAAY,GAChB,GAAI,CACF,IAAMC,GAAcF,GAChB,CAAE,eAAgBA,GAAQ,WAAY,EAAK,EAC3C,CAAE,WAAY,EAAK,EAGvBC,GAAY,MAAM,KAAK,sBAAsB,CAAE,YAAajF,CAAO,EAAGkF,EAAW,CACnF,OAASrd,GAAK,CACZ,QAAQ,KAAK,uDAAwDA,EAAG,GACxElS,EAAA,KAAK,SAAL,MAAAA,EAAA,UAAc,uDACd,MACF,CAOA,GAJA,KAAK,WAAaqqB,EACd,KAAK,UAAS,KAAK,QAAQ,YAAcA,GAGzC,CAACiF,GAAW,CACd,QAAQ,KAAK,4EAA4E,EAGzF,MACF,CAGA,GAAI,CACE,KAAK,YAAY,aAAa,KAAK,UAAU,EACjD,MAAM,KAAK,YAAY,EAAI,CAC7B,OAASE,GAAI,CACX,QAAQ,KAAK,mCAAoCA,EAAE,GACnDrtB,EAAA,KAAK,aAAL,MAAAA,EAAA,UAAkB,aAClBC,GAAA,KAAK,SAAL,MAAAA,GAAA,UAAc,6CACd,MACF,CAGA,OAAO,SAAS,OAAO,EAGvB,OAAO,SAAS,OAAO,CAEzB,OAAS8P,GAAK,CACZ,QAAQ,KAAK,mCAAoCA,EAAG,GACpD7P,GAAA,KAAK,SAAL,MAAAA,GAAA,UAAc,yBAChB,QAAE,CACA,KAAK,mBAAqB,EAC5B,EACF,CAAC,EACD,KAAK,cAAgB,cAAc,KAAK,YAAY,EACpD,KAAK,aAAe,YAAY,IAAMgsB,EAA0B,KAAK,IAAI,EAAG,GAAG,EAC/EA,EAA0B,KAAK,IAAI,CACrC,OAAQtwB,EAAG,CACT,QAAQ,KAAK,uCAAwCA,CAAC,CACxD,CACF,CACKmuB,EAAI,UAAU,eAAcA,EAAI,UAAU,aAAeC,GACzDD,EAAI,UAAU,gBAAeA,EAAI,UAAU,cAAgBE,GAChEF,EAAI,UAAU,sBAAwBa,EACjCb,EAAI,UAAU,qBAAoBA,EAAI,UAAU,mBAAqBgC,GAC1E,GAAI,CACF,IAAMuB,EAAO,OAAO,yBAAyBvD,EAAI,UAAW,MAAM,EAClE,GAAIuD,IAASA,EAAK,KAAOA,EAAK,KAAM,CAClC,IAAMC,EAAUD,EAAK,IACrB,OAAO,eAAevD,EAAI,UAAW,OAAQ,CAC3C,aAAc,GAAM,WAAY,GAChC,IAAIxqB,EAAG,CAAMguB,GAASA,EAAQ,KAAK,KAAMhuB,CAAC,EAAG,GAAI,CAAE8sB,EAAsB,KAAK,IAAI,CAAG,MAAU,CAAC,CAAE,EAClG,IAAKiB,EAAK,KAAO,UAAU,CAAE,OAAO,KAAK,KAAO,CAClD,CAAC,CACH,SAAW,OAAOvD,EAAI,UAAU,SAAY,WAAY,CACtD,IAAMhc,EAAOgc,EAAI,UAAU,QAC3BA,EAAI,UAAU,QAAU,SAASxqB,EAAE,CAAMwO,GAAMA,EAAK,KAAK,KAAMxO,CAAC,EAAG,GAAI,CAAE8sB,EAAsB,KAAK,IAAI,CAAG,MAAU,CAAC,CAAE,CAC1H,KAAO,CACL,IAAMmB,EAAazD,EAAI,UAAU,SAAWA,EAAI,UAAU,aAC1DA,EAAI,UAAU,QAAU,YAAY0D,EAAK,CAAMD,GAAYA,EAAW,MAAM,KAAMC,CAAI,EAAG,GAAI,CAAEpB,EAAsB,KAAK,IAAI,CAAG,MAAU,CAAC,CAAE,CAChJ,CACF,OAAQzwB,EAAE,CAAE,QAAQ,KAAK,yCAA0CA,CAAC,CAAG,CACzE,GAAG",
  "names": ["isWindow", "thing", "Window", "realWindow", "win", "init", "window", "el", "document", "createTextNode", "ownerDocument", "wrap", "getWindow", "node", "defaultView", "object", "_typeof", "func", "is", "docFrag", "nodeType", "number", "bool", "string", "element", "_window", "test", "Element", "nodeName", "plainObject", "constructor", "toString", "array", "length", "splice", "beforeMove", "_ref", "interaction", "prepared", "name", "axis", "coords", "cur", "page", "y", "start", "client", "velocity", "x", "move", "_ref2", "iEvent", "opposite", "delta", "drag", "id", "install", "scope", "actions", "Interactable", "defaults", "prototype", "draggable", "map", "methodDict", "listeners", "arg", "interactable", "buttons", "dragOptions", "options", "enabled", "pointerIsDown", "pointerType", "mouseButtons", "action", "lockAxis", "startAxis", "this", "setPerAction", "setOnEvents", "getCursor", "filterEventType", "type", "search", "drag$1", "domObjects", "DocumentFragment", "blank", "SVGElement", "SVGSVGElement", "SVGElementInstance", "HTMLElement", "Event", "Touch", "PointerEvent", "MSPointerEvent", "domObjects$1", "browser", "navigator", "supportsTouch", "DocumentTouch", "supportsPointerEvent", "pointerEnabled", "isIOS", "platform", "isIOS7", "appVersion", "isIe9", "userAgent", "isOperaMobile", "appName", "prefixedMatchesSelector", "pEventTypes", "up", "down", "over", "out", "cancel", "wheelEvent", "browser$1", "nodeContains", "parent", "child", "contains", "parentNode", "closest", "selector", "matchesSelector", "host", "replace", "getParent", "getNodeParents", "limit", "parentParent", "parents", "unshift", "matchesUpTo", "getActualElement", "correspondingUseElement", "getElementClientRect", "clientRect", "getBoundingClientRect", "getClientRects", "left", "right", "top", "bottom", "width", "height", "getElementRect", "relevantWindow", "scroll", "scrollX", "documentElement", "scrollLeft", "scrollY", "scrollTop", "getPath", "path", "push", "trySelector", "value", "querySelector", "extend", "dest", "source", "prop", "getStringOptionResult", "target", "getRect", "resolveRectLike", "functionArgs", "returnValue", "apply", "rectToXY", "rect", "tlbrToXywh", "addEdges", "edges", "getOriginXY", "actionName", "actionOptions", "origin", "normalize", "filter", "arguments", "_typeOrPrefix", "result", "split", "forEach", "t", "_i2", "_listeners2", "l", "prefix", "p", "concat", "trim", "hypot", "Math", "sqrt", "VENDOR_PREFIXES", "pointerExtend", "__set", "_loop", "some", "indexOf", "Object", "defineProperty", "get", "set", "configurable", "copyCoords", "src", "timeStamp", "setZeroCoords", "targetObj", "isNativePointer", "pointer", "dom", "getXY", "xy", "getPageXY", "getPointerId", "pointerId", "identifier", "setCoords", "pointers", "pointerAverage", "getTouchPair", "event", "touches", "changedTouches", "average", "pageX", "pageY", "clientX", "clientY", "screenX", "screenY", "touchBBox", "minX", "min", "minY", "maxX", "max", "maxY", "touchDistance", "deltaSource", "sourceX", "sourceY", "dx", "dy", "touchAngle", "atan2", "PI", "getPointerType", "undefined", "getEventTargets", "composedPath", "domUtils", "currentTarget", "BaseEvent", "_classCallCheck", "immediatePropagationStopped", "propagationStopped", "_interaction", "_createClass", "key", "_proxy", "merge", "item", "from", "findIndex", "i", "find", "DropEvent", "_BaseEvent", "_inherits", "_super", "_createSuper", "dropState", "dragEvent", "_this", "call", "dropzone", "relatedTarget", "prev", "_this2", "rejected", "events", "enter", "stopImmediatePropagation", "activeDrops", "index", "arr", "deactivateEvent", "fire", "fireActivationEvents", "_i6", "_activeDrops$slice2", "slice", "_activeDrops$slice2$_", "getActiveDrops", "dragElement", "draggableElement", "drops", "_interactables$list2", "interactables", "list", "drop", "accept", "_i4", "_dropzone$getAllEleme2", "getAllElements", "dropzoneElement", "_i8", "activeDrop", "getDrop", "pointerEvent", "validDrops", "_i10", "_dropState$activeDrop2", "_dropState$activeDrop3", "isValid", "dropCheck", "dropIndex", "elements", "deepestNodeIndex", "higherNode", "lowerNode", "deepestNodeParents", "currentNode", "deepestNode", "currentNodeParent", "deepestNodeParent", "ancestryStart", "ownerSVGElement", "currentNodeParents", "commonIndex", "lastChild", "previousSibling", "parseInt", "getComputedStyle", "zIndex", "getDropEvents", "_pointerEvent", "dropEvents", "leave", "activate", "deactivate", "dragLeave", "prevDropzone", "dragEnter", "fireDropEvents", "onEventCreated", "_ref3", "dynamicDrop", "dropResult", "interact", "interactStatic", "usePlugin", "normalized", "normalizeListeners", "corrected", "keys", "reduce", "acc", "prevListeners", "off", "on", "ondrop", "ondropactivate", "ondropdeactivate", "ondragenter", "ondragleave", "ondropmove", "overlap", "checker", "dropElement", "dropped", "dropOverlap", "pointerUtils", "horizontal", "vertical", "dragRect", "cx", "cy", "newValue", "phaselessTypes", "dragenter", "dragleave", "dropactivate", "dropdeactivate", "dropmove", "_ref4", "_ref5", "_ref6", "_ref7", "drop$1", "updateGestureProps", "phase", "starting", "ending", "distance", "box", "scale", "ds", "angle", "da", "gesture", "startDistance", "startAngle", "prevEvent", "Infinity", "isNaN", "before", "gesturable", "gestureOptions", "gesture$1", "checkResizeEdge", "interactableElement", "margin", "abs", "edge", "updateEventAxes", "resizeAxes", "resizeEvent", "resize", "square", "axes", "request", "cursors", "topleft", "bottomright", "topright", "bottomleft", "defaultMargin", "resizable", "preserveAspectRatio", "_rects", "previous", "deltaRect", "invert", "invertible", "current", "_interaction$_rects", "startRect", "swap", "resizeOptions", "resizeEdges", "_latestPointer", "eventTarget", "NaN", "cursorKey", "_ref8", "resize$1", "lastTime", "raf", "callback", "token", "global", "requestAnimationFrame", "cancelAnimationFrame", "vendors", "vendor", "bind", "currTime", "Date", "now", "timeToCall", "setTimeout", "clearTimeout", "autoScroll", "container", "speed", "isScrolling", "prevTime", "stop", "getContainer", "dt", "s", "scrollBy", "prevScroll", "getScroll", "curScroll", "check", "_options$actionName$a", "onInteractionMove", "interacting", "simulation", "innerWidth", "innerHeight", "body", "autoScrollPlugin", "autoscroll", "perAction", "autoScroll$1", "warnOnce", "method", "message", "warned", "console", "warn", "copyAction", "styleCursor", "actionChecker", "InteractableMethods", "getAction", "button", "ignoreFrom", "_backCompatOption", "allowFrom", "validateAction", "testIgnoreAllow", "withinInteractionLimit", "validateMatches", "matches", "matchElements", "len", "match", "matchElement", "matchAction", "getActionInfo", "pushMatches", "forEachMatch", "actionInfo", "manualStart", "prepare", "setInteractionCursor", "maxActions", "maxPerElement", "autoStartMax", "autoStart", "maxInteractions", "activeInteractions", "interactableCount", "elementCount", "_scope$interactions$l2", "interactions", "otherAction", "setCursor", "cursor", "prevCursorElement", "cursorElement", "style", "cursorChecker", "_interacting", "base", "pointerWasMoved", "autoStart$2", "dragAxis", "absX", "absY", "targetOptions", "currentAxis", "getDraggable", "downPointer", "downEvent", "thisAxis", "getHoldDuration", "hold", "delay", "basePlugin", "autoStartHoldTimer", "duplicate", "hold$1", "preventDefault", "onInteractionEvent", "checkAndPreventDefault", "interactablePreventDefault", "setting", "supportsPassive", "doc", "docOptions", "getDocOptions", "passive", "docEvents", "listener", "eventType", "isNonNativeEvent", "substr", "phases", "clone", "Modification", "states", "startOffset", "startDelta", "endResult", "startEdges", "createResult", "pageCoords", "modifierList", "actionModifiers", "modifiers", "methods", "_methods", "m", "prepareStates", "fillArg", "preEnd", "startAll", "setAll", "_this$states2", "state", "skipModifiers", "unmodifiedRect", "unmodifiedEdges", "newResult", "_state$methods", "lastModifierCoords", "shouldDo", "rectUtils", "eventProps", "rectDelta", "prevCoords", "prevRect", "rectChanged", "changed", "curCoords", "startCoords", "curDelta", "_ref3$_i", "coordsSet", "modifiedCoords", "adjustment", "applyToInteraction", "doPreend", "endPosition", "beforeEnd", "modifierArg", "_this$states4", "_modifierList$index", "_ref4$interaction", "modification", "_modification$result", "_i12", "_ref6$_i", "requireEndOnly", "endOnly", "setStart", "other", "makeModifier", "module", "modifier", "_options", "enable", "disable", "_defaults", "addEventModifiers", "modifiersBase", "ret", "setAndApply", "restoreInteractionCoords", "InteractEvent", "ctrlKey", "shiftKey", "altKey", "metaKey", "x0", "y0", "t0", "duration", "clientX0", "clientY0", "swipe", "_assertThisInitialized", "downTime", "getSwipe", "velocityY", "velocityX", "defineProperties", "PointerInfo", "downTarget", "_ProxyValues", "_ProxyMethods", "idCounter", "Interaction", "scopeFire", "_scopeFire", "_ending", "_stopped", "doMove", "signalArg", "_id", "that", "_loop2", "_key", "pointerIndex", "updatePointer", "pointerInfo", "_doPhase", "duplicateMove", "pointerMoveTolerance", "getPointerIndex", "curEventTarget", "end", "removePointer", "endPhaseResult", "curPointer", "_now", "_updateLatestPointer", "_this$interactable", "_createPreparedEvent", "_fireEvent", "beforeAction", "applyPending", "offset", "pending", "addToCoords", "offsetBy", "total", "offset$1", "InertiaState", "active", "isModified", "smoothEnd", "allowResume", "modifierCount", "v0", "te", "targetOffset", "modifiedOffset", "currentOffset", "lambda_v0", "one_ve_v0", "timeout", "getOptions", "velocityClient", "pointerSpeed", "copyFrom", "minSpeed", "endSpeed", "startInertia", "startSmoothEnd", "startVelocity", "lambda", "resistance", "inertiaDur", "log", "onNextFrame", "inertiaTick", "smoothEndTick", "tickFn", "_this3", "startX", "startY", "cpX", "cpY", "endX", "endY", "position", "_this4", "newOffset", "progress", "exp", "_getQBezierValue", "_this5", "smoothEndDuration", "easeOutQuad", "inertia", "inertiastart", "resume", "p1", "p2", "p3", "iT", "b", "c", "d", "inertia$1", "fireUntilImmediateStopped", "Eventable", "types", "eventList", "_listeners$type2", "subListener", "_element", "FakeEvent", "originalEvent", "pExtend", "stopPropagation", "param", "capture", "optionsMatch", "a", "_scope$document", "targets", "delegatedEvents", "documents", "eventsMethods", "add", "remove", "addDelegate", "context", "optionalArg", "_i3", "delegateListener", "delegateUseCapture", "delegates", "delegate", "removeDelegate", "matchFound", "entry", "supportsOptions", "addEventListener", "removeEventListener", "targetIndex", "typeIsEmpty", "typeListeners", "hasOwnProperty", "fakeEvent", "_i5", "createElement", "finder", "methodOrder", "details", "_finder$methodOrder2", "simulationResume", "mouseOrPen", "firstNonActive", "_scope$interactions$l4", "hasPointerId", "_scope$interactions$l6", "hasPointer", "_scope$interactions$l8", "idle", "_scope$interactions$l10", "finder$1", "methodNames", "doOnInteractions", "_pointerUtils$getEven", "prevTouchTime", "_event$changedTouches2", "changedTouch", "searchDetails", "getInteraction", "invalidPointer", "_matches$_i", "new", "onDocSignal", "eventMethodName", "eventMethod", "eventOptions", "_i14", "_docEvents$_i", "releasePointersOnRemovedEls", "_interaction$pointers2", "pointerDown", "pointerMove", "pointerUp", "documentBlur", "_InteractionBase", "_class", "InteractionBase", "destroy", "interactions$1", "OnOffMethod", "defaultContext", "scopeEvents", "_actions", "_context", "_win", "_doc", "_scopeEvents", "onstart", "onmove", "onend", "oninertiastart", "_this$_actions$map$ac", "actionFilter", "_onOff", "Off", "On", "optionName_", "optionName", "optionValue", "updatePerActionListeners", "Array", "querySelectorAll", "targetNode", "testIgnore", "testAllow", "typeArg", "listenerArg", "_listeners$_type2", "actionName_", "methodName", "rectChecker", "delegated", "_delegated$i", "InteractableSet", "selectorMap", "addListeners", "interactablesOnTarget", "addDocument", "isSelector", "inContext", "_this$list2", "Scope", "floor", "random", "isInitialized", "listenerMaps", "getExisting", "globalEvents", "getPointerAverage", "getTouchBBox", "getTouchDistance", "getTouchAngle", "version", "process", "use", "plugin", "isSet", "_type2", "debug", "_this$scope$interacti2", "removeDocument", "_plugins", "onWindowUnload", "_InteractableBase", "_class2", "_get", "_getPrototypeOf", "InteractableBase", "_this$listenerMaps2", "pluginIsInstalled", "pluginIdRoot", "otherId", "getDocIndex", "docIndex", "interact$1", "_global", "globalThis", "fn", "grid", "coordFields", "xField", "yField", "gridFunc", "range", "_grid$limits", "limits", "_grid$offset", "_coordFields$_i", "gridx", "round", "gridy", "snappersPlugin", "snappers", "allSnappers", "createSnapGrid", "aspectRatio", "_state$options", "ratio", "_state$options2", "equalDelta", "linkedEdges", "xIsPrimaryAxis", "sign", "edgeSign", "subModification", "_objectSpread", "initialCoords", "aspectMethod", "setEqualDelta", "setRatio", "correctedRect", "newHeight", "newWidth", "aspectRatio$1", "noop", "rubberband", "getRestrictionRect", "restrict", "elementRect", "restriction", "widthDiff", "heightDiff", "restrict$1", "noInner", "noOuter", "fixRect", "restrictEdges", "inner", "outer", "restrictEdges$1", "_", "restrictRect$1", "noMin", "noMax", "restrictSize$1", "minSize", "maxSize", "snap", "snapOffset", "offsetWithOrigin", "optionsOrigin", "offsetRect", "relativePoints", "offsets", "relativePoint", "relativeX", "relativeY", "snapTarget", "inRange", "snap$1", "snapSize", "targetFields", "relative", "_state$targetFields2", "_state$targetFields2$", "snapSize$1", "all", "restrictRect", "restrictSize", "snapEdges", "spring", "avoid", "transform", "_all", "modifiers$1", "interval", "tapTime", "double", "prevTap", "originX", "originY", "pointerEvents", "clearHold", "timer", "minDuration", "_signalArg$targets2", "holdDuration", "eventable", "collectEventTargets", "tap", "doubletap", "_arg$targets", "props", "_subtractOrigin", "_addOrigin", "_interaction$pointers", "Nn", "Bn", "endHoldRepeat", "holdIntervalHandle", "clearInterval", "holdRepeat", "holdRepeatInterval", "holdrepeat", "enderTypes", "count", "holdRepeat$1", "__backCompatOption", "interactableTargets", "reflow", "Promise", "promises", "reflowPromise", "runningInteraction", "_reflowPromise", "resolve", "_reflowResolve", "xywh", "then", "reflow$1", "default", "exports", "_unused", "import_interactjs", "isNothing", "subject", "isObject", "toArray", "sequence", "extend", "target", "source", "index", "length", "key", "sourceKeys", "repeat", "string", "count", "result", "cycle", "isNegativeZero", "number", "isNothing_1", "isObject_1", "toArray_1", "repeat_1", "isNegativeZero_1", "extend_1", "common", "formatError", "exception", "compact", "where", "message", "YAMLException$1", "reason", "mark", "getLine", "buffer", "lineStart", "lineEnd", "position", "maxLineLength", "head", "tail", "maxHalfLength", "padStart", "max", "makeSnippet", "options", "re", "lineStarts", "lineEnds", "match", "foundLineNo", "i", "line", "lineNoLength", "snippet", "TYPE_CONSTRUCTOR_OPTIONS", "YAML_NODE_KINDS", "compileStyleAliases", "map", "style", "alias", "Type$1", "tag", "name", "data", "type", "compileList", "schema", "currentType", "newIndex", "previousType", "previousIndex", "compileMap", "collectType", "Schema$1", "definition", "implicit", "explicit", "type$1", "str", "seq", "failsafe", "resolveYamlNull", "constructYamlNull", "isNull", "object", "_null", "resolveYamlBoolean", "constructYamlBoolean", "isBoolean", "bool", "isHexCode", "c", "isOctCode", "isDecCode", "resolveYamlInteger", "hasDigits", "ch", "constructYamlInteger", "value", "sign", "isInteger", "int", "obj", "YAML_FLOAT_PATTERN", "resolveYamlFloat", "constructYamlFloat", "SCIENTIFIC_WITHOUT_DOT", "representYamlFloat", "res", "isFloat", "float", "json", "core", "YAML_DATE_REGEXP", "YAML_TIMESTAMP_REGEXP", "resolveYamlTimestamp", "constructYamlTimestamp", "year", "month", "day", "hour", "minute", "second", "fraction", "delta", "tz_hour", "tz_minute", "date", "representYamlTimestamp", "timestamp", "resolveYamlMerge", "merge", "BASE64_MAP", "resolveYamlBinary", "code", "idx", "bitlen", "constructYamlBinary", "tailbits", "input", "bits", "representYamlBinary", "isBinary", "binary", "_hasOwnProperty$3", "_toString$2", "resolveYamlOmap", "objectKeys", "pair", "pairKey", "pairHasKey", "constructYamlOmap", "omap", "_toString$1", "resolveYamlPairs", "keys", "constructYamlPairs", "pairs", "_hasOwnProperty$2", "resolveYamlSet", "constructYamlSet", "set", "_default", "_hasOwnProperty$1", "CONTEXT_FLOW_IN", "CONTEXT_FLOW_OUT", "CONTEXT_BLOCK_IN", "CONTEXT_BLOCK_OUT", "CHOMPING_CLIP", "CHOMPING_STRIP", "CHOMPING_KEEP", "PATTERN_NON_PRINTABLE", "PATTERN_NON_ASCII_LINE_BREAKS", "PATTERN_FLOW_INDICATORS", "PATTERN_TAG_HANDLE", "PATTERN_TAG_URI", "_class", "is_EOL", "is_WHITE_SPACE", "is_WS_OR_EOL", "is_FLOW_INDICATOR", "fromHexCode", "lc", "escapedHexLen", "fromDecimalCode", "simpleEscapeSequence", "charFromCodepoint", "simpleEscapeCheck", "simpleEscapeMap", "State$1", "generateError", "state", "throwError", "throwWarning", "directiveHandlers", "args", "major", "minor", "handle", "prefix", "captureSegment", "start", "end", "checkJson", "_position", "_length", "_character", "_result", "mergeMappings", "destination", "overridableKeys", "quantity", "storeMappingPair", "keyTag", "keyNode", "valueNode", "startLine", "startLineStart", "startPos", "readLineBreak", "skipSeparationSpace", "allowComments", "checkIndent", "lineBreaks", "testDocumentSeparator", "writeFoldedLines", "readPlainScalar", "nodeIndent", "withinFlowCollection", "preceding", "following", "captureStart", "captureEnd", "hasPendingContent", "_line", "_lineStart", "_lineIndent", "_kind", "readSingleQuotedScalar", "readDoubleQuotedScalar", "hexLength", "hexResult", "tmp", "readFlowCollection", "readNext", "_pos", "_tag", "_anchor", "terminator", "isPair", "isExplicitPair", "isMapping", "composeNode", "readBlockScalar", "folding", "chomping", "didReadContent", "detectedIndent", "textIndent", "emptyLines", "atMoreIndented", "readBlockSequence", "detected", "readBlockMapping", "flowIndent", "allowCompact", "_keyLine", "_keyLineStart", "_keyPos", "atExplicitKey", "readTagProperty", "isVerbatim", "isNamed", "tagHandle", "tagName", "readAnchorProperty", "readAlias", "parentIndent", "nodeContext", "allowToSeek", "allowBlockStyles", "allowBlockScalars", "allowBlockCollections", "indentStatus", "atNewLine", "hasContent", "typeIndex", "typeQuantity", "typeList", "blockIndent", "readDocument", "documentStart", "directiveName", "directiveArgs", "hasDirectives", "loadDocuments", "nullpos", "loadAll$1", "iterator", "documents", "load$1", "loadAll_1", "load_1", "loader", "_toString", "_hasOwnProperty", "CHAR_BOM", "CHAR_TAB", "CHAR_LINE_FEED", "CHAR_CARRIAGE_RETURN", "CHAR_SPACE", "CHAR_EXCLAMATION", "CHAR_DOUBLE_QUOTE", "CHAR_SHARP", "CHAR_PERCENT", "CHAR_AMPERSAND", "CHAR_SINGLE_QUOTE", "CHAR_ASTERISK", "CHAR_COMMA", "CHAR_MINUS", "CHAR_COLON", "CHAR_EQUALS", "CHAR_GREATER_THAN", "CHAR_QUESTION", "CHAR_COMMERCIAL_AT", "CHAR_LEFT_SQUARE_BRACKET", "CHAR_RIGHT_SQUARE_BRACKET", "CHAR_GRAVE_ACCENT", "CHAR_LEFT_CURLY_BRACKET", "CHAR_VERTICAL_LINE", "CHAR_RIGHT_CURLY_BRACKET", "ESCAPE_SEQUENCES", "DEPRECATED_BOOLEANS_SYNTAX", "DEPRECATED_BASE60_SYNTAX", "compileStyleMap", "encodeHex", "character", "QUOTING_TYPE_SINGLE", "QUOTING_TYPE_DOUBLE", "State", "indentString", "spaces", "ind", "next", "generateNextLine", "level", "testImplicitResolving", "isWhitespace", "isPrintable", "isNsCharOrWhitespace", "isPlainSafe", "prev", "inblock", "cIsNsCharOrWhitespace", "cIsNsChar", "isPlainSafeFirst", "isPlainSafeLast", "codePointAt", "pos", "first", "needIndentIndicator", "leadingSpaceRe", "STYLE_PLAIN", "STYLE_SINGLE", "STYLE_LITERAL", "STYLE_FOLDED", "STYLE_DOUBLE", "chooseScalarStyle", "singleLineOnly", "indentPerLevel", "lineWidth", "testAmbiguousType", "quotingType", "forceQuotes", "char", "prevChar", "hasLineBreak", "hasFoldableLine", "shouldTrackWidth", "previousLineBreak", "plain", "writeScalar", "iskey", "indent", "testAmbiguity", "blockHeader", "dropEndingNewline", "foldString", "escapeString", "indentIndicator", "clip", "keep", "chomp", "width", "lineRe", "nextLF", "foldLine", "prevMoreIndented", "moreIndented", "breakRe", "curr", "escapeSeq", "writeFlowSequence", "writeNode", "writeBlockSequence", "writeFlowMapping", "objectKeyList", "objectKey", "objectValue", "pairBuffer", "writeBlockMapping", "explicitPair", "detectType", "block", "isblockseq", "tagStr", "objectOrArray", "duplicateIndex", "duplicate", "getDuplicateReferences", "objects", "duplicatesIndexes", "inspectNode", "dump$1", "dump_1", "dumper", "renamed", "from", "to", "Type", "Schema", "FAILSAFE_SCHEMA", "JSON_SCHEMA", "CORE_SCHEMA", "DEFAULT_SCHEMA", "load", "loadAll", "dump", "YAMLException", "types", "safeLoad", "safeLoadAll", "safeDump", "jsYaml", "js_yaml_default", "interact", "js_yaml_default", "VERSION", "LOG", "m", "a", "raf", "r", "idle", "DragAndDropCard", "_DragAndDropCard", "__publicField", "_a", "bar", "btn", "idx", "selected", "e", "list", "focusedIndex", "b", "activeIndex", "target", "first", "id", "url_path", "ll", "hit", "c", "viewIndex", "cardIndex", "parentPath", "view", "updated", "_b", "partial", "merged", "llConfig", "predicate", "views", "vi", "node", "cards", "ci", "sub", "container", "value", "show", "_c", "_d", "_e", "el", "host", "prev", "cc", "showAll", "cfg", "bg", "cont", "url", "repeat", "opacity", "size", "position", "attachment", "filter", "visList", "hass", "evalCond", "cond", "type", "children", "child", "entity", "stateObj", "st", "v", "val", "mq", "users", "uid", "wraps", "currentTabId", "wrap", "shouldShow", "_f", "_g", "_h", "_i", "_j", "gs", "step", "dx", "dy", "sel", "w", "_k", "_l", "t", "dup", "w2", "x", "y", "tid", "liveSnap", "fixed", "box", "proposed", "rawX", "rawY", "h", "nx", "ny", "sx", "sy", "p", "ref", "width", "rect", "rect2", "editable", "tag", "ev", "path", "n", "outer", "selector", "root", "results", "visit", "treeWalker", "sr", "inp", "updateButtons", "dirty", "isDirty", "applyBtn", "fire", "newConfig", "toggleSizeControls", "mode", "revertBtn", "s", "config", "presetSelect", "groups", "acc", "group", "items", "optgroup", "preset", "item", "header", "base", "current", "baseline", "on", "initial", "cw", "ch", "ww", "hh", "nw", "nh", "nx2", "ny2", "sz", "kind", "msg", "extra", "line", "_m", "_n", "_o", "_p", "_q", "_r", "_s", "_t", "_u", "_v", "prevKey", "lastT", "keyChanged", "io", "entries", "force", "__rebuildAfter", "saved", "local", "yamlCfg", "storage_key", "optsNoKey", "overrideKeys", "cfgOpts", "k", "builtAny", "conf", "cardEl", "tabId", "valid", "tabs", "style", "computed", "initialTransform", "frames", "wrapper", "entryTabId", "chip", "opt", "cur", "entering", "wasOff", "handle", "ox", "oy", "HOLD_MS", "DRIFT_PX", "isElem", "containsSafe", "within", "isOverCard", "makeRing", "fg", "circ", "timer", "ring", "startX", "startY", "activePointerId", "clearTimer", "onPointerDown", "toState", "onPointerMove", "onPointerUpOrCancel", "onContextMenu", "onDblClick", "empty", "toggle", "reason", "clientX", "clientY", "localX", "localY", "veil", "live", "mods", "gridSnap", "lead", "srL", "curLeadX", "curLeadY", "dxLead", "dyLead", "snapX", "snapY", "pr", "endRects", "curW", "curH", "height", "wTry", "hTry", "nextW", "nextH", "prevW", "prevH", "wSnap", "hSnap", "resolve", "delHandle", "act", "targets", "za", "zb", "minZ", "z", "baseMin", "newCfg", "oldEl", "newEl", "shield", "inner", "hero", "heroImgUrl", "img", "title", "card", "delta", "next", "max", "maxX", "maxY", "wEl", "right", "bottom", "gw", "tick", "d", "pw", "availableW", "scale", "cr", "proposedRects", "gridSize", "selectedSet", "allCards", "isFixed", "orig", "snX", "snY", "selectedRects", "finalPos", "cardSizes", "signX", "signY", "horizontal", "other", "candidateX", "candidateY", "ow", "oh", "overlaps", "guard", "candidateRect", "collision", "fp", "pos", "wpx", "hpx", "x0", "y0", "eps", "ignoreSet", "others", "otherRects", "or", "raw", "parsed", "helpers", "err", "getCardClass", "baseCfg", "stubCfg", "inst", "CardClass", "formInfo", "formEl", "entry", "candidates", "delay", "tmp", "it", "S", "o", "any", "fireChange", "clean", "entRow", "entLabel", "entInput", "newVal", "updateAttributeOptions", "grid", "makeField", "labelText", "inputEl", "lab", "nameInput", "iconInput", "attrInput", "attrs", "eid", "FRIENDLY_ATTR_NAMES", "makeLabel", "key", "part", "name", "emptyItem", "emptyOpt", "unitInput", "themeInput", "colorInput", "colWrap", "colorLabel", "cfg2", "themeNames", "prevVal", "sc", "out", "f", "domains", "all", "map", "set", "l", "hostEl", "initialCfg", "onValidChange", "onInvalidChange", "dump", "parse", "initialText", "ed", "programmatic", "txt", "cm", "text", "ta", "rowHeight", "renderRow", "spacer", "mount", "render", "scrollTop", "last", "i", "newItems", "onCommit", "close", "modal", "left", "addTop", "addBottom", "cancelTop", "cancelBot", "search", "cardHost", "editorHost", "editorSpin", "quickFill", "yamlHost", "yamlErr", "yamlSec", "tabVisual", "tabYaml", "tabVis", "visSec", "visHost", "previewSpin", "enableCommit", "setError", "faves", "recent", "catalog", "favSection", "recSection", "allItems", "customItems", "quickFillSecDiv", "optionsHd", "selInfo", "favBtn", "updateFavStar", "currentType", "icon", "updateHeader", "nm", "titleSpan", "renderLeft", "__activeTab", "showTab", "wantYaml", "wantVis", "wantVisual", "visualEditor", "mountVisualEditor", "currentConfig", "buildVisUI", "filteredCatalog", "q", "section", "sec", "cat", "div", "highlight", "selectType", "yamlEditorApi", "editor", "pickSeq", "__previewTimer", "__lastPreviewCfgJSON", "buildQuickFill", "fieldWrap", "addEntityItem", "arr", "keyForMulti", "mountPreview", "row", "label", "pool", "paint", "filtered", "dsWrap", "ds", "iconLead", "dl", "inpWrap", "numIcon", "selWrap", "selIcon", "tIcon", "visExpansionStates", "buildVisUIOld", "reRender", "updateConfig", "headerDiv", "leftWrap", "iconName", "labelSpan", "del", "index", "typeRow", "typeLabel", "typeSel", "fields", "addField", "lbl", "entPicker", "opSel", "optEq", "optNeq", "stInput", "aboveField", "belowField", "screenSel", "presets", "customInp", "userPicker", "addBtn", "__cachedUserList", "fetchUsers", "resp", "fallbackLists", "u", "instr", "renderList", "renderCondition", "addWrap", "existing", "menu", "newCond", "ic", "la", "parentList", "expanded", "rm", "tn", "ent", "op", "above", "below", "opts", "rowcb", "cb", "sp", "up", "loading", "selUsers", "uList", "uname", "commit", "childContainer", "cfgJSON", "seq", "temp", "wantType", "byDomain", "better", "onChange", "nextType", "mountYaml", "shaped", "typeChanged", "getStub", "visReady", "finalCfg", "__searchTimer", "stub", "firstSensor", "defaultEntity", "pick", "areas", "occupied", "xStart", "yStart", "xEnd", "yEnd", "xi", "yi", "cardConfig", "wrappers", "minX", "minY", "clip", "shift", "baseX", "baseY", "marquee", "active", "toLocal", "updateSel", "rRect", "wr", "down", "move", "sk", "usingHost", "logsToHtml", "rows", "refreshLogs", "logArea", "logsToHtmlLocal", "cardCfg", "payload", "blob", "file", "json", "back", "existingModal", "chkAuto", "inpGrid", "chkAnim", "chkHdr", "chkBar", "chkSnap", "chkASave", "inpDeb", "selSize", "selOrient", "chkOverlap", "inpCBg", "inpCardBg", "inpBgImg", "chkDebug", "bgObj", "extrasDiv", "updateSizeExtras", "modeVal", "wrapW", "spanW", "inpW", "wrapH", "spanH", "inpH", "span", "select", "closeModal", "newAuto", "newGrid", "newAnim", "newHideHdr", "newHideBar", "newSnap", "newASave", "newDeb", "newSize", "newOrient", "newOverlap", "newCBg", "newCardBg", "newBgImg", "newDebug", "snapChanged", "sizeChanged", "orientChanged", "wVal", "hVal", "presetVal", "prevBg", "background_image", "rest", "cfgErr", "recalc", "updatedCfg", "HARD_REPLACE", "ADOPT_IMPORTED_STORAGE_KEY", "KNOWN_OPT_KEYS", "_w", "_x", "_y", "_z", "_A", "_B", "_C", "_D", "_E", "_F", "_G", "_H", "_I", "_J", "_K", "_L", "_M", "_N", "_O", "_P", "_Q", "_R", "_S", "_T", "_U", "_V", "prevStorageKey", "hasOptionsTabs", "hasCardTabIds", "compatTabs", "compatTabsPosition", "compatDefaultTab", "compatHideSingle", "imported", "targetKey", "importedOptions", "persistOptions", "result", "yamlOk", "hop", "rHost", "seen", "hits", "push", "obj", "viewIdx", "vv", "patchAllInCurrentViewIfNoKey", "curView", "newKey", "keys", "inCur", "basePatch", "seg", "existingKey", "shouldRename", "silent", "t0", "ms", "data", "res", "message", "ha", "main", "drawer", "ppr", "panel", "SEEN", "isLikelyCard", "rebuildOnce", "deepScan", "installOnInstance", "mo", "muts", "hookExisting", "ctor", "origConnected", "iv", "Cls", "_getLovelace", "_scanDdcCards", "_makeYamlBackup", "patch", "when", "backup", "_offerBackupDownload", "_recordRecentKey", "K", "_getRecentKeys", "_collectBackupKeys", "names", "_persistOptionsToYaml", "forceTargetKey", "onlyThisCard", "noDownload", "norm", "myKey", "cardsForStorage", "_fetchBackendKeys", "parseKeys", "urls", "_fetchLayoutByKey", "parseDesign", "tryCall", "method", "params", "tryFetch", "ct", "j", "enc", "_applyDesignObject", "source", "toPersist", "_updateSwitcherVisibility", "edit", "hui", "_ensureInlineSwitcher", "toolbar", "fill", "serverKeys", "backupKeys", "recentKeys", "toUnique", "server", "backups", "makeGroup", "og", "none", "design", "oldKey", "persistOk", "persistOpts", "e2", "desc", "origSet", "origUpdate", "args"]
}
